<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Source code Review / SAST Tools</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="源代码审查--sast-工具"><a class="header" href="#源代码审查--sast-工具">源代码审查 / SAST 工具</a></h1>
<p>{% hint style="success" %}
学习与实践 AWS 黑客技术：<img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习与实践 GCP 黑客技术：<img src="../../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="../../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>Telegram 群组</strong></a> 或 <strong>关注</strong> 我们的 <strong>Twitter</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub 仓库提交 PR 分享黑客技巧。</li>
</ul>
</details>
{% endhint %}
<h2 id="指导和工具列表"><a class="header" href="#指导和工具列表">指导和工具列表</a></h2>
<ul>
<li><a href="https://owasp.org/www-community/Source_Code_Analysis_Tools"><strong>https://owasp.org/www-community/Source_Code_Analysis_Tools</strong></a></li>
<li><a href="https://github.com/analysis-tools-dev/static-analysis"><strong>https://github.com/analysis-tools-dev/static-analysis</strong></a></li>
</ul>
<h2 id="多语言工具"><a class="header" href="#多语言工具">多语言工具</a></h2>
<h3 id="naxus---ai-gents"><a class="header" href="#naxus---ai-gents"><a href="https://www.naxusai.com/">Naxus - AI-Gents</a></a></h3>
<p>有一个 <strong>免费包来审查 PR</strong>。</p>
<h3 id="semgrep"><a class="header" href="#semgrep"><a href="https://github.com/returntocorp/semgrep"><strong>Semgrep</strong></a></a></h3>
<p>这是一个 <strong>开源工具</strong>。</p>
<h4 id="支持的语言"><a class="header" href="#支持的语言">支持的语言</a></h4>
<div class="table-wrapper"><table><thead><tr><th>类别</th><th>语言</th></tr></thead><tbody>
<tr><td>GA</td><td>C# · Go · Java · JavaScript · JSX · JSON · PHP · Python · Ruby · Scala · Terraform · TypeScript · TSX</td></tr>
<tr><td>Beta</td><td>Kotlin · Rust</td></tr>
<tr><td>Experimental</td><td>Bash · C · C++ · Clojure · Dart · Dockerfile · Elixir · HTML · Julia · Jsonnet · Lisp ·</td></tr>
</tbody></table>
</div>
<h4 id="快速开始"><a class="header" href="#快速开始">快速开始</a></h4>
<p>{% code overflow="wrap" %}</p>
<pre><code class="language-bash"># Install https://github.com/returntocorp/semgrep#option-1-getting-started-from-the-cli
brew install semgrep

# Go to your repo code and scan
cd repo
semgrep scan --config auto
</code></pre>
<p>{% endcode %}</p>
<p>您还可以使用 <a href="https://marketplace.visualstudio.com/items?itemName=Semgrep.semgrep"><strong>semgrep VSCode 扩展</strong></a> 在 VSCode 中获取发现结果。</p>
<h3 id="sonarqube"><a class="header" href="#sonarqube"><a href="https://www.sonarsource.com/products/sonarqube/downloads/"><strong>SonarQube</strong></a></a></h3>
<p>有一个可安装的 <strong>免费版本</strong>。</p>
<h4 id="快速开始-1"><a class="header" href="#快速开始-1">快速开始</a></h4>
<p>{% code overflow="wrap" %}</p>
<pre><code class="language-bash"># Run the paltform in docker
docker run -d --name sonarqube -e SONAR_ES_BOOTSTRAP_CHECKS_DISABLE=true -p 9000:9000 sonarqube:latest
# Install cli tool
brew install sonar-scanner

# Go to localhost:9000 and login with admin:admin or admin:sonar
# Generate a local project and then a TOKEN for it

# Using the token and from the folder with the repo, scan it
cd path/to/repo
sonar-scanner \
-Dsonar.projectKey=&lt;project-name&gt; \
-Dsonar.sources=. \
-Dsonar.host.url=http://localhost:9000 \
-Dsonar.token=&lt;sonar_project_token&gt;
</code></pre>
<p>{% endcode %}</p>
<h3 id="codeql"><a class="header" href="#codeql">CodeQL</a></h3>
<p>有一个<strong>可安装的免费版本</strong>，但根据许可证，您<strong>只能在开源项目中使用免费代码QL版本</strong>。</p>
<h4 id="安装"><a class="header" href="#安装">安装</a></h4>
<p>{% code overflow="wrap" %}</p>
<pre><code class="language-bash"># Download your release from https://github.com/github/codeql-action/releases
## Example
wget https://github.com/github/codeql-action/releases/download/codeql-bundle-v2.14.3/codeql-bundle-osx64.tar.gz

# Move it to the destination folder
mkdir ~/codeql
mv codeql-bundle* ~/codeql

# Decompress it
cd ~/codeql
tar -xzvf codeql-bundle-*.tar.gz
rm codeql-bundle-*.tar.gz

# Add to path
echo 'export PATH="$PATH:/Users/username/codeql/codeql"' &gt;&gt; ~/.zshrc

# Check it's correctly installed
## Open a new terminal
codeql resolve qlpacks #Get paths to QL packs
</code></pre>
<p>{% endcode %}</p>
<h4 id="快速开始---准备数据库"><a class="header" href="#快速开始---准备数据库">快速开始 - 准备数据库</a></h4>
<p>{% hint style="success" %}
您需要做的第一件事是<strong>准备数据库</strong>（创建代码树），以便后续查询可以在其上运行。
{% endhint %}</p>
<ul>
<li>您可以允许 codeql 自动识别仓库的语言并创建数据库</li>
</ul>
<p>{% code overflow="wrap" %}</p>
<pre><code class="language-bash">codeql database create &lt;database&gt; --language &lt;language&gt;

# Example
codeql database create /path/repo/codeql_db --source-root /path/repo
## DB will be created in /path/repo/codeql_db
</code></pre>
<p>{% endcode %}</p>
<p>{% hint style="danger" %}
这<strong>通常会触发一个错误</strong>，说指定了多个语言（或自动检测到）。<strong>检查下一个选项</strong>以修复此问题！
{% endhint %}</p>
<ul>
<li>您可以<strong>手动指示****repo</strong>和<strong>语言</strong>（<a href="https://docs.github.com/en/code-security/codeql-cli/getting-started-with-the-codeql-cli/preparing-your-code-for-codeql-analysis#running-codeql-database-create">语言列表</a>）</li>
</ul>
<p>{% code overflow="wrap" %}</p>
<pre><code class="language-bash">codeql database create &lt;database&gt; --language &lt;language&gt; --source-root &lt;/path/to/repo&gt;

# Example
codeql database create /path/repo/codeql_db --language javascript --source-root /path/repo
## DB will be created in /path/repo/codeql_db
</code></pre>
<p>{% endcode %}</p>
<ul>
<li>如果您的代码库使用<strong>多于1种语言</strong>，您还可以为每种语言创建<strong>1个数据库</strong>，并指明每种语言。</li>
</ul>
<p>{% code overflow="wrap" %}</p>
<pre><code class="language-bash">export GITHUB_TOKEN=ghp_32849y23hij4...
codeql database create &lt;database&gt; --source-root /path/to/repo --db-cluster --language "javascript,python"

# Example
export GITHUB_TOKEN=ghp_32849y23hij4...
codeql database create /path/repo/codeql_db --source-root /path/to/repo --db-cluster --language "javascript,python"
## DBs will be created in /path/repo/codeql_db/*
</code></pre>
<p>{% endcode %}</p>
<ul>
<li>您还可以允许 <code>codeql</code> <strong>为您识别所有语言</strong>并为每种语言创建一个数据库。您需要提供一个 <strong>GITHUB_TOKEN</strong>。</li>
</ul>
<p>{% code overflow="wrap" %}</p>
<pre><code class="language-bash">export GITHUB_TOKEN=ghp_32849y23hij4...
codeql database create &lt;database&gt; --db-cluster --source-root &lt;/path/to/repo&gt;

# Example
export GITHUB_TOKEN=ghp_32849y23hij4...
codeql database create /tmp/codeql_db --db-cluster --source-root /path/repo
## DBs will be created in /path/repo/codeql_db/*
</code></pre>
<p>{% endcode %}</p>
<h4 id="快速开始---分析代码"><a class="header" href="#快速开始---分析代码">快速开始 - 分析代码</a></h4>
<p>{% hint style="success" %}
现在终于是分析代码的时候了
{% endhint %}</p>
<p>请记住，如果您使用了多种语言，<strong>每种语言都会在您指定的路径中创建一个数据库</strong>。</p>
<p>{% code overflow="wrap" %}</p>
<pre><code class="language-bash"># Default analysis
codeql database analyze &lt;database&gt; --format=&lt;format&gt; --output=&lt;/out/file/path&gt;
# Example
codeql database analyze /tmp/codeql_db/javascript --format=sarif-latest --output=/tmp/graphql_results.sarif

# Specify QL pack to use in the analysis
codeql database analyze &lt;database&gt; \
&lt;qls pack&gt; --sarif-category=&lt;language&gt; \
--sarif-add-baseline-file-info \ --format=&lt;format&gt; \
--output=/out/file/path&gt;
# Example
codeql database analyze /tmp/codeql_db \
javascript-security-extended --sarif-category=javascript \
--sarif-add-baseline-file-info --format=sarif-latest \
--output=/tmp/sec-extended.sarif
</code></pre>
<h4 id="快速开始---脚本化"><a class="header" href="#快速开始---脚本化">快速开始 - 脚本化</a></h4>
<p>{% code overflow="wrap" %}</p>
<pre><code class="language-bash">export GITHUB_TOKEN=ghp_32849y23hij4...
export REPO_PATH=/path/to/repo
export OUTPUT_DIR_PATH="$REPO_PATH/codeql_results"
mkdir -p "$OUTPUT_DIR_PATH"
export FINAL_MSG="Results available in: "

echo "Creating DB"
codeql database create "$REPO_PATH/codeql_db" --db-cluster --source-root "$REPO_PATH"
for db in `ls "$REPO_PATH/codeql_db"`; do
echo "Analyzing $db"
codeql database analyze "$REPO_PATH/codeql_db/$db" --format=sarif-latest --output="${OUTPUT_DIR_PATH}/$db).sarif"
FINAL_MSG="$FINAL_MSG ${OUTPUT_DIR_PATH}/$db.sarif ,"
echo ""
done

echo $FINAL_MSG
</code></pre>
<p>{% endcode %}</p>
<p>您可以在 <a href="https://microsoft.github.io/sarif-web-component/"><strong>https://microsoft.github.io/sarif-web-component/</strong></a> 中可视化发现的结果，或使用 VSCode 扩展 <a href="https://marketplace.visualstudio.com/items?itemName=MS-SarifVSCode.sarif-viewer"><strong>SARIF viewer</strong></a>。</p>
<p>您还可以使用 <a href="https://marketplace.visualstudio.com/items?itemName=GitHub.vscode-codeql"><strong>VSCode 扩展</strong></a> 在 VSCode 中获取发现的结果。您仍然需要手动创建数据库，但之后您可以选择任何文件并点击 <code>右键</code> -&gt; <code>CodeQL: 在选定文件中运行查询</code></p>
<h3 id="snyk"><a class="header" href="#snyk"><a href="https://snyk.io/product/snyk-code/"><strong>Snyk</strong></a></a></h3>
<p>有一个 <strong>可安装的免费版本</strong>。</p>
<h4 id="快速入门"><a class="header" href="#快速入门">快速入门</a></h4>
<pre><code class="language-bash"># Install
sudo npm install -g snyk

# Authenticate (you can use a free account)
snyk auth

# Test for open source vulns &amp; license issues
snyk test [--all-projects]

# Test for code vulnerabilities
## This will upload your code and you need to enable this option in: Settings &gt; Snyk Code
snyk test code

# Test for vulns in images
snyk container test [image]

# Test for IaC vulns
snyk iac test
</code></pre>
<p>您还可以使用 <a href="https://marketplace.visualstudio.com/items?itemName=snyk-security.snyk-vulnerability-scanner"><strong>snyk VSCode Extension</strong></a> 在 VSCode 中获取发现。</p>
<h3 id="insider"><a class="header" href="#insider"><a href="https://github.com/insidersec/insider">Insider</a></a></h3>
<p>它是 <strong>开源</strong> 的，但看起来 <strong>未维护</strong>。</p>
<h4 id="支持的语言-1"><a class="header" href="#支持的语言-1">支持的语言</a></h4>
<p>Java (Maven 和 Android)、Kotlin (Android)、Swift (iOS)、.NET Full Framework、C# 和 Javascript (Node.js)。</p>
<h4 id="快速开始-2"><a class="header" href="#快速开始-2">快速开始</a></h4>
<pre><code class="language-bash"># Check the correct release for your environment
$ wget https://github.com/insidersec/insider/releases/download/2.1.0/insider_2.1.0_linux_x86_64.tar.gz
$ tar -xf insider_2.1.0_linux_x86_64.tar.gz
$ chmod +x insider
$ ./insider --tech javascript  --target &lt;projectfolder&gt;
</code></pre>
<h3 id="deepsource"><a class="header" href="#deepsource"><a href="https://deepsource.com/pricing"><strong>DeepSource</strong></a></a></h3>
<p>对<strong>公共仓库</strong>免费。</p>
<h2 id="nodejs"><a class="header" href="#nodejs">NodeJS</a></h2>
<ul>
<li><strong><code>yarn</code></strong></li>
</ul>
<pre><code class="language-bash"># Install
brew install yarn
# Run
cd /path/to/repo
yarn install
yarn audit # In lower versions
yarn npm audit # In 2+ versions

npm audit
</code></pre>
<ul>
<li><strong><code>pnpm</code></strong></li>
</ul>
<pre><code class="language-bash"># Install
npm install -g pnpm
# Run
cd /path/to/repo
pnpm install
pnpm audit
</code></pre>
<ul>
<li><a href="https://github.com/ajinabraham/nodejsscan"><strong>nodejsscan</strong></a><strong>:</strong> 用于 Node.js 应用程序的静态安全代码扫描器 (SAST)，由 <a href="https://github.com/ajinabraham/libsast">libsast</a> 和 <a href="https://github.com/returntocorp/semgrep">semgrep</a> 提供支持。</li>
</ul>
<pre><code class="language-bash"># Install &amp; run
docker run -it -p 9090:9090 opensecurity/nodejsscan:latest
# Got to localhost:9090
# Upload a zip file with the code
</code></pre>
<ul>
<li><a href="https://github.com/RetireJS/retire.js"><strong>RetireJS</strong></a><strong>:</strong> Retire.js的目标是帮助您检测使用具有已知漏洞的JS库版本。</li>
</ul>
<pre><code class="language-bash"># Install
npm install -g retire
# Run
cd /path/to/repo
retire --colors
</code></pre>
<h2 id="electron"><a class="header" href="#electron">Electron</a></h2>
<ul>
<li><a href="https://github.com/doyensec/electronegativity"><strong>electronegativity</strong></a><strong>:</strong> 这是一个用于识别基于Electron的应用程序中的错误配置和安全反模式的工具。</li>
</ul>
<h2 id="python"><a class="header" href="#python">Python</a></h2>
<ul>
<li><a href="https://github.com/PyCQA/bandit"><strong>Bandit</strong></a><strong>:</strong> Bandit是一个旨在发现Python代码中常见安全问题的工具。为此，Bandit处理每个文件，从中构建AST，并对AST节点运行适当的插件。一旦Bandit完成对所有文件的扫描，它会生成一份报告。</li>
</ul>
<pre><code class="language-bash"># Install
pip3 install bandit

# Run
bandit -r &lt;path to folder&gt;
</code></pre>
<ul>
<li><a href="https://github.com/pyupio/safety"><strong>safety</strong></a>: Safety 检查 Python 依赖项是否存在已知安全漏洞，并建议针对检测到的漏洞的适当修复措施。Safety 可以在开发者机器、CI/CD 管道和生产系统上运行。</li>
</ul>
<pre><code class="language-bash"># Install
pip install safety
# Run
safety check
</code></pre>
<ul>
<li><a href="https://github.com/python-security/pyt"><del><strong>Pyt</strong></del></a>: 不再维护。</li>
</ul>
<h2 id="net"><a class="header" href="#net">.NET</a></h2>
<pre><code class="language-bash"># dnSpy
https://github.com/0xd4d/dnSpy

# .NET compilation
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe test.cs
</code></pre>
<h2 id="rust"><a class="header" href="#rust">RUST</a></h2>
<pre><code class="language-bash"># Install
cargo install cargo-audit

# Run
cargo audit

#Update the Advisory Database
cargo audit fetch
</code></pre>
<h2 id="java"><a class="header" href="#java">Java</a></h2>
<pre><code class="language-bash"># JD-Gui
https://github.com/java-decompiler/jd-gui

# Java compilation step-by-step
javac -source 1.8 -target 1.8 test.java
mkdir META-INF
echo "Main-Class: test" &gt; META-INF/MANIFEST.MF
jar cmvf META-INF/MANIFEST.MF test.jar test.class
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>任务</th><th>命令</th></tr></thead><tbody>
<tr><td>执行 Jar</td><td>java -jar [jar]</td></tr>
<tr><td>解压 Jar</td><td>unzip -d [output directory] [jar]</td></tr>
<tr><td>创建 Jar</td><td>jar -cmf META-INF/MANIFEST.MF [output jar] *</td></tr>
<tr><td>Base64 SHA256</td><td>sha256sum [file] | cut -d' ' -f1 | xxd -r -p | base64</td></tr>
<tr><td>移除签名</td><td>rm META-INF/<em>.SF META-INF/</em>.RSA META-INF/*.DSA</td></tr>
<tr><td>从 Jar 中删除</td><td>zip -d [jar] [file to remove]</td></tr>
<tr><td>反编译类</td><td>procyon -o . [path to class]</td></tr>
<tr><td>反编译 Jar</td><td>procyon -jar [jar] -o [output directory]</td></tr>
<tr><td>编译类</td><td>javac [path to .java file]</td></tr>
</tbody></table>
</div>
<h2 id="go"><a class="header" href="#go">Go</a></h2>
<pre><code class="language-bash">https://github.com/securego/gosec
</code></pre>
<h2 id="php"><a class="header" href="#php">PHP</a></h2>
<p><a href="https://phpmagazine.net/2018/12/find-errors-in-your-php-applications-with-psalm.html">Psalm</a> 和 <a href="https://phpmagazine.net/2020/09/phpstan-pro-edition-launched.html">PHPStan</a>。</p>
<h3 id="wordpress-插件"><a class="header" href="#wordpress-插件">Wordpress 插件</a></h3>
<p><a href="https://www.pluginvulnerabilities.com/plugin-security-checker/">https://www.pluginvulnerabilities.com/plugin-security-checker/</a></p>
<h2 id="solidity"><a class="header" href="#solidity">Solidity</a></h2>
<ul>
<li><a href="https://www.npmjs.com/package/solium">https://www.npmjs.com/package/solium</a></li>
</ul>
<h2 id="javascript"><a class="header" href="#javascript">JavaScript</a></h2>
<h3 id="发现"><a class="header" href="#发现">发现</a></h3>
<ol>
<li>Burp:</li>
</ol>
<ul>
<li>爬虫并发现内容</li>
<li>网站地图 &gt; 过滤</li>
<li>网站地图 &gt; 右键点击域名 &gt; 参与工具 &gt; 查找脚本</li>
</ul>
<ol start="2">
<li><a href="https://github.com/tomnomnom/waybackurls">WaybackURLs</a>:</li>
</ol>
<ul>
<li><code>waybackurls &lt;domain&gt; |grep -i "\.js" |sort -u</code></li>
</ul>
<h3 id="静态分析"><a class="header" href="#静态分析">静态分析</a></h3>
<h4 id="反压缩美化格式化"><a class="header" href="#反压缩美化格式化">反压缩/美化/格式化</a></h4>
<ul>
<li><a href="https://prettier.io/playground/">https://prettier.io/playground/</a></li>
<li><a href="https://beautifier.io/">https://beautifier.io/</a></li>
<li>参见下面“反混淆/解包”中提到的一些工具。</li>
</ul>
<h4 id="反混淆解包"><a class="header" href="#反混淆解包">反混淆/解包</a></h4>
<p><strong>注意</strong>：可能无法完全反混淆。</p>
<ol>
<li>查找并使用 .map 文件：</li>
</ol>
<ul>
<li>如果 .map 文件被暴露，可以用来轻松反混淆。</li>
<li>通常，foo.js.map 映射到 foo.js。手动查找它们。</li>
<li>使用 <a href="https://github.com/PortSwigger/js-miner">JS Miner</a> 查找它们。</li>
<li>确保进行主动扫描。</li>
<li>阅读 '<a href="https://github.com/minamo7sen/burp-JS-Miner/wiki#tips--notes">提示/注意事项</a>'</li>
<li>如果找到，使用 <a href="https://www.npmjs.com/package/maximize">Maximize</a> 进行反混淆。</li>
</ul>
<ol start="2">
<li>如果没有 .map 文件，尝试 JSnice：</li>
</ol>
<ul>
<li>参考： <a href="http://jsnice.org/">http://jsnice.org/</a> &amp; <a href="https://www.npmjs.com/package/jsnice">https://www.npmjs.com/package/jsnice</a></li>
<li>提示：</li>
<li>如果使用 jsnice.org，点击“Nicify JavaScript”按钮旁边的选项按钮，取消选择“推断类型”，以减少代码中的注释杂乱。</li>
<li>确保在脚本之前没有留下任何空行，因为这可能会影响反混淆过程并给出不准确的结果。</li>
</ul>
<ol start="3">
<li>对于一些更现代的 JSNice 替代品，您可能想查看以下内容：</li>
</ol>
<ul>
<li><a href="https://github.com/pionxzh/wakaru">https://github.com/pionxzh/wakaru</a></li>
<li>
<blockquote>
<p>Javascript 反编译器、解包器和反压缩工具包 Wakaru 是现代前端的 Javascript 反编译器。它从打包和转译的源代码中恢复原始代码。</p>
</blockquote>
</li>
<li><a href="https://github.com/j4k0xb/webcrack">https://github.com/j4k0xb/webcrack</a></li>
<li>
<blockquote>
<p>反混淆 obfuscator.io，反压缩和解包打包的 javascript</p>
</blockquote>
</li>
<li><a href="https://github.com/jehna/humanify">https://github.com/jehna/humanify</a></li>
<li>
<blockquote>
<p>使用 ChatGPT 反压缩 Javascript 代码 此工具使用大型语言模型（如 ChatGPT 和 llama2）及其他工具来反压缩 Javascript 代码。请注意，LLM 不会进行任何结构性更改 – 它们仅提供重命名变量和函数的提示。重任由 Babel 在 AST 级别完成，以确保代码保持 1-1 等价。</p>
</blockquote>
</li>
<li><a href="https://thejunkland.com/blog/using-llms-to-reverse-javascript-minification.html">https://thejunkland.com/blog/using-llms-to-reverse-javascript-minification.html</a></li>
<li>
<blockquote>
<p>使用 LLM 反转 JavaScript 变量名压缩</p>
</blockquote>
</li>
</ul>
<ol start="3">
<li>使用 <code>console.log()</code>；</li>
</ol>
<ul>
<li>找到返回值并将其更改为 <code>console.log(&lt;packerReturnVariable&gt;);</code>，以便打印反混淆的 js，而不是执行它。</li>
<li>然后，将修改后的（仍然混淆的）js 粘贴到 <a href="https://jsconsole.com/">https://jsconsole.com/</a> 以查看反混淆的 js 记录到控制台。</li>
<li>最后，将反混淆的输出粘贴到 <a href="https://prettier.io/playground/">https://prettier.io/playground/</a> 以美化它以便分析。</li>
<li><strong>注意</strong>：如果您仍然看到打包的（但不同的）js，可能是递归打包。重复该过程。</li>
</ul>
<h4 id="参考"><a class="header" href="#参考">参考</a></h4>
<ul>
<li><a href="https://www.youtube.com/watch?v=_v8r_t4v6hQ">YouTube: DAST - Javascript 动态分析</a></li>
<li><a href="https://web.archive.org/web/20221226054137/https://blog.nvisium.com/angular-for-pentesters-part-1">https://blog.nvisium.com/angular-for-pentesters-part-1</a></li>
<li><a href="https://web.archive.org/web/20230204012439/https://blog.nvisium.com/angular-for-pentesters-part-2">https://blog.nvisium.com/angular-for-pentesters-part-2</a></li>
<li><a href="https://twitter.com/_devalias">devalias</a> 的 <a href="https://gist.github.com/0xdevalias">GitHub Gists</a>:</li>
<li><a href="https://gist.github.com/0xdevalias/d8b743efb82c0e9406fc69da0d6c6581#deobfuscating--unminifying-obfuscated-web-app-code">反混淆/反压缩混淆的 Web 应用代码</a></li>
<li><a href="https://gist.github.com/0xdevalias/8c621c5d09d780b1d321bfdb86d67cdd#reverse-engineering-webpack-apps">逆向工程 Webpack 应用</a></li>
<li><a href="https://gist.github.com/search?q=user:0xdevalias+javascript">等</a></li>
</ul>
<h4 id="工具"><a class="header" href="#工具">工具</a></h4>
<ul>
<li><a href="https://portswigger.net/burp/documentation/desktop/tools/dom-invader">https://portswigger.net/burp/documentation/desktop/tools/dom-invader</a></li>
</ul>
<h4 id="较少使用的参考"><a class="header" href="#较少使用的参考">较少使用的参考</a></h4>
<ul>
<li><a href="https://cyberchef.org/">https://cyberchef.org/</a></li>
<li><a href="https://olajs.com/javascript-prettifier">https://olajs.com/javascript-prettifier</a></li>
<li><a href="https://jshint.com/">https://jshint.com/</a></li>
<li><a href="https://github.com/jshint/jshint/">https://github.com/jshint/jshint/</a></li>
</ul>
<p>{% hint style="success" %}
学习与实践 AWS 黑客攻击：<img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习与实践 GCP 黑客攻击： <img src="../../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="../../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>电报群组</strong></a> 或 <strong>在 Twitter 上关注</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> github 仓库提交 PR 来分享黑客技巧。</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../network-services-pentesting/pentesting-web/special-http-headers.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../network-services-pentesting/pentesting-web/spring-actuators.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../network-services-pentesting/pentesting-web/special-http-headers.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../network-services-pentesting/pentesting-web/spring-actuators.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
