<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>80,443 - Pentesting Web Methodology</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="80443---pentesting-web-methodology"><a class="header" href="#80443---pentesting-web-methodology">80,443 - Pentesting Web Methodology</a></h1>
<p>{% hint style="success" %}
学习和实践 AWS 黑客技术：<img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习和实践 GCP 黑客技术：<img src="../../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="../../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>Telegram 群组</strong></a> 或 <strong>关注</strong> 我们的 <strong>Twitter</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub 仓库提交 PR 分享黑客技巧。</li>
</ul>
</details>
{% endhint %}
<figure><img src="../../.gitbook/assets/pentest-tools.svg" alt=""><figcaption></figcaption></figure>
<p><strong>从黑客的角度看待您的网络应用、网络和云</strong></p>
<p><strong>发现并报告具有实际商业影响的关键可利用漏洞。</strong> 使用我们 20 多个自定义工具来映射攻击面，查找让您提升权限的安全问题，并使用自动化漏洞利用收集重要证据，将您的辛勤工作转化为有说服力的报告。</p>
<p>{% embed url="https://pentest-tools.com/?utm_term=jul2024&amp;utm_medium=link&amp;utm_source=hacktricks&amp;utm_campaign=spons" %}</p>
<h2 id="基本信息"><a class="header" href="#基本信息">基本信息</a></h2>
<p>网络服务是最 <strong>常见和广泛的服务</strong>，存在许多 <strong>不同类型的漏洞</strong>。</p>
<p><strong>默认端口：</strong> 80 (HTTP)，443(HTTPS)</p>
<pre><code class="language-bash">PORT    STATE SERVICE
80/tcp  open  http
443/tcp open  ssl/https
</code></pre>
<pre><code class="language-bash">nc -v domain.com 80 # GET / HTTP/1.0
openssl s_client -connect domain.com:443 # GET / HTTP/1.0
</code></pre>
<h3 id="web-api-guidance"><a class="header" href="#web-api-guidance">Web API Guidance</a></h3>
<p>{% content-ref url="web-api-pentesting.md" %}
<a href="web-api-pentesting.html">web-api-pentesting.md</a>
{% endcontent-ref %}</p>
<h2 id="methodology-summary"><a class="header" href="#methodology-summary">Methodology summary</a></h2>
<blockquote>
<p>在这个方法论中，我们假设你将攻击一个域（或子域），仅此而已。因此，你应该将此方法论应用于每个发现的域、子域或具有不确定网络服务器的IP。</p>
</blockquote>
<ul>
<li><input disabled="" type="checkbox"/>
首先<strong>识别</strong>网络服务器使用的<strong>技术</strong>。寻找<strong>技巧</strong>，以便在测试的其余部分中牢记，如果你能成功识别技术。</li>
<li><input disabled="" type="checkbox"/>
该技术版本是否有任何<strong>已知漏洞</strong>？</li>
<li><input disabled="" type="checkbox"/>
使用任何<strong>知名技术</strong>？有没有<strong>有用的技巧</strong>来提取更多信息？</li>
<li><input disabled="" type="checkbox"/>
是否有任何<strong>专业扫描器</strong>可以运行（如wpscan）？</li>
<li><input disabled="" type="checkbox"/>
启动<strong>通用扫描器</strong>。你永远不知道它们是否会发现某些东西或找到一些有趣的信息。</li>
<li><input disabled="" type="checkbox"/>
从<strong>初始检查</strong>开始：<strong>robots</strong>、<strong>sitemap</strong>、<strong>404</strong>错误和<strong>SSL/TLS扫描</strong>（如果是HTTPS）。</li>
<li><input disabled="" type="checkbox"/>
开始<strong>爬取</strong>网页：是时候<strong>查找</strong>所有可能的<strong>文件、文件夹</strong>和<strong>使用的参数</strong>。同时，检查<strong>特殊发现</strong>。</li>
<li><input disabled="" type="checkbox"/>
<em>注意，在暴力破解或爬取过程中发现新目录时，应进行爬取。</em></li>
<li><input disabled="" type="checkbox"/>
<strong>目录暴力破解</strong>：尝试暴力破解所有发现的文件夹，寻找新的<strong>文件</strong>和<strong>目录</strong>。</li>
<li><input disabled="" type="checkbox"/>
<em>注意，在暴力破解或爬取过程中发现新目录时，应进行暴力破解。</em></li>
<li><input disabled="" type="checkbox"/>
<strong>备份检查</strong>：测试是否可以通过附加常见备份扩展名找到<strong>发现的文件</strong>的<strong>备份</strong>。</li>
<li><input disabled="" type="checkbox"/>
<strong>暴力破解参数</strong>：尝试<strong>查找隐藏参数</strong>。</li>
<li><input disabled="" type="checkbox"/>
一旦你<strong>识别</strong>了所有可能接受<strong>用户输入</strong>的<strong>端点</strong>，检查与之相关的各种<strong>漏洞</strong>。</li>
<li><input disabled="" type="checkbox"/>
<a href="../../pentesting-web/web-vulnerabilities-methodology.html">遵循此检查清单</a></li>
</ul>
<h2 id="server-version-vulnerable"><a class="header" href="#server-version-vulnerable">Server Version (Vulnerable?)</a></h2>
<h3 id="identify"><a class="header" href="#identify">Identify</a></h3>
<p>检查正在运行的服务器<strong>版本</strong>是否存在<strong>已知漏洞</strong>。<br />
<strong>HTTP响应的头部和cookie</strong>可能非常有用，以<strong>识别</strong>所使用的<strong>技术</strong>和/或<strong>版本</strong>。<strong>Nmap扫描</strong>可以识别服务器版本，但工具<a href="https://github.com/urbanadventurer/WhatWeb"><strong>whatweb</strong></a><strong>、</strong><a href="https://github.com/ShielderSec/webtech"><strong>webtech</strong></a>或<a href="https://builtwith.com"><strong>https://builtwith.com/</strong></a><strong>也可能有用：</strong></p>
<pre><code class="language-bash">whatweb -a 1 &lt;URL&gt; #Stealthy
whatweb -a 3 &lt;URL&gt; #Aggresive
webtech -u &lt;URL&gt;
webanalyze -host https://google.com -crawl 2
</code></pre>
<p>Search <strong>for</strong> <a href="../../generic-hacking/search-exploits.html"><strong>web应用程序版本的漏洞</strong></a></p>
<h3 id="检查是否有waf"><a class="header" href="#检查是否有waf"><strong>检查是否有WAF</strong></a></h3>
<ul>
<li><a href="https://github.com/EnableSecurity/wafw00f"><strong>https://github.com/EnableSecurity/wafw00f</strong></a></li>
<li><a href="https://github.com/Ekultek/WhatWaf.git"><strong>https://github.com/Ekultek/WhatWaf.git</strong></a></li>
<li><a href="https://nmap.org/nsedoc/scripts/http-waf-detect.html"><strong>https://nmap.org/nsedoc/scripts/http-waf-detect.html</strong></a></li>
</ul>
<h3 id="web技术技巧"><a class="header" href="#web技术技巧">Web技术技巧</a></h3>
<p>一些<strong>技巧</strong>用于<strong>查找</strong>不同知名<strong>技术</strong>中的<strong>漏洞</strong>：</p>
<ul>
<li><a href="aem-adobe-experience-cloud.html"><strong>AEM - Adobe Experience Cloud</strong></a></li>
<li><a href="apache.html"><strong>Apache</strong></a></li>
<li><a href="artifactory-hacking-guide.html"><strong>Artifactory</strong></a></li>
<li><a href="buckets/"><strong>Buckets</strong></a></li>
<li><a href="cgi.html"><strong>CGI</strong></a></li>
<li><a href="drupal/"><strong>Drupal</strong></a></li>
<li><a href="flask.html"><strong>Flask</strong></a></li>
<li><a href="git.html"><strong>Git</strong></a></li>
<li><a href="golang.html"><strong>Golang</strong></a></li>
<li><a href="graphql.html"><strong>GraphQL</strong></a></li>
<li><a href="h2-java-sql-database.html"><strong>H2 - Java SQL数据库</strong></a></li>
<li><a href="iis-internet-information-services.html"><strong>IIS技巧</strong></a></li>
<li><a href="jboss.html"><strong>JBOSS</strong></a></li>
<li><a href="%5Bhttps:/github.com/carlospolop/hacktricks/blob/master/network-services-pentesting/pentesting-web/broken-reference/README.html"><strong>Jenkins</strong></a></li>
<li><a href="jira.html"><strong>Jira</strong></a></li>
<li><a href="joomla.html"><strong>Joomla</strong></a></li>
<li><a href="jsp.html"><strong>JSP</strong></a></li>
<li><a href="laravel.html"><strong>Laravel</strong></a></li>
<li><a href="moodle.html"><strong>Moodle</strong></a></li>
<li><a href="nginx.html"><strong>Nginx</strong></a></li>
<li><a href="php-tricks-esp/"><strong>PHP（php有很多有趣的技巧可以被利用）</strong></a></li>
<li><a href="python.html"><strong>Python</strong></a></li>
<li><a href="spring-actuators.html"><strong>Spring Actuators</strong></a></li>
<li><a href="symphony.html"><strong>Symphony</strong></a></li>
<li><a href="tomcat/"><strong>Tomcat</strong></a></li>
<li><a href="vmware-esx-vcenter....html"><strong>VMWare</strong></a></li>
<li><a href="web-api-pentesting.html"><strong>Web API Pentesting</strong></a></li>
<li><a href="put-method-webdav.html"><strong>WebDav</strong></a></li>
<li><a href="werkzeug.html"><strong>Werkzeug</strong></a></li>
<li><a href="wordpress.html"><strong>Wordpress</strong></a></li>
<li><a href="electron-desktop-apps/"><strong>Electron Desktop (XSS到RCE)</strong></a></li>
</ul>
<p><em>请注意，<strong>同一域名</strong>可能在不同的<strong>端口</strong>、<strong>文件夹</strong>和<strong>子域名</strong>中使用<strong>不同的技术</strong>。</em><br />
如果web应用程序使用任何知名的<strong>技术/平台</strong>或<strong>其他任何技术</strong>，请不要忘记<strong>在互联网上搜索</strong>新的技巧（并告诉我！）。</p>
<h3 id="源代码审查"><a class="header" href="#源代码审查">源代码审查</a></h3>
<p>如果应用程序的<strong>源代码</strong>在<strong>github</strong>上可用，除了进行<strong>自己的白盒测试</strong>外，还有<strong>一些信息</strong>可能对当前的<strong>黑盒测试</strong>是<strong>有用的</strong>：</p>
<ul>
<li>是否有<strong>变更日志或自述文件或版本</strong>文件或任何带有**版本信息的可通过网络访问的内容？</li>
<li><strong>凭据</strong>是如何保存的？是否有任何（可访问的？）<strong>文件</strong>包含凭据（用户名或密码）？</li>
<li><strong>密码</strong>是以<strong>明文</strong>、<strong>加密</strong>还是使用了哪种<strong>哈希算法</strong>？</li>
<li>是否使用任何<strong>主密钥</strong>来加密某些内容？使用了哪种<strong>算法</strong>？</li>
<li>你能否通过利用某个漏洞<strong>访问这些文件</strong>？</li>
<li>在github中是否有任何<strong>有趣的信息</strong>（已解决和未解决的）<strong>问题</strong>？或者在<strong>提交历史</strong>中（也许某个<strong>密码在旧提交中引入</strong>）？</li>
</ul>
<p>{% content-ref url="code-review-tools.md" %}
<a href="code-review-tools.html">code-review-tools.md</a>
{% endcontent-ref %}</p>
<h3 id="自动扫描器"><a class="header" href="#自动扫描器">自动扫描器</a></h3>
<h4 id="通用自动扫描器"><a class="header" href="#通用自动扫描器">通用自动扫描器</a></h4>
<pre><code class="language-bash">nikto -h &lt;URL&gt;
whatweb -a 4 &lt;URL&gt;
wapiti -u &lt;URL&gt;
W3af
zaproxy #You can use an API
nuclei -ut &amp;&amp; nuclei -target &lt;URL&gt;

# https://github.com/ignis-sec/puff (client side vulns fuzzer)
node puff.js -w ./wordlist-examples/xss.txt -u "http://www.xssgame.com/f/m4KKGHi2rVUN/?query=FUZZ"
</code></pre>
<h4 id="cms-扫描器"><a class="header" href="#cms-扫描器">CMS 扫描器</a></h4>
<p>如果使用了 CMS，不要忘记 <strong>运行扫描器</strong>，也许会发现一些有价值的信息：</p>
<p><a href="https://github.com/hatRiot/clusterd"><strong>Clusterd</strong></a><strong>:</strong> <a href="jboss.html"><strong>JBoss</strong></a><strong>, ColdFusion, WebLogic,</strong> <a href="tomcat/"><strong>Tomcat</strong></a><strong>, Railo, Axis2, Glassfish</strong><br />
<a href="https://github.com/ajinabraham/CMSScan"><strong>CMSScan</strong></a>: <a href="wordpress.html"><strong>WordPress</strong></a>, <a href="drupal/"><strong>Drupal</strong></a>, <strong>Joomla</strong>, <strong>vBulletin</strong> 网站的安全问题。 (GUI)<br />
<a href="https://github.com/anouarbensaad/vulnx"><strong>VulnX</strong></a><strong>:</strong> <a href="joomla.html"><strong>Joomla</strong></a><strong>,</strong> <a href="wordpress.html"><strong>Wordpress</strong></a><strong>,</strong> <a href="drupal/"><strong>Drupal</strong></a><strong>, PrestaShop, Opencart</strong><br />
<strong>CMSMap</strong>: <a href="wordpress.html"><strong>(W)ordpress</strong></a><strong>,</strong> <a href="joomla.html"><strong>(J)oomla</strong></a><strong>,</strong> <a href="drupal/"><strong>(D)rupal</strong></a> <strong>或</strong> <a href="moodle.html"><strong>(M)oodle</strong></a><br />
<a href="https://github.com/droope/droopescan"><strong>droopscan</strong></a><strong>:</strong> <a href="drupal/"><strong>Drupal</strong></a><strong>,</strong> <a href="joomla.html"><strong>Joomla</strong></a><strong>,</strong> <a href="moodle.html"><strong>Moodle</strong></a><strong>, Silverstripe,</strong> <a href="wordpress.html"><strong>Wordpress</strong></a></p>
<pre><code class="language-bash">cmsmap [-f W] -F -d &lt;URL&gt;
wpscan --force update -e --url &lt;URL&gt;
joomscan --ec -u &lt;URL&gt;
joomlavs.rb #https://github.com/rastating/joomlavs
</code></pre>
<blockquote>
<p>在这一点上，您应该已经获得了一些关于客户使用的网络服务器的信息（如果提供了任何数据）以及在测试期间需要记住的一些技巧。如果您运气好，您甚至找到了一个CMS并运行了一些扫描器。</p>
</blockquote>
<h2 id="逐步web应用程序发现"><a class="header" href="#逐步web应用程序发现">逐步Web应用程序发现</a></h2>
<blockquote>
<p>从这一点开始，我们将开始与Web应用程序进行交互。</p>
</blockquote>
<h3 id="初始检查"><a class="header" href="#初始检查">初始检查</a></h3>
<p><strong>包含有趣信息的默认页面：</strong></p>
<ul>
<li>/robots.txt</li>
<li>/sitemap.xml</li>
<li>/crossdomain.xml</li>
<li>/clientaccesspolicy.xml</li>
<li>/.well-known/</li>
<li>还要检查主页面和次页面中的评论。</li>
</ul>
<p><strong>强制错误</strong></p>
<p>当向Web服务器发送奇怪的数据时，可能会<strong>表现出意外行为</strong>。这可能会打开<strong>漏洞</strong>或<strong>泄露敏感信息</strong>。</p>
<ul>
<li>访问<strong>假页面</strong>如 /whatever_fake.php (.aspx,.html,.etc)</li>
<li>在<strong>cookie值</strong>和<strong>参数</strong>值中**添加 "[]", "]]", 和 "[["**以创建错误</li>
<li>通过在<strong>URL</strong>的<strong>末尾</strong>提供输入为**<code>/~randomthing/%s</code>**来生成错误</li>
<li>尝试<strong>不同的HTTP动词</strong>如 PATCH、DEBUG 或错误的如 FAKE</li>
</ul>
<h4 id="检查您是否可以上传文件put动词webdav"><a class="header" href="#检查您是否可以上传文件put动词webdav"><strong>检查您是否可以上传文件（</strong><a href="put-method-webdav.html"><strong>PUT动词，WebDav</strong></a><strong>）</strong></a></h4>
<p>如果您发现<strong>WebDav</strong>已<strong>启用</strong>但您没有足够的权限在根文件夹中<strong>上传文件</strong>，请尝试：</p>
<ul>
<li><strong>暴力破解</strong>凭据</li>
<li>通过WebDav向网页中<strong>找到的其他文件夹</strong>上传文件。您可能有权限在其他文件夹中上传文件。</li>
</ul>
<h3 id="ssltls漏洞"><a class="header" href="#ssltls漏洞"><strong>SSL/TLS漏洞</strong></a></h3>
<ul>
<li>如果应用程序在任何部分<strong>不强制用户使用HTTPS</strong>，那么它<strong>容易受到中间人攻击</strong></li>
<li>如果应用程序<strong>使用HTTP发送敏感数据（密码）</strong>，那么这是一个高风险漏洞。</li>
</ul>
<p>使用<a href="https://github.com/drwetter/testssl.sh"><strong>testssl.sh</strong></a>检查<strong>漏洞</strong>（在漏洞赏金计划中，这类漏洞可能不会被接受），并使用<a href="https://github.com/hahwul/a2sv"><strong>a2sv</strong></a>重新检查漏洞：</p>
<pre><code class="language-bash">./testssl.sh [--htmlfile] 10.10.10.10:443
#Use the --htmlfile to save the output inside an htmlfile also

# You can also use other tools, by testssl.sh at this momment is the best one (I think)
sslscan &lt;host:port&gt;
sslyze --regular &lt;ip:port&gt;
</code></pre>
<p>关于SSL/TLS漏洞的信息：</p>
<ul>
<li><a href="https://www.gracefulsecurity.com/tls-ssl-vulnerabilities/">https://www.gracefulsecurity.com/tls-ssl-vulnerabilities/</a></li>
<li><a href="https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/">https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/</a></li>
</ul>
<h3 id="爬虫"><a class="header" href="#爬虫">爬虫</a></h3>
<p>在网络中启动某种<strong>爬虫</strong>。爬虫的目标是<strong>尽可能多地找到</strong>被测试应用程序的路径。因此，应使用网络爬虫和外部来源来找到尽可能多的有效路径。</p>
<ul>
<li><a href="https://github.com/jaeles-project/gospider"><strong>gospider</strong></a> (go): HTML爬虫，JS文件中的LinkFinder和外部来源（Archive.org, CommonCrawl.org, VirusTotal.com, AlienVault.com）。</li>
<li><a href="https://github.com/hakluke/hakrawler"><strong>hakrawler</strong></a> (go): HML爬虫，带有JS文件的LinkFinder和Archive.org作为外部来源。</li>
<li><a href="https://github.com/Nekmo/dirhunt"><strong>dirhunt</strong></a> (python): HTML爬虫，也指示“美味文件”。</li>
<li><a href="https://github.com/saeeddhqan/evine"><strong>evine</strong> </a>(go): 交互式CLI HTML爬虫。它还在Archive.org中搜索。</li>
<li><a href="https://github.com/tomnomnom/meg"><strong>meg</strong></a> (go): 该工具不是爬虫，但可能有用。您只需指示一个包含主机的文件和一个包含路径的文件，meg将获取每个主机上的每个路径并保存响应。</li>
<li><a href="https://github.com/IAmStoxe/urlgrab"><strong>urlgrab</strong></a> (go): 带有JS渲染功能的HTML爬虫。然而，它似乎没有维护，预编译版本较旧，当前代码无法编译。</li>
<li><a href="https://github.com/lc/gau"><strong>gau</strong></a> (go): 使用外部提供者（wayback, otx, commoncrawl）的HTML爬虫。</li>
<li><a href="https://github.com/devanshbatham/ParamSpider"><strong>ParamSpider</strong></a>: 该脚本将找到带参数的URL并列出它们。</li>
<li><a href="https://github.com/dwisiswant0/galer"><strong>galer</strong></a> (go): 带有JS渲染功能的HTML爬虫。</li>
<li><a href="https://github.com/GerbenJavado/LinkFinder"><strong>LinkFinder</strong></a> (python): HTML爬虫，具有JS美化功能，能够在JS文件中搜索新路径。查看<a href="https://github.com/dark-warlord14/JSScanner">JSScanner</a>也可能值得一看，它是LinkFinder的一个包装器。</li>
<li><a href="https://github.com/0xsha/GoLinkFinder"><strong>goLinkFinder</strong></a> (go): 提取HTML源代码和嵌入的JavaScript文件中的端点。对漏洞猎人、红队员、信息安全专家有用。</li>
<li><a href="https://github.com/nahamsec/JSParser"><strong>JSParser</strong></a> (python2.7): 一个使用Tornado和JSBeautifier从JavaScript文件中解析相对URL的Python 2.7脚本。对轻松发现AJAX请求很有用。看起来没有维护。</li>
<li><a href="https://github.com/jobertabma/relative-url-extractor"><strong>relative-url-extractor</strong></a> (ruby): 给定一个文件（HTML），它将使用巧妙的正则表达式从丑陋（压缩）文件中提取相对URL。</li>
<li><a href="https://github.com/KathanP19/JSFScan.sh"><strong>JSFScan</strong></a> (bash, 多个工具): 使用多个工具从JS文件中收集有趣的信息。</li>
<li><a href="https://github.com/lc/subjs"><strong>subjs</strong></a> (go): 查找JS文件。</li>
<li><a href="https://github.com/detectify/page-fetch"><strong>page-fetch</strong></a> (go): 在无头浏览器中加载页面并打印出加载页面的所有URL。</li>
<li><a href="https://github.com/epi052/feroxbuster"><strong>Feroxbuster</strong></a> (rust): 内容发现工具，结合了之前工具的多个选项。</li>
<li><a href="https://github.com/xnl-h4ck3r/burp-extensions"><strong>Javascript Parsing</strong></a>: 一个Burp扩展，用于查找JS文件中的路径和参数。</li>
<li><a href="https://github.com/denandz/sourcemapper"><strong>Sourcemapper</strong></a>: 一个工具，给定.js.map URL将获取美化的JS代码。</li>
<li><a href="https://github.com/xnl-h4ck3r/xnLinkFinder"><strong>xnLinkFinder</strong></a>: 这是一个用于发现给定目标的端点的工具。</li>
<li><a href="https://github.com/xnl-h4ck3r/waymore"><strong>waymore</strong></a><strong>:</strong> 从时光机发现链接（还下载时光机中的响应并寻找更多链接）。</li>
<li><a href="https://github.com/redhuntlabs/HTTPLoot"><strong>HTTPLoot</strong></a> (go): 爬取（甚至通过填写表单）并使用特定正则表达式查找敏感信息。</li>
<li><a href="https://github.com/3nock/SpiderSuite"><strong>SpiderSuite</strong></a>: Spider Suite是一个高级多功能GUI网络安全爬虫/蜘蛛，专为网络安全专业人员设计。</li>
<li><a href="https://github.com/BishopFox/jsluice"><strong>jsluice</strong></a> (go): 这是一个Go包和<a href="https://github.com/BishopFox/jsluice/blob/main/cmd/jsluice">命令行工具</a>，用于从JavaScript源代码中提取URL、路径、秘密和其他有趣的数据。</li>
<li><a href="https://github.com/Anof-cyber/ParaForge"><strong>ParaForge</strong></a>: ParaForge是一个简单的<strong>Burp Suite扩展</strong>，用于<strong>提取请求中的参数和端点</strong>以创建自定义字典进行模糊测试和枚举。</li>
<li><a href="https://github.com/projectdiscovery/katana"><strong>katana</strong></a> (go): 这个工具很棒。</li>
<li><a href="https://github.com/s0rg/crawley"><strong>Crawley</strong></a> (go): 打印它能够找到的每个链接。</li>
</ul>
<h3 id="暴力破解目录和文件"><a class="header" href="#暴力破解目录和文件">暴力破解目录和文件</a></h3>
<p>从根文件夹开始<strong>暴力破解</strong>，确保使用<strong>此方法</strong>暴力破解<strong>所有</strong>找到的<strong>目录</strong>以及通过<strong>爬虫</strong>（您可以递归地进行此暴力破解，并在使用的字典开头附加找到的目录名称）。<br />
工具：</p>
<ul>
<li><strong>Dirb</strong> / <strong>Dirbuster</strong> - 包含在Kali中，<strong>旧</strong>（和<strong>慢</strong>）但功能正常。允许自动签名证书和递归搜索。与其他选项相比太慢。</li>
<li><a href="https://github.com/maurosoria/dirsearch"><strong>Dirsearch</strong></a> (python)<strong>: 它不允许自动签名证书，但</strong>允许递归搜索。</li>
<li><a href="https://github.com/OJ/gobuster"><strong>Gobuster</strong></a> (go): 它允许自动签名证书，<strong>不</strong>具有<strong>递归</strong>搜索。</li>
<li><a href="https://github.com/epi052/feroxbuster"><strong>Feroxbuster</strong></a> <strong>- 快速，支持递归搜索。</strong></li>
<li><a href="https://github.com/xmendez/wfuzz"><strong>wfuzz</strong></a> <code>wfuzz -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt https://domain.com/api/FUZZ</code></li>
<li><a href="https://github.com/ffuf/ffuf"><strong>ffuf</strong> </a>- 快速: <code>ffuf -c -w /usr/share/wordlists/dirb/big.txt -u http://10.10.10.10/FUZZ</code></li>
<li><a href="https://github.com/s0md3v/uro"><strong>uro</strong></a> (python): 这不是一个爬虫，而是一个工具，给定找到的URL列表将删除“重复”的URL。</li>
<li><a href="https://github.com/0xDexter0us/Scavenger"><strong>Scavenger</strong></a>: Burp扩展，从不同页面的burp历史中创建目录列表。</li>
<li><a href="https://github.com/michael1026/trashcompactor"><strong>TrashCompactor</strong></a>: 删除具有重复功能的URL（基于js导入）。</li>
<li><a href="https://github.com/iustin24/chameleon"><strong>Chamaleon</strong></a>: 它使用wapalyzer检测使用的技术并选择要使用的字典。</li>
</ul>
<p><strong>推荐字典：</strong></p>
<ul>
<li><a href="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/bf_directories.txt">https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/bf_directories.txt</a></li>
<li><a href="https://github.com/maurosoria/dirsearch/blob/master/db/dicc.txt"><strong>Dirsearch</strong>包含的字典</a></li>
<li><a href="http://gist.github.com/jhaddix/b80ea67d85c13206125806f0828f4d10">http://gist.github.com/jhaddix/b80ea67d85c13206125806f0828f4d10</a></li>
<li><a href="https://wordlists.assetnote.io">Assetnote字典</a></li>
<li><a href="https://github.com/danielmiessler/SecLists/tree/master/Discovery/Web-Content">https://github.com/danielmiessler/SecLists/tree/master/Discovery/Web-Content</a></li>
<li>raft-large-directories-lowercase.txt</li>
<li>directory-list-2.3-medium.txt</li>
<li>RobotsDisallowed/top10000.txt</li>
<li><a href="https://github.com/random-robbie/bruteforce-lists">https://github.com/random-robbie/bruteforce-lists</a></li>
<li><a href="https://github.com/google/fuzzing/tree/master/dictionaries">https://github.com/google/fuzzing/tree/master/dictionaries</a></li>
<li><a href="https://github.com/six2dez/OneListForAll">https://github.com/six2dez/OneListForAll</a></li>
<li><a href="https://github.com/random-robbie/bruteforce-lists">https://github.com/random-robbie/bruteforce-lists</a></li>
<li><a href="https://github.com/ayoubfathi/leaky-paths">https://github.com/ayoubfathi/leaky-paths</a></li>
<li><em>/usr/share/wordlists/dirb/common.txt</em></li>
<li><em>/usr/share/wordlists/dirb/big.txt</em></li>
<li><em>/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</em></li>
</ul>
<p><em>注意，在暴力破解或爬虫过程中发现新目录时，应进行暴力破解。</em></p>
<h3 id="检查每个找到的文件"><a class="header" href="#检查每个找到的文件">检查每个找到的文件</a></h3>
<ul>
<li><a href="https://github.com/stevenvachon/broken-link-checker"><strong>Broken link checker</strong></a>: 查找HTML中的断链，可能容易被接管。</li>
<li><strong>文件备份</strong>: 一旦找到所有文件，查找所有可执行文件的备份（"<em>.php</em>", "<em>.aspx</em>"...）。备份命名的常见变体有：<em>file.ext~, #file.ext#, ~file.ext, file.ext.bak, file.ext.tmp, file.ext.old, file.bak, file.tmp和file.old.</em> 您还可以使用工具<a href="https://github.com/mazen160/bfac"><strong>bfac</strong></a> <strong>或</strong> <a href="https://github.com/Nishantbhagat57/backup-gen"><strong>backup-gen</strong></a><strong>.</strong></li>
<li><strong>发现新参数</strong>: 您可以使用工具如<a href="https://github.com/s0md3v/Arjun"><strong>Arjun</strong></a><strong>,</strong> <a href="https://github.com/maK-/parameth"><strong>parameth</strong></a><strong>,</strong> <a href="https://github.com/sh1yo/x8"><strong>x8</strong></a> <strong>和</strong> <a href="https://github.com/PortSwigger/param-miner"><strong>Param Miner</strong></a> <strong>来发现隐藏参数。如果可以，您可以尝试在每个可执行的Web文件中搜索</strong>隐藏参数。</li>
<li><em>Arjun所有默认字典:</em> <a href="https://github.com/s0md3v/Arjun/tree/master/arjun/db">https://github.com/s0md3v/Arjun/tree/master/arjun/db</a></li>
<li><em>Param-miner “params” :</em> <a href="https://github.com/PortSwigger/param-miner/blob/master/resources/params">https://github.com/PortSwigger/param-miner/blob/master/resources/params</a></li>
<li><em>Assetnote “parameters_top_1m”:</em> <a href="https://wordlists.assetnote.io">https://wordlists.assetnote.io/</a></li>
<li><em>nullenc0de “params.txt”:</em> <a href="https://gist.github.com/nullenc0de/9cb36260207924f8e1787279a05eb773">https://gist.github.com/nullenc0de/9cb36260207924f8e1787279a05eb773</a></li>
<li><strong>评论:</strong> 检查所有文件的评论，您可以找到<strong>凭据</strong>或<strong>隐藏功能</strong>。</li>
<li>如果您在进行<strong>CTF</strong>，一个“常见”技巧是将<strong>信息</strong>隐藏在页面<strong>右侧</strong>的评论中（使用<strong>数百个</strong>空格，以便在使用浏览器打开源代码时看不到数据）。另一种可能性是在网页底部使用<strong>多个新行</strong>并在评论中<strong>隐藏信息</strong>。</li>
<li><strong>API密钥</strong>: 如果您<strong>找到任何API密钥</strong>，有一个指南指示如何使用不同平台的API密钥：<a href="https://github.com/streaak/keyhacks"><strong>keyhacks</strong></a><strong>,</strong> <a href="https://github.com/xyele/zile.git"><strong>zile</strong></a><strong>,</strong> <a href="https://github.com/trufflesecurity/truffleHog"><strong>truffleHog</strong></a><strong>,</strong> <a href="https://github.com/m4ll0k/SecretFinder"><strong>SecretFinder</strong></a><strong>,</strong> <a href="https://github.com/l4yton/RegHex)/"><strong>RegHex</strong></a><strong>,</strong> <a href="https://github.com/securing/DumpsterDiver"><strong>DumpsterDive</strong></a><strong>,</strong> <a href="https://github.com/americanexpress/earlybird"><strong>EarlyBird</strong></a></li>
<li>Google API密钥: 如果您找到任何看起来像<strong>AIza</strong>SyA-qLheq6xjDiEIRisP_ujUseYLQCHUjik的API密钥，您可以使用项目<a href="https://github.com/ozguralp/gmapsapiscanner"><strong>gmapapiscanner</strong></a>检查该密钥可以访问哪些API。</li>
<li><strong>S3存储桶</strong>: 在爬虫时查看是否有任何<strong>子域</strong>或任何<strong>链接</strong>与某些<strong>S3存储桶</strong>相关。在这种情况下，<a href="buckets/"><strong>检查</strong>存储桶的<strong>权限</strong></a>。</li>
</ul>
<h3 id="特殊发现"><a class="header" href="#特殊发现">特殊发现</a></h3>
<p><strong>在</strong>执行<strong>爬虫</strong>和<strong>暴力破解</strong>时，您可能会发现<strong>有趣的</strong> <strong>事物</strong>，您需要<strong>注意</strong>。</p>
<p><strong>有趣的文件</strong></p>
<ul>
<li>查找<strong>CSS</strong>文件中指向其他文件的<strong>链接</strong>。</li>
<li><a href="git.html">如果您找到一个_<strong>.git</strong>_文件，可以提取一些信息</a></li>
<li>如果您找到一个_<strong>.env</strong>_文件，可以找到API密钥、数据库密码和其他信息。</li>
<li>如果您找到<strong>API端点</strong>，您<a href="web-api-pentesting.html">也应该测试它们</a>。这些不是文件，但可能“看起来像”它们。</li>
<li><strong>JS文件</strong>: 在爬虫部分提到了一些可以从JS文件中提取路径的工具。此外，监控每个找到的JS文件也很有趣，因为在某些情况下，变化可能表明代码中引入了潜在的漏洞。您可以使用例如<a href="https://github.com/robre/jsmon"><strong>JSMon</strong></a><strong>.</strong></li>
<li>您还应该使用<a href="https://github.com/retirejs/retire.js/"><strong>RetireJS</strong></a>或<a href="https://github.com/callforpapers-source/jshole"><strong>JSHole</strong></a>检查发现的JS文件，以查看它是否存在漏洞。</li>
<li><strong>Javascript反混淆器和解包器:</strong> <a href="https://lelinhtinh.github.io/de4js/">https://lelinhtinh.github.io/de4js/</a>, <a href="https://www.dcode.fr/javascript-unobfuscator">https://www.dcode.fr/javascript-unobfuscator</a></li>
<li><strong>Javascript美化器:</strong> <a href="https://beautifier.io">http://jsbeautifier.org/</a>, <a href="http://jsnice.org">http://jsnice.org/</a></li>
<li><strong>JsFuck反混淆</strong> (javascript with chars:"[]!+" <a href="https://enkhee-osiris.github.io/Decoder-JSFuck/">https://enkhee-osiris.github.io/Decoder-JSFuck/</a>)</li>
<li><a href="https://github.com/taco-c/trainfuck"><strong>TrainFuck</strong></a><strong>:</strong> <code>+72.+29.+7..+3.-67.-12.+55.+24.+3.-6.-8.-67.-23.</code></li>
<li>在多个场合，您需要<strong>理解使用的正则表达式</strong>。这将很有用：<a href="https://regex101.com">https://regex101.com/</a>或<a href="https://pythonium.net/regex">https://pythonium.net/regex</a></li>
<li>您还可以<strong>监控检测到表单的文件</strong>，因为参数的变化或新表单的出现可能表明潜在的新漏洞功能。</li>
</ul>
<p><strong>403 Forbidden/Basic Authentication/401 Unauthorized (绕过)</strong></p>
<p>{% content-ref url="403-and-401-bypasses.md" %}
<a href="403-and-401-bypasses.html">403-and-401-bypasses.md</a>
{% endcontent-ref %}</p>
<p><strong>502 Proxy Error</strong></p>
<p>如果任何页面<strong>响应</strong>该<strong>代码</strong>，它可能是<strong>配置错误的代理</strong>。<strong>如果您发送HTTP请求，如：<code>GET https://google.com HTTP/1.1</code></strong>（带有主机头和其他常见头），<strong>代理</strong>将尝试<strong>访问</strong><em><strong>google.com</strong></em> <strong>，您将发现一个</strong> SSRF。</p>
<p><strong>NTLM认证 - 信息泄露</strong></p>
<p>如果运行的服务器要求身份验证是<strong>Windows</strong>或您发现一个登录要求您的<strong>凭据</strong>（并要求<strong>域名</strong>），您可以引发<strong>信息泄露</strong>。<br />
<strong>发送</strong>头：<code>“Authorization: NTLM TlRMTVNTUAABAAAAB4IIAAAAAAAAAAAAAAAAAAAAAAA=”</code>，由于<strong>NTLM认证的工作原理</strong>，服务器将响应内部信息（IIS版本，Windows版本...）在“WWW-Authenticate”头中。<br />
您可以使用<strong>nmap插件</strong>"<em>http-ntlm-info.nse</em>"来<strong>自动化</strong>此过程。</p>
<p><strong>HTTP重定向（CTF）</strong></p>
<p>可以在<strong>重定向</strong>中<strong>放置内容</strong>。这些内容<strong>不会显示给用户</strong>（因为浏览器将执行重定向），但其中可能<strong>隐藏</strong>某些内容。</p>
<h3 id="网络漏洞检查"><a class="header" href="#网络漏洞检查">网络漏洞检查</a></h3>
<p>现在已经对Web应用程序进行了全面的枚举，是时候检查许多可能的漏洞。您可以在这里找到检查清单：</p>
<p>{% content-ref url="../../pentesting-web/web-vulnerabilities-methodology.md" %}
<a href="../../pentesting-web/web-vulnerabilities-methodology.html">web-vulnerabilities-methodology.md</a>
{% endcontent-ref %}</p>
<p>有关Web漏洞的更多信息，请访问：</p>
<ul>
<li><a href="https://six2dez.gitbook.io/pentest-book/others/web-checklist">https://six2dez.gitbook.io/pentest-book/others/web-checklist</a></li>
<li><a href="https://kennel209.gitbooks.io/owasp-testing-guide-v4/content/en/web_application_security_testing/configuration_and_deployment_management_testing.html">https://kennel209.gitbooks.io/owasp-testing-guide-v4/content/en/web_application_security_testing/configuration_and_deployment_management_testing.html</a></li>
<li><a href="https://owasp-skf.gitbook.io/asvs-write-ups/kbid-111-client-side-template-injection">https://owasp-skf.gitbook.io/asvs-write-ups/kbid-111-client-side-template-injection</a></li>
</ul>
<h3 id="监控页面变化"><a class="header" href="#监控页面变化">监控页面变化</a></h3>
<p>您可以使用工具如<a href="https://github.com/dgtlmoon/changedetection.io">https://github.com/dgtlmoon/changedetection.io</a>来监控页面的修改，这可能会插入漏洞。</p>
<figure><img src="../../.gitbook/assets/pentest-tools.svg" alt=""><figcaption></figcaption></figure>
<p><strong>从黑客的角度看待您的Web应用程序、网络和云</strong></p>
<p><strong>查找并报告具有实际商业影响的关键、可利用漏洞。</strong> 使用我们20多个自定义工具映射攻击面，查找让您提升权限的安全问题，并使用自动化利用收集重要证据，将您的辛勤工作转化为有说服力的报告。</p>
<p>{% embed url="https://pentest-tools.com/?utm_term=jul2024&amp;utm_medium=link&amp;utm_source=hacktricks&amp;utm_campaign=spons" %}</p>
<h3 id="hacktricks自动命令"><a class="header" href="#hacktricks自动命令">HackTricks自动命令</a></h3>
<pre><code>Protocol_Name: Web    #Protocol Abbreviation if there is one.
Port_Number:  80,443     #Comma separated if there is more than one.
Protocol_Description: Web         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for Web
Note: |
https://book.hacktricks.xyz/pentesting/pentesting-web

Entry_2:
Name: Quick Web Scan
Description: Nikto and GoBuster
Command: nikto -host {Web_Proto}://{IP}:{Web_Port} &amp;&amp;&amp;&amp; gobuster dir -w {Small_Dirlist} -u {Web_Proto}://{IP}:{Web_Port} &amp;&amp; gobuster dir -w {Big_Dirlist} -u {Web_Proto}://{IP}:{Web_Port}

Entry_3:
Name: Nikto
Description: Basic Site Info via Nikto
Command: nikto -host {Web_Proto}://{IP}:{Web_Port}

Entry_4:
Name: WhatWeb
Description: General purpose auto scanner
Command: whatweb -a 4 {IP}

Entry_5:
Name: Directory Brute Force Non-Recursive
Description:  Non-Recursive Directory Brute Force
Command: gobuster dir -w {Big_Dirlist} -u {Web_Proto}://{IP}:{Web_Port}

Entry_6:
Name: Directory Brute Force Recursive
Description: Recursive Directory Brute Force
Command: python3 {Tool_Dir}dirsearch/dirsearch.py -w {Small_Dirlist} -e php,exe,sh,py,html,pl -f -t 20 -u {Web_Proto}://{IP}:{Web_Port} -r 10

Entry_7:
Name: Directory Brute Force CGI
Description: Common Gateway Interface Brute Force
Command: gobuster dir -u {Web_Proto}://{IP}:{Web_Port}/ -w /usr/share/seclists/Discovery/Web-Content/CGIs.txt -s 200

Entry_8:
Name: Nmap Web Vuln Scan
Description: Tailored Nmap Scan for web Vulnerabilities
Command: nmap -vv --reason -Pn -sV -p {Web_Port} --script=`banner,(http* or ssl*) and not (brute or broadcast or dos or external or http-slowloris* or fuzzer)` {IP}

Entry_9:
Name: Drupal
Description: Drupal Enumeration Notes
Note: |
git clone https://github.com/immunIT/drupwn.git for low hanging fruit and git clone https://github.com/droope/droopescan.git for deeper enumeration

Entry_10:
Name: WordPress
Description: WordPress Enumeration with WPScan
Command: |
?What is the location of the wp-login.php? Example: /Yeet/cannon/wp-login.php
wpscan --url {Web_Proto}://{IP}{1} --enumerate ap,at,cb,dbe &amp;&amp; wpscan --url {Web_Proto}://{IP}{1} --enumerate u,tt,t,vp --passwords {Big_Passwordlist} -e

Entry_11:
Name: WordPress Hydra Brute Force
Description: Need User (admin is default)
Command: hydra -l admin -P {Big_Passwordlist} {IP} -V http-form-post '/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log In&amp;testcookie=1:S=Location'

Entry_12:
Name: Ffuf Vhost
Description: Simple Scan with Ffuf for discovering additional vhosts
Command: ffuf -w {Subdomain_List}:FUZZ -u {Web_Proto}://{Domain_Name} -H "Host:FUZZ.{Domain_Name}" -c -mc all {Ffuf_Filters}
</code></pre>
<p>{% hint style="success" %}
学习与实践 AWS 黑客技术：<img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习与实践 GCP 黑客技术：<img src="../../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="../../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>Telegram 群组</strong></a> 或 <strong>关注</strong> 我们的 <strong>Twitter</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub 仓库提交 PR 来分享黑客技巧。</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../network-services-pentesting/pentesting-finger.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../network-services-pentesting/pentesting-web/403-and-401-bypasses.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../network-services-pentesting/pentesting-finger.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../network-services-pentesting/pentesting-web/403-and-401-bypasses.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
