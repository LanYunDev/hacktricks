<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>111/TCP/UDP - Pentesting Portmapper</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="111tcpudp---pentesting-portmapper"><a class="header" href="#111tcpudp---pentesting-portmapper">111/TCP/UDP - Pentesting Portmapper</a></h1>
<p>{% hint style="success" %}
Learn &amp; practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks Training AWS Red Team Expert (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
Learn &amp; practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks Training GCP Red Team Expert (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>Support HackTricks</summary>
<ul>
<li>Check the <a href="https://github.com/sponsors/carlospolop"><strong>subscription plans</strong></a>!</li>
<li><strong>Join the</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord group</strong></a> or the <a href="https://t.me/peass"><strong>telegram group</strong></a> or <strong>follow</strong> us on <strong>Twitter</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>Share hacking tricks by submitting PRs to the</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> and <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> github repos.</li>
</ul>
</details>
{% endhint %}
<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>
<p>{% embed url="https://websec.nl/" %}</p>
<h2 id="基本信息"><a class="header" href="#基本信息">基本信息</a></h2>
<p><strong>Portmapper</strong> 是一种用于将网络服务端口映射到 <strong>RPC</strong>（远程过程调用）程序编号的服务。它作为 <strong>Unix</strong> 系统中的一个关键组件，促进了这些系统之间的信息交换。与 <strong>Portmapper</strong> 相关的 <strong>端口</strong> 经常被攻击者扫描，因为它可以揭示有价值的信息。这些信息包括正在运行的 <strong>Unix 操作系统（OS）</strong> 的类型以及系统上可用服务的详细信息。此外，<strong>Portmapper</strong> 通常与 <strong>NFS（网络文件系统）</strong>、<strong>NIS（网络信息服务）</strong> 和其他 <strong>基于 RPC 的服务</strong> 一起使用，以有效管理网络服务。</p>
<p><strong>默认端口：</strong> 111/TCP/UDP，Oracle Solaris 中的 32771</p>
<pre><code>PORT    STATE SERVICE
111/tcp open  rpcbind
</code></pre>
<h2 id="枚举"><a class="header" href="#枚举">枚举</a></h2>
<pre><code>rpcinfo irked.htb
nmap -sSUC -p111 192.168.10.1
</code></pre>
<p>有时它不会给你任何信息，而在其他情况下，你会得到类似这样的内容：</p>
<p><img src="../.gitbook/assets/image%20(553).png" alt="" /></p>
<h3 id="shodan"><a class="header" href="#shodan">Shodan</a></h3>
<ul>
<li><code>port:111 portmap</code></li>
</ul>
<h2 id="rpcbind--nfs"><a class="header" href="#rpcbind--nfs">RPCBind + NFS</a></h2>
<p>如果你发现服务 NFS，那么你可能能够列出和下载（也许还可以上传）文件：</p>
<p><img src="../.gitbook/assets/image%20(872).png" alt="" /></p>
<p>阅读<a href="nfs-service-pentesting.html"> 2049 - Pentesting NFS service</a>以了解更多关于如何测试此协议的信息。</p>
<h2 id="nis"><a class="header" href="#nis">NIS</a></h2>
<p>探索 <strong>NIS</strong> 漏洞涉及一个两步过程，首先是识别服务 <code>ypbind</code>。这一探索的基石是揭示 <strong>NIS 域名</strong>，没有这个，进展将会停止。</p>
<p><img src="../.gitbook/assets/image%20(859).png" alt="" /></p>
<p>探索之旅始于安装必要的包（<code>apt-get install nis</code>）。接下来的步骤需要使用 <code>ypwhich</code> 通过域名和服务器 IP 确认 NIS 服务器的存在，确保这些元素为安全而匿名。</p>
<p>最后一个也是至关重要的步骤涉及 <code>ypcat</code> 命令以提取敏感数据，特别是加密的用户密码。这些哈希值一旦使用像 <strong>John the Ripper</strong> 这样的工具破解，将揭示系统访问和权限的见解。</p>
<pre><code class="language-bash"># Install NIS tools
apt-get install nis
# Ping the NIS server to confirm its presence
ypwhich -d &lt;domain-name&gt; &lt;server-ip&gt;
# Extract user credentials
ypcat –d &lt;domain-name&gt; –h &lt;server-ip&gt; passwd.byname
</code></pre>
<h3 id="nif-文件"><a class="header" href="#nif-文件">NIF 文件</a></h3>
<div class="table-wrapper"><table><thead><tr><th><strong>主文件</strong></th><th><strong>映射</strong></th><th><strong>备注</strong></th></tr></thead><tbody>
<tr><td>/etc/hosts</td><td>hosts.byname, hosts.byaddr</td><td>包含主机名和 IP 详细信息</td></tr>
<tr><td>/etc/passwd</td><td>passwd.byname, passwd.byuid</td><td>NIS 用户密码文件</td></tr>
<tr><td>/etc/group</td><td>group.byname, group.bygid</td><td>NIS 组文件</td></tr>
<tr><td>/usr/lib/aliases</td><td>mail.aliases</td><td>邮件别名详细信息</td></tr>
</tbody></table>
</div>
<h2 id="rpc-用户"><a class="header" href="#rpc-用户">RPC 用户</a></h2>
<p>如果你发现 <strong>rusersd</strong> 服务列出如下：</p>
<p><img src="../.gitbook/assets/image%20(1041).png" alt="" /></p>
<p>你可以枚举该主机的用户。要了解如何，请阅读 <a href="1026-pentesting-rusersd.html">1026 - Pentesting Rsusersd</a>。</p>
<h2 id="绕过过滤的-portmapper-端口"><a class="header" href="#绕过过滤的-portmapper-端口">绕过过滤的 Portmapper 端口</a></h2>
<p>在进行 <strong>nmap 扫描</strong> 并发现 NFS 端口开放且端口 111 被过滤时，直接利用这些端口是不可行的。然而，通过 <strong>在本地模拟一个 portmapper 服务并从你的机器创建一个隧道到目标</strong>，利用变得可能，使用标准工具即可。这种技术允许绕过端口 111 的过滤状态，从而访问 NFS 服务。有关此方法的详细指导，请参阅 <a href="https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc">此链接</a> 中的文章。</p>
<h2 id="shodan-1"><a class="header" href="#shodan-1">Shodan</a></h2>
<ul>
<li><code>Portmap</code></li>
</ul>
<h2 id="实践实验室"><a class="header" href="#实践实验室">实践实验室</a></h2>
<ul>
<li>在 <a href="https://app.hackthebox.com/machines/Irked"><strong>Irked HTB 机器</strong></a> 中练习这些技术。</li>
</ul>
<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>
<p>{% embed url="https://websec.nl/" %}</p>
<h2 id="hacktricks-自动命令"><a class="header" href="#hacktricks-自动命令">HackTricks 自动命令</a></h2>
<pre><code>Protocol_Name: Portmapper    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: PM or RPCBind        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for PortMapper
Note: |
Portmapper is a service that is utilized for mapping network service ports to RPC (Remote Procedure Call) program numbers. It acts as a critical component in Unix-based systems, facilitating the exchange of information between these systems. The port associated with Portmapper is frequently scanned by attackers as it can reveal valuable information. This information includes the type of Unix Operating System (OS) running and details about the services that are available on the system. Additionally, Portmapper is commonly used in conjunction with NFS (Network File System), NIS (Network Information Service), and other RPC-based services to manage network services effectively.

https://book.hacktricks.xyz/pentesting/pentesting-rpcbind

Entry_2:
Name: rpc info
Description: May give netstat-type info
Command: whois -h {IP} -p 43 {Domain_Name} &amp;&amp; echo {Domain_Name} | nc -vn {IP} 43

Entry_3:
Name: nmap
Description: May give netstat-type info
Command: nmap -sSUC -p 111 {IP}
</code></pre>
<p>{% hint style="success" %}
学习与实践 AWS 黑客技术：<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习与实践 GCP 黑客技术：<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>Telegram 群组</strong></a> 或 <strong>关注</strong> 我们的 <strong>Twitter</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub 仓库提交 PR 来分享黑客技巧。</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../network-services-pentesting/pentesting-pop.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../network-services-pentesting/113-pentesting-ident.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../network-services-pentesting/pentesting-pop.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../network-services-pentesting/113-pentesting-ident.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
