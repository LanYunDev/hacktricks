<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Phishing Methodology</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="phishing-methodology"><a class="header" href="#phishing-methodology">Phishing Methodology</a></h1>
<p>{% hint style="success" %}
学习和实践 AWS 黑客技术：<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习和实践 GCP 黑客技术：<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>Telegram 群组</strong></a> 或 <strong>关注</strong> 我们的 <strong>Twitter</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub 仓库提交 PR 分享黑客技巧。</li>
</ul>
</details>
{% endhint %}
<h2 id="methodology"><a class="header" href="#methodology">Methodology</a></h2>
<ol>
<li>侦查受害者</li>
<li>选择 <strong>受害者域名</strong>。</li>
<li>执行一些基本的网络枚举 <strong>寻找受害者使用的登录门户</strong> 并 <strong>决定</strong> 你将 <strong>冒充</strong> 哪一个。</li>
<li>使用一些 <strong>OSINT</strong> 来 <strong>查找电子邮件</strong>。</li>
<li>准备环境</li>
<li><strong>购买你将用于钓鱼评估的域名</strong></li>
<li><strong>配置电子邮件服务</strong> 相关记录 (SPF, DMARC, DKIM, rDNS)</li>
<li>使用 <strong>gophish</strong> 配置 VPS</li>
<li>准备活动</li>
<li>准备 <strong>电子邮件模板</strong></li>
<li>准备 <strong>网页</strong> 以窃取凭据</li>
<li>启动活动！</li>
</ol>
<h2 id="生成类似域名或购买受信任的域名"><a class="header" href="#生成类似域名或购买受信任的域名">生成类似域名或购买受信任的域名</a></h2>
<h3 id="域名变体技术"><a class="header" href="#域名变体技术">域名变体技术</a></h3>
<ul>
<li><strong>关键词</strong>：域名 <strong>包含</strong> 原始域名的重要 <strong>关键词</strong> (例如，zelster.com-management.com)。</li>
<li><strong>带连字符的子域</strong>：将子域的 <strong>点替换为连字符</strong> (例如，www-zelster.com)。</li>
<li><strong>新 TLD</strong>：使用 <strong>新 TLD</strong> 的相同域名 (例如，zelster.org)</li>
<li><strong>同形异义字</strong>：用 <strong>看起来相似的字母</strong> 替换域名中的一个字母 (例如，zelfser.com)。</li>
<li><strong>置换</strong>：在域名中 <strong>交换两个字母</strong> (例如，zelsetr.com)。</li>
<li><strong>单数/复数化</strong>：在域名末尾添加或删除 “s” (例如，zeltsers.com)。</li>
<li><strong>省略</strong>：从域名中 <strong>删除一个</strong> 字母 (例如，zelser.com)。</li>
<li><strong>重复</strong>：在域名中 <strong>重复一个</strong> 字母 (例如，zeltsser.com)。</li>
<li><strong>替换</strong>：类似同形异义字，但不太隐蔽。它用键盘上与原字母相近的字母替换域名中的一个字母 (例如，zektser.com)。</li>
<li><strong>子域化</strong>：在域名中引入一个 <strong>点</strong> (例如，ze.lster.com)。</li>
<li><strong>插入</strong>：在域名中 <strong>插入一个字母</strong> (例如，zerltser.com)。</li>
<li><strong>缺失点</strong>：将 TLD 附加到域名上 (例如，zelstercom.com)</li>
</ul>
<p><strong>自动工具</strong></p>
<ul>
<li><a href="https://github.com/elceef/dnstwist"><strong>dnstwist</strong></a></li>
<li><a href="https://github.com/urbanadventurer/urlcrazy"><strong>urlcrazy</strong></a></li>
</ul>
<p><strong>网站</strong></p>
<ul>
<li><a href="https://dnstwist.it">https://dnstwist.it/</a></li>
<li><a href="https://dnstwister.report">https://dnstwister.report/</a></li>
<li><a href="https://www.internetmarketingninjas.com/tools/free-tools/domain-typo-generator/">https://www.internetmarketingninjas.com/tools/free-tools/domain-typo-generator/</a></li>
</ul>
<h3 id="bitflipping"><a class="header" href="#bitflipping">Bitflipping</a></h3>
<p>有 <strong>可能性某些存储或通信中的位会因各种因素而自动翻转</strong>，例如太阳耀斑、宇宙射线或硬件错误。</p>
<p>当这个概念 <strong>应用于 DNS 请求</strong> 时，<strong>DNS 服务器接收到的域名</strong> 可能与最初请求的域名不同。</p>
<p>例如，域名 "windows.com" 的单个位修改可以将其更改为 "windnws.com"。</p>
<p>攻击者可能会 <strong>利用这一点注册多个与受害者域名相似的位翻转域名</strong>。他们的意图是将合法用户重定向到他们自己的基础设施。</p>
<p>有关更多信息，请阅读 <a href="https://www.bleepingcomputer.com/news/security/hijacking-traffic-to-microsoft-s-windowscom-with-bitflipping/">https://www.bleepingcomputer.com/news/security/hijacking-traffic-to-microsoft-s-windowscom-with-bitflipping/</a></p>
<h3 id="购买受信任的域名"><a class="header" href="#购买受信任的域名">购买受信任的域名</a></h3>
<p>你可以在 <a href="https://www.expireddomains.net">https://www.expireddomains.net/</a> 搜索可以使用的过期域名。<br />
为了确保你要购买的过期域名 <strong>已经有良好的 SEO</strong>，你可以搜索它在以下网站的分类：</p>
<ul>
<li><a href="http://www.fortiguard.com/webfilter">http://www.fortiguard.com/webfilter</a></li>
<li><a href="https://urlfiltering.paloaltonetworks.com/query/">https://urlfiltering.paloaltonetworks.com/query/</a></li>
</ul>
<h2 id="发现电子邮件"><a class="header" href="#发现电子邮件">发现电子邮件</a></h2>
<ul>
<li><a href="https://github.com/laramies/theHarvester">https://github.com/laramies/theHarvester</a> (100% 免费)</li>
<li><a href="https://phonebook.cz">https://phonebook.cz/</a> (100% 免费)</li>
<li><a href="https://maildb.io">https://maildb.io/</a></li>
<li><a href="https://hunter.io">https://hunter.io/</a></li>
<li><a href="https://anymailfinder.com">https://anymailfinder.com/</a></li>
</ul>
<p>为了 <strong>发现更多</strong> 有效的电子邮件地址或 <strong>验证你已经发现的地址</strong>，你可以检查是否可以对受害者的 smtp 服务器进行暴力破解。 <a href="../../network-services-pentesting/pentesting-smtp/#username-bruteforce-enumeration">在这里学习如何验证/发现电子邮件地址</a>。<br />
此外，不要忘记，如果用户使用 <strong>任何网络门户访问他们的邮件</strong>，你可以检查它是否容易受到 <strong>用户名暴力破解</strong>，并在可能的情况下利用该漏洞。</p>
<h2 id="配置-gophish"><a class="header" href="#配置-gophish">配置 GoPhish</a></h2>
<h3 id="安装"><a class="header" href="#安装">安装</a></h3>
<p>你可以从 <a href="https://github.com/gophish/gophish/releases/tag/v0.11.0">https://github.com/gophish/gophish/releases/tag/v0.11.0</a> 下载。</p>
<p>下载并解压到 <code>/opt/gophish</code> 中，然后执行 <code>/opt/gophish/gophish</code><br />
你将在输出中获得端口 3333 的管理员用户密码。因此，访问该端口并使用这些凭据更改管理员密码。你可能需要将该端口隧道到本地：</p>
<pre><code class="language-bash">ssh -L 3333:127.0.0.1:3333 &lt;user&gt;@&lt;ip&gt;
</code></pre>
<h3 id="配置"><a class="header" href="#配置">配置</a></h3>
<p><strong>TLS 证书配置</strong></p>
<p>在这一步之前，您应该已经<strong>购买了您将要使用的域名</strong>，并且它必须<strong>指向</strong>您正在配置<strong>gophish</strong>的<strong>VPS 的 IP</strong>。</p>
<pre><code class="language-bash">DOMAIN="&lt;domain&gt;"
wget https://dl.eff.org/certbot-auto
chmod +x certbot-auto
sudo apt install snapd
sudo snap install core
sudo snap refresh core
sudo apt-get remove certbot
sudo snap install --classic certbot
sudo ln -s /snap/bin/certbot /usr/bin/certbot
certbot certonly --standalone -d "$DOMAIN"
mkdir /opt/gophish/ssl_keys
cp "/etc/letsencrypt/live/$DOMAIN/privkey.pem" /opt/gophish/ssl_keys/key.pem
cp "/etc/letsencrypt/live/$DOMAIN/fullchain.pem" /opt/gophish/ssl_keys/key.crt​
</code></pre>
<p><strong>邮件配置</strong></p>
<p>开始安装: <code>apt-get install postfix</code></p>
<p>然后将域名添加到以下文件中:</p>
<ul>
<li><strong>/etc/postfix/virtual_domains</strong></li>
<li><strong>/etc/postfix/transport</strong></li>
<li><strong>/etc/postfix/virtual_regexp</strong></li>
</ul>
<p><strong>还要更改 /etc/postfix/main.cf 中以下变量的值</strong></p>
<p><code>myhostname = &lt;domain&gt;</code><br />
<code>mydestination = $myhostname, &lt;domain&gt;, localhost.com, localhost</code></p>
<p>最后将文件 <strong><code>/etc/hostname</code></strong> 和 <strong><code>/etc/mailname</code></strong> 修改为您的域名，并<strong>重启您的 VPS。</strong></p>
<p>现在，创建一个指向 VPS <strong>ip 地址</strong> 的 <strong>DNS A 记录</strong> <code>mail.&lt;domain&gt;</code> 和一个指向 <code>mail.&lt;domain&gt;</code> 的 <strong>DNS MX</strong> 记录。</p>
<p>现在让我们测试发送电子邮件:</p>
<pre><code class="language-bash">apt install mailutils
echo "This is the body of the email" | mail -s "This is the subject line" test@email.com
</code></pre>
<p><strong>Gophish 配置</strong></p>
<p>停止 gophish 的执行，然后进行配置。<br />
将 <code>/opt/gophish/config.json</code> 修改为以下内容（注意使用 https）：</p>
<pre><code class="language-bash">{
"admin_server": {
"listen_url": "127.0.0.1:3333",
"use_tls": true,
"cert_path": "gophish_admin.crt",
"key_path": "gophish_admin.key"
},
"phish_server": {
"listen_url": "0.0.0.0:443",
"use_tls": true,
"cert_path": "/opt/gophish/ssl_keys/key.crt",
"key_path": "/opt/gophish/ssl_keys/key.pem"
},
"db_name": "sqlite3",
"db_path": "gophish.db",
"migrations_prefix": "db/db_",
"contact_address": "",
"logging": {
"filename": "",
"level": ""
}
}
</code></pre>
<p><strong>配置 gophish 服务</strong></p>
<p>为了创建 gophish 服务，使其能够自动启动并作为服务进行管理，您可以创建文件 <code>/etc/init.d/gophish</code>，并添加以下内容：</p>
<pre><code class="language-bash">#!/bin/bash
# /etc/init.d/gophish
# initialization file for stop/start of gophish application server
#
# chkconfig: - 64 36
# description: stops/starts gophish application server
# processname:gophish
# config:/opt/gophish/config.json
# From https://github.com/gophish/gophish/issues/586

# define script variables

processName=Gophish
process=gophish
appDirectory=/opt/gophish
logfile=/var/log/gophish/gophish.log
errfile=/var/log/gophish/gophish.error

start() {
echo 'Starting '${processName}'...'
cd ${appDirectory}
nohup ./$process &gt;&gt;$logfile 2&gt;&gt;$errfile &amp;
sleep 1
}

stop() {
echo 'Stopping '${processName}'...'
pid=$(/bin/pidof ${process})
kill ${pid}
sleep 1
}

status() {
pid=$(/bin/pidof ${process})
if [["$pid" != ""| "$pid" != "" ]]; then
echo ${processName}' is running...'
else
echo ${processName}' is not running...'
fi
}

case $1 in
start|stop|status) "$1" ;;
esac
</code></pre>
<p>完成配置服务并检查它的方法是：</p>
<pre><code class="language-bash">mkdir /var/log/gophish
chmod +x /etc/init.d/gophish
update-rc.d gophish defaults
#Check the service
service gophish start
service gophish status
ss -l | grep "3333\|443"
service gophish stop
</code></pre>
<h2 id="配置邮件服务器和域名"><a class="header" href="#配置邮件服务器和域名">配置邮件服务器和域名</a></h2>
<h3 id="等待并保持合法"><a class="header" href="#等待并保持合法">等待并保持合法</a></h3>
<p>域名越老，被识别为垃圾邮件的可能性就越小。因此，在进行钓鱼评估之前，您应该尽可能等待更长的时间（至少1周）。此外，如果您放置一个关于声誉行业的页面，获得的声誉将会更好。</p>
<p>请注意，即使您需要等待一周，您现在也可以完成所有配置。</p>
<h3 id="配置反向dns-rdns-记录"><a class="header" href="#配置反向dns-rdns-记录">配置反向DNS (rDNS) 记录</a></h3>
<p>设置一个将VPS的IP地址解析到域名的rDNS (PTR) 记录。</p>
<h3 id="发件人策略框架-spf-记录"><a class="header" href="#发件人策略框架-spf-记录">发件人策略框架 (SPF) 记录</a></h3>
<p>您必须<strong>为新域配置SPF记录</strong>。如果您不知道什么是SPF记录，请<a href="../../network-services-pentesting/pentesting-smtp/#spf"><strong>阅读此页面</strong></a>。</p>
<p>您可以使用<a href="https://www.spfwizard.net">https://www.spfwizard.net/</a>来生成您的SPF策略（使用VPS机器的IP）</p>
<p><img src="../../.gitbook/assets/image%20(1037).png" alt="" /></p>
<p>这是必须在域名的TXT记录中设置的内容：</p>
<pre><code class="language-bash">v=spf1 mx a ip4:ip.ip.ip.ip ?all
</code></pre>
<h3 id="基于域的消息认证报告和一致性-dmarc-记录"><a class="header" href="#基于域的消息认证报告和一致性-dmarc-记录">基于域的消息认证、报告和一致性 (DMARC) 记录</a></h3>
<p>您必须<strong>为新域配置 DMARC 记录</strong>。如果您不知道什么是 DMARC 记录 <a href="../../network-services-pentesting/pentesting-smtp/#dmarc"><strong>请阅读此页面</strong></a>。</p>
<p>您需要创建一个新的 DNS TXT 记录，指向主机名 <code>_dmarc.&lt;domain&gt;</code>，内容如下：</p>
<pre><code class="language-bash">v=DMARC1; p=none
</code></pre>
<h3 id="domainkeys-identified-mail-dkim"><a class="header" href="#domainkeys-identified-mail-dkim">DomainKeys Identified Mail (DKIM)</a></h3>
<p>您必须<strong>为新域配置 DKIM</strong>。如果您不知道什么是 DMARC 记录 <a href="../../network-services-pentesting/pentesting-smtp/#dkim"><strong>请阅读此页面</strong></a>。</p>
<p>本教程基于：<a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-configure-dkim-with-postfix-on-debian-wheezy">https://www.digitalocean.com/community/tutorials/how-to-install-and-configure-dkim-with-postfix-on-debian-wheezy</a></p>
<p>{% hint style="info" %}
您需要连接 DKIM 密钥生成的两个 B64 值：</p>
<pre><code>v=DKIM1; h=sha256; k=rsa; p=MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA0wPibdqPtzYk81njjQCrChIcHzxOp8a1wjbsoNtka2X9QXCZs+iXkvw++QsWDtdYu3q0Ofnr0Yd/TmG/Y2bBGoEgeE+YTUG2aEgw8Xx42NLJq2D1pB2lRQPW4IxefROnXu5HfKSm7dyzML1gZ1U0pR5X4IZCH0wOPhIq326QjxJZm79E1nTh3xj" "Y9N/Dt3+fVnIbMupzXE216TdFuifKM6Tl6O/axNsbswMS1TH812euno8xRpsdXJzFlB9q3VbMkVWig4P538mHolGzudEBg563vv66U8D7uuzGYxYT4WS8NVm3QBMg0QKPWZaKp+bADLkOSB9J2nUpk4Aj9KB5swIDAQAB
</code></pre>
<p>{% endhint %}</p>
<h3 id="测试您的电子邮件配置得分"><a class="header" href="#测试您的电子邮件配置得分">测试您的电子邮件配置得分</a></h3>
<p>您可以使用 <a href="https://www.mail-tester.com">https://www.mail-tester.com/</a><br />
只需访问该页面并向他们提供的地址发送电子邮件：</p>
<pre><code class="language-bash">echo "This is the body of the email" | mail -s "This is the subject line" test-iimosa79z@srv1.mail-tester.com
</code></pre>
<p>您还可以通过向 <code>check-auth@verifier.port25.com</code> 发送电子邮件来<strong>检查您的电子邮件配置</strong>，并<strong>阅读响应</strong>（为此，您需要<strong>打开</strong>端口<strong>25</strong>，并在文件 <em>/var/mail/root</em> 中查看响应，如果您以 root 身份发送电子邮件）。<br />
检查您是否通过了所有测试：</p>
<pre><code class="language-bash">==========================================================
Summary of Results
==========================================================
SPF check:          pass
DomainKeys check:   neutral
DKIM check:         pass
Sender-ID check:    pass
SpamAssassin check: ham
</code></pre>
<p>您还可以向<strong>您控制的Gmail发送消息</strong>，并检查您Gmail收件箱中的<strong>电子邮件头</strong>，<code>dkim=pass</code>应出现在<code>Authentication-Results</code>头字段中。</p>
<pre><code>Authentication-Results: mx.google.com;
spf=pass (google.com: domain of contact@example.com designates --- as permitted sender) smtp.mail=contact@example.com;
dkim=pass header.i=@example.com;
</code></pre>
<h3 id="从spamhouse黑名单中移除"><a class="header" href="#从spamhouse黑名单中移除">​从Spamhouse黑名单中移除</a></h3>
<p>页面 <a href="https://www.mail-tester.com">www.mail-tester.com</a> 可以指示您的域名是否被spamhouse阻止。您可以在以下网址请求移除您的域名/IP: ​<a href="https://www.spamhaus.org/lookup/">https://www.spamhaus.org/lookup/</a></p>
<h3 id="从microsoft黑名单中移除"><a class="header" href="#从microsoft黑名单中移除">从Microsoft黑名单中移除</a></h3>
<p>您可以在 <a href="https://sender.office.com">https://sender.office.com/</a> 请求移除您的域名/IP。</p>
<h2 id="创建并启动gophish活动"><a class="header" href="#创建并启动gophish活动">创建并启动GoPhish活动</a></h2>
<h3 id="发送配置"><a class="header" href="#发送配置">发送配置</a></h3>
<ul>
<li>设置一些 <strong>名称以识别</strong> 发送者配置</li>
<li>决定您将从哪个账户发送钓鱼邮件。建议：<em>noreply, support, servicedesk, salesforce...</em></li>
<li>您可以将用户名和密码留空，但请确保勾选忽略证书错误</li>
</ul>
<p><img src="../../.gitbook/assets/image%20(253)%20(1)%20(2)%20(1)%20(1)%20(2)%20(2)%20(3)%20(3)%20(5)%20(3)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(1)%20(10)%20(15)%20(2).png" alt="" /></p>
<p>{% hint style="info" %}
建议使用“<strong>发送测试邮件</strong>”功能来测试一切是否正常。<br />
我建议将<strong>测试邮件发送到10分钟邮件地址</strong>以避免在测试中被列入黑名单。
{% endhint %}</p>
<h3 id="邮件模板"><a class="header" href="#邮件模板">邮件模板</a></h3>
<ul>
<li>设置一些 <strong>名称以识别</strong> 模板</li>
<li>然后写一个 <strong>主题</strong>（没有奇怪的内容，只是您在常规邮件中可能会看到的内容）</li>
<li>确保您已勾选“<strong>添加跟踪图像</strong>”</li>
<li>编写 <strong>邮件模板</strong>（您可以使用变量，如以下示例所示）：</li>
</ul>
<pre><code class="language-markup">&lt;html&gt;
&lt;head&gt;
&lt;title&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;p class="MsoNormal"&gt;&lt;span style="font-size:10.0pt;font-family:&amp;quot;Verdana&amp;quot;,sans-serif;color:black"&gt;Dear {{.FirstName}} {{.LastName}},&lt;/span&gt;&lt;/p&gt;
&lt;br /&gt;
Note: We require all user to login an a very suspicios page before the end of the week, thanks!&lt;br /&gt;
&lt;br /&gt;
Regards,&lt;/span&gt;&lt;/p&gt;

WRITE HERE SOME SIGNATURE OF SOMEONE FROM THE COMPANY

&lt;p&gt;{{.Tracker}}&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>注意，<strong>为了提高电子邮件的可信度</strong>，建议使用客户的电子邮件中的某些签名。建议：</p>
<ul>
<li>向一个<strong>不存在的地址</strong>发送电子邮件，并检查回复是否有任何签名。</li>
<li>搜索<strong>公共电子邮件</strong>，如 info@ex.com 或 press@ex.com 或 public@ex.com，并向他们发送电子邮件，等待回复。</li>
<li>尝试联系<strong>一些有效发现的</strong>电子邮件，并等待回复。</li>
</ul>
<p><img src="../../.gitbook/assets/image%20(80).png" alt="" /></p>
<p>{% hint style="info" %}
电子邮件模板还允许<strong>附加要发送的文件</strong>。如果您还想使用一些特别制作的文件/文档窃取 NTLM 挑战，请<a href="../../windows-hardening/ntlm/places-to-steal-ntlm-creds.html">阅读此页面</a>。
{% endhint %}</p>
<h3 id="登陆页面"><a class="header" href="#登陆页面">登陆页面</a></h3>
<ul>
<li>写一个<strong>名称</strong></li>
<li><strong>编写网页的 HTML 代码</strong>。请注意，您可以<strong>导入</strong>网页。</li>
<li>标记<strong>捕获提交的数据</strong>和<strong>捕获密码</strong></li>
<li>设置<strong>重定向</strong></li>
</ul>
<p><img src="../../.gitbook/assets/image%20(826).png" alt="" /></p>
<p>{% hint style="info" %}
通常，您需要修改页面的 HTML 代码并在本地进行一些测试（可能使用一些 Apache 服务器）<strong>直到您喜欢结果。</strong> 然后，将该 HTML 代码写入框中。<br />
请注意，如果您需要<strong>使用一些静态资源</strong>用于 HTML（可能是一些 CSS 和 JS 页面），您可以将它们保存在 <em><strong>/opt/gophish/static/endpoint</strong></em> 中，然后从 <em><strong>/static/&lt;filename&gt;</strong></em> 访问它们。
{% endhint %}</p>
<p>{% hint style="info" %}
对于重定向，您可以<strong>将用户重定向到受害者的合法主网页</strong>，或者将他们重定向到 <em>/static/migration.html</em>，例如，放置一些<strong>旋转轮</strong>（<strong><a href="https://loading.io">https://loading.io/</a></strong>）5 秒钟，然后指示该过程成功。
{% endhint %}</p>
<h3 id="用户与组"><a class="header" href="#用户与组">用户与组</a></h3>
<ul>
<li>设置一个名称</li>
<li><strong>导入数据</strong>（请注意，为了使用示例模板，您需要每个用户的名字、姓氏和电子邮件地址）</li>
</ul>
<p><img src="../../.gitbook/assets/image%20(163).png" alt="" /></p>
<h3 id="活动"><a class="header" href="#活动">活动</a></h3>
<p>最后，创建一个活动，选择一个名称、电子邮件模板、登陆页面、URL、发送配置文件和组。请注意，URL 将是发送给受害者的链接。</p>
<p>请注意，<strong>发送配置文件允许发送测试电子邮件以查看最终的钓鱼电子邮件的外观</strong>：</p>
<p><img src="../../.gitbook/assets/image%20(192).png" alt="" /></p>
<p>{% hint style="info" %}
我建议<strong>将测试电子邮件发送到 10 分钟邮件地址</strong>以避免在测试中被列入黑名单。
{% endhint %}</p>
<p>一切准备就绪后，只需启动活动！</p>
<h2 id="网站克隆"><a class="header" href="#网站克隆">网站克隆</a></h2>
<p>如果出于任何原因您想克隆网站，请查看以下页面：</p>
<p>{% content-ref url="clone-a-website.md" %}
<a href="clone-a-website.html">clone-a-website.md</a>
{% endcontent-ref %}</p>
<h2 id="后门文档和文件"><a class="header" href="#后门文档和文件">后门文档和文件</a></h2>
<p>在某些钓鱼评估中（主要针对红队），您还希望<strong>发送包含某种后门的文件</strong>（可能是 C2，或者只是触发身份验证的东西）。<br />
查看以下页面以获取一些示例：</p>
<p>{% content-ref url="phishing-documents.md" %}
<a href="phishing-documents.html">phishing-documents.md</a>
{% endcontent-ref %}</p>
<h2 id="钓鱼-mfa"><a class="header" href="#钓鱼-mfa">钓鱼 MFA</a></h2>
<h3 id="通过代理-mitm"><a class="header" href="#通过代理-mitm">通过代理 MitM</a></h3>
<p>之前的攻击非常聪明，因为您伪造了一个真实的网站并收集了用户输入的信息。不幸的是，如果用户没有输入正确的密码，或者您伪造的应用程序配置了 2FA，<strong>这些信息将无法让您冒充被欺骗的用户</strong>。</p>
<p>这就是像 <a href="https://github.com/kgretzky/evilginx2"><strong>evilginx2</strong></a><strong>、</strong> <a href="https://github.com/ustayready/CredSniper"><strong>CredSniper</strong></a> 和 <a href="https://github.com/muraenateam/muraena"><strong>muraena</strong></a> 这样的工具有用的地方。该工具将允许您生成类似 MitM 的攻击。基本上，攻击的工作方式如下：</p>
<ol>
<li>您<strong>冒充真实网页的登录</strong>表单。</li>
<li>用户<strong>发送</strong>他的<strong>凭据</strong>到您的假页面，工具将这些发送到真实网页，<strong>检查凭据是否有效</strong>。</li>
<li>如果账户配置了<strong>2FA</strong>，MitM 页面将要求输入，一旦<strong>用户输入</strong>，工具将其发送到真实网页。</li>
<li>一旦用户通过身份验证，您（作为攻击者）将<strong>捕获凭据、2FA、cookie 和任何信息</strong>，在工具执行 MitM 时的每次交互。</li>
</ol>
<h3 id="通过-vnc"><a class="header" href="#通过-vnc">通过 VNC</a></h3>
<p>如果您不是<strong>将受害者发送到一个与原始页面外观相同的恶意页面</strong>，而是将他发送到一个<strong>与真实网页连接的浏览器的 VNC 会话</strong>呢？您将能够看到他所做的事情，窃取密码、使用的 MFA、cookie...<br />
您可以使用 <a href="https://github.com/JoelGMSec/EvilnoVNC"><strong>EvilnVNC</strong></a> 来做到这一点。</p>
<h2 id="检测检测"><a class="header" href="#检测检测">检测检测</a></h2>
<p>显然，知道您是否被发现的最佳方法之一是<strong>在黑名单中搜索您的域名</strong>。如果它出现在列表中，您的域名以某种方式被检测为可疑。<br />
检查您的域名是否出现在任何黑名单中的一种简单方法是使用 <a href="https://malwareworld.com">https://malwareworld.com/</a>。</p>
<p>然而，还有其他方法可以知道受害者是否<strong>在积极寻找可疑的钓鱼活动</strong>，如以下所述：</p>
<p>{% content-ref url="detecting-phising.md" %}
<a href="detecting-phising.html">detecting-phising.md</a>
{% endcontent-ref %}</p>
<p>您可以<strong>购买一个与受害者域名非常相似的域名</strong>，<strong>和/或为您控制的域名的</strong>子域名<strong>生成证书</strong>，<strong>包含</strong>受害者域名的<strong>关键字</strong>。如果<strong>受害者</strong>与它们进行任何类型的<strong>DNS 或 HTTP 交互</strong>，您将知道<strong>他在积极寻找</strong>可疑域名，您需要非常隐蔽。</p>
<h3 id="评估钓鱼"><a class="header" href="#评估钓鱼">评估钓鱼</a></h3>
<p>使用 <a href="https://github.com/Rices/Phishious"><strong>Phishious</strong> </a> 评估您的电子邮件是否会进入垃圾邮件文件夹，或者是否会被阻止或成功。</p>
<h2 id="参考"><a class="header" href="#参考">参考</a></h2>
<ul>
<li><a href="https://zeltser.com/domain-name-variations-in-phishing/">https://zeltser.com/domain-name-variations-in-phishing/</a></li>
<li><a href="https://0xpatrik.com/phishing-domains/">https://0xpatrik.com/phishing-domains/</a></li>
<li><a href="https://darkbyte.net/robando-sesiones-y-bypasseando-2fa-con-evilnovnc/">https://darkbyte.net/robando-sesiones-y-bypasseando-2fa-con-evilnovnc/</a></li>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-configure-dkim-with-postfix-on-debian-wheezy">https://www.digitalocean.com/community/tutorials/how-to-install-and-configure-dkim-with-postfix-on-debian-wheezy</a></li>
</ul>
<p>{% hint style="success" %}
学习和实践 AWS 黑客攻击：<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习和实践 GCP 黑客攻击：<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>电报群组</strong></a> 或 <strong>在 Twitter 上关注</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> github 仓库提交 PR 来分享黑客技巧。</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../generic-methodologies-and-resources/pentesting-wifi/evil-twin-eap-tls.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../generic-methodologies-and-resources/phishing-methodology/clone-a-website.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../generic-methodologies-and-resources/pentesting-wifi/evil-twin-eap-tls.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../generic-methodologies-and-resources/phishing-methodology/clone-a-website.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
