<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Linux Forensics</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="linux-forensics"><a class="header" href="#linux-forensics">Linux Forensics</a></h1>
<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>
<p><br />
ä½¿ç”¨ <a href="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=text&amp;utm_campaign=ppc&amp;utm_content=linux-forensics"><strong>Trickest</strong></a> è½»æ¾æ„å»ºå’Œ <strong>è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹</strong>ï¼Œç”±ä¸–ç•Œä¸Š <strong>æœ€å…ˆè¿›</strong> çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚<br />
ä»Šå¤©è·å–è®¿é—®æƒé™ï¼š</p>
<p>{% embed url="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=banner&amp;utm_campaign=ppc&amp;utm_content=linux-forensics" %}</p>
<p>{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>ç”µæŠ¥ç¾¤ç»„</strong></a> æˆ– <strong>åœ¨</strong> <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a>** ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚**</li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> github ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}
<h2 id="åˆå§‹ä¿¡æ¯æ”¶é›†"><a class="header" href="#åˆå§‹ä¿¡æ¯æ”¶é›†">åˆå§‹ä¿¡æ¯æ”¶é›†</a></h2>
<h3 id="åŸºæœ¬ä¿¡æ¯"><a class="header" href="#åŸºæœ¬ä¿¡æ¯">åŸºæœ¬ä¿¡æ¯</a></h3>
<p>é¦–å…ˆï¼Œå»ºè®®å‡†å¤‡ä¸€äº› <strong>USB</strong>ï¼Œä¸Šé¢æœ‰ <strong>å·²çŸ¥çš„è‰¯å¥½äºŒè¿›åˆ¶æ–‡ä»¶å’Œåº“</strong>ï¼ˆä½ å¯ä»¥ç›´æ¥è·å– ubuntu å¹¶å¤åˆ¶æ–‡ä»¶å¤¹ <em>/bin</em>, <em>/sbin</em>, <em>/lib,</em> å’Œ <em>/lib64</em>ï¼‰ï¼Œç„¶åæŒ‚è½½ USBï¼Œå¹¶ä¿®æ”¹ç¯å¢ƒå˜é‡ä»¥ä½¿ç”¨è¿™äº›äºŒè¿›åˆ¶æ–‡ä»¶ï¼š</p>
<pre><code class="language-bash">export PATH=/mnt/usb/bin:/mnt/usb/sbin
export LD_LIBRARY_PATH=/mnt/usb/lib:/mnt/usb/lib64
</code></pre>
<p>ä¸€æ—¦æ‚¨é…ç½®ç³»ç»Ÿä»¥ä½¿ç”¨è‰¯å¥½ä¸”å·²çŸ¥çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ‚¨å¯ä»¥å¼€å§‹<strong>æå–ä¸€äº›åŸºæœ¬ä¿¡æ¯</strong>ï¼š</p>
<pre><code class="language-bash">date #Date and time (Clock may be skewed, Might be at a different timezone)
uname -a #OS info
ifconfig -a || ip a #Network interfaces (promiscuous mode?)
ps -ef #Running processes
netstat -anp #Proccess and ports
lsof -V #Open files
netstat -rn; route #Routing table
df; mount #Free space and mounted devices
free #Meam and swap space
w #Who is connected
last -Faiwx #Logins
lsmod #What is loaded
cat /etc/passwd #Unexpected data?
cat /etc/shadow #Unexpected data?
find /directory -type f -mtime -1 -print #Find modified files during the last minute in the directory
</code></pre>
<h4 id="å¯ç–‘ä¿¡æ¯"><a class="header" href="#å¯ç–‘ä¿¡æ¯">å¯ç–‘ä¿¡æ¯</a></h4>
<p>åœ¨è·å–åŸºæœ¬ä¿¡æ¯æ—¶ï¼Œæ‚¨åº”è¯¥æ£€æŸ¥ä¸€äº›å¥‡æ€ªçš„äº‹æƒ…ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li><strong>Root è¿›ç¨‹</strong> é€šå¸¸ä½¿ç”¨ä½ PIDSï¼Œå› æ­¤å¦‚æœæ‚¨å‘ç°ä¸€ä¸ªå…·æœ‰å¤§ PID çš„ root è¿›ç¨‹ï¼Œæ‚¨å¯èƒ½ä¼šæ€€ç–‘</li>
<li>æ£€æŸ¥ <code>/etc/passwd</code> ä¸­æ²¡æœ‰ shell çš„ç”¨æˆ·çš„ <strong>æ³¨å†Œç™»å½•</strong></li>
<li>æ£€æŸ¥ <code>/etc/shadow</code> ä¸­æ²¡æœ‰ shell çš„ç”¨æˆ·çš„ <strong>å¯†ç å“ˆå¸Œ</strong></li>
</ul>
<h3 id="å†…å­˜è½¬å‚¨"><a class="header" href="#å†…å­˜è½¬å‚¨">å†…å­˜è½¬å‚¨</a></h3>
<p>è¦è·å–è¿è¡Œç³»ç»Ÿçš„å†…å­˜ï¼Œå»ºè®®ä½¿ç”¨ <a href="https://github.com/504ensicsLabs/LiME"><strong>LiME</strong></a>ã€‚<br />
è¦ <strong>ç¼–è¯‘</strong> å®ƒï¼Œæ‚¨éœ€è¦ä½¿ç”¨å—å®³è€…æœºå™¨æ­£åœ¨ä½¿ç”¨çš„ <strong>ç›¸åŒå†…æ ¸</strong>ã€‚</p>
<p>{% hint style="info" %}
è¯·è®°ä½ï¼Œæ‚¨ <strong>ä¸èƒ½åœ¨å—å®³è€…æœºå™¨ä¸Šå®‰è£… LiME æˆ–å…¶ä»–ä»»ä½•ä¸œè¥¿</strong>ï¼Œå› ä¸ºè¿™ä¼šå¯¹å…¶è¿›è¡Œå¤šé¡¹æ›´æ”¹
{% endhint %}</p>
<p>å› æ­¤ï¼Œå¦‚æœæ‚¨æœ‰ä¸€ä¸ªç›¸åŒç‰ˆæœ¬çš„ Ubuntuï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ <code>apt-get install lime-forensics-dkms</code><br />
åœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œæ‚¨éœ€è¦ä» github ä¸‹è½½ <a href="https://github.com/504ensicsLabs/LiME"><strong>LiME</strong></a> å¹¶ä½¿ç”¨æ­£ç¡®çš„å†…æ ¸å¤´æ–‡ä»¶è¿›è¡Œç¼–è¯‘ã€‚è¦ <strong>è·å–å—å®³è€…æœºå™¨çš„ç¡®åˆ‡å†…æ ¸å¤´æ–‡ä»¶</strong>ï¼Œæ‚¨å¯ä»¥ç›´æ¥ <strong>å¤åˆ¶ç›®å½•</strong> <code>/lib/modules/&lt;kernel version&gt;</code> åˆ°æ‚¨çš„æœºå™¨ï¼Œç„¶åä½¿ç”¨å®ƒä»¬ <strong>ç¼–è¯‘</strong> LiMEï¼š</p>
<pre><code class="language-bash">make -C /lib/modules/&lt;kernel version&gt;/build M=$PWD
sudo insmod lime.ko "path=/home/sansforensics/Desktop/mem_dump.bin format=lime"
</code></pre>
<p>LiME æ”¯æŒ 3 <strong>æ ¼å¼</strong>ï¼š</p>
<ul>
<li>åŸå§‹ï¼ˆæ¯ä¸ªæ®µè½è¿æ¥åœ¨ä¸€èµ·ï¼‰</li>
<li>å¡«å……ï¼ˆä¸åŸå§‹ç›¸åŒï¼Œä½†å³ä¾§ä½ç”¨é›¶å¡«å……ï¼‰</li>
<li>Limeï¼ˆæ¨èæ ¼å¼ï¼Œå¸¦æœ‰å…ƒæ•°æ®ï¼‰</li>
</ul>
<p>LiME è¿˜å¯ä»¥ç”¨äº <strong>é€šè¿‡ç½‘ç»œå‘é€è½¬å‚¨</strong>ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç±»ä¼¼ <code>path=tcp:4444</code> çš„æ–¹å¼å°†å…¶å­˜å‚¨åœ¨ç³»ç»Ÿä¸Šã€‚</p>
<h3 id="ç£ç›˜æˆåƒ"><a class="header" href="#ç£ç›˜æˆåƒ">ç£ç›˜æˆåƒ</a></h3>
<h4 id="å…³æœº"><a class="header" href="#å…³æœº">å…³æœº</a></h4>
<p>é¦–å…ˆï¼Œæ‚¨éœ€è¦ <strong>å…³é—­ç³»ç»Ÿ</strong>ã€‚è¿™å¹¶ä¸æ€»æ˜¯ä¸€ä¸ªé€‰é¡¹ï¼Œå› ä¸ºæœ‰æ—¶ç³»ç»Ÿå¯èƒ½æ˜¯å…¬å¸æ— æ³•æ‰¿å—å…³é—­çš„ç”Ÿäº§æœåŠ¡å™¨ã€‚<br />
æœ‰ <strong>2 ç§æ–¹æ³•</strong> å¯ä»¥å…³é—­ç³»ç»Ÿï¼Œ<strong>æ­£å¸¸å…³æœº</strong> å’Œ <strong>â€œæ‹”æ‰æ’å¤´â€å…³æœº</strong>ã€‚ç¬¬ä¸€ç§æ–¹æ³•å°†å…è®¸ <strong>è¿›ç¨‹æ­£å¸¸ç»ˆæ­¢</strong>ï¼Œå¹¶ä½¿ <strong>æ–‡ä»¶ç³»ç»Ÿ</strong> <strong>åŒæ­¥</strong>ï¼Œä½†è¿™ä¹Ÿå¯èƒ½å…è®¸æ½œåœ¨çš„ <strong>æ¶æ„è½¯ä»¶</strong> <strong>ç ´åè¯æ®</strong>ã€‚â€œæ‹”æ‰æ’å¤´â€æ–¹æ³•å¯èƒ½ä¼šå¯¼è‡´ <strong>ä¸€äº›ä¿¡æ¯ä¸¢å¤±</strong>ï¼ˆç”±äºæˆ‘ä»¬å·²ç»è·å–äº†å†…å­˜çš„æ˜ åƒï¼Œä¸¢å¤±çš„ä¿¡æ¯ä¸ä¼šå¾ˆå¤šï¼‰ï¼Œå¹¶ä¸” <strong>æ¶æ„è½¯ä»¶å°†æ²¡æœ‰æœºä¼š</strong> é‡‡å–ä»»ä½•è¡ŒåŠ¨ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨ <strong>æ€€ç–‘</strong> å¯èƒ½å­˜åœ¨ <strong>æ¶æ„è½¯ä»¶</strong>ï¼Œè¯·åœ¨ç³»ç»Ÿä¸Šæ‰§è¡Œ <strong><code>sync</code></strong> <strong>å‘½ä»¤</strong> ç„¶åæ‹”æ‰æ’å¤´ã€‚</p>
<h4 id="è·å–ç£ç›˜æ˜ åƒ"><a class="header" href="#è·å–ç£ç›˜æ˜ åƒ">è·å–ç£ç›˜æ˜ åƒ</a></h4>
<p>é‡è¦çš„æ˜¯è¦æ³¨æ„ï¼Œåœ¨ <strong>å°†è®¡ç®—æœºè¿æ¥åˆ°ä¸æ¡ˆä»¶ç›¸å…³çš„ä»»ä½•è®¾å¤‡ä¹‹å‰</strong>ï¼Œæ‚¨éœ€è¦ç¡®ä¿å®ƒå°†ä»¥ <strong>åªè¯»æ–¹å¼æŒ‚è½½</strong>ï¼Œä»¥é¿å…ä¿®æ”¹ä»»ä½•ä¿¡æ¯ã€‚</p>
<pre><code class="language-bash">#Create a raw copy of the disk
dd if=&lt;subject device&gt; of=&lt;image file&gt; bs=512

#Raw copy with hashes along the way (more secure as it checks hashes while it's copying the data)
dcfldd if=&lt;subject device&gt; of=&lt;image file&gt; bs=512 hash=&lt;algorithm&gt; hashwindow=&lt;chunk size&gt; hashlog=&lt;hash file&gt;
dcfldd if=/dev/sdc of=/media/usb/pc.image hash=sha256 hashwindow=1M hashlog=/media/usb/pc.hashes
</code></pre>
<h3 id="ç£ç›˜æ˜ åƒé¢„åˆ†æ"><a class="header" href="#ç£ç›˜æ˜ åƒé¢„åˆ†æ">ç£ç›˜æ˜ åƒé¢„åˆ†æ</a></h3>
<p>å¯¹æ²¡æœ‰æ›´å¤šæ•°æ®çš„ç£ç›˜æ˜ åƒè¿›è¡Œæˆåƒã€‚</p>
<pre><code class="language-bash">#Find out if it's a disk image using "file" command
file disk.img
disk.img: Linux rev 1.0 ext4 filesystem data, UUID=59e7a736-9c90-4fab-ae35-1d6a28e5de27 (extents) (64bit) (large files) (huge files)

#Check which type of disk image it's
img_stat -t evidence.img
raw
#You can list supported types with
img_stat -i list
Supported image format types:
raw (Single or split raw file (dd))
aff (Advanced Forensic Format)
afd (AFF Multiple File)
afm (AFF with external metadata)
afflib (All AFFLIB image formats (including beta ones))
ewf (Expert Witness Format (EnCase))

#Data of the image
fsstat -i raw -f ext4 disk.img
FILE SYSTEM INFORMATION
--------------------------------------------
File System Type: Ext4
Volume Name:
Volume ID: 162850f203fd75afab4f1e4736a7e776

Last Written at: 2020-02-06 06:22:48 (UTC)
Last Checked at: 2020-02-06 06:15:09 (UTC)

Last Mounted at: 2020-02-06 06:15:18 (UTC)
Unmounted properly
Last mounted on: /mnt/disk0

Source OS: Linux
[...]

#ls inside the image
fls -i raw -f ext4 disk.img
d/d 11: lost+found
d/d 12: Documents
d/d 8193:       folder1
d/d 8194:       folder2
V/V 65537:      $OrphanFiles

#ls inside folder
fls -i raw -f ext4 disk.img 12
r/r 16: secret.txt

#cat file inside image
icat -i raw -f ext4 disk.img 16
ThisisTheMasterSecret
</code></pre>
<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>
<p><br />
ä½¿ç”¨ <a href="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=text&amp;utm_campaign=ppc&amp;utm_content=linux-forensics"><strong>Trickest</strong></a> è½»æ¾æ„å»ºå’Œ <strong>è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹</strong>ï¼Œç”±ä¸–ç•Œä¸Š <strong>æœ€å…ˆè¿›</strong> çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚<br />
ç«‹å³è·å–è®¿é—®æƒé™ï¼š</p>
<p>{% embed url="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=banner&amp;utm_campaign=ppc&amp;utm_content=linux-forensics" %}</p>
<h2 id="æœç´¢å·²çŸ¥æ¶æ„è½¯ä»¶"><a class="header" href="#æœç´¢å·²çŸ¥æ¶æ„è½¯ä»¶">æœç´¢å·²çŸ¥æ¶æ„è½¯ä»¶</a></h2>
<h3 id="ä¿®æ”¹è¿‡çš„ç³»ç»Ÿæ–‡ä»¶"><a class="header" href="#ä¿®æ”¹è¿‡çš„ç³»ç»Ÿæ–‡ä»¶">ä¿®æ”¹è¿‡çš„ç³»ç»Ÿæ–‡ä»¶</a></h3>
<p>Linux æä¾›å·¥å…·ä»¥ç¡®ä¿ç³»ç»Ÿç»„ä»¶çš„å®Œæ•´æ€§ï¼Œè¿™å¯¹äºå‘ç°æ½œåœ¨é—®é¢˜æ–‡ä»¶è‡³å…³é‡è¦ã€‚</p>
<ul>
<li><strong>åŸºäº RedHat çš„ç³»ç»Ÿ</strong>ï¼šä½¿ç”¨ <code>rpm -Va</code> è¿›è¡Œå…¨é¢æ£€æŸ¥ã€‚</li>
<li><strong>åŸºäº Debian çš„ç³»ç»Ÿ</strong>ï¼šä½¿ç”¨ <code>dpkg --verify</code> è¿›è¡Œåˆæ­¥éªŒè¯ï¼Œç„¶åä½¿ç”¨ <code>debsums | grep -v "OK$"</code>ï¼ˆåœ¨ä½¿ç”¨ <code>apt-get install debsums</code> å®‰è£… <code>debsums</code> åï¼‰æ¥è¯†åˆ«ä»»ä½•é—®é¢˜ã€‚</li>
</ul>
<h3 id="æ¶æ„è½¯ä»¶rootkit-æ£€æµ‹å™¨"><a class="header" href="#æ¶æ„è½¯ä»¶rootkit-æ£€æµ‹å™¨">æ¶æ„è½¯ä»¶/Rootkit æ£€æµ‹å™¨</a></h3>
<p>é˜…è¯»ä»¥ä¸‹é¡µé¢ä»¥äº†è§£å¯ä»¥ç”¨äºæŸ¥æ‰¾æ¶æ„è½¯ä»¶çš„å·¥å…·ï¼š</p>
<p>{% content-ref url="malware-analysis.md" %}
<a href="malware-analysis.html">malware-analysis.md</a>
{% endcontent-ref %}</p>
<h2 id="æœç´¢å·²å®‰è£…ç¨‹åº"><a class="header" href="#æœç´¢å·²å®‰è£…ç¨‹åº">æœç´¢å·²å®‰è£…ç¨‹åº</a></h2>
<p>è¦æœ‰æ•ˆæœç´¢ Debian å’Œ RedHat ç³»ç»Ÿä¸Šå·²å®‰è£…çš„ç¨‹åºï¼Œå¯ä»¥è€ƒè™‘åˆ©ç”¨ç³»ç»Ÿæ—¥å¿—å’Œæ•°æ®åº“ï¼ŒåŒæ—¶åœ¨å¸¸è§ç›®å½•ä¸­è¿›è¡Œæ‰‹åŠ¨æ£€æŸ¥ã€‚</p>
<ul>
<li>å¯¹äº Debianï¼Œæ£€æŸ¥ <em><strong><code>/var/lib/dpkg/status</code></strong></em> å’Œ <em><strong><code>/var/log/dpkg.log</code></strong></em> ä»¥è·å–æœ‰å…³è½¯ä»¶åŒ…å®‰è£…çš„è¯¦ç»†ä¿¡æ¯ï¼Œä½¿ç”¨ <code>grep</code> è¿‡æ»¤ç‰¹å®šä¿¡æ¯ã€‚</li>
<li>RedHat ç”¨æˆ·å¯ä»¥ä½¿ç”¨ <code>rpm -qa --root=/mntpath/var/lib/rpm</code> æŸ¥è¯¢ RPM æ•°æ®åº“ä»¥åˆ—å‡ºå·²å®‰è£…çš„è½¯ä»¶åŒ…ã€‚</li>
</ul>
<p>è¦å‘ç°æ‰‹åŠ¨å®‰è£…æˆ–åœ¨è¿™äº›è½¯ä»¶åŒ…ç®¡ç†å™¨ä¹‹å¤–å®‰è£…çš„è½¯ä»¶ï¼Œæ¢ç´¢ç›®å½•å¦‚ <em><strong><code>/usr/local</code></strong></em>ã€<em><strong><code>/opt</code></strong></em>ã€<em><strong><code>/usr/sbin</code></strong></em>ã€<em><strong><code>/usr/bin</code></strong></em>ã€<em><strong><code>/bin</code></strong></em> å’Œ <em><strong><code>/sbin</code></strong></em>ã€‚å°†ç›®å½•åˆ—è¡¨ä¸ç‰¹å®šäºç³»ç»Ÿçš„å‘½ä»¤ç»“åˆä½¿ç”¨ï¼Œä»¥è¯†åˆ«ä¸å·²çŸ¥è½¯ä»¶åŒ…æ— å…³çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»è€Œå¢å¼ºæ‚¨å¯¹æ‰€æœ‰å·²å®‰è£…ç¨‹åºçš„æœç´¢ã€‚</p>
<pre><code class="language-bash"># Debian package and log details
cat /var/lib/dpkg/status | grep -E "Package:|Status:"
cat /var/log/dpkg.log | grep installed
# RedHat RPM database query
rpm -qa --root=/mntpath/var/lib/rpm
# Listing directories for manual installations
ls /usr/sbin /usr/bin /bin /sbin
# Identifying non-package executables (Debian)
find /sbin/ -exec dpkg -S {} \; | grep "no path found"
# Identifying non-package executables (RedHat)
find /sbin/ â€“exec rpm -qf {} \; | grep "is not"
# Find exacuable files
find / -type f -executable | grep &lt;something&gt;
</code></pre>
<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>
<p><br />
ä½¿ç”¨ <a href="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=text&amp;utm_campaign=ppc&amp;utm_content=linux-forensics"><strong>Trickest</strong></a> è½»æ¾æ„å»ºå’Œ <strong>è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹</strong>ï¼Œç”±ä¸–ç•Œä¸Š <strong>æœ€å…ˆè¿›</strong> çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚<br />
ç«‹å³è·å–è®¿é—®æƒé™ï¼š</p>
<p>{% embed url="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=banner&amp;utm_campaign=ppc&amp;utm_content=linux-forensics" %}</p>
<h2 id="æ¢å¤å·²åˆ é™¤çš„è¿è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶"><a class="header" href="#æ¢å¤å·²åˆ é™¤çš„è¿è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶">æ¢å¤å·²åˆ é™¤çš„è¿è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶</a></h2>
<p>æƒ³è±¡ä¸€ä¸‹ä¸€ä¸ªä» /tmp/exec æ‰§è¡Œå¹¶éšåè¢«åˆ é™¤çš„è¿›ç¨‹ã€‚å¯ä»¥æå–å®ƒ</p>
<pre><code class="language-bash">cd /proc/3746/ #PID with the exec file deleted
head -1 maps #Get address of the file. It was 08048000-08049000
dd if=mem bs=1 skip=08048000 count=1000 of=/tmp/exec2 #Recorver it
</code></pre>
<h2 id="æ£€æŸ¥è‡ªå¯åŠ¨ä½ç½®"><a class="header" href="#æ£€æŸ¥è‡ªå¯åŠ¨ä½ç½®">æ£€æŸ¥è‡ªå¯åŠ¨ä½ç½®</a></h2>
<h3 id="è®¡åˆ’ä»»åŠ¡"><a class="header" href="#è®¡åˆ’ä»»åŠ¡">è®¡åˆ’ä»»åŠ¡</a></h3>
<pre><code class="language-bash">cat /var/spool/cron/crontabs/*  \
/var/spool/cron/atjobs \
/var/spool/anacron \
/etc/cron* \
/etc/at* \
/etc/anacrontab \
/etc/incron.d/* \
/var/spool/incron/* \

#MacOS
ls -l /usr/lib/cron/tabs/ /Library/LaunchAgents/ /Library/LaunchDaemons/ ~/Library/LaunchAgents/
</code></pre>
<h3 id="æœåŠ¡"><a class="header" href="#æœåŠ¡">æœåŠ¡</a></h3>
<p>æ¶æ„è½¯ä»¶å¯ä»¥ä½œä¸ºæœåŠ¡å®‰è£…çš„è·¯å¾„ï¼š</p>
<ul>
<li><strong>/etc/inittab</strong>: è°ƒç”¨åˆå§‹åŒ–è„šæœ¬ï¼Œå¦‚ rc.sysinitï¼Œè¿›ä¸€æ­¥æŒ‡å‘å¯åŠ¨è„šæœ¬ã€‚</li>
<li><strong>/etc/rc.d/</strong> å’Œ <strong>/etc/rc.boot/</strong>: åŒ…å«æœåŠ¡å¯åŠ¨çš„è„šæœ¬ï¼Œåè€…åœ¨è¾ƒæ—§çš„ Linux ç‰ˆæœ¬ä¸­æ‰¾åˆ°ã€‚</li>
<li><strong>/etc/init.d/</strong>: åœ¨æŸäº› Linux ç‰ˆæœ¬ä¸­ï¼ˆå¦‚ Debianï¼‰ç”¨äºå­˜å‚¨å¯åŠ¨è„šæœ¬ã€‚</li>
<li>æœåŠ¡ä¹Ÿå¯ä»¥é€šè¿‡ <strong>/etc/inetd.conf</strong> æˆ– <strong>/etc/xinetd/</strong> æ¿€æ´»ï¼Œå…·ä½“å–å†³äº Linux å˜ä½“ã€‚</li>
<li><strong>/etc/systemd/system</strong>: ç³»ç»Ÿå’ŒæœåŠ¡ç®¡ç†å™¨è„šæœ¬çš„ç›®å½•ã€‚</li>
<li><strong>/etc/systemd/system/multi-user.target.wants/</strong>: åŒ…å«åº”åœ¨å¤šç”¨æˆ·è¿è¡Œçº§åˆ«å¯åŠ¨çš„æœåŠ¡çš„é“¾æ¥ã€‚</li>
<li><strong>/usr/local/etc/rc.d/</strong>: ç”¨äºè‡ªå®šä¹‰æˆ–ç¬¬ä¸‰æ–¹æœåŠ¡ã€‚</li>
<li><strong>~/.config/autostart/</strong>: ç”¨æˆ·ç‰¹å®šçš„è‡ªåŠ¨å¯åŠ¨åº”ç”¨ç¨‹åºï¼Œå¯ä»¥æ˜¯é’ˆå¯¹ç”¨æˆ·çš„æ¶æ„è½¯ä»¶çš„éšè—åœ°ç‚¹ã€‚</li>
<li><strong>/lib/systemd/system/</strong>: å®‰è£…åŒ…æä¾›çš„ç³»ç»ŸèŒƒå›´é»˜è®¤å•å…ƒæ–‡ä»¶ã€‚</li>
</ul>
<h3 id="å†…æ ¸æ¨¡å—"><a class="header" href="#å†…æ ¸æ¨¡å—">å†…æ ¸æ¨¡å—</a></h3>
<p>Linux å†…æ ¸æ¨¡å—ï¼Œé€šå¸¸è¢«æ¶æ„è½¯ä»¶ä½œä¸º rootkit ç»„ä»¶ä½¿ç”¨ï¼Œåœ¨ç³»ç»Ÿå¯åŠ¨æ—¶åŠ è½½ã€‚ä¸è¿™äº›æ¨¡å—ç›¸å…³çš„å…³é”®ç›®å½•å’Œæ–‡ä»¶åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>/lib/modules/$(uname -r)</strong>: å­˜æ”¾æ­£åœ¨è¿è¡Œçš„å†…æ ¸ç‰ˆæœ¬çš„æ¨¡å—ã€‚</li>
<li><strong>/etc/modprobe.d</strong>: åŒ…å«æ§åˆ¶æ¨¡å—åŠ è½½çš„é…ç½®æ–‡ä»¶ã€‚</li>
<li><strong>/etc/modprobe</strong> å’Œ <strong>/etc/modprobe.conf</strong>: å…¨å±€æ¨¡å—è®¾ç½®çš„æ–‡ä»¶ã€‚</li>
</ul>
<h3 id="å…¶ä»–è‡ªåŠ¨å¯åŠ¨ä½ç½®"><a class="header" href="#å…¶ä»–è‡ªåŠ¨å¯åŠ¨ä½ç½®">å…¶ä»–è‡ªåŠ¨å¯åŠ¨ä½ç½®</a></h3>
<p>Linux ä½¿ç”¨å„ç§æ–‡ä»¶åœ¨ç”¨æˆ·ç™»å½•æ—¶è‡ªåŠ¨æ‰§è¡Œç¨‹åºï¼Œå¯èƒ½éšè—æ¶æ„è½¯ä»¶ï¼š</p>
<ul>
<li><strong>/etc/profile.d/</strong>*, <strong>/etc/profile</strong> å’Œ <strong>/etc/bash.bashrc</strong>: é’ˆå¯¹ä»»ä½•ç”¨æˆ·ç™»å½•æ‰§è¡Œã€‚</li>
<li><strong>~/.bashrc</strong>, <strong>~/.bash_profile</strong>, <strong>~/.profile</strong> å’Œ <strong>~/.config/autostart</strong>: ç”¨æˆ·ç‰¹å®šçš„æ–‡ä»¶ï¼Œåœ¨ä»–ä»¬ç™»å½•æ—¶è¿è¡Œã€‚</li>
<li><strong>/etc/rc.local</strong>: åœ¨æ‰€æœ‰ç³»ç»ŸæœåŠ¡å¯åŠ¨åè¿è¡Œï¼Œæ ‡å¿—ç€è¿‡æ¸¡åˆ°å¤šç”¨æˆ·ç¯å¢ƒçš„ç»“æŸã€‚</li>
</ul>
<h2 id="æ£€æŸ¥æ—¥å¿—"><a class="header" href="#æ£€æŸ¥æ—¥å¿—">æ£€æŸ¥æ—¥å¿—</a></h2>
<p>Linux ç³»ç»Ÿé€šè¿‡å„ç§æ—¥å¿—æ–‡ä»¶è·Ÿè¸ªç”¨æˆ·æ´»åŠ¨å’Œç³»ç»Ÿäº‹ä»¶ã€‚è¿™äº›æ—¥å¿—å¯¹äºè¯†åˆ«æœªç»æˆæƒçš„è®¿é—®ã€æ¶æ„è½¯ä»¶æ„ŸæŸ“å’Œå…¶ä»–å®‰å…¨äº‹ä»¶è‡³å…³é‡è¦ã€‚å…³é”®æ—¥å¿—æ–‡ä»¶åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>/var/log/syslog</strong> (Debian) æˆ– <strong>/var/log/messages</strong> (RedHat): æ•è·ç³»ç»ŸèŒƒå›´çš„æ¶ˆæ¯å’Œæ´»åŠ¨ã€‚</li>
<li><strong>/var/log/auth.log</strong> (Debian) æˆ– <strong>/var/log/secure</strong> (RedHat): è®°å½•èº«ä»½éªŒè¯å°è¯•ã€æˆåŠŸå’Œå¤±è´¥çš„ç™»å½•ã€‚</li>
<li>ä½¿ç”¨ <code>grep -iE "session opened for|accepted password|new session|not in sudoers" /var/log/auth.log</code> è¿‡æ»¤ç›¸å…³çš„èº«ä»½éªŒè¯äº‹ä»¶ã€‚</li>
<li><strong>/var/log/boot.log</strong>: åŒ…å«ç³»ç»Ÿå¯åŠ¨æ¶ˆæ¯ã€‚</li>
<li><strong>/var/log/maillog</strong> æˆ– <strong>/var/log/mail.log</strong>: è®°å½•é‚®ä»¶æœåŠ¡å™¨æ´»åŠ¨ï¼Œæœ‰åŠ©äºè·Ÿè¸ªä¸é‚®ä»¶ç›¸å…³çš„æœåŠ¡ã€‚</li>
<li><strong>/var/log/kern.log</strong>: å­˜å‚¨å†…æ ¸æ¶ˆæ¯ï¼ŒåŒ…æ‹¬é”™è¯¯å’Œè­¦å‘Šã€‚</li>
<li><strong>/var/log/dmesg</strong>: ä¿å­˜è®¾å¤‡é©±åŠ¨ç¨‹åºæ¶ˆæ¯ã€‚</li>
<li><strong>/var/log/faillog</strong>: è®°å½•å¤±è´¥çš„ç™»å½•å°è¯•ï¼Œæœ‰åŠ©äºå®‰å…¨æ¼æ´è°ƒæŸ¥ã€‚</li>
<li><strong>/var/log/cron</strong>: è®°å½• cron ä½œä¸šæ‰§è¡Œã€‚</li>
<li><strong>/var/log/daemon.log</strong>: è·Ÿè¸ªåå°æœåŠ¡æ´»åŠ¨ã€‚</li>
<li><strong>/var/log/btmp</strong>: è®°å½•å¤±è´¥çš„ç™»å½•å°è¯•ã€‚</li>
<li><strong>/var/log/httpd/</strong>: åŒ…å« Apache HTTPD é”™è¯¯å’Œè®¿é—®æ—¥å¿—ã€‚</li>
<li><strong>/var/log/mysqld.log</strong> æˆ– <strong>/var/log/mysql.log</strong>: è®°å½• MySQL æ•°æ®åº“æ´»åŠ¨ã€‚</li>
<li><strong>/var/log/xferlog</strong>: è®°å½• FTP æ–‡ä»¶ä¼ è¾“ã€‚</li>
<li><strong>/var/log/</strong>: å§‹ç»ˆæ£€æŸ¥æ­¤å¤„æ˜¯å¦æœ‰æ„å¤–æ—¥å¿—ã€‚</li>
</ul>
<p>{% hint style="info" %}
Linux ç³»ç»Ÿæ—¥å¿—å’Œå®¡è®¡å­ç³»ç»Ÿå¯èƒ½åœ¨å…¥ä¾µæˆ–æ¶æ„è½¯ä»¶äº‹ä»¶ä¸­è¢«ç¦ç”¨æˆ–åˆ é™¤ã€‚ç”±äº Linux ç³»ç»Ÿä¸Šçš„æ—¥å¿—é€šå¸¸åŒ…å«æœ‰å…³æ¶æ„æ´»åŠ¨çš„ä¸€äº›æœ€æœ‰ç”¨çš„ä¿¡æ¯ï¼Œå…¥ä¾µè€…é€šå¸¸ä¼šåˆ é™¤å®ƒä»¬ã€‚å› æ­¤ï¼Œåœ¨æ£€æŸ¥å¯ç”¨æ—¥å¿—æ–‡ä»¶æ—¶ï¼Œé‡è¦çš„æ˜¯æŸ¥æ‰¾å¯èƒ½è¡¨æ˜åˆ é™¤æˆ–ç¯¡æ”¹çš„é—´éš™æˆ–æ— åºæ¡ç›®ã€‚
{% endhint %}</p>
<p><strong>Linux ä¸ºæ¯ä¸ªç”¨æˆ·ç»´æŠ¤å‘½ä»¤å†å²</strong>ï¼Œå­˜å‚¨åœ¨ï¼š</p>
<ul>
<li>~/.bash_history</li>
<li>~/.zsh_history</li>
<li>~/.zsh_sessions/*</li>
<li>~/.python_history</li>
<li>~/.*_history</li>
</ul>
<p>æ­¤å¤–ï¼Œ<code>last -Faiwx</code> å‘½ä»¤æä¾›ç”¨æˆ·ç™»å½•çš„åˆ—è¡¨ã€‚æ£€æŸ¥æ˜¯å¦æœ‰æœªçŸ¥æˆ–æ„å¤–çš„ç™»å½•ã€‚</p>
<p>æ£€æŸ¥å¯ä»¥æˆäºˆé¢å¤–æƒé™çš„æ–‡ä»¶ï¼š</p>
<ul>
<li>å®¡æŸ¥ <code>/etc/sudoers</code> ä»¥æŸ¥æ‰¾å¯èƒ½è¢«æˆäºˆçš„æ„å¤–ç”¨æˆ·æƒé™ã€‚</li>
<li>å®¡æŸ¥ <code>/etc/sudoers.d/</code> ä»¥æŸ¥æ‰¾å¯èƒ½è¢«æˆäºˆçš„æ„å¤–ç”¨æˆ·æƒé™ã€‚</li>
<li>æ£€æŸ¥ <code>/etc/groups</code> ä»¥è¯†åˆ«ä»»ä½•ä¸å¯»å¸¸çš„ç»„æˆå‘˜èµ„æ ¼æˆ–æƒé™ã€‚</li>
<li>æ£€æŸ¥ <code>/etc/passwd</code> ä»¥è¯†åˆ«ä»»ä½•ä¸å¯»å¸¸çš„ç»„æˆå‘˜èµ„æ ¼æˆ–æƒé™ã€‚</li>
</ul>
<p>ä¸€äº›åº”ç”¨ç¨‹åºè¿˜ä¼šç”Ÿæˆè‡ªå·±çš„æ—¥å¿—ï¼š</p>
<ul>
<li><strong>SSH</strong>: æ£€æŸ¥ <em>~/.ssh/authorized_keys</em> å’Œ <em>~/.ssh/known_hosts</em> ä»¥æŸ¥æ‰¾æœªç»æˆæƒçš„è¿œç¨‹è¿æ¥ã€‚</li>
<li><strong>Gnome æ¡Œé¢</strong>: æŸ¥çœ‹ <em>~/.recently-used.xbel</em> ä»¥æŸ¥æ‰¾é€šè¿‡ Gnome åº”ç”¨ç¨‹åºæœ€è¿‘è®¿é—®çš„æ–‡ä»¶ã€‚</li>
<li><strong>Firefox/Chrome</strong>: æ£€æŸ¥ <em>~/.mozilla/firefox</em> æˆ– <em>~/.config/google-chrome</em> ä¸­çš„æµè§ˆå™¨å†å²å’Œä¸‹è½½ï¼Œä»¥æŸ¥æ‰¾å¯ç–‘æ´»åŠ¨ã€‚</li>
<li><strong>VIM</strong>: æ£€æŸ¥ <em>~/.viminfo</em> ä»¥è·å–ä½¿ç”¨è¯¦æƒ…ï¼Œå¦‚è®¿é—®çš„æ–‡ä»¶è·¯å¾„å’Œæœç´¢å†å²ã€‚</li>
<li><strong>Open Office</strong>: æ£€æŸ¥æœ€è¿‘çš„æ–‡æ¡£è®¿é—®ï¼Œä»¥æŒ‡ç¤ºå¯èƒ½è¢«ç ´åçš„æ–‡ä»¶ã€‚</li>
<li><strong>FTP/SFTP</strong>: æ£€æŸ¥ <em>~/.ftp_history</em> æˆ– <em>~/.sftp_history</em> ä¸­çš„æ—¥å¿—ï¼Œä»¥æŸ¥æ‰¾å¯èƒ½æœªç»æˆæƒçš„æ–‡ä»¶ä¼ è¾“ã€‚</li>
<li><strong>MySQL</strong>: æ£€æŸ¥ <em>~/.mysql_history</em> ä»¥è°ƒæŸ¥æ‰§è¡Œçš„ MySQL æŸ¥è¯¢ï¼Œå¯èƒ½æ­ç¤ºæœªç»æˆæƒçš„æ•°æ®åº“æ´»åŠ¨ã€‚</li>
<li><strong>Less</strong>: åˆ†æ <em>~/.lesshst</em> ä»¥è·å–ä½¿ç”¨å†å²ï¼ŒåŒ…æ‹¬æŸ¥çœ‹çš„æ–‡ä»¶å’Œæ‰§è¡Œçš„å‘½ä»¤ã€‚</li>
<li><strong>Git</strong>: æ£€æŸ¥ <em>~/.gitconfig</em> å’Œé¡¹ç›® <em>.git/logs</em> ä»¥æŸ¥æ‰¾å¯¹å­˜å‚¨åº“çš„æ›´æ”¹ã€‚</li>
</ul>
<h3 id="usb-æ—¥å¿—"><a class="header" href="#usb-æ—¥å¿—">USB æ—¥å¿—</a></h3>
<p><a href="https://github.com/snovvcrash/usbrip"><strong>usbrip</strong></a> æ˜¯ä¸€ä¸ªç”¨çº¯ Python 3 ç¼–å†™çš„å°è½¯ä»¶ï¼Œå®ƒè§£æ Linux æ—¥å¿—æ–‡ä»¶ï¼ˆ<code>/var/log/syslog*</code> æˆ– <code>/var/log/messages*</code>ï¼Œå…·ä½“å–å†³äºå‘è¡Œç‰ˆï¼‰ï¼Œä»¥æ„å»º USB äº‹ä»¶å†å²è¡¨ã€‚</p>
<p>äº†è§£<strong>æ‰€æœ‰ä½¿ç”¨è¿‡çš„ USB</strong> æ˜¯å¾ˆæœ‰è¶£çš„ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªæˆæƒçš„ USB åˆ—è¡¨æ¥æŸ¥æ‰¾â€œè¿è§„äº‹ä»¶â€ï¼ˆä¸åœ¨è¯¥åˆ—è¡¨ä¸­çš„ USB ä½¿ç”¨ï¼‰ï¼Œå°†æ›´æœ‰ç”¨ã€‚</p>
<h3 id="å®‰è£…"><a class="header" href="#å®‰è£…">å®‰è£…</a></h3>
<pre><code class="language-bash">pip3 install usbrip
usbrip ids download #Download USB ID database
</code></pre>
<h3 id="ç¤ºä¾‹"><a class="header" href="#ç¤ºä¾‹">ç¤ºä¾‹</a></h3>
<pre><code class="language-bash">usbrip events history #Get USB history of your curent linux machine
usbrip events history --pid 0002 --vid 0e0f --user kali #Search by pid OR vid OR user
#Search for vid and/or pid
usbrip ids download #Downlaod database
usbrip ids search --pid 0002 --vid 0e0f #Search for pid AND vid
</code></pre>
<p>æ›´å¤šç¤ºä¾‹å’Œä¿¡æ¯è¯·æŸ¥çœ‹ GitHub: <a href="https://github.com/snovvcrash/usbrip">https://github.com/snovvcrash/usbrip</a></p>
<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>
<p><br />
ä½¿ç”¨ <a href="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=text&amp;utm_campaign=ppc&amp;utm_content=linux-forensics"><strong>Trickest</strong></a> è½»æ¾æ„å»ºå’Œ <strong>è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹</strong>ï¼Œç”±ä¸–ç•Œä¸Š <strong>æœ€å…ˆè¿›</strong> çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚<br />
ä»Šå¤©å°±è·å–è®¿é—®æƒé™ï¼š</p>
<p>{% embed url="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=banner&amp;utm_campaign=ppc&amp;utm_content=linux-forensics" %}</p>
<h2 id="å®¡æŸ¥ç”¨æˆ·è´¦æˆ·å’Œç™»å½•æ´»åŠ¨"><a class="header" href="#å®¡æŸ¥ç”¨æˆ·è´¦æˆ·å’Œç™»å½•æ´»åŠ¨">å®¡æŸ¥ç”¨æˆ·è´¦æˆ·å’Œç™»å½•æ´»åŠ¨</a></h2>
<p>æ£€æŸ¥ <em><strong>/etc/passwd</strong></em>ã€<em><strong>/etc/shadow</strong></em> å’Œ <strong>å®‰å…¨æ—¥å¿—</strong>ï¼Œå¯»æ‰¾ä¸å¯»å¸¸çš„åç§°æˆ–åœ¨å·²çŸ¥æœªæˆæƒäº‹ä»¶é™„è¿‘åˆ›å»ºå’Œä½¿ç”¨çš„è´¦æˆ·ã€‚åŒæ—¶ï¼Œæ£€æŸ¥å¯èƒ½çš„ sudo æš´åŠ›æ”»å‡»ã€‚<br />
æ­¤å¤–ï¼Œæ£€æŸ¥åƒ <em><strong>/etc/sudoers</strong></em> å’Œ <em><strong>/etc/groups</strong></em> è¿™æ ·çš„æ–‡ä»¶ï¼Œå¯»æ‰¾æ„å¤–æˆäºˆç”¨æˆ·çš„ç‰¹æƒã€‚<br />
æœ€åï¼ŒæŸ¥æ‰¾ <strong>æ²¡æœ‰å¯†ç </strong> æˆ– <strong>å®¹æ˜“çŒœæµ‹</strong> çš„å¯†ç çš„è´¦æˆ·ã€‚</p>
<h2 id="æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿ"><a class="header" href="#æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿ">æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿ</a></h2>
<h3 id="åœ¨æ¶æ„è½¯ä»¶è°ƒæŸ¥ä¸­åˆ†ææ–‡ä»¶ç³»ç»Ÿç»“æ„"><a class="header" href="#åœ¨æ¶æ„è½¯ä»¶è°ƒæŸ¥ä¸­åˆ†ææ–‡ä»¶ç³»ç»Ÿç»“æ„">åœ¨æ¶æ„è½¯ä»¶è°ƒæŸ¥ä¸­åˆ†ææ–‡ä»¶ç³»ç»Ÿç»“æ„</a></h3>
<p>åœ¨è°ƒæŸ¥æ¶æ„è½¯ä»¶äº‹ä»¶æ—¶ï¼Œæ–‡ä»¶ç³»ç»Ÿçš„ç»“æ„æ˜¯é‡è¦çš„ä¿¡æ¯æ¥æºï¼Œæ­ç¤ºäº‹ä»¶çš„é¡ºåºå’Œæ¶æ„è½¯ä»¶çš„å†…å®¹ã€‚ç„¶è€Œï¼Œæ¶æ„è½¯ä»¶ä½œè€…æ­£åœ¨å¼€å‘æŠ€æœ¯æ¥é˜»ç¢è¿™ç§åˆ†æï¼Œä¾‹å¦‚ä¿®æ”¹æ–‡ä»¶æ—¶é—´æˆ³æˆ–é¿å…ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œæ•°æ®å­˜å‚¨ã€‚</p>
<p>ä¸ºäº†å¯¹æŠ—è¿™äº›åå–è¯æ–¹æ³•ï¼Œè‡³å…³é‡è¦çš„æ˜¯ï¼š</p>
<ul>
<li><strong>è¿›è¡Œå½»åº•çš„æ—¶é—´çº¿åˆ†æ</strong>ï¼Œä½¿ç”¨åƒ <strong>Autopsy</strong> è¿™æ ·çš„å·¥å…·å¯è§†åŒ–äº‹ä»¶æ—¶é—´çº¿ï¼Œæˆ–ä½¿ç”¨ <strong>Sleuth Kit</strong> çš„ <code>mactime</code> è·å–è¯¦ç»†çš„æ—¶é—´çº¿æ•°æ®ã€‚</li>
<li><strong>è°ƒæŸ¥ç³»ç»Ÿ $PATH ä¸­çš„æ„å¤–è„šæœ¬</strong>ï¼Œè¿™äº›è„šæœ¬å¯èƒ½åŒ…æ‹¬æ”»å‡»è€…ä½¿ç”¨çš„ shell æˆ– PHP è„šæœ¬ã€‚</li>
<li><strong>æ£€æŸ¥ <code>/dev</code> ä¸­çš„éå…¸å‹æ–‡ä»¶</strong>ï¼Œå› ä¸ºå®ƒé€šå¸¸åŒ…å«ç‰¹æ®Šæ–‡ä»¶ï¼Œä½†å¯èƒ½å­˜æ”¾ä¸æ¶æ„è½¯ä»¶ç›¸å…³çš„æ–‡ä»¶ã€‚</li>
<li><strong>æœç´¢éšè—çš„æ–‡ä»¶æˆ–ç›®å½•</strong>ï¼Œåç§°å¯èƒ½ä¸º ".. "ï¼ˆç‚¹ç‚¹ç©ºæ ¼ï¼‰æˆ– "..^G"ï¼ˆç‚¹ç‚¹æ§åˆ¶-Gï¼‰ï¼Œè¿™äº›å¯èƒ½éšè—æ¶æ„å†…å®¹ã€‚</li>
<li><strong>è¯†åˆ« setuid root æ–‡ä»¶</strong>ï¼Œä½¿ç”¨å‘½ä»¤ï¼š<code>find / -user root -perm -04000 -print</code> è¿™å°†æ‰¾åˆ°å…·æœ‰æå‡æƒé™çš„æ–‡ä»¶ï¼Œå¯èƒ½è¢«æ”»å‡»è€…æ»¥ç”¨ã€‚</li>
<li><strong>æ£€æŸ¥ inode è¡¨ä¸­çš„åˆ é™¤æ—¶é—´æˆ³</strong>ï¼Œä»¥å‘ç°å¤§è§„æ¨¡æ–‡ä»¶åˆ é™¤ï¼Œå¯èƒ½è¡¨æ˜å­˜åœ¨ rootkit æˆ–æœ¨é©¬ã€‚</li>
<li><strong>åœ¨è¯†åˆ«åˆ°ä¸€ä¸ªæ¶æ„æ–‡ä»¶åï¼Œæ£€æŸ¥è¿ç»­çš„ inode</strong>ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½è¢«æ”¾ç½®åœ¨ä¸€èµ·ã€‚</li>
<li><strong>æ£€æŸ¥å¸¸è§çš„äºŒè¿›åˆ¶ç›®å½•</strong> (<em>/bin</em>ã€<em>/sbin</em>) ä¸­æœ€è¿‘ä¿®æ”¹çš„æ–‡ä»¶ï¼Œå› ä¸ºè¿™äº›æ–‡ä»¶å¯èƒ½è¢«æ¶æ„è½¯ä»¶æ›´æ”¹ã€‚</li>
</ul>
<pre><code class="language-bash"># List recent files in a directory:
ls -laR --sort=time /bin```

# Sort files in a directory by inode:
ls -lai /bin | sort -n```
</code></pre>
<p>{% hint style="info" %}
æ³¨æ„ï¼Œ<strong>æ”»å‡»è€…</strong>å¯ä»¥<strong>ä¿®æ”¹****æ—¶é—´</strong>ä»¥ä½¿<strong>æ–‡ä»¶çœ‹èµ·æ¥</strong>æ˜¯<strong>åˆæ³•çš„</strong>ï¼Œä½†ä»–<strong>æ— æ³•</strong>ä¿®æ”¹<strong>inode</strong>ã€‚å¦‚æœä½ å‘ç°ä¸€ä¸ª<strong>æ–‡ä»¶</strong>æ˜¾ç¤ºå®ƒçš„åˆ›å»ºå’Œä¿®æ”¹æ—¶é—´ä¸åŒä¸€æ–‡ä»¶å¤¹ä¸­å…¶ä»–æ–‡ä»¶çš„<strong>æ—¶é—´ç›¸åŒ</strong>ï¼Œä½†<strong>inode</strong>å´<strong>æ„å¤–åœ°æ›´å¤§</strong>ï¼Œé‚£ä¹ˆè¯¥<strong>æ–‡ä»¶çš„æ—¶é—´æˆ³è¢«ä¿®æ”¹äº†</strong>ã€‚
{% endhint %}</p>
<h2 id="æ¯”è¾ƒä¸åŒæ–‡ä»¶ç³»ç»Ÿç‰ˆæœ¬çš„æ–‡ä»¶"><a class="header" href="#æ¯”è¾ƒä¸åŒæ–‡ä»¶ç³»ç»Ÿç‰ˆæœ¬çš„æ–‡ä»¶">æ¯”è¾ƒä¸åŒæ–‡ä»¶ç³»ç»Ÿç‰ˆæœ¬çš„æ–‡ä»¶</a></h2>
<h3 id="æ–‡ä»¶ç³»ç»Ÿç‰ˆæœ¬æ¯”è¾ƒæ‘˜è¦"><a class="header" href="#æ–‡ä»¶ç³»ç»Ÿç‰ˆæœ¬æ¯”è¾ƒæ‘˜è¦">æ–‡ä»¶ç³»ç»Ÿç‰ˆæœ¬æ¯”è¾ƒæ‘˜è¦</a></h3>
<p>ä¸ºäº†æ¯”è¾ƒæ–‡ä»¶ç³»ç»Ÿç‰ˆæœ¬å¹¶ç¡®å®šæ›´æ”¹ï¼Œæˆ‘ä»¬ä½¿ç”¨ç®€åŒ–çš„ <code>git diff</code> å‘½ä»¤ï¼š</p>
<ul>
<li><strong>æŸ¥æ‰¾æ–°æ–‡ä»¶</strong>ï¼Œæ¯”è¾ƒä¸¤ä¸ªç›®å½•ï¼š</li>
</ul>
<pre><code class="language-bash">git diff --no-index --diff-filter=A path/to/old_version/ path/to/new_version/
</code></pre>
<ul>
<li><strong>å¯¹äºä¿®æ”¹è¿‡çš„å†…å®¹</strong>ï¼Œåˆ—å‡ºæ›´æ”¹ï¼ŒåŒæ—¶å¿½ç•¥ç‰¹å®šè¡Œï¼š</li>
</ul>
<pre><code class="language-bash">git diff --no-index --diff-filter=M path/to/old_version/ path/to/new_version/ | grep -E "^\+" | grep -v "Installed-Time"
</code></pre>
<ul>
<li><strong>æ£€æµ‹å·²åˆ é™¤æ–‡ä»¶</strong>:</li>
</ul>
<pre><code class="language-bash">git diff --no-index --diff-filter=D path/to/old_version/ path/to/new_version/
</code></pre>
<ul>
<li><strong>è¿‡æ»¤é€‰é¡¹</strong> (<code>--diff-filter</code>) æœ‰åŠ©äºç¼©å°åˆ°ç‰¹å®šçš„æ›´æ”¹ï¼Œå¦‚æ·»åŠ çš„ (<code>A</code>)ã€åˆ é™¤çš„ (<code>D</code>) æˆ–ä¿®æ”¹çš„ (<code>M</code>) æ–‡ä»¶ã€‚</li>
<li><code>A</code>: æ·»åŠ çš„æ–‡ä»¶</li>
<li><code>C</code>: å¤åˆ¶çš„æ–‡ä»¶</li>
<li><code>D</code>: åˆ é™¤çš„æ–‡ä»¶</li>
<li><code>M</code>: ä¿®æ”¹çš„æ–‡ä»¶</li>
<li><code>R</code>: é‡å‘½åçš„æ–‡ä»¶</li>
<li><code>T</code>: ç±»å‹æ›´æ”¹ï¼ˆä¾‹å¦‚ï¼Œä»æ–‡ä»¶åˆ°ç¬¦å·é“¾æ¥ï¼‰</li>
<li><code>U</code>: æœªåˆå¹¶çš„æ–‡ä»¶</li>
<li><code>X</code>: æœªçŸ¥çš„æ–‡ä»¶</li>
<li><code>B</code>: æŸåçš„æ–‡ä»¶</li>
</ul>
<h2 id="å‚è€ƒæ–‡çŒ®"><a class="header" href="#å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</a></h2>
<ul>
<li><a href="https://cdn.ttgtmedia.com/rms/security/Malware%20Forensics%20Field%20Guide%20for%20Linux%20Systems_Ch3.pdf">https://cdn.ttgtmedia.com/rms/security/Malware%20Forensics%20Field%20Guide%20for%20Linux%20Systems_Ch3.pdf</a></li>
<li><a href="https://www.plesk.com/blog/featured/linux-logs-explained/">https://www.plesk.com/blog/featured/linux-logs-explained/</a></li>
<li><a href="https://git-scm.com/docs/git-diff#Documentation/git-diff.txt---diff-filterACDMRTUXB82308203">https://git-scm.com/docs/git-diff#Documentation/git-diff.txt---diff-filterACDMRTUXB82308203</a></li>
<li><strong>ä¹¦ç±ï¼šLinuxç³»ç»Ÿæ¶æ„è½¯ä»¶å–è¯å®ç”¨æŒ‡å—ï¼šæ•°å­—å–è¯å®ç”¨æŒ‡å—</strong></li>
</ul>
<p>{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>ç”µæŠ¥ç¾¤ç»„</strong></a> æˆ– <strong>å…³æ³¨</strong> æˆ‘ä»¬çš„ <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> github ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}
<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>
<p><br />
ä½¿ç”¨ <a href="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=text&amp;utm_campaign=ppc&amp;utm_content=linux-forensics"><strong>Trickest</strong></a> è½»æ¾æ„å»ºå’Œ <strong>è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹</strong>ï¼Œç”±ä¸–ç•Œä¸Š <strong>æœ€å…ˆè¿›</strong> çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚<br />
ä»Šå¤©å°±è·å–è®¿é—®æƒé™ï¼š</p>
<p>{% embed url="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=banner&amp;utm_campaign=ppc&amp;utm_content=linux-forensics" %}</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../generic-methodologies-and-resources/basic-forensic-methodology/image-acquisition-and-mount.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../generic-methodologies-and-resources/basic-forensic-methodology/malware-analysis.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../generic-methodologies-and-resources/basic-forensic-methodology/image-acquisition-and-mount.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../generic-methodologies-and-resources/basic-forensic-methodology/malware-analysis.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
