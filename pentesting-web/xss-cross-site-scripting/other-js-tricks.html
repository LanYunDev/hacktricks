<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Misc JS Tricks &amp; Relevant Info</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="misc-js-tricks--relevant-info"><a class="header" href="#misc-js-tricks--relevant-info">Misc JS Tricks &amp; Relevant Info</a></h1>
<p>{% hint style="success" %}
学习和实践 AWS 黑客技术：<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习和实践 GCP 黑客技术：<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>Telegram 群组</strong></a> 或 <strong>关注</strong> 我们的 <strong>Twitter</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub 仓库提交 PR 分享黑客技巧。</li>
</ul>
</details>
{% endhint %}
<h2 id="javascript-fuzzing"><a class="header" href="#javascript-fuzzing">Javascript Fuzzing</a></h2>
<h3 id="valid-js-comment-chars"><a class="header" href="#valid-js-comment-chars">Valid JS Comment Chars</a></h3>
<pre><code class="language-javascript">//This is a 1 line comment
/* This is a multiline comment*/
#!This is a 1 line comment, but "#!" must to be at the beggining of the line
--&gt;This is a 1 line comment, but "--&gt;" must to be at the beggining of the line


for (let j = 0; j &lt; 128; j++) {
for (let k = 0; k &lt; 128; k++) {
for (let l = 0; l &lt; 128; l++) {
if (j == 34 || k ==34 || l ==34)
continue;
if (j == 0x0a || k ==0x0a || l ==0x0a)
continue;
if (j == 0x0d || k ==0x0d || l ==0x0d)
continue;
if (j == 0x3c || k ==0x3c || l ==0x3c)
continue;
if (
(j == 47 &amp;&amp; k == 47)
||(k == 47 &amp;&amp; l == 47)
)
continue;
try {
var cmd = String.fromCharCode(j) + String.fromCharCode(k) + String.fromCharCode(l) + 'a.orange.ctf"';
eval(cmd);
} catch(e) {
var err = e.toString().split('\n')[0].split(':')[0];
if (err === 'SyntaxError' || err === "ReferenceError")
continue
err = e.toString().split('\n')[0]
}
console.log(err,cmd);
}
}
}
//From: https://balsn.tw/ctf_writeup/20191012-hitconctfquals/#bounty-pl33z

// From: Heyes, Gareth. JavaScript for hackers: Learn to think like a hacker (p. 43). Kindle Edition.
log=[];
for(let i=0;i&lt;=0xff;i++){
for(let j=0;j&lt;=0xfff;j++){
try {
eval(`${String.fromCodePoint(i,j)}%$£234$`)
log.push([i,j])
}catch(e){}
}
}
console.log(log)//[35,33],[47,47]
</code></pre>
<h3 id="有效的-js-新行字符"><a class="header" href="#有效的-js-新行字符">有效的 JS 新行字符</a></h3>
<pre><code class="language-javascript">//Javascript interpret as new line these chars:
String.fromCharCode(10) //0x0a
String.fromCharCode(13) //0x0d
String.fromCharCode(8232) //0xe2 0x80 0xa8
String.fromCharCode(8233) //0xe2 0x80 0xa8

for (let j = 0; j &lt; 65536; j++) {
try {
var cmd = '"aaaaa";'+String.fromCharCode(j) + '--&gt;a.orange.ctf"';
eval(cmd);
} catch(e) {
var err = e.toString().split('\n')[0].split(':')[0];
if (err === 'SyntaxError' || err === "ReferenceError")
continue;
err = e.toString().split('\n')[0]
}
console.log(`[${err}]`,j,cmd);
}
//From: https://balsn.tw/ctf_writeup/20191012-hitconctfquals/#bounty-pl33z
</code></pre>
<h3 id="有效的-js-空格在函数调用中"><a class="header" href="#有效的-js-空格在函数调用中">有效的 JS 空格在函数调用中</a></h3>
<pre><code class="language-javascript">// Heyes, Gareth. JavaScript for hackers: Learn to think like a hacker (pp. 40-41). Kindle Edition.

// Check chars that can be put in between in func name and the ()
function x(){}

log=[];
for(let i=0;i&lt;=0x10ffff;i++){
try {
eval(`x${String.fromCodePoint(i)}()`)
log.push(i)
}catch(e){}
}

console.log(log)v//9,10,11,12,13,32,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,813 232,8233,8239,8287,12288,65279
</code></pre>
<h3 id="生成字符串的有效字符"><a class="header" href="#生成字符串的有效字符"><strong>生成字符串的有效字符</strong></a></h3>
<pre><code class="language-javascript">// Heyes, Gareth. JavaScript for hackers: Learn to think like a hacker (pp. 41-42). Kindle Edition.

// Check which pairs of chars can make something be a valid string
log=[];
for(let i=0;i&lt;=0x10ffff;i++){
try {
eval(`${String.fromCodePoint(i)}%$£234${String.fromCodePoint(i)}`)
log.push(i)
}catch(e){}
}
console.log(log) //34,39,47,96
//single quote, quotes, backticks &amp; // (regex)
</code></pre>
<h3 id="surrogate-pairs-bf"><a class="header" href="#surrogate-pairs-bf"><strong>Surrogate Pairs BF</strong></a></h3>
<p>此技术对于XSS并不是很有用，但它可能有助于绕过WAF保护。此python代码接收2个字节作为输入，并搜索一个代理对，其中第一个字节是高代理对的最后一个字节，最后一个字节是低代理对的最后一个字节。</p>
<pre><code class="language-python">def unicode(findHex):
for i in range(0,0xFFFFF):
H = hex(int(((i - 0x10000) / 0x400) + 0xD800))
h = chr(int(H[-2:],16))
L = hex(int(((i - 0x10000) % 0x400 + 0xDC00)))
l = chr(int(L[-2:],16))
if(h == findHex[0]) and (l == findHex[1]):
print(H.replace("0x","\\u")+L.replace("0x","\\u"))
</code></pre>
<h3 id="javascript-协议模糊测试"><a class="header" href="#javascript-协议模糊测试"><code>javascript{}:</code> 协议模糊测试</a></h3>
<pre><code class="language-javascript">// Heyes, Gareth. JavaScript for hackers: Learn to think like a hacker (p. 34). Kindle Edition.
log=[];
let anchor = document.createElement('a');
for(let i=0;i&lt;=0x10ffff;i++){
anchor.href = `javascript${String.fromCodePoint(i)}:`;
if(anchor.protocol === 'javascript:') {
log.push(i);
}
}
console.log(log)//9,10,13,58
// Note that you could BF also other possitions of the use of multiple chars

// Test one option
let anchor = document.createElement('a');
anchor.href = `javascript${String.fromCodePoint(58)}:alert(1337)`;
anchor.append('Click me')
document.body.append(anchor)

// Another way to test
&lt;a href="&amp;#12;javascript:alert(1337)"&gt;Test&lt;/a&gt;
</code></pre>
<h3 id="url-模糊测试"><a class="header" href="#url-模糊测试">URL 模糊测试</a></h3>
<pre><code class="language-javascript">// Heyes, Gareth. JavaScript for hackers: Learn to think like a hacker (pp. 36-37). Kindle Edition.

// Before the protocol
a=document.createElement('a');
log=[];
for(let i=0;i&lt;=0x10ffff;i++){
a.href = `${String.fromCodePoint(i)}https://hacktricks.xyz`;
if(a.hostname === 'hacktricks.xyz'){
log.push(i);
}
}
console.log(log) //0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32

// Between the slashes
a=document.createElement('a');
log=[];
for(let i=0;i&lt;=0x10ffff;i++){
a.href = `/${String.fromCodePoint(i)}/hacktricks.xyz`;
if(a.hostname === 'hacktricks.xyz'){
log.push(i);
}
}
console.log(log) //9,10,13,47,92
</code></pre>
<h3 id="html-模糊测试"><a class="header" href="#html-模糊测试">HTML 模糊测试</a></h3>
<pre><code class="language-javascript">// Heyes, Gareth. JavaScript for hackers: Learn to think like a hacker (p. 38). Kindle Edition.

// Fuzzing chars that can close an HTML comment

let log=[];
let div = document.createElement('div');
for(let i=0;i&lt;=0x10ffff;i++){
div.innerHTML=`&lt;!----${String.fromCodePoint(i)}&gt;&lt;span&gt;&lt;/span&gt;--&gt;`;
if(div.querySelector('span')){
log.push(i);
}
}
console.log(log)//33,45,62
</code></pre>
<h2 id="分析属性"><a class="header" href="#分析属性"><strong>分析属性</strong></a></h2>
<p>工具 <strong>Hackability inspector</strong> 来自 Portswigger，帮助 <strong>分析</strong> javascript 对象的 <strong>属性</strong>。查看: <a href="https://portswigger-labs.net/hackability/inspector/?input=x.contentWindow&amp;html=%3Ciframe%20src=//subdomain1.portswigger-labs.net%20id=x%3E">https://portswigger-labs.net/hackability/inspector/?input=x.contentWindow&amp;html=%3Ciframe%20src=//subdomain1.portswigger-labs.net%20id=x%3E</a></p>
<h2 id="map-js-文件"><a class="header" href="#map-js-文件"><strong>.map js 文件</strong></a></h2>
<ul>
<li>下载 .map js 文件的技巧: <a href="https://medium.com/@bitthebyte/javascript-for-bug-bounty-hunters-part-2-f82164917e7">https://medium.com/@bitthebyte/javascript-for-bug-bounty-hunters-part-2-f82164917e7</a></li>
<li>你可以使用这个工具来分析这些文件 <a href="https://github.com/paazmaya/shuji">https://github.com/paazmaya/shuji</a></li>
</ul>
<h2 id="---赋值"><a class="header" href="#---赋值">"--" 赋值</a></h2>
<p>递减运算符 <code>--</code> 也是一种赋值。这个运算符取一个值，然后将其减去一。如果该值不是数字，它将被设置为 <code>NaN</code>。这可以用来 <strong>从环境中移除变量的内容</strong>。</p>
<p><img src="../../.gitbook/assets/image%20(993).png" alt="" /></p>
<p><img src="../../.gitbook/assets/image%20(329).png" alt="" /></p>
<h2 id="函数技巧"><a class="header" href="#函数技巧">函数技巧</a></h2>
<h3 id="call-和-apply"><a class="header" href="#call-和-apply">.call 和 .apply</a></h3>
<p>函数的 <strong><code>.call</code></strong> 方法用于 <strong>运行函数</strong>。<br />
它默认期望的 <strong>第一个参数</strong> 是 <strong><code>this</code> 的值</strong>，如果 <strong>没有</strong> 提供，<strong><code>window</code></strong> 将是该值（除非使用 <strong><code>严格模式</code></strong>）。</p>
<pre><code class="language-javascript">function test_call(){
console.log(this.value); //baz
}
new_this={value:"hey!"}
test_call.call(new_this);

// To pass more arguments, just pass then inside .call()
function test_call() {
console.log(arguments[0]); //"arg1"
console.log(arguments[1]); //"arg2"
console.log(this); //[object Window]
}
test_call.call(null, "arg1", "arg2")

// If you use the "use strict" directive "this" will be null instead of window:
function test_call() {
"use strict";
console.log(this); //null
}
test_call.call(null)

//The apply function is pretty much exactly the same as the call function with one important difference, you can supply an array of arguments in the second argument:
function test_apply() {
console.log(arguments[0]); //"arg1"
console.log(arguments[1]); //"arg2"
console.log(this); //[object Window]
}
test_apply.apply(null, ["arg1", "arg2"])
</code></pre>
<h3 id="arrow-functions"><a class="header" href="#arrow-functions">Arrow functions</a></h3>
<p>箭头函数允许您更轻松地在一行中生成函数（如果您理解它们）</p>
<pre><code class="language-javascript">// Traditional
function (a){ return a + 1; }
// Arrow forms
a =&gt; a + 100;
a =&gt; {a + 100};

// Traditional
function (a, b){ return a + b + 1; }
// Arrow
(a, b) =&gt; a + b + 100;

// Tradictional no args
let a = 4;
let b = 2;
function (){ return a + b + 1; }

// Arrow
let a = 4;
let b = 2;
() =&gt; a + b + 1;
</code></pre>
<p>所以，之前的大多数函数实际上是无用的，因为我们没有将它们保存到任何地方以便保存和调用它们。示例创建 <code>plusone</code> 函数：</p>
<pre><code class="language-javascript">// Traductional
function plusone (a){ return a + 1; }

//Arrow
plusone = a =&gt; a + 100;
</code></pre>
<h3 id="bind-function"><a class="header" href="#bind-function">Bind function</a></h3>
<p>bind 函数允许创建一个 <strong>副本</strong> 的 <strong>函数，修改</strong> <strong><code>this</code></strong> 对象和给定的 <strong>参数</strong>。</p>
<pre><code class="language-javascript">//This will use the this object and print "Hello World"
var fn = function ( param1, param2 ) {
console.info( this, param1, param2 );
}
fn('Hello', 'World')

//This will still use the this object and print "Hello World"
var copyFn = fn.bind();
copyFn('Hello', 'World')

//This will use the "console" object as "this" object inside the function and print "fixingparam1 Hello"
var bindFn_change = fn.bind(console, "fixingparam1");
bindFn_change('Hello', 'World')

//This will still use the this object and print "fixingparam1 Hello"
var bindFn_thisnull = fn.bind(null, "fixingparam1");
bindFn_change('Hello', 'World')

//This will still use the this object and print "fixingparam1 Hello"
var bindFn_this = fn.bind(this, "fixingparam1");
bindFn_change('Hello', 'World')
</code></pre>
<p>{% hint style="info" %}
注意使用 <strong><code>bind</code></strong> 可以操纵在调用函数时将要使用的 <strong><code>this</code></strong> 对象。
{% endhint %}</p>
<h3 id="函数代码泄露"><a class="header" href="#函数代码泄露">函数代码泄露</a></h3>
<p>如果你可以 <strong>访问一个函数的对象</strong>，你可以 <strong>获取该函数的代码</strong>。</p>
<pre><code class="language-javascript">function afunc(){
return 1+1;
}
console.log(afunc.toString()); //This will print the code of the function
console.log(String(afunc)); //This will print the code of the function
console.log(this.afunc.toString()); //This will print the code of the function
console.log(global.afunc.toString()); //This will print the code of the function
</code></pre>
<p>在<strong>函数没有任何名称</strong>的情况下，您仍然可以从内部打印<strong>函数代码</strong>：</p>
<pre><code class="language-javascript">(function (){ return arguments.callee.toString(); })()
(function (){ return arguments[0]; })("arg0")
</code></pre>
<p>一些<strong>随机</strong>方法来<strong>提取代码</strong>从另一个函数（甚至注释）:</p>
<pre><code class="language-javascript">(function (){ return retFunc =&gt; String(arguments[0]) })(a=&gt;{/* Hidden commment */})()
(function (){ return retFunc =&gt; Array(arguments[0].toString()) })(a=&gt;{/* Hidden commment */})()
(function (){ return String(this)}).bind(()=&gt;{ /* Hidden commment */ })()
(u=&gt;(String(u)))(_=&gt;{ /* Hidden commment */ })
(u=&gt;_=&gt;(String(u)))(_=&gt;{ /* Hidden commment */ })()
</code></pre>
<h2 id="沙箱逃逸---恢复窗口对象"><a class="header" href="#沙箱逃逸---恢复窗口对象">沙箱逃逸 - 恢复窗口对象</a></h2>
<p>Window 对象允许访问全局定义的函数，如 alert 或 eval。</p>
<p>{% code overflow="wrap" %}</p>
<pre><code class="language-javascript">// Some ways to access window
window.eval("alert(1)")
frames
globalThis
parent
self
top //If inside a frame, this is top most window

// Access window from document
document.defaultView.alert(1)
// Access document from a node object
node = document.createElement('div')
node.ownerDocument.defaultView.alert(1)

// There is a path property on each error event whose last element is the window
&lt;img src onerror=event.path.pop().alert(1337)&gt;
// In other browsers the method is
&lt;img src onerror=event.composedPath().pop().alert(1337)&gt;
// In case of svg, the "event" object is called "evt"
&lt;svg&gt;&lt;image href=1 onerror=evt.composedPath().pop().alert(1337)&gt;

// Abusing Error.prepareStackTrace to get Window back
Error.prepareStackTrace=function(error, callSites){
2   callSites.shift().getThis().alert(1337);
3 };
4 new Error().stack

// From an HTML event
// Events from HTML are executed in this context
with(document) {
with(element) {
//executed event
}
}
// Because of that with(document) it's possible to access properties of document like:
&lt;img src onerror=defaultView.alert(1337)&gt;
&lt;img src onerror=s=createElement('script');s.append('alert(1337)');appendChild(s)&gt;
</code></pre>
<p>{% endcode %}</p>
<h2 id="访问值时的断点"><a class="header" href="#访问值时的断点">访问值时的断点</a></h2>
<pre><code class="language-javascript">// Stop when a property in sessionStorage or localStorage is set/get
// via getItem or setItem functions
sessionStorage.getItem = localStorage.getItem  = function(prop) {
debugger;
return sessionStorage[prop];
}

localStorage.setItem = function(prop, val) {
debugger;
localStorage[prop] = val;
}
</code></pre>
<pre><code class="language-javascript">// Stop when anyone sets or gets the property "ppmap" in any object
// For example sessionStorage.ppmap
// "123".ppmap
// Useful to find where weird properties are being set or accessed
// or to find where prototype pollutions are occurring

function debugAccess(obj, prop, debugGet=true){

var origValue = obj[prop];

Object.defineProperty(obj, prop, {
get: function () {
if ( debugGet )
debugger;
return origValue;
},
set: function(val) {
debugger;
origValue = val;
}
});
};

debugAccess(Object.prototype, 'ppmap')
</code></pre>
<h2 id="自动浏览器访问以测试有效载荷"><a class="header" href="#自动浏览器访问以测试有效载荷">自动浏览器访问以测试有效载荷</a></h2>
<pre><code class="language-javascript">//Taken from https://github.com/svennergr/writeups/blob/master/inti/0621/README.md
const puppeteer = require("puppeteer");

const realPasswordLength = 3000;
async function sleep(ms) {
return new Promise((resolve) =&gt; setTimeout(resolve, ms));
}

(async () =&gt; {
const browser = await puppeteer.launch();
const page = await browser.newPage();
//Loop to iterate through different values
for (let i = 0; i &lt; 10000; i += 100) {
console.log(`Run number ${i}`);
const input = `${"0".repeat(i)}${realPasswordLength}`;
console.log(`  https://challenge-0621.intigriti.io/passgen.php?passwordLength=${input}&amp;allowNumbers=true&amp;allowSymbols=true&amp;timestamp=1624556811000`);
//Go to the page
await page.goto(
`https://challenge-0621.intigriti.io/passgen.php?passwordLength=${input}&amp;allowNumbers=true&amp;allowSymbols=true&amp;timestamp=1624556811000`
);
//Call function "generate()" inside the page
await page.evaluate("generate()");
//Get node inner text from an HTML element
const passwordContent = await page.$$eval(
".alert .page-content",
(node) =&gt; node[0].innerText
);
//Transform the content and print it in console
const plainPassword = passwordContent.replace("Your password is: ", "");
if (plainPassword.length != realPasswordLength) {
console.log(i, plainPassword.length, plainPassword);
}

await sleep(1000);
}
await browser.close();
})();
</code></pre>
<p>{% hint style="success" %}
学习与实践 AWS 黑客技术：<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习与实践 GCP 黑客技术：<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>Telegram 群组</strong></a> 或 <strong>关注</strong> 我们的 <strong>Twitter</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub 仓库提交 PR 来分享黑客技巧。</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../pentesting-web/xss-cross-site-scripting/js-hoisting.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../pentesting-web/xss-cross-site-scripting/pdf-injection.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../pentesting-web/xss-cross-site-scripting/js-hoisting.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../pentesting-web/xss-cross-site-scripting/pdf-injection.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
