<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Misc JS Tricks &amp; Relevant Info</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="misc-js-tricks--relevant-info"><a class="header" href="#misc-js-tricks--relevant-info">Misc JS Tricks &amp; Relevant Info</a></h1>
<p>{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>Telegram ç¾¤ç»„</strong></a> æˆ– <strong>å…³æ³¨</strong> æˆ‘ä»¬çš„ <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}
<h2 id="javascript-fuzzing"><a class="header" href="#javascript-fuzzing">Javascript Fuzzing</a></h2>
<h3 id="valid-js-comment-chars"><a class="header" href="#valid-js-comment-chars">Valid JS Comment Chars</a></h3>
<pre><code class="language-javascript">//This is a 1 line comment
/* This is a multiline comment*/
#!This is a 1 line comment, but "#!" must to be at the beggining of the line
--&gt;This is a 1 line comment, but "--&gt;" must to be at the beggining of the line


for (let j = 0; j &lt; 128; j++) {
for (let k = 0; k &lt; 128; k++) {
for (let l = 0; l &lt; 128; l++) {
if (j == 34 || k ==34 || l ==34)
continue;
if (j == 0x0a || k ==0x0a || l ==0x0a)
continue;
if (j == 0x0d || k ==0x0d || l ==0x0d)
continue;
if (j == 0x3c || k ==0x3c || l ==0x3c)
continue;
if (
(j == 47 &amp;&amp; k == 47)
||(k == 47 &amp;&amp; l == 47)
)
continue;
try {
var cmd = String.fromCharCode(j) + String.fromCharCode(k) + String.fromCharCode(l) + 'a.orange.ctf"';
eval(cmd);
} catch(e) {
var err = e.toString().split('\n')[0].split(':')[0];
if (err === 'SyntaxError' || err === "ReferenceError")
continue
err = e.toString().split('\n')[0]
}
console.log(err,cmd);
}
}
}
//From: https://balsn.tw/ctf_writeup/20191012-hitconctfquals/#bounty-pl33z

// From: Heyes, Gareth. JavaScript for hackers: Learn to think like a hacker (p. 43). Kindle Edition.
log=[];
for(let i=0;i&lt;=0xff;i++){
for(let j=0;j&lt;=0xfff;j++){
try {
eval(`${String.fromCodePoint(i,j)}%$Â£234$`)
log.push([i,j])
}catch(e){}
}
}
console.log(log)//[35,33],[47,47]
</code></pre>
<h3 id="æœ‰æ•ˆçš„-js-æ–°è¡Œå­—ç¬¦"><a class="header" href="#æœ‰æ•ˆçš„-js-æ–°è¡Œå­—ç¬¦">æœ‰æ•ˆçš„ JS æ–°è¡Œå­—ç¬¦</a></h3>
<pre><code class="language-javascript">//Javascript interpret as new line these chars:
String.fromCharCode(10) //0x0a
String.fromCharCode(13) //0x0d
String.fromCharCode(8232) //0xe2 0x80 0xa8
String.fromCharCode(8233) //0xe2 0x80 0xa8

for (let j = 0; j &lt; 65536; j++) {
try {
var cmd = '"aaaaa";'+String.fromCharCode(j) + '--&gt;a.orange.ctf"';
eval(cmd);
} catch(e) {
var err = e.toString().split('\n')[0].split(':')[0];
if (err === 'SyntaxError' || err === "ReferenceError")
continue;
err = e.toString().split('\n')[0]
}
console.log(`[${err}]`,j,cmd);
}
//From: https://balsn.tw/ctf_writeup/20191012-hitconctfquals/#bounty-pl33z
</code></pre>
<h3 id="æœ‰æ•ˆçš„-js-ç©ºæ ¼åœ¨å‡½æ•°è°ƒç”¨ä¸­"><a class="header" href="#æœ‰æ•ˆçš„-js-ç©ºæ ¼åœ¨å‡½æ•°è°ƒç”¨ä¸­">æœ‰æ•ˆçš„ JS ç©ºæ ¼åœ¨å‡½æ•°è°ƒç”¨ä¸­</a></h3>
<pre><code class="language-javascript">// Heyes, Gareth. JavaScript for hackers: Learn to think like a hacker (pp. 40-41). Kindle Edition.

// Check chars that can be put in between in func name and the ()
function x(){}

log=[];
for(let i=0;i&lt;=0x10ffff;i++){
try {
eval(`x${String.fromCodePoint(i)}()`)
log.push(i)
}catch(e){}
}

console.log(log)v//9,10,11,12,13,32,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,813 232,8233,8239,8287,12288,65279
</code></pre>
<h3 id="ç”Ÿæˆå­—ç¬¦ä¸²çš„æœ‰æ•ˆå­—ç¬¦"><a class="header" href="#ç”Ÿæˆå­—ç¬¦ä¸²çš„æœ‰æ•ˆå­—ç¬¦"><strong>ç”Ÿæˆå­—ç¬¦ä¸²çš„æœ‰æ•ˆå­—ç¬¦</strong></a></h3>
<pre><code class="language-javascript">// Heyes, Gareth. JavaScript for hackers: Learn to think like a hacker (pp. 41-42). Kindle Edition.

// Check which pairs of chars can make something be a valid string
log=[];
for(let i=0;i&lt;=0x10ffff;i++){
try {
eval(`${String.fromCodePoint(i)}%$Â£234${String.fromCodePoint(i)}`)
log.push(i)
}catch(e){}
}
console.log(log) //34,39,47,96
//single quote, quotes, backticks &amp; // (regex)
</code></pre>
<h3 id="surrogate-pairs-bf"><a class="header" href="#surrogate-pairs-bf"><strong>Surrogate Pairs BF</strong></a></h3>
<p>æ­¤æŠ€æœ¯å¯¹äºXSSå¹¶ä¸æ˜¯å¾ˆæœ‰ç”¨ï¼Œä½†å®ƒå¯èƒ½æœ‰åŠ©äºç»•è¿‡WAFä¿æŠ¤ã€‚æ­¤pythonä»£ç æ¥æ”¶2ä¸ªå­—èŠ‚ä½œä¸ºè¾“å…¥ï¼Œå¹¶æœç´¢ä¸€ä¸ªä»£ç†å¯¹ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯é«˜ä»£ç†å¯¹çš„æœ€åä¸€ä¸ªå­—èŠ‚ï¼Œæœ€åä¸€ä¸ªå­—èŠ‚æ˜¯ä½ä»£ç†å¯¹çš„æœ€åä¸€ä¸ªå­—èŠ‚ã€‚</p>
<pre><code class="language-python">def unicode(findHex):
for i in range(0,0xFFFFF):
H = hex(int(((i - 0x10000) / 0x400) + 0xD800))
h = chr(int(H[-2:],16))
L = hex(int(((i - 0x10000) % 0x400 + 0xDC00)))
l = chr(int(L[-2:],16))
if(h == findHex[0]) and (l == findHex[1]):
print(H.replace("0x","\\u")+L.replace("0x","\\u"))
</code></pre>
<h3 id="javascript-åè®®æ¨¡ç³Šæµ‹è¯•"><a class="header" href="#javascript-åè®®æ¨¡ç³Šæµ‹è¯•"><code>javascript{}:</code> åè®®æ¨¡ç³Šæµ‹è¯•</a></h3>
<pre><code class="language-javascript">// Heyes, Gareth. JavaScript for hackers: Learn to think like a hacker (p. 34). Kindle Edition.
log=[];
let anchor = document.createElement('a');
for(let i=0;i&lt;=0x10ffff;i++){
anchor.href = `javascript${String.fromCodePoint(i)}:`;
if(anchor.protocol === 'javascript:') {
log.push(i);
}
}
console.log(log)//9,10,13,58
// Note that you could BF also other possitions of the use of multiple chars

// Test one option
let anchor = document.createElement('a');
anchor.href = `javascript${String.fromCodePoint(58)}:alert(1337)`;
anchor.append('Click me')
document.body.append(anchor)

// Another way to test
&lt;a href="&amp;#12;javascript:alert(1337)"&gt;Test&lt;/a&gt;
</code></pre>
<h3 id="url-æ¨¡ç³Šæµ‹è¯•"><a class="header" href="#url-æ¨¡ç³Šæµ‹è¯•">URL æ¨¡ç³Šæµ‹è¯•</a></h3>
<pre><code class="language-javascript">// Heyes, Gareth. JavaScript for hackers: Learn to think like a hacker (pp. 36-37). Kindle Edition.

// Before the protocol
a=document.createElement('a');
log=[];
for(let i=0;i&lt;=0x10ffff;i++){
a.href = `${String.fromCodePoint(i)}https://hacktricks.xyz`;
if(a.hostname === 'hacktricks.xyz'){
log.push(i);
}
}
console.log(log) //0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32

// Between the slashes
a=document.createElement('a');
log=[];
for(let i=0;i&lt;=0x10ffff;i++){
a.href = `/${String.fromCodePoint(i)}/hacktricks.xyz`;
if(a.hostname === 'hacktricks.xyz'){
log.push(i);
}
}
console.log(log) //9,10,13,47,92
</code></pre>
<h3 id="html-æ¨¡ç³Šæµ‹è¯•"><a class="header" href="#html-æ¨¡ç³Šæµ‹è¯•">HTML æ¨¡ç³Šæµ‹è¯•</a></h3>
<pre><code class="language-javascript">// Heyes, Gareth. JavaScript for hackers: Learn to think like a hacker (p. 38). Kindle Edition.

// Fuzzing chars that can close an HTML comment

let log=[];
let div = document.createElement('div');
for(let i=0;i&lt;=0x10ffff;i++){
div.innerHTML=`&lt;!----${String.fromCodePoint(i)}&gt;&lt;span&gt;&lt;/span&gt;--&gt;`;
if(div.querySelector('span')){
log.push(i);
}
}
console.log(log)//33,45,62
</code></pre>
<h2 id="åˆ†æå±æ€§"><a class="header" href="#åˆ†æå±æ€§"><strong>åˆ†æå±æ€§</strong></a></h2>
<p>å·¥å…· <strong>Hackability inspector</strong> æ¥è‡ª Portswiggerï¼Œå¸®åŠ© <strong>åˆ†æ</strong> javascript å¯¹è±¡çš„ <strong>å±æ€§</strong>ã€‚æŸ¥çœ‹: <a href="https://portswigger-labs.net/hackability/inspector/?input=x.contentWindow&amp;html=%3Ciframe%20src=//subdomain1.portswigger-labs.net%20id=x%3E">https://portswigger-labs.net/hackability/inspector/?input=x.contentWindow&amp;html=%3Ciframe%20src=//subdomain1.portswigger-labs.net%20id=x%3E</a></p>
<h2 id="map-js-æ–‡ä»¶"><a class="header" href="#map-js-æ–‡ä»¶"><strong>.map js æ–‡ä»¶</strong></a></h2>
<ul>
<li>ä¸‹è½½ .map js æ–‡ä»¶çš„æŠ€å·§: <a href="https://medium.com/@bitthebyte/javascript-for-bug-bounty-hunters-part-2-f82164917e7">https://medium.com/@bitthebyte/javascript-for-bug-bounty-hunters-part-2-f82164917e7</a></li>
<li>ä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªå·¥å…·æ¥åˆ†æè¿™äº›æ–‡ä»¶ <a href="https://github.com/paazmaya/shuji">https://github.com/paazmaya/shuji</a></li>
</ul>
<h2 id="---èµ‹å€¼"><a class="header" href="#---èµ‹å€¼">"--" èµ‹å€¼</a></h2>
<p>é€’å‡è¿ç®—ç¬¦ <code>--</code> ä¹Ÿæ˜¯ä¸€ç§èµ‹å€¼ã€‚è¿™ä¸ªè¿ç®—ç¬¦å–ä¸€ä¸ªå€¼ï¼Œç„¶åå°†å…¶å‡å»ä¸€ã€‚å¦‚æœè¯¥å€¼ä¸æ˜¯æ•°å­—ï¼Œå®ƒå°†è¢«è®¾ç½®ä¸º <code>NaN</code>ã€‚è¿™å¯ä»¥ç”¨æ¥ <strong>ä»ç¯å¢ƒä¸­ç§»é™¤å˜é‡çš„å†…å®¹</strong>ã€‚</p>
<p><img src="../../.gitbook/assets/image%20(993).png" alt="" /></p>
<p><img src="../../.gitbook/assets/image%20(329).png" alt="" /></p>
<h2 id="å‡½æ•°æŠ€å·§"><a class="header" href="#å‡½æ•°æŠ€å·§">å‡½æ•°æŠ€å·§</a></h2>
<h3 id="call-å’Œ-apply"><a class="header" href="#call-å’Œ-apply">.call å’Œ .apply</a></h3>
<p>å‡½æ•°çš„ <strong><code>.call</code></strong> æ–¹æ³•ç”¨äº <strong>è¿è¡Œå‡½æ•°</strong>ã€‚<br />
å®ƒé»˜è®¤æœŸæœ›çš„ <strong>ç¬¬ä¸€ä¸ªå‚æ•°</strong> æ˜¯ <strong><code>this</code> çš„å€¼</strong>ï¼Œå¦‚æœ <strong>æ²¡æœ‰</strong> æä¾›ï¼Œ<strong><code>window</code></strong> å°†æ˜¯è¯¥å€¼ï¼ˆé™¤éä½¿ç”¨ <strong><code>ä¸¥æ ¼æ¨¡å¼</code></strong>ï¼‰ã€‚</p>
<pre><code class="language-javascript">function test_call(){
console.log(this.value); //baz
}
new_this={value:"hey!"}
test_call.call(new_this);

// To pass more arguments, just pass then inside .call()
function test_call() {
console.log(arguments[0]); //"arg1"
console.log(arguments[1]); //"arg2"
console.log(this); //[object Window]
}
test_call.call(null, "arg1", "arg2")

// If you use the "use strict" directive "this" will be null instead of window:
function test_call() {
"use strict";
console.log(this); //null
}
test_call.call(null)

//The apply function is pretty much exactly the same as the call function with one important difference, you can supply an array of arguments in the second argument:
function test_apply() {
console.log(arguments[0]); //"arg1"
console.log(arguments[1]); //"arg2"
console.log(this); //[object Window]
}
test_apply.apply(null, ["arg1", "arg2"])
</code></pre>
<h3 id="arrow-functions"><a class="header" href="#arrow-functions">Arrow functions</a></h3>
<p>ç®­å¤´å‡½æ•°å…è®¸æ‚¨æ›´è½»æ¾åœ°åœ¨ä¸€è¡Œä¸­ç”Ÿæˆå‡½æ•°ï¼ˆå¦‚æœæ‚¨ç†è§£å®ƒä»¬ï¼‰</p>
<pre><code class="language-javascript">// Traditional
function (a){ return a + 1; }
// Arrow forms
a =&gt; a + 100;
a =&gt; {a + 100};

// Traditional
function (a, b){ return a + b + 1; }
// Arrow
(a, b) =&gt; a + b + 100;

// Tradictional no args
let a = 4;
let b = 2;
function (){ return a + b + 1; }

// Arrow
let a = 4;
let b = 2;
() =&gt; a + b + 1;
</code></pre>
<p>æ‰€ä»¥ï¼Œä¹‹å‰çš„å¤§å¤šæ•°å‡½æ•°å®é™…ä¸Šæ˜¯æ— ç”¨çš„ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰å°†å®ƒä»¬ä¿å­˜åˆ°ä»»ä½•åœ°æ–¹ä»¥ä¾¿ä¿å­˜å’Œè°ƒç”¨å®ƒä»¬ã€‚ç¤ºä¾‹åˆ›å»º <code>plusone</code> å‡½æ•°ï¼š</p>
<pre><code class="language-javascript">// Traductional
function plusone (a){ return a + 1; }

//Arrow
plusone = a =&gt; a + 100;
</code></pre>
<h3 id="bind-function"><a class="header" href="#bind-function">Bind function</a></h3>
<p>bind å‡½æ•°å…è®¸åˆ›å»ºä¸€ä¸ª <strong>å‰¯æœ¬</strong> çš„ <strong>å‡½æ•°ï¼Œä¿®æ”¹</strong> <strong><code>this</code></strong> å¯¹è±¡å’Œç»™å®šçš„ <strong>å‚æ•°</strong>ã€‚</p>
<pre><code class="language-javascript">//This will use the this object and print "Hello World"
var fn = function ( param1, param2 ) {
console.info( this, param1, param2 );
}
fn('Hello', 'World')

//This will still use the this object and print "Hello World"
var copyFn = fn.bind();
copyFn('Hello', 'World')

//This will use the "console" object as "this" object inside the function and print "fixingparam1 Hello"
var bindFn_change = fn.bind(console, "fixingparam1");
bindFn_change('Hello', 'World')

//This will still use the this object and print "fixingparam1 Hello"
var bindFn_thisnull = fn.bind(null, "fixingparam1");
bindFn_change('Hello', 'World')

//This will still use the this object and print "fixingparam1 Hello"
var bindFn_this = fn.bind(this, "fixingparam1");
bindFn_change('Hello', 'World')
</code></pre>
<p>{% hint style="info" %}
æ³¨æ„ä½¿ç”¨ <strong><code>bind</code></strong> å¯ä»¥æ“çºµåœ¨è°ƒç”¨å‡½æ•°æ—¶å°†è¦ä½¿ç”¨çš„ <strong><code>this</code></strong> å¯¹è±¡ã€‚
{% endhint %}</p>
<h3 id="å‡½æ•°ä»£ç æ³„éœ²"><a class="header" href="#å‡½æ•°ä»£ç æ³„éœ²">å‡½æ•°ä»£ç æ³„éœ²</a></h3>
<p>å¦‚æœä½ å¯ä»¥ <strong>è®¿é—®ä¸€ä¸ªå‡½æ•°çš„å¯¹è±¡</strong>ï¼Œä½ å¯ä»¥ <strong>è·å–è¯¥å‡½æ•°çš„ä»£ç </strong>ã€‚</p>
<pre><code class="language-javascript">function afunc(){
return 1+1;
}
console.log(afunc.toString()); //This will print the code of the function
console.log(String(afunc)); //This will print the code of the function
console.log(this.afunc.toString()); //This will print the code of the function
console.log(global.afunc.toString()); //This will print the code of the function
</code></pre>
<p>åœ¨<strong>å‡½æ•°æ²¡æœ‰ä»»ä½•åç§°</strong>çš„æƒ…å†µä¸‹ï¼Œæ‚¨ä»ç„¶å¯ä»¥ä»å†…éƒ¨æ‰“å°<strong>å‡½æ•°ä»£ç </strong>ï¼š</p>
<pre><code class="language-javascript">(function (){ return arguments.callee.toString(); })()
(function (){ return arguments[0]; })("arg0")
</code></pre>
<p>ä¸€äº›<strong>éšæœº</strong>æ–¹æ³•æ¥<strong>æå–ä»£ç </strong>ä»å¦ä¸€ä¸ªå‡½æ•°ï¼ˆç”šè‡³æ³¨é‡Šï¼‰:</p>
<pre><code class="language-javascript">(function (){ return retFunc =&gt; String(arguments[0]) })(a=&gt;{/* Hidden commment */})()
(function (){ return retFunc =&gt; Array(arguments[0].toString()) })(a=&gt;{/* Hidden commment */})()
(function (){ return String(this)}).bind(()=&gt;{ /* Hidden commment */ })()
(u=&gt;(String(u)))(_=&gt;{ /* Hidden commment */ })
(u=&gt;_=&gt;(String(u)))(_=&gt;{ /* Hidden commment */ })()
</code></pre>
<h2 id="æ²™ç®±é€ƒé€¸---æ¢å¤çª—å£å¯¹è±¡"><a class="header" href="#æ²™ç®±é€ƒé€¸---æ¢å¤çª—å£å¯¹è±¡">æ²™ç®±é€ƒé€¸ - æ¢å¤çª—å£å¯¹è±¡</a></h2>
<p>Window å¯¹è±¡å…è®¸è®¿é—®å…¨å±€å®šä¹‰çš„å‡½æ•°ï¼Œå¦‚ alert æˆ– evalã€‚</p>
<p>{% code overflow="wrap" %}</p>
<pre><code class="language-javascript">// Some ways to access window
window.eval("alert(1)")
frames
globalThis
parent
self
top //If inside a frame, this is top most window

// Access window from document
document.defaultView.alert(1)
// Access document from a node object
node = document.createElement('div')
node.ownerDocument.defaultView.alert(1)

// There is a path property on each error event whose last element is the window
&lt;img src onerror=event.path.pop().alert(1337)&gt;
// In other browsers the method is
&lt;img src onerror=event.composedPath().pop().alert(1337)&gt;
// In case of svg, the "event" object is called "evt"
&lt;svg&gt;&lt;image href=1 onerror=evt.composedPath().pop().alert(1337)&gt;

// Abusing Error.prepareStackTrace to get Window back
Error.prepareStackTrace=function(error, callSites){
2   callSites.shift().getThis().alert(1337);
3 };
4 new Error().stack

// From an HTML event
// Events from HTML are executed in this context
with(document) {
with(element) {
//executed event
}
}
// Because of that with(document) it's possible to access properties of document like:
&lt;img src onerror=defaultView.alert(1337)&gt;
&lt;img src onerror=s=createElement('script');s.append('alert(1337)');appendChild(s)&gt;
</code></pre>
<p>{% endcode %}</p>
<h2 id="è®¿é—®å€¼æ—¶çš„æ–­ç‚¹"><a class="header" href="#è®¿é—®å€¼æ—¶çš„æ–­ç‚¹">è®¿é—®å€¼æ—¶çš„æ–­ç‚¹</a></h2>
<pre><code class="language-javascript">// Stop when a property in sessionStorage or localStorage is set/get
// via getItem or setItem functions
sessionStorage.getItem = localStorage.getItem  = function(prop) {
debugger;
return sessionStorage[prop];
}

localStorage.setItem = function(prop, val) {
debugger;
localStorage[prop] = val;
}
</code></pre>
<pre><code class="language-javascript">// Stop when anyone sets or gets the property "ppmap" in any object
// For example sessionStorage.ppmap
// "123".ppmap
// Useful to find where weird properties are being set or accessed
// or to find where prototype pollutions are occurring

function debugAccess(obj, prop, debugGet=true){

var origValue = obj[prop];

Object.defineProperty(obj, prop, {
get: function () {
if ( debugGet )
debugger;
return origValue;
},
set: function(val) {
debugger;
origValue = val;
}
});
};

debugAccess(Object.prototype, 'ppmap')
</code></pre>
<h2 id="è‡ªåŠ¨æµè§ˆå™¨è®¿é—®ä»¥æµ‹è¯•æœ‰æ•ˆè½½è·"><a class="header" href="#è‡ªåŠ¨æµè§ˆå™¨è®¿é—®ä»¥æµ‹è¯•æœ‰æ•ˆè½½è·">è‡ªåŠ¨æµè§ˆå™¨è®¿é—®ä»¥æµ‹è¯•æœ‰æ•ˆè½½è·</a></h2>
<pre><code class="language-javascript">//Taken from https://github.com/svennergr/writeups/blob/master/inti/0621/README.md
const puppeteer = require("puppeteer");

const realPasswordLength = 3000;
async function sleep(ms) {
return new Promise((resolve) =&gt; setTimeout(resolve, ms));
}

(async () =&gt; {
const browser = await puppeteer.launch();
const page = await browser.newPage();
//Loop to iterate through different values
for (let i = 0; i &lt; 10000; i += 100) {
console.log(`Run number ${i}`);
const input = `${"0".repeat(i)}${realPasswordLength}`;
console.log(`  https://challenge-0621.intigriti.io/passgen.php?passwordLength=${input}&amp;allowNumbers=true&amp;allowSymbols=true&amp;timestamp=1624556811000`);
//Go to the page
await page.goto(
`https://challenge-0621.intigriti.io/passgen.php?passwordLength=${input}&amp;allowNumbers=true&amp;allowSymbols=true&amp;timestamp=1624556811000`
);
//Call function "generate()" inside the page
await page.evaluate("generate()");
//Get node inner text from an HTML element
const passwordContent = await page.$$eval(
".alert .page-content",
(node) =&gt; node[0].innerText
);
//Transform the content and print it in console
const plainPassword = passwordContent.replace("Your password is: ", "");
if (plainPassword.length != realPasswordLength) {
console.log(i, plainPassword.length, plainPassword);
}

await sleep(1000);
}
await browser.close();
})();
</code></pre>
<p>{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>Telegram ç¾¤ç»„</strong></a> æˆ– <strong>å…³æ³¨</strong> æˆ‘ä»¬çš„ <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../pentesting-web/xss-cross-site-scripting/js-hoisting.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../pentesting-web/xss-cross-site-scripting/pdf-injection.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../pentesting-web/xss-cross-site-scripting/js-hoisting.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../pentesting-web/xss-cross-site-scripting/pdf-injection.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
