<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>DOM XSS</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="dom-xss"><a class="header" href="#dom-xss">DOM XSS</a></h1>
<p>{% hint style="success" %}
学习与实践 AWS 黑客技术：<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习与实践 GCP 黑客技术：<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>Telegram 群组</strong></a> 或 <strong>关注</strong> 我们的 <strong>Twitter</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub 仓库提交 PR 分享黑客技巧。</li>
</ul>
</details>
{% endhint %}
<h2 id="dom-漏洞"><a class="header" href="#dom-漏洞">DOM 漏洞</a></h2>
<p>DOM 漏洞发生在来自攻击者控制的 <strong>源</strong>（如 <code>location.search</code>、<code>document.referrer</code> 或 <code>document.cookie</code>）的数据不安全地传输到 <strong>接收点</strong>。接收点是可以执行或渲染有害内容的函数或对象（例如 <code>eval()</code>、<code>document.body.innerHTML</code>），如果给定恶意数据。</p>
<ul>
<li><strong>源</strong> 是可以被攻击者操控的输入，包括 URL、cookie 和网页消息。</li>
<li><strong>接收点</strong> 是潜在危险的端点，恶意数据可能导致不良后果，例如脚本执行。</li>
</ul>
<p>当数据从源流向接收点而没有适当的验证或清理时，风险就会出现，从而使攻击如 XSS 成为可能。</p>
<p>{% hint style="info" %}
<strong>您可以在</strong> <a href="https://github.com/wisec/domxsswiki/wiki"><strong>https://github.com/wisec/domxsswiki/wiki</strong></a> <strong>找到更更新的源和接收点列表</strong>
{% endhint %}</p>
<p><strong>常见源：</strong></p>
<pre><code class="language-javascript">document.URL
document.documentURI
document.URLUnencoded
document.baseURI
location
document.cookie
document.referrer
window.name
history.pushState
history.replaceState
localStorage
sessionStorage
IndexedDB (mozIndexedDB, webkitIndexedDB, msIndexedDB)
Database
</code></pre>
<p><strong>常见的接收点：</strong></p>
<div class="table-wrapper"><table><thead><tr><th><a href="dom-xss.html#open-redirect"><strong>开放重定向</strong></a></th><th><a href="dom-xss.html#javascript-injection"><strong>Javascript 注入</strong></a></th><th><a href="dom-xss.html#dom-data-manipulation"><strong>DOM 数据操作</strong></a></th><th><strong>jQuery</strong></th></tr></thead><tbody>
<tr><td><code>location</code></td><td><code>eval()</code></td><td><code>scriptElement.src</code></td><td><code>add()</code></td></tr>
<tr><td><code>location.host</code></td><td><code>Function() constructor</code></td><td><code>scriptElement.text</code></td><td><code>after()</code></td></tr>
<tr><td><code>location.hostname</code></td><td><code>setTimeout()</code></td><td><code>scriptElement.textContent</code></td><td><code>append()</code></td></tr>
<tr><td><code>location.href</code></td><td><code>setInterval()</code></td><td><code>scriptElement.innerText</code></td><td><code>animate()</code></td></tr>
<tr><td><code>location.pathname</code></td><td><code>setImmediate()</code></td><td><code>someDOMElement.setAttribute()</code></td><td><code>insertAfter()</code></td></tr>
<tr><td><code>location.search</code></td><td><code>execCommand()</code></td><td><code>someDOMElement.search</code></td><td><code>insertBefore()</code></td></tr>
<tr><td><code>location.protocol</code></td><td><code>execScript()</code></td><td><code>someDOMElement.text</code></td><td><code>before()</code></td></tr>
<tr><td><code>location.assign()</code></td><td><code>msSetImmediate()</code></td><td><code>someDOMElement.textContent</code></td><td><code>html()</code></td></tr>
<tr><td><code>location.replace()</code></td><td><code>range.createContextualFragment()</code></td><td><code>someDOMElement.innerText</code></td><td><code>prepend()</code></td></tr>
<tr><td><code>open()</code></td><td><code>crypto.generateCRMFRequest()</code></td><td><code>someDOMElement.outerText</code></td><td><code>replaceAll()</code></td></tr>
<tr><td><code>domElem.srcdoc</code></td><td><strong>``</strong><a href="dom-xss.html#local-file-path-manipulation"><strong>本地文件路径操作</strong></a></td><td><code>someDOMElement.value</code></td><td><code>replaceWith()</code></td></tr>
<tr><td><code>XMLHttpRequest.open()</code></td><td><code>FileReader.readAsArrayBuffer()</code></td><td><code>someDOMElement.name</code></td><td><code>wrap()</code></td></tr>
<tr><td><code>XMLHttpRequest.send()</code></td><td><code>FileReader.readAsBinaryString()</code></td><td><code>someDOMElement.target</code></td><td><code>wrapInner()</code></td></tr>
<tr><td><code>jQuery.ajax()</code></td><td><code>FileReader.readAsDataURL()</code></td><td><code>someDOMElement.method</code></td><td><code>wrapAll()</code></td></tr>
<tr><td><code>$.ajax()</code></td><td><code>FileReader.readAsText()</code></td><td><code>someDOMElement.type</code></td><td><code>has()</code></td></tr>
<tr><td><strong>``</strong><a href="dom-xss.html#ajax-request-manipulation"><strong>Ajax 请求操作</strong></a></td><td><code>FileReader.readAsFile()</code></td><td><code>someDOMElement.backgroundImage</code></td><td><code>constructor()</code></td></tr>
<tr><td><code>XMLHttpRequest.setRequestHeader()</code></td><td><code>FileReader.root.getFile()</code></td><td><code>someDOMElement.cssText</code></td><td><code>init()</code></td></tr>
<tr><td><code>XMLHttpRequest.open()</code></td><td><code>FileReader.root.getFile()</code></td><td><code>someDOMElement.codebase</code></td><td><code>index()</code></td></tr>
<tr><td><code>XMLHttpRequest.send()</code></td><td><a href="dom-xss.html#link-manipulation"><strong>链接操作</strong></a></td><td><code>someDOMElement.innerHTML</code></td><td><code>jQuery.parseHTML()</code></td></tr>
<tr><td><code>jQuery.globalEval()</code></td><td><code>someDOMElement.href</code></td><td><code>someDOMElement.outerHTML</code></td><td><code>$.parseHTML()</code></td></tr>
<tr><td><code>$.globalEval()</code></td><td><code>someDOMElement.src</code></td><td><code>someDOMElement.insertAdjacentHTML</code></td><td><a href="dom-xss.html#client-side-sql-injection"><strong>客户端 JSON 注入</strong></a></td></tr>
<tr><td><strong>``</strong><a href="dom-xss.html#html-5-storage-manipulation"><strong>HTML5 存储操作</strong></a></td><td><code>someDOMElement.action</code></td><td><code>someDOMElement.onevent</code></td><td><code>JSON.parse()</code></td></tr>
<tr><td><code>sessionStorage.setItem()</code></td><td><a href="dom-xss.html#xpath-injection"><strong>XPath 注入</strong></a></td><td><code>document.write()</code></td><td><code>jQuery.parseJSON()</code></td></tr>
<tr><td><code>localStorage.setItem()</code></td><td><code>document.evaluate()</code></td><td><code>document.writeln()</code></td><td><code>$.parseJSON()</code></td></tr>
<tr><td><strong><code>**[**拒绝服务**](dom-xss.md#denial-of-service)**</code></strong></td><td><code>someDOMElement.evaluate()</code></td><td><code>document.title</code></td><td><strong>``</strong><a href="dom-xss.html#cookie-manipulation"><strong>Cookie 操作</strong></a></td></tr>
<tr><td><code>requestFileSystem()</code></td><td><strong>``</strong><a href="dom-xss.html#document-domain-manipulation"><strong>文档域操作</strong></a></td><td><code>document.implementation.createHTMLDocument()</code></td><td><code>document.cookie</code></td></tr>
<tr><td><code>RegExp()</code></td><td><code>document.domain</code></td><td><code>history.pushState()</code></td><td><a href="dom-xss.html#websocket-url-poisoning"><strong>WebSocket-URL 中毒</strong></a></td></tr>
<tr><td><a href="dom-xss.html#client-side-sql-injection"><strong>客户端 SQL 注入</strong></a></td><td><a href="dom-xss.html#web-message-manipulation"><strong>Web 消息操作</strong></a></td><td><code>history.replaceState()</code></td><td><code>WebSocket</code></td></tr>
<tr><td><code>executeSql()</code></td><td><code>postMessage()</code></td><td>``</td><td>``</td></tr>
</tbody></table>
</div>
<p><strong><code>innerHTML</code></strong> 接收点在任何现代浏览器中都不接受 <code>script</code> 元素，也不会触发 <code>svg onload</code> 事件。这意味着您需要使用替代元素，如 <code>img</code> 或 <code>iframe</code>。</p>
<p>这种类型的 XSS 可能是 <strong>最难发现的</strong>，因为您需要查看 JS 代码，看看它是否 <strong>使用</strong> 任何您 <strong>控制的</strong> 对象的 <strong>值</strong>，并在这种情况下，查看是否有 <strong>任何方法可以滥用</strong> 它来执行任意 JS。</p>
<h2 id="查找工具"><a class="header" href="#查找工具">查找工具</a></h2>
<ul>
<li><a href="https://github.com/mozilla/eslint-plugin-no-unsanitized">https://github.com/mozilla/eslint-plugin-no-unsanitized</a></li>
<li>检查每个到达潜在接收点的数据的浏览器扩展：<a href="https://github.com/kevin-mizu/domloggerpp">https://github.com/kevin-mizu/domloggerpp</a></li>
</ul>
<h2 id="示例"><a class="header" href="#示例">示例</a></h2>
<h3 id="开放重定向"><a class="header" href="#开放重定向">开放重定向</a></h3>
<p>来自：<a href="https://portswigger.net/web-security/dom-based/open-redirection">https://portswigger.net/web-security/dom-based/open-redirection</a></p>
<p><strong>DOM 中的开放重定向漏洞</strong> 发生在脚本将攻击者可以控制的数据写入能够跨域导航的接收点时。</p>
<p>理解执行任意代码（例如 <strong><code>javascript:alert(1)</code></strong>）是可能的，如果您控制重定向发生的 URL 开头，这是至关重要的。</p>
<p>接收点：</p>
<pre><code class="language-javascript">location
location.host
location.hostname
location.href
location.pathname
location.search
location.protocol
location.assign()
location.replace()
open()
domElem.srcdoc
XMLHttpRequest.open()
XMLHttpRequest.send()
jQuery.ajax()
$.ajax()
</code></pre>
<h3 id="cookie-manipulation"><a class="header" href="#cookie-manipulation">Cookie manipulation</a></h3>
<p>来自: <a href="https://portswigger.net/web-security/dom-based/cookie-manipulation">https://portswigger.net/web-security/dom-based/cookie-manipulation</a></p>
<p>基于DOM的cookie操控漏洞发生在脚本将攻击者可以控制的数据纳入cookie的值时。如果cookie在网站内被使用，这种漏洞可能导致网页出现意外行为。此外，如果cookie涉及用户会话跟踪，它可以被利用来进行会话固定攻击。与此漏洞相关的主要汇聚点是：</p>
<p>Sinks:</p>
<pre><code class="language-javascript">document.cookie
</code></pre>
<h3 id="javascript-注入"><a class="header" href="#javascript-注入">JavaScript 注入</a></h3>
<p>来自: <a href="https://portswigger.net/web-security/dom-based/javascript-injection">https://portswigger.net/web-security/dom-based/javascript-injection</a></p>
<p>基于 DOM 的 JavaScript 注入漏洞是在脚本将可以被攻击者控制的数据作为 JavaScript 代码运行时产生的。</p>
<p>Sinks:</p>
<pre><code class="language-javascript">eval()
Function() constructor
setTimeout()
setInterval()
setImmediate()
execCommand()
execScript()
msSetImmediate()
range.createContextualFragment()
crypto.generateCRMFRequest()
</code></pre>
<h3 id="document-domain-manipulation"><a class="header" href="#document-domain-manipulation">Document-domain manipulation</a></h3>
<p>From: <a href="https://portswigger.net/web-security/dom-based/document-domain-manipulation">https://portswigger.net/web-security/dom-based/document-domain-manipulation</a></p>
<p><strong>文档域操控漏洞</strong> 发生在脚本使用攻击者可以控制的数据设置 <code>document.domain</code> 属性时。</p>
<p><code>document.domain</code> 属性在浏览器的 <strong>同源策略</strong> 的 <strong>执行</strong> 中发挥着 <strong>关键作用</strong>。当来自不同源的两个页面将它们的 <code>document.domain</code> 设置为 <strong>相同的值</strong> 时，它们可以不受限制地进行交互。尽管浏览器对可分配给 <code>document.domain</code> 的值施加了某些 <strong>限制</strong>，防止将完全不相关的值分配给实际页面源，但仍然存在例外。通常，浏览器允许使用 <strong>子域</strong> 或 <strong>父域</strong>。</p>
<p>Sinks:</p>
<pre><code class="language-javascript">document.domain
</code></pre>
<h3 id="websocket-url-poisoning"><a class="header" href="#websocket-url-poisoning">WebSocket-URL poisoning</a></h3>
<p>来自: <a href="https://portswigger.net/web-security/dom-based/websocket-url-poisoning">https://portswigger.net/web-security/dom-based/websocket-url-poisoning</a></p>
<p><strong>WebSocket-URL poisoning</strong> 发生在脚本将 <strong>可控数据作为 WebSocket 连接的目标 URL</strong> 使用时。</p>
<p>Sinks:</p>
<p><code>WebSocket</code> 构造函数可能导致 WebSocket-URL poisoning 漏洞。</p>
<h3 id="link-manipulation"><a class="header" href="#link-manipulation">Link manipulation</a></h3>
<p>来自: <a href="https://portswigger.net/web-security/dom-based/link-manipulation">https://portswigger.net/web-security/dom-based/link-manipulation</a></p>
<p><strong>DOM-based link-manipulation vulnerabilities</strong> 出现于脚本将 <strong>攻击者可控的数据写入当前页面的导航目标</strong>，例如可点击的链接或表单的提交 URL。</p>
<p>Sinks:</p>
<pre><code class="language-javascript">someDOMElement.href
someDOMElement.src
someDOMElement.action
</code></pre>
<h3 id="ajax请求操控"><a class="header" href="#ajax请求操控">Ajax请求操控</a></h3>
<p>来自: <a href="https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation">https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation</a></p>
<p><strong>Ajax请求操控漏洞</strong> 出现于脚本将 <strong>攻击者可控的数据写入使用 <code>XmlHttpRequest</code> 对象发出的Ajax请求</strong> 时。</p>
<p>Sink:</p>
<pre><code class="language-javascript">XMLHttpRequest.setRequestHeader()
XMLHttpRequest.open()
XMLHttpRequest.send()
jQuery.globalEval()
$.globalEval()
</code></pre>
<h3 id="本地文件路径操控"><a class="header" href="#本地文件路径操控">本地文件路径操控</a></h3>
<p>来自: <a href="https://portswigger.net/web-security/dom-based/local-file-path-manipulation">https://portswigger.net/web-security/dom-based/local-file-path-manipulation</a></p>
<p><strong>本地文件路径操控漏洞</strong> 出现于脚本将 <strong>攻击者可控的数据传递给文件处理API</strong> 作为 <code>filename</code> 参数。攻击者可以利用此漏洞构造一个URL，如果另一个用户访问该URL，可能导致 <strong>用户的浏览器打开或写入任意本地文件</strong>。</p>
<p>Sinks:</p>
<pre><code class="language-javascript">FileReader.readAsArrayBuffer()
FileReader.readAsBinaryString()
FileReader.readAsDataURL()
FileReader.readAsText()
FileReader.readAsFile()
FileReader.root.getFile()
FileReader.root.getFile()
</code></pre>
<h3 id="客户端-sql-注入"><a class="header" href="#客户端-sql-注入">客户端 SQL 注入</a></h3>
<p>来自: <a href="https://portswigger.net/web-security/dom-based/client-side-sql-injection">https://portswigger.net/web-security/dom-based/client-side-sql-injection</a></p>
<p><strong>客户端 SQL 注入漏洞</strong> 发生在脚本以 <strong>不安全的方式将攻击者可控的数据纳入客户端 SQL 查询</strong> 时。</p>
<p>Sinks:</p>
<pre><code class="language-javascript">executeSql()
</code></pre>
<h3 id="html5-storage-manipulation"><a class="header" href="#html5-storage-manipulation">HTML5-storage manipulation</a></h3>
<p>From: <a href="https://portswigger.net/web-security/dom-based/html5-storage-manipulation">https://portswigger.net/web-security/dom-based/html5-storage-manipulation</a></p>
<p><strong>HTML5-storage manipulation vulnerabilities</strong> 出现于脚本 <strong>在网页浏览器的 HTML5 存储中存储攻击者可控的数据</strong> (<code>localStorage</code> 或 <code>sessionStorage</code>)。虽然此操作本身并不是安全漏洞，但如果应用程序随后 <strong>读取存储的数据并不安全地处理它</strong>，则会变得有问题。这可能允许攻击者利用存储机制进行其他基于 DOM 的攻击，例如跨站脚本和 JavaScript 注入。</p>
<p>Sinks:</p>
<pre><code class="language-javascript">sessionStorage.setItem()
localStorage.setItem()
</code></pre>
<h3 id="xpath-注入"><a class="header" href="#xpath-注入">XPath 注入</a></h3>
<p>来自: <a href="https://portswigger.net/web-security/dom-based/client-side-xpath-injection">https://portswigger.net/web-security/dom-based/client-side-xpath-injection</a></p>
<p><strong>基于 DOM 的 XPath 注入漏洞</strong> 发生在脚本将 <strong>攻击者可控的数据纳入 XPath 查询</strong> 时。</p>
<p>Sinks:</p>
<pre><code class="language-javascript">document.evaluate()
someDOMElement.evaluate()
</code></pre>
<h3 id="客户端-json-注入"><a class="header" href="#客户端-json-注入">客户端 JSON 注入</a></h3>
<p>来自: <a href="https://portswigger.net/web-security/dom-based/client-side-json-injection">https://portswigger.net/web-security/dom-based/client-side-json-injection</a></p>
<p><strong>基于 DOM 的 JSON 注入漏洞</strong> 发生在脚本将 <strong>攻击者可控的数据纳入一个被解析为 JSON 数据结构的字符串中，然后由应用程序处理</strong>。</p>
<p>Sinks:</p>
<pre><code class="language-javascript">JSON.parse()
jQuery.parseJSON()
$.parseJSON()
</code></pre>
<h3 id="web-message-manipulation"><a class="header" href="#web-message-manipulation">Web-message manipulation</a></h3>
<p>From: <a href="https://portswigger.net/web-security/dom-based/web-message-manipulation">https://portswigger.net/web-security/dom-based/web-message-manipulation</a></p>
<p><strong>Web-message vulnerabilities</strong> 在脚本将 <strong>攻击者可控的数据作为网络消息发送到浏览器内的另一个文档</strong> 时出现。一个 <strong>示例</strong> 的易受攻击的Web消息操控可以在 <a href="https://portswigger.net/web-security/dom-based/controlling-the-web-message-source">PortSwigger的网络安全学院</a> 找到。</p>
<p>Sinks:</p>
<p><code>postMessage()</code> 方法用于发送网络消息，如果接收消息的事件监听器以不安全的方式处理传入数据，则可能导致漏洞。</p>
<h3 id="dom-data-manipulation"><a class="header" href="#dom-data-manipulation">DOM-data manipulation</a></h3>
<p>From: <a href="https://portswigger.net/web-security/dom-based/dom-data-manipulation">https://portswigger.net/web-security/dom-based/dom-data-manipulation</a></p>
<p><strong>DOM-data manipulation vulnerabilities</strong> 在脚本将 <strong>攻击者可控的数据写入DOM中的一个字段</strong> 时出现，该字段在可见的UI或客户端逻辑中被使用。攻击者可以利用此漏洞构造一个URL，如果其他用户访问该URL，可以改变客户端UI的外观或行为。</p>
<p>Sinks:</p>
<pre><code class="language-javascript">scriptElement.src
scriptElement.text
scriptElement.textContent
scriptElement.innerText
someDOMElement.setAttribute()
someDOMElement.search
someDOMElement.text
someDOMElement.textContent
someDOMElement.innerText
someDOMElement.outerText
someDOMElement.value
someDOMElement.name
someDOMElement.target
someDOMElement.method
someDOMElement.type
someDOMElement.backgroundImage
someDOMElement.cssText
someDOMElement.codebase
document.title
document.implementation.createHTMLDocument()
history.pushState()
history.replaceState()
</code></pre>
<h3 id="denial-of-service"><a class="header" href="#denial-of-service">Denial of Service</a></h3>
<p>From: <a href="https://portswigger.net/web-security/dom-based/denial-of-service">https://portswigger.net/web-security/dom-based/denial-of-service</a></p>
<p><strong>基于DOM的拒绝服务漏洞</strong>发生在脚本将<strong>攻击者可控的数据不安全地传递给有问题的平台API</strong>时。这包括在调用时可能导致用户计算机消耗<strong>过多的CPU或磁盘空间</strong>的API。这类漏洞可能会产生显著的副作用，例如浏览器通过拒绝尝试在<code>localStorage</code>中存储数据或终止繁忙的脚本来限制网站的功能。</p>
<p>Sinks:</p>
<pre><code class="language-javascript">requestFileSystem()
RegExp()
</code></pre>
<h2 id="dom-clobbering"><a class="header" href="#dom-clobbering">Dom Clobbering</a></h2>
<p>{% content-ref url="dom-clobbering.md" %}
<a href="dom-clobbering.html">dom-clobbering.md</a>
{% endcontent-ref %}</p>
<p>{% hint style="success" %}
学习和实践 AWS 黑客技术：<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习和实践 GCP 黑客技术：<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>Telegram 群组</strong></a> 或 <strong>在</strong> <strong>Twitter</strong> 🐦 <strong>上关注我们</strong> <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub 仓库提交 PR 来分享黑客技巧。</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../pentesting-web/xss-cross-site-scripting/dom-invader.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../pentesting-web/xss-cross-site-scripting/iframes-in-xss-and-csp.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../pentesting-web/xss-cross-site-scripting/dom-invader.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../pentesting-web/xss-cross-site-scripting/iframes-in-xss-and-csp.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
