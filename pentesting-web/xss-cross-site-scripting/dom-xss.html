<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>DOM XSS</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="dom-xss"><a class="header" href="#dom-xss">DOM XSS</a></h1>
<p>{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>Telegram ç¾¤ç»„</strong></a> æˆ– <strong>å…³æ³¨</strong> æˆ‘ä»¬çš„ <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}
<h2 id="dom-æ¼æ´"><a class="header" href="#dom-æ¼æ´">DOM æ¼æ´</a></h2>
<p>DOM æ¼æ´å‘ç”Ÿåœ¨æ¥è‡ªæ”»å‡»è€…æ§åˆ¶çš„ <strong>æº</strong>ï¼ˆå¦‚ <code>location.search</code>ã€<code>document.referrer</code> æˆ– <code>document.cookie</code>ï¼‰çš„æ•°æ®ä¸å®‰å…¨åœ°ä¼ è¾“åˆ° <strong>æ¥æ”¶ç‚¹</strong>ã€‚æ¥æ”¶ç‚¹æ˜¯å¯ä»¥æ‰§è¡Œæˆ–æ¸²æŸ“æœ‰å®³å†…å®¹çš„å‡½æ•°æˆ–å¯¹è±¡ï¼ˆä¾‹å¦‚ <code>eval()</code>ã€<code>document.body.innerHTML</code>ï¼‰ï¼Œå¦‚æœç»™å®šæ¶æ„æ•°æ®ã€‚</p>
<ul>
<li><strong>æº</strong> æ˜¯å¯ä»¥è¢«æ”»å‡»è€…æ“æ§çš„è¾“å…¥ï¼ŒåŒ…æ‹¬ URLã€cookie å’Œç½‘é¡µæ¶ˆæ¯ã€‚</li>
<li><strong>æ¥æ”¶ç‚¹</strong> æ˜¯æ½œåœ¨å±é™©çš„ç«¯ç‚¹ï¼Œæ¶æ„æ•°æ®å¯èƒ½å¯¼è‡´ä¸è‰¯åæœï¼Œä¾‹å¦‚è„šæœ¬æ‰§è¡Œã€‚</li>
</ul>
<p>å½“æ•°æ®ä»æºæµå‘æ¥æ”¶ç‚¹è€Œæ²¡æœ‰é€‚å½“çš„éªŒè¯æˆ–æ¸…ç†æ—¶ï¼Œé£é™©å°±ä¼šå‡ºç°ï¼Œä»è€Œä½¿æ”»å‡»å¦‚ XSS æˆä¸ºå¯èƒ½ã€‚</p>
<p>{% hint style="info" %}
<strong>æ‚¨å¯ä»¥åœ¨</strong> <a href="https://github.com/wisec/domxsswiki/wiki"><strong>https://github.com/wisec/domxsswiki/wiki</strong></a> <strong>æ‰¾åˆ°æ›´æ›´æ–°çš„æºå’Œæ¥æ”¶ç‚¹åˆ—è¡¨</strong>
{% endhint %}</p>
<p><strong>å¸¸è§æºï¼š</strong></p>
<pre><code class="language-javascript">document.URL
document.documentURI
document.URLUnencoded
document.baseURI
location
document.cookie
document.referrer
window.name
history.pushState
history.replaceState
localStorage
sessionStorage
IndexedDB (mozIndexedDB, webkitIndexedDB, msIndexedDB)
Database
</code></pre>
<p><strong>å¸¸è§çš„æ¥æ”¶ç‚¹ï¼š</strong></p>
<div class="table-wrapper"><table><thead><tr><th><a href="dom-xss.html#open-redirect"><strong>å¼€æ”¾é‡å®šå‘</strong></a></th><th><a href="dom-xss.html#javascript-injection"><strong>Javascript æ³¨å…¥</strong></a></th><th><a href="dom-xss.html#dom-data-manipulation"><strong>DOM æ•°æ®æ“ä½œ</strong></a></th><th><strong>jQuery</strong></th></tr></thead><tbody>
<tr><td><code>location</code></td><td><code>eval()</code></td><td><code>scriptElement.src</code></td><td><code>add()</code></td></tr>
<tr><td><code>location.host</code></td><td><code>Function() constructor</code></td><td><code>scriptElement.text</code></td><td><code>after()</code></td></tr>
<tr><td><code>location.hostname</code></td><td><code>setTimeout()</code></td><td><code>scriptElement.textContent</code></td><td><code>append()</code></td></tr>
<tr><td><code>location.href</code></td><td><code>setInterval()</code></td><td><code>scriptElement.innerText</code></td><td><code>animate()</code></td></tr>
<tr><td><code>location.pathname</code></td><td><code>setImmediate()</code></td><td><code>someDOMElement.setAttribute()</code></td><td><code>insertAfter()</code></td></tr>
<tr><td><code>location.search</code></td><td><code>execCommand()</code></td><td><code>someDOMElement.search</code></td><td><code>insertBefore()</code></td></tr>
<tr><td><code>location.protocol</code></td><td><code>execScript()</code></td><td><code>someDOMElement.text</code></td><td><code>before()</code></td></tr>
<tr><td><code>location.assign()</code></td><td><code>msSetImmediate()</code></td><td><code>someDOMElement.textContent</code></td><td><code>html()</code></td></tr>
<tr><td><code>location.replace()</code></td><td><code>range.createContextualFragment()</code></td><td><code>someDOMElement.innerText</code></td><td><code>prepend()</code></td></tr>
<tr><td><code>open()</code></td><td><code>crypto.generateCRMFRequest()</code></td><td><code>someDOMElement.outerText</code></td><td><code>replaceAll()</code></td></tr>
<tr><td><code>domElem.srcdoc</code></td><td><strong>``</strong><a href="dom-xss.html#local-file-path-manipulation"><strong>æœ¬åœ°æ–‡ä»¶è·¯å¾„æ“ä½œ</strong></a></td><td><code>someDOMElement.value</code></td><td><code>replaceWith()</code></td></tr>
<tr><td><code>XMLHttpRequest.open()</code></td><td><code>FileReader.readAsArrayBuffer()</code></td><td><code>someDOMElement.name</code></td><td><code>wrap()</code></td></tr>
<tr><td><code>XMLHttpRequest.send()</code></td><td><code>FileReader.readAsBinaryString()</code></td><td><code>someDOMElement.target</code></td><td><code>wrapInner()</code></td></tr>
<tr><td><code>jQuery.ajax()</code></td><td><code>FileReader.readAsDataURL()</code></td><td><code>someDOMElement.method</code></td><td><code>wrapAll()</code></td></tr>
<tr><td><code>$.ajax()</code></td><td><code>FileReader.readAsText()</code></td><td><code>someDOMElement.type</code></td><td><code>has()</code></td></tr>
<tr><td><strong>``</strong><a href="dom-xss.html#ajax-request-manipulation"><strong>Ajax è¯·æ±‚æ“ä½œ</strong></a></td><td><code>FileReader.readAsFile()</code></td><td><code>someDOMElement.backgroundImage</code></td><td><code>constructor()</code></td></tr>
<tr><td><code>XMLHttpRequest.setRequestHeader()</code></td><td><code>FileReader.root.getFile()</code></td><td><code>someDOMElement.cssText</code></td><td><code>init()</code></td></tr>
<tr><td><code>XMLHttpRequest.open()</code></td><td><code>FileReader.root.getFile()</code></td><td><code>someDOMElement.codebase</code></td><td><code>index()</code></td></tr>
<tr><td><code>XMLHttpRequest.send()</code></td><td><a href="dom-xss.html#link-manipulation"><strong>é“¾æ¥æ“ä½œ</strong></a></td><td><code>someDOMElement.innerHTML</code></td><td><code>jQuery.parseHTML()</code></td></tr>
<tr><td><code>jQuery.globalEval()</code></td><td><code>someDOMElement.href</code></td><td><code>someDOMElement.outerHTML</code></td><td><code>$.parseHTML()</code></td></tr>
<tr><td><code>$.globalEval()</code></td><td><code>someDOMElement.src</code></td><td><code>someDOMElement.insertAdjacentHTML</code></td><td><a href="dom-xss.html#client-side-sql-injection"><strong>å®¢æˆ·ç«¯ JSON æ³¨å…¥</strong></a></td></tr>
<tr><td><strong>``</strong><a href="dom-xss.html#html-5-storage-manipulation"><strong>HTML5 å­˜å‚¨æ“ä½œ</strong></a></td><td><code>someDOMElement.action</code></td><td><code>someDOMElement.onevent</code></td><td><code>JSON.parse()</code></td></tr>
<tr><td><code>sessionStorage.setItem()</code></td><td><a href="dom-xss.html#xpath-injection"><strong>XPath æ³¨å…¥</strong></a></td><td><code>document.write()</code></td><td><code>jQuery.parseJSON()</code></td></tr>
<tr><td><code>localStorage.setItem()</code></td><td><code>document.evaluate()</code></td><td><code>document.writeln()</code></td><td><code>$.parseJSON()</code></td></tr>
<tr><td><strong><code>**[**æ‹’ç»æœåŠ¡**](dom-xss.md#denial-of-service)**</code></strong></td><td><code>someDOMElement.evaluate()</code></td><td><code>document.title</code></td><td><strong>``</strong><a href="dom-xss.html#cookie-manipulation"><strong>Cookie æ“ä½œ</strong></a></td></tr>
<tr><td><code>requestFileSystem()</code></td><td><strong>``</strong><a href="dom-xss.html#document-domain-manipulation"><strong>æ–‡æ¡£åŸŸæ“ä½œ</strong></a></td><td><code>document.implementation.createHTMLDocument()</code></td><td><code>document.cookie</code></td></tr>
<tr><td><code>RegExp()</code></td><td><code>document.domain</code></td><td><code>history.pushState()</code></td><td><a href="dom-xss.html#websocket-url-poisoning"><strong>WebSocket-URL ä¸­æ¯’</strong></a></td></tr>
<tr><td><a href="dom-xss.html#client-side-sql-injection"><strong>å®¢æˆ·ç«¯ SQL æ³¨å…¥</strong></a></td><td><a href="dom-xss.html#web-message-manipulation"><strong>Web æ¶ˆæ¯æ“ä½œ</strong></a></td><td><code>history.replaceState()</code></td><td><code>WebSocket</code></td></tr>
<tr><td><code>executeSql()</code></td><td><code>postMessage()</code></td><td>``</td><td>``</td></tr>
</tbody></table>
</div>
<p><strong><code>innerHTML</code></strong> æ¥æ”¶ç‚¹åœ¨ä»»ä½•ç°ä»£æµè§ˆå™¨ä¸­éƒ½ä¸æ¥å— <code>script</code> å…ƒç´ ï¼Œä¹Ÿä¸ä¼šè§¦å‘ <code>svg onload</code> äº‹ä»¶ã€‚è¿™æ„å‘³ç€æ‚¨éœ€è¦ä½¿ç”¨æ›¿ä»£å…ƒç´ ï¼Œå¦‚ <code>img</code> æˆ– <code>iframe</code>ã€‚</p>
<p>è¿™ç§ç±»å‹çš„ XSS å¯èƒ½æ˜¯ <strong>æœ€éš¾å‘ç°çš„</strong>ï¼Œå› ä¸ºæ‚¨éœ€è¦æŸ¥çœ‹ JS ä»£ç ï¼Œçœ‹çœ‹å®ƒæ˜¯å¦ <strong>ä½¿ç”¨</strong> ä»»ä½•æ‚¨ <strong>æ§åˆ¶çš„</strong> å¯¹è±¡çš„ <strong>å€¼</strong>ï¼Œå¹¶åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰ <strong>ä»»ä½•æ–¹æ³•å¯ä»¥æ»¥ç”¨</strong> å®ƒæ¥æ‰§è¡Œä»»æ„ JSã€‚</p>
<h2 id="æŸ¥æ‰¾å·¥å…·"><a class="header" href="#æŸ¥æ‰¾å·¥å…·">æŸ¥æ‰¾å·¥å…·</a></h2>
<ul>
<li><a href="https://github.com/mozilla/eslint-plugin-no-unsanitized">https://github.com/mozilla/eslint-plugin-no-unsanitized</a></li>
<li>æ£€æŸ¥æ¯ä¸ªåˆ°è¾¾æ½œåœ¨æ¥æ”¶ç‚¹çš„æ•°æ®çš„æµè§ˆå™¨æ‰©å±•ï¼š<a href="https://github.com/kevin-mizu/domloggerpp">https://github.com/kevin-mizu/domloggerpp</a></li>
</ul>
<h2 id="ç¤ºä¾‹"><a class="header" href="#ç¤ºä¾‹">ç¤ºä¾‹</a></h2>
<h3 id="å¼€æ”¾é‡å®šå‘"><a class="header" href="#å¼€æ”¾é‡å®šå‘">å¼€æ”¾é‡å®šå‘</a></h3>
<p>æ¥è‡ªï¼š<a href="https://portswigger.net/web-security/dom-based/open-redirection">https://portswigger.net/web-security/dom-based/open-redirection</a></p>
<p><strong>DOM ä¸­çš„å¼€æ”¾é‡å®šå‘æ¼æ´</strong> å‘ç”Ÿåœ¨è„šæœ¬å°†æ”»å‡»è€…å¯ä»¥æ§åˆ¶çš„æ•°æ®å†™å…¥èƒ½å¤Ÿè·¨åŸŸå¯¼èˆªçš„æ¥æ”¶ç‚¹æ—¶ã€‚</p>
<p>ç†è§£æ‰§è¡Œä»»æ„ä»£ç ï¼ˆä¾‹å¦‚ <strong><code>javascript:alert(1)</code></strong>ï¼‰æ˜¯å¯èƒ½çš„ï¼Œå¦‚æœæ‚¨æ§åˆ¶é‡å®šå‘å‘ç”Ÿçš„ URL å¼€å¤´ï¼Œè¿™æ˜¯è‡³å…³é‡è¦çš„ã€‚</p>
<p>æ¥æ”¶ç‚¹ï¼š</p>
<pre><code class="language-javascript">location
location.host
location.hostname
location.href
location.pathname
location.search
location.protocol
location.assign()
location.replace()
open()
domElem.srcdoc
XMLHttpRequest.open()
XMLHttpRequest.send()
jQuery.ajax()
$.ajax()
</code></pre>
<h3 id="cookie-manipulation"><a class="header" href="#cookie-manipulation">Cookie manipulation</a></h3>
<p>æ¥è‡ª: <a href="https://portswigger.net/web-security/dom-based/cookie-manipulation">https://portswigger.net/web-security/dom-based/cookie-manipulation</a></p>
<p>åŸºäºDOMçš„cookieæ“æ§æ¼æ´å‘ç”Ÿåœ¨è„šæœ¬å°†æ”»å‡»è€…å¯ä»¥æ§åˆ¶çš„æ•°æ®çº³å…¥cookieçš„å€¼æ—¶ã€‚å¦‚æœcookieåœ¨ç½‘ç«™å†…è¢«ä½¿ç”¨ï¼Œè¿™ç§æ¼æ´å¯èƒ½å¯¼è‡´ç½‘é¡µå‡ºç°æ„å¤–è¡Œä¸ºã€‚æ­¤å¤–ï¼Œå¦‚æœcookieæ¶‰åŠç”¨æˆ·ä¼šè¯è·Ÿè¸ªï¼Œå®ƒå¯ä»¥è¢«åˆ©ç”¨æ¥è¿›è¡Œä¼šè¯å›ºå®šæ”»å‡»ã€‚ä¸æ­¤æ¼æ´ç›¸å…³çš„ä¸»è¦æ±‡èšç‚¹æ˜¯ï¼š</p>
<p>Sinks:</p>
<pre><code class="language-javascript">document.cookie
</code></pre>
<h3 id="javascript-æ³¨å…¥"><a class="header" href="#javascript-æ³¨å…¥">JavaScript æ³¨å…¥</a></h3>
<p>æ¥è‡ª: <a href="https://portswigger.net/web-security/dom-based/javascript-injection">https://portswigger.net/web-security/dom-based/javascript-injection</a></p>
<p>åŸºäº DOM çš„ JavaScript æ³¨å…¥æ¼æ´æ˜¯åœ¨è„šæœ¬å°†å¯ä»¥è¢«æ”»å‡»è€…æ§åˆ¶çš„æ•°æ®ä½œä¸º JavaScript ä»£ç è¿è¡Œæ—¶äº§ç”Ÿçš„ã€‚</p>
<p>Sinks:</p>
<pre><code class="language-javascript">eval()
Function() constructor
setTimeout()
setInterval()
setImmediate()
execCommand()
execScript()
msSetImmediate()
range.createContextualFragment()
crypto.generateCRMFRequest()
</code></pre>
<h3 id="document-domain-manipulation"><a class="header" href="#document-domain-manipulation">Document-domain manipulation</a></h3>
<p>From: <a href="https://portswigger.net/web-security/dom-based/document-domain-manipulation">https://portswigger.net/web-security/dom-based/document-domain-manipulation</a></p>
<p><strong>æ–‡æ¡£åŸŸæ“æ§æ¼æ´</strong> å‘ç”Ÿåœ¨è„šæœ¬ä½¿ç”¨æ”»å‡»è€…å¯ä»¥æ§åˆ¶çš„æ•°æ®è®¾ç½® <code>document.domain</code> å±æ€§æ—¶ã€‚</p>
<p><code>document.domain</code> å±æ€§åœ¨æµè§ˆå™¨çš„ <strong>åŒæºç­–ç•¥</strong> çš„ <strong>æ‰§è¡Œ</strong> ä¸­å‘æŒ¥ç€ <strong>å…³é”®ä½œç”¨</strong>ã€‚å½“æ¥è‡ªä¸åŒæºçš„ä¸¤ä¸ªé¡µé¢å°†å®ƒä»¬çš„ <code>document.domain</code> è®¾ç½®ä¸º <strong>ç›¸åŒçš„å€¼</strong> æ—¶ï¼Œå®ƒä»¬å¯ä»¥ä¸å—é™åˆ¶åœ°è¿›è¡Œäº¤äº’ã€‚å°½ç®¡æµè§ˆå™¨å¯¹å¯åˆ†é…ç»™ <code>document.domain</code> çš„å€¼æ–½åŠ äº†æŸäº› <strong>é™åˆ¶</strong>ï¼Œé˜²æ­¢å°†å®Œå…¨ä¸ç›¸å…³çš„å€¼åˆ†é…ç»™å®é™…é¡µé¢æºï¼Œä½†ä»ç„¶å­˜åœ¨ä¾‹å¤–ã€‚é€šå¸¸ï¼Œæµè§ˆå™¨å…è®¸ä½¿ç”¨ <strong>å­åŸŸ</strong> æˆ– <strong>çˆ¶åŸŸ</strong>ã€‚</p>
<p>Sinks:</p>
<pre><code class="language-javascript">document.domain
</code></pre>
<h3 id="websocket-url-poisoning"><a class="header" href="#websocket-url-poisoning">WebSocket-URL poisoning</a></h3>
<p>æ¥è‡ª: <a href="https://portswigger.net/web-security/dom-based/websocket-url-poisoning">https://portswigger.net/web-security/dom-based/websocket-url-poisoning</a></p>
<p><strong>WebSocket-URL poisoning</strong> å‘ç”Ÿåœ¨è„šæœ¬å°† <strong>å¯æ§æ•°æ®ä½œä¸º WebSocket è¿æ¥çš„ç›®æ ‡ URL</strong> ä½¿ç”¨æ—¶ã€‚</p>
<p>Sinks:</p>
<p><code>WebSocket</code> æ„é€ å‡½æ•°å¯èƒ½å¯¼è‡´ WebSocket-URL poisoning æ¼æ´ã€‚</p>
<h3 id="link-manipulation"><a class="header" href="#link-manipulation">Link manipulation</a></h3>
<p>æ¥è‡ª: <a href="https://portswigger.net/web-security/dom-based/link-manipulation">https://portswigger.net/web-security/dom-based/link-manipulation</a></p>
<p><strong>DOM-based link-manipulation vulnerabilities</strong> å‡ºç°äºè„šæœ¬å°† <strong>æ”»å‡»è€…å¯æ§çš„æ•°æ®å†™å…¥å½“å‰é¡µé¢çš„å¯¼èˆªç›®æ ‡</strong>ï¼Œä¾‹å¦‚å¯ç‚¹å‡»çš„é“¾æ¥æˆ–è¡¨å•çš„æäº¤ URLã€‚</p>
<p>Sinks:</p>
<pre><code class="language-javascript">someDOMElement.href
someDOMElement.src
someDOMElement.action
</code></pre>
<h3 id="ajaxè¯·æ±‚æ“æ§"><a class="header" href="#ajaxè¯·æ±‚æ“æ§">Ajaxè¯·æ±‚æ“æ§</a></h3>
<p>æ¥è‡ª: <a href="https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation">https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation</a></p>
<p><strong>Ajaxè¯·æ±‚æ“æ§æ¼æ´</strong> å‡ºç°äºè„šæœ¬å°† <strong>æ”»å‡»è€…å¯æ§çš„æ•°æ®å†™å…¥ä½¿ç”¨ <code>XmlHttpRequest</code> å¯¹è±¡å‘å‡ºçš„Ajaxè¯·æ±‚</strong> æ—¶ã€‚</p>
<p>Sink:</p>
<pre><code class="language-javascript">XMLHttpRequest.setRequestHeader()
XMLHttpRequest.open()
XMLHttpRequest.send()
jQuery.globalEval()
$.globalEval()
</code></pre>
<h3 id="æœ¬åœ°æ–‡ä»¶è·¯å¾„æ“æ§"><a class="header" href="#æœ¬åœ°æ–‡ä»¶è·¯å¾„æ“æ§">æœ¬åœ°æ–‡ä»¶è·¯å¾„æ“æ§</a></h3>
<p>æ¥è‡ª: <a href="https://portswigger.net/web-security/dom-based/local-file-path-manipulation">https://portswigger.net/web-security/dom-based/local-file-path-manipulation</a></p>
<p><strong>æœ¬åœ°æ–‡ä»¶è·¯å¾„æ“æ§æ¼æ´</strong> å‡ºç°äºè„šæœ¬å°† <strong>æ”»å‡»è€…å¯æ§çš„æ•°æ®ä¼ é€’ç»™æ–‡ä»¶å¤„ç†API</strong> ä½œä¸º <code>filename</code> å‚æ•°ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ„é€ ä¸€ä¸ªURLï¼Œå¦‚æœå¦ä¸€ä¸ªç”¨æˆ·è®¿é—®è¯¥URLï¼Œå¯èƒ½å¯¼è‡´ <strong>ç”¨æˆ·çš„æµè§ˆå™¨æ‰“å¼€æˆ–å†™å…¥ä»»æ„æœ¬åœ°æ–‡ä»¶</strong>ã€‚</p>
<p>Sinks:</p>
<pre><code class="language-javascript">FileReader.readAsArrayBuffer()
FileReader.readAsBinaryString()
FileReader.readAsDataURL()
FileReader.readAsText()
FileReader.readAsFile()
FileReader.root.getFile()
FileReader.root.getFile()
</code></pre>
<h3 id="å®¢æˆ·ç«¯-sql-æ³¨å…¥"><a class="header" href="#å®¢æˆ·ç«¯-sql-æ³¨å…¥">å®¢æˆ·ç«¯ SQL æ³¨å…¥</a></h3>
<p>æ¥è‡ª: <a href="https://portswigger.net/web-security/dom-based/client-side-sql-injection">https://portswigger.net/web-security/dom-based/client-side-sql-injection</a></p>
<p><strong>å®¢æˆ·ç«¯ SQL æ³¨å…¥æ¼æ´</strong> å‘ç”Ÿåœ¨è„šæœ¬ä»¥ <strong>ä¸å®‰å…¨çš„æ–¹å¼å°†æ”»å‡»è€…å¯æ§çš„æ•°æ®çº³å…¥å®¢æˆ·ç«¯ SQL æŸ¥è¯¢</strong> æ—¶ã€‚</p>
<p>Sinks:</p>
<pre><code class="language-javascript">executeSql()
</code></pre>
<h3 id="html5-storage-manipulation"><a class="header" href="#html5-storage-manipulation">HTML5-storage manipulation</a></h3>
<p>From: <a href="https://portswigger.net/web-security/dom-based/html5-storage-manipulation">https://portswigger.net/web-security/dom-based/html5-storage-manipulation</a></p>
<p><strong>HTML5-storage manipulation vulnerabilities</strong> å‡ºç°äºè„šæœ¬ <strong>åœ¨ç½‘é¡µæµè§ˆå™¨çš„ HTML5 å­˜å‚¨ä¸­å­˜å‚¨æ”»å‡»è€…å¯æ§çš„æ•°æ®</strong> (<code>localStorage</code> æˆ– <code>sessionStorage</code>)ã€‚è™½ç„¶æ­¤æ“ä½œæœ¬èº«å¹¶ä¸æ˜¯å®‰å…¨æ¼æ´ï¼Œä½†å¦‚æœåº”ç”¨ç¨‹åºéšå <strong>è¯»å–å­˜å‚¨çš„æ•°æ®å¹¶ä¸å®‰å…¨åœ°å¤„ç†å®ƒ</strong>ï¼Œåˆ™ä¼šå˜å¾—æœ‰é—®é¢˜ã€‚è¿™å¯èƒ½å…è®¸æ”»å‡»è€…åˆ©ç”¨å­˜å‚¨æœºåˆ¶è¿›è¡Œå…¶ä»–åŸºäº DOM çš„æ”»å‡»ï¼Œä¾‹å¦‚è·¨ç«™è„šæœ¬å’Œ JavaScript æ³¨å…¥ã€‚</p>
<p>Sinks:</p>
<pre><code class="language-javascript">sessionStorage.setItem()
localStorage.setItem()
</code></pre>
<h3 id="xpath-æ³¨å…¥"><a class="header" href="#xpath-æ³¨å…¥">XPath æ³¨å…¥</a></h3>
<p>æ¥è‡ª: <a href="https://portswigger.net/web-security/dom-based/client-side-xpath-injection">https://portswigger.net/web-security/dom-based/client-side-xpath-injection</a></p>
<p><strong>åŸºäº DOM çš„ XPath æ³¨å…¥æ¼æ´</strong> å‘ç”Ÿåœ¨è„šæœ¬å°† <strong>æ”»å‡»è€…å¯æ§çš„æ•°æ®çº³å…¥ XPath æŸ¥è¯¢</strong> æ—¶ã€‚</p>
<p>Sinks:</p>
<pre><code class="language-javascript">document.evaluate()
someDOMElement.evaluate()
</code></pre>
<h3 id="å®¢æˆ·ç«¯-json-æ³¨å…¥"><a class="header" href="#å®¢æˆ·ç«¯-json-æ³¨å…¥">å®¢æˆ·ç«¯ JSON æ³¨å…¥</a></h3>
<p>æ¥è‡ª: <a href="https://portswigger.net/web-security/dom-based/client-side-json-injection">https://portswigger.net/web-security/dom-based/client-side-json-injection</a></p>
<p><strong>åŸºäº DOM çš„ JSON æ³¨å…¥æ¼æ´</strong> å‘ç”Ÿåœ¨è„šæœ¬å°† <strong>æ”»å‡»è€…å¯æ§çš„æ•°æ®çº³å…¥ä¸€ä¸ªè¢«è§£æä¸º JSON æ•°æ®ç»“æ„çš„å­—ç¬¦ä¸²ä¸­ï¼Œç„¶åç”±åº”ç”¨ç¨‹åºå¤„ç†</strong>ã€‚</p>
<p>Sinks:</p>
<pre><code class="language-javascript">JSON.parse()
jQuery.parseJSON()
$.parseJSON()
</code></pre>
<h3 id="web-message-manipulation"><a class="header" href="#web-message-manipulation">Web-message manipulation</a></h3>
<p>From: <a href="https://portswigger.net/web-security/dom-based/web-message-manipulation">https://portswigger.net/web-security/dom-based/web-message-manipulation</a></p>
<p><strong>Web-message vulnerabilities</strong> åœ¨è„šæœ¬å°† <strong>æ”»å‡»è€…å¯æ§çš„æ•°æ®ä½œä¸ºç½‘ç»œæ¶ˆæ¯å‘é€åˆ°æµè§ˆå™¨å†…çš„å¦ä¸€ä¸ªæ–‡æ¡£</strong> æ—¶å‡ºç°ã€‚ä¸€ä¸ª <strong>ç¤ºä¾‹</strong> çš„æ˜“å—æ”»å‡»çš„Webæ¶ˆæ¯æ“æ§å¯ä»¥åœ¨ <a href="https://portswigger.net/web-security/dom-based/controlling-the-web-message-source">PortSwiggerçš„ç½‘ç»œå®‰å…¨å­¦é™¢</a> æ‰¾åˆ°ã€‚</p>
<p>Sinks:</p>
<p><code>postMessage()</code> æ–¹æ³•ç”¨äºå‘é€ç½‘ç»œæ¶ˆæ¯ï¼Œå¦‚æœæ¥æ”¶æ¶ˆæ¯çš„äº‹ä»¶ç›‘å¬å™¨ä»¥ä¸å®‰å…¨çš„æ–¹å¼å¤„ç†ä¼ å…¥æ•°æ®ï¼Œåˆ™å¯èƒ½å¯¼è‡´æ¼æ´ã€‚</p>
<h3 id="dom-data-manipulation"><a class="header" href="#dom-data-manipulation">DOM-data manipulation</a></h3>
<p>From: <a href="https://portswigger.net/web-security/dom-based/dom-data-manipulation">https://portswigger.net/web-security/dom-based/dom-data-manipulation</a></p>
<p><strong>DOM-data manipulation vulnerabilities</strong> åœ¨è„šæœ¬å°† <strong>æ”»å‡»è€…å¯æ§çš„æ•°æ®å†™å…¥DOMä¸­çš„ä¸€ä¸ªå­—æ®µ</strong> æ—¶å‡ºç°ï¼Œè¯¥å­—æ®µåœ¨å¯è§çš„UIæˆ–å®¢æˆ·ç«¯é€»è¾‘ä¸­è¢«ä½¿ç”¨ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ„é€ ä¸€ä¸ªURLï¼Œå¦‚æœå…¶ä»–ç”¨æˆ·è®¿é—®è¯¥URLï¼Œå¯ä»¥æ”¹å˜å®¢æˆ·ç«¯UIçš„å¤–è§‚æˆ–è¡Œä¸ºã€‚</p>
<p>Sinks:</p>
<pre><code class="language-javascript">scriptElement.src
scriptElement.text
scriptElement.textContent
scriptElement.innerText
someDOMElement.setAttribute()
someDOMElement.search
someDOMElement.text
someDOMElement.textContent
someDOMElement.innerText
someDOMElement.outerText
someDOMElement.value
someDOMElement.name
someDOMElement.target
someDOMElement.method
someDOMElement.type
someDOMElement.backgroundImage
someDOMElement.cssText
someDOMElement.codebase
document.title
document.implementation.createHTMLDocument()
history.pushState()
history.replaceState()
</code></pre>
<h3 id="denial-of-service"><a class="header" href="#denial-of-service">Denial of Service</a></h3>
<p>From: <a href="https://portswigger.net/web-security/dom-based/denial-of-service">https://portswigger.net/web-security/dom-based/denial-of-service</a></p>
<p><strong>åŸºäºDOMçš„æ‹’ç»æœåŠ¡æ¼æ´</strong>å‘ç”Ÿåœ¨è„šæœ¬å°†<strong>æ”»å‡»è€…å¯æ§çš„æ•°æ®ä¸å®‰å…¨åœ°ä¼ é€’ç»™æœ‰é—®é¢˜çš„å¹³å°API</strong>æ—¶ã€‚è¿™åŒ…æ‹¬åœ¨è°ƒç”¨æ—¶å¯èƒ½å¯¼è‡´ç”¨æˆ·è®¡ç®—æœºæ¶ˆè€—<strong>è¿‡å¤šçš„CPUæˆ–ç£ç›˜ç©ºé—´</strong>çš„APIã€‚è¿™ç±»æ¼æ´å¯èƒ½ä¼šäº§ç”Ÿæ˜¾è‘—çš„å‰¯ä½œç”¨ï¼Œä¾‹å¦‚æµè§ˆå™¨é€šè¿‡æ‹’ç»å°è¯•åœ¨<code>localStorage</code>ä¸­å­˜å‚¨æ•°æ®æˆ–ç»ˆæ­¢ç¹å¿™çš„è„šæœ¬æ¥é™åˆ¶ç½‘ç«™çš„åŠŸèƒ½ã€‚</p>
<p>Sinks:</p>
<pre><code class="language-javascript">requestFileSystem()
RegExp()
</code></pre>
<h2 id="dom-clobbering"><a class="header" href="#dom-clobbering">Dom Clobbering</a></h2>
<p>{% content-ref url="dom-clobbering.md" %}
<a href="dom-clobbering.html">dom-clobbering.md</a>
{% endcontent-ref %}</p>
<p>{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>Telegram ç¾¤ç»„</strong></a> æˆ– <strong>åœ¨</strong> <strong>Twitter</strong> ğŸ¦ <strong>ä¸Šå…³æ³¨æˆ‘ä»¬</strong> <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../pentesting-web/xss-cross-site-scripting/dom-invader.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../pentesting-web/xss-cross-site-scripting/iframes-in-xss-and-csp.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../pentesting-web/xss-cross-site-scripting/dom-invader.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../pentesting-web/xss-cross-site-scripting/iframes-in-xss-and-csp.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
