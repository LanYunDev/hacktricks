<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Pentesting RFID</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="pentesting-rfid"><a class="header" href="#pentesting-rfid">Pentesting RFID</a></h1>
<p>{% hint style="success" %}
学习和实践 AWS 黑客技术：<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习和实践 GCP 黑客技术：<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>Telegram 群组</strong></a> 或 <strong>关注</strong> 我们的 <strong>Twitter</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub 仓库提交 PR 分享黑客技巧。</li>
</ul>
</details>
{% endhint %}
<h2 id="介绍"><a class="header" href="#介绍">介绍</a></h2>
<p><strong>射频识别 (RFID)</strong> 是最流行的短距离无线解决方案。它通常用于存储和传输识别实体的信息。</p>
<p>RFID 标签可以依赖于 <strong>自身的电源 (主动)</strong>，例如嵌入式电池，或通过读取天线接收来自 <strong>接收无线电波的电流</strong>（<strong>被动</strong>）来获取电源。</p>
<h3 id="类别"><a class="header" href="#类别">类别</a></h3>
<p>EPCglobal 将 RFID 标签分为六类。每个类别的标签都具备前一类别中列出的所有功能，从而实现向后兼容。</p>
<ul>
<li><strong>Class 0</strong> 标签是 <strong>被动</strong> 标签，工作在 <strong>UHF</strong> 频段。供应商在生产工厂 <strong>预编程</strong> 它们。因此，您 <strong>无法更改</strong> 存储在其内存中的信息。</li>
<li><strong>Class 1</strong> 标签也可以在 <strong>HF</strong> 频段工作。此外，它们在生产后只能 <strong>写入一次</strong>。许多 Class 1 标签还可以处理接收到的命令的 <strong>循环冗余检查</strong>（CRC）。CRC 是命令末尾的几个额外字节，用于错误检测。</li>
<li><strong>Class 2</strong> 标签可以 <strong>多次写入</strong>。</li>
<li><strong>Class 3</strong> 标签可以包含 <strong>嵌入式传感器</strong>，可以记录环境参数，例如当前温度或标签的运动。这些标签是 <strong>半主动</strong> 的，因为尽管它们 <strong>具有</strong> 嵌入式电源，例如集成 <strong>电池</strong>，但它们 <strong>无法发起</strong> 与其他标签或读取器的无线 <strong>通信</strong>。</li>
<li><strong>Class 4</strong> 标签可以与同类的其他标签发起通信，使其成为 <strong>主动标签</strong>。</li>
<li><strong>Class 5</strong> 标签可以为其他标签提供 <strong>电源并与所有前面的标签</strong> 类别进行通信。Class 5 标签可以充当 <strong>RFID 读取器</strong>。</li>
</ul>
<h3 id="rfid-标签中存储的信息"><a class="header" href="#rfid-标签中存储的信息">RFID 标签中存储的信息</a></h3>
<p>RFID 标签的内存通常存储四种数据：<strong>识别数据</strong>，用于 <strong>识别</strong> 标签所附着的 <strong>实体</strong>（这些数据包括用户定义的字段，例如银行账户）；<strong>补充数据</strong>，提供有关实体的 <strong>进一步</strong> <strong>细节</strong>；<strong>控制数据</strong>，用于标签的内部 <strong>配置</strong>；以及标签的 <strong>制造商数据</strong>，其中包含标签的唯一标识符（<strong>UID</strong>）和有关标签的 <strong>生产</strong>、<strong>类型</strong> 和 <strong>供应商</strong> 的详细信息。您将在所有商业标签中找到前两种数据；最后两种数据可能会根据标签的供应商而有所不同。</p>
<p>ISO 标准指定了应用程序系列标识符（<strong>AFI</strong>）值，这是一个指示标签所属 <strong>对象类型</strong> 的代码。另一个重要的寄存器，也是由 ISO 指定的，是数据存储格式标识符（<strong>DSFID</strong>），它定义了 <strong>用户数据的逻辑组织</strong>。</p>
<p>大多数 RFID <strong>安全控制</strong> 具有机制，<strong>限制</strong> 每个用户内存块以及包含 AFI 和 DSFID 值的特殊寄存器上的 <strong>读取</strong> 或 <strong>写入</strong> 操作。这些 <strong>锁定</strong> <strong>机制</strong> 使用存储在控制内存中的数据，并具有供应商预配置的 <strong>默认密码</strong>，但允许标签所有者 <strong>配置自定义密码</strong>。</p>
<h3 id="低频与高频标签比较"><a class="header" href="#低频与高频标签比较">低频与高频标签比较</a></h3>
<figure><img src="../../.gitbook/assets/image (983).png" alt=""><figcaption></figcaption></figure>
<h2 id="低频-rfid-标签-125khz"><a class="header" href="#低频-rfid-标签-125khz">低频 RFID 标签 (125kHz)</a></h2>
<p><strong>低频标签</strong> 通常用于 <strong>不需要高安全性</strong> 的系统：建筑物访问、对讲机钥匙、健身会员卡等。由于其较高的范围，它们在付费停车时使用方便：司机无需将卡靠近读取器，因为它可以在更远的地方触发。同时，低频标签非常原始，数据传输速率低。因此，无法实现复杂的双向数据传输，例如保持余额和加密。低频标签仅传输其短 ID，而没有任何身份验证手段。</p>
<p>这些设备依赖于 <strong>被动</strong> <strong>RFID</strong> 技术，工作在 <strong>30 kHz 到 300 kHz</strong> 的范围内，尽管更常用的是 125 kHz 到 134 kHz：</p>
<ul>
<li><strong>长距离</strong> — 较低的频率意味着更高的范围。有一些 EM-Marin 和 HID 读取器，可以在距离达一米的地方工作。这些通常用于停车场。</li>
<li><strong>原始协议</strong> — 由于数据传输速率低，这些标签只能传输其短 ID。在大多数情况下，数据没有经过身份验证，也没有以任何方式受到保护。只要卡在读取器的范围内，它就会开始传输其 ID。</li>
<li><strong>低安全性</strong> — 这些卡可以很容易地被复制，甚至可以从其他人的口袋中读取，因为协议的原始性。</li>
</ul>
<p><strong>流行的 125 kHz 协议：</strong></p>
<ul>
<li><strong>EM-Marin</strong> — EM4100，EM4102。CIS 中最流行的协议。由于其简单性和稳定性，可以在约一米的距离内读取。</li>
<li><strong>HID Prox II</strong> — HID Global 引入的低频协议。该协议在西方国家更为流行。它更复杂，且该协议的卡和读取器相对昂贵。</li>
<li><strong>Indala</strong> — 由摩托罗拉引入的非常古老的低频协议，后来被 HID 收购。与前两者相比，您在野外遇到它的可能性较小，因为它正在逐渐被淘汰。</li>
</ul>
<p>实际上，还有很多其他低频协议。但它们都在物理层上使用相同的调制方式，可以被视为上述协议的某种变体。</p>
<h3 id="攻击"><a class="header" href="#攻击">攻击</a></h3>
<p>您可以 <strong>使用 Flipper Zero 攻击这些标签</strong>：</p>
<p>{% content-ref url="flipper-zero/fz-125khz-rfid.md" %}
<a href="flipper-zero/fz-125khz-rfid.html">fz-125khz-rfid.md</a>
{% endcontent-ref %}</p>
<h2 id="高频-rfid-标签-1356-mhz"><a class="header" href="#高频-rfid-标签-1356-mhz">高频 RFID 标签 (13.56 MHz)</a></h2>
<p><strong>高频标签</strong> 用于更复杂的读取器-标签交互，当您需要加密、大量双向数据传输、身份验证等时。<br />
它通常出现在银行卡、公共交通和其他安全通行证中。</p>
<p><strong>高频 13.56 MHz 标签是一组标准和协议</strong>。它们通常被称为 <a href="https://nfc-forum.org/what-is-nfc/about-the-technology/">NFC</a>，但这并不总是正确。物理和逻辑层上使用的基本协议集是 ISO 14443。高级协议以及替代标准（如 ISO 19092）都是基于它的。许多人将这项技术称为 <strong>近场通信 (NFC)</strong>，这是指在 13.56 MHz 频率上运行的设备。</p>
<figure><img src="../../.gitbook/assets/image (930).png" alt=""><figcaption></figcaption></figure>
<p>简单来说，NFC 的架构是这样的：传输协议由制造卡片的公司选择，并基于低级 ISO 14443 实现。例如，NXP 发明了自己的高级传输协议，称为 Mifare。但在较低层面上，Mifare 卡是基于 ISO 14443-A 标准的。</p>
<p>Flipper 可以与低级 ISO 14443 协议以及 Mifare Ultralight 数据传输协议和用于银行卡的 EMV 进行交互。我们正在努力添加对 Mifare Classic 和 NFC NDEF 的支持。深入研究构成 NFC 的协议和标准值得单独撰写一篇文章，我们计划稍后发布。</p>
<p>所有基于 ISO 14443-A 标准的高频卡都有一个唯一的芯片 ID。它充当卡的序列号，类似于网络卡的 MAC 地址。<strong>通常，UID 长度为 4 或 7 字节</strong>，但很少可以 <strong>达到 10</strong>。UID 不是秘密，且易于读取，<strong>有时甚至印在卡片上</strong>。</p>
<p>有许多访问控制系统依赖 UID 来 <strong>进行身份验证和授予访问</strong>。有时即使 RFID 标签 <strong>支持加密</strong>，这种情况也会发生。这种 <strong>误用</strong> 使它们在 <strong>安全性</strong> 上降至愚蠢的 <strong>125 kHz 卡</strong> 的水平。虚拟卡（如 Apple Pay）使用动态 UID，以便手机用户不会用他们的支付应用打开门。</p>
<ul>
<li><strong>低范围</strong> — 高频卡专门设计为必须靠近读取器放置。这也有助于保护卡免受未经授权的交互。我们所能实现的最大读取范围约为 15 厘米，而这还是使用定制的高范围读取器。</li>
<li><strong>高级协议</strong> — 数据传输速度高达 424 kbps，允许复杂的协议进行完整的双向数据传输。这反过来 <strong>允许加密</strong>、数据传输等。</li>
<li><strong>高安全性</strong> — 高频非接触卡在任何方面都不逊色于智能卡。有些卡支持强加密算法，如 AES，并实现非对称加密。</li>
</ul>
<h3 id="攻击-1"><a class="header" href="#攻击-1">攻击</a></h3>
<p>您可以 <strong>使用 Flipper Zero 攻击这些标签</strong>：</p>
<p>{% content-ref url="flipper-zero/fz-nfc.md" %}
<a href="flipper-zero/fz-nfc.html">fz-nfc.md</a>
{% endcontent-ref %}</p>
<p>或者使用 <strong>proxmark</strong>：</p>
<p>{% content-ref url="proxmark-3.md" %}
<a href="proxmark-3.html">proxmark-3.md</a>
{% endcontent-ref %}</p>
<h2 id="参考文献"><a class="header" href="#参考文献">参考文献</a></h2>
<ul>
<li><a href="https://blog.flipperzero.one/rfid/">https://blog.flipperzero.one/rfid/</a></li>
</ul>
<p>{% hint style="success" %}
学习和实践 AWS 黑客技术：<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习和实践 GCP 黑客技术：<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>Telegram 群组</strong></a> 或 <strong>关注</strong> 我们的 <strong>Twitter</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub 仓库提交 PR 分享黑客技巧。</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../todo/radio-hacking/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../todo/radio-hacking/infrared.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../todo/radio-hacking/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../todo/radio-hacking/infrared.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
