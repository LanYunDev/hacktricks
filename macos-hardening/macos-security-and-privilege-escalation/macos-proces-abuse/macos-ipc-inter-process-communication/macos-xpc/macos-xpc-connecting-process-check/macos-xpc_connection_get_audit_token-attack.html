<!DOCTYPE HTML>
<html lang="zh" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>macOS xpc_connection_get_audit_token Attack</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../../../../../favicon.svg">
        <link rel="shortcut icon" href="../../../../../../favicon.png">
        <link rel="stylesheet" href="../../../../../../css/variables.css">
        <link rel="stylesheet" href="../../../../../../css/general.css">
        <link rel="stylesheet" href="../../../../../../css/chrome.css">
        <link rel="stylesheet" href="../../../../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../../../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../../../../highlight.css">
        <link rel="stylesheet" href="../../../../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../../../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../../../../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../../../../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../../../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="macos-xpc_connection_get_audit_token-攻击"><a class="header" href="#macos-xpc_connection_get_audit_token-攻击">macOS xpc_connection_get_audit_token 攻击</a></h1>
<p>{% hint style="success" %}
学习和实践 AWS 黑客技术：<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习和实践 GCP 黑客技术：<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>Telegram 群组</strong></a> 或 <strong>关注</strong> 我们的 <strong>Twitter</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub 仓库提交 PR 分享黑客技巧。</li>
</ul>
</details>
{% endhint %}
<p><strong>有关更多信息，请查看原始帖子：</strong> <a href="https://sector7.computest.nl/post/2023-10-xpc-audit-token-spoofing/"><strong>https://sector7.computest.nl/post/2023-10-xpc-audit-token-spoofing/</strong></a>。这是一个摘要：</p>
<h2 id="mach-消息基本信息"><a class="header" href="#mach-消息基本信息">Mach 消息基本信息</a></h2>
<p>如果你不知道 Mach 消息是什么，请开始查看此页面：</p>
<p>{% content-ref url="../../" %}
<a href="../../">..</a>
{% endcontent-ref %}</p>
<p>目前请记住（<a href="https://sector7.computest.nl/post/2023-10-xpc-audit-token-spoofing">此处定义</a>）：<br />
Mach 消息通过 <em>mach 端口</em> 发送，这是一个内置于 mach 内核的 <strong>单接收者，多发送者通信</strong> 通道。<strong>多个进程可以向 mach 端口发送消息</strong>，但在任何时候 <strong>只有一个进程可以从中读取</strong>。就像文件描述符和套接字一样，mach 端口由内核分配和管理，进程只看到一个整数，可以用来指示内核它们想使用哪个 mach 端口。</p>
<h2 id="xpc-连接"><a class="header" href="#xpc-连接">XPC 连接</a></h2>
<p>如果你不知道如何建立 XPC 连接，请查看：</p>
<p>{% content-ref url="../" %}
<a href="../">..</a>
{% endcontent-ref %}</p>
<h2 id="漏洞摘要"><a class="header" href="#漏洞摘要">漏洞摘要</a></h2>
<p>你需要知道的有趣信息是 <strong>XPC 的抽象是一个一对一的连接</strong>，但它是基于一种 <strong>可以有多个发送者的技术，因此：</strong></p>
<ul>
<li>Mach 端口是单接收者，<strong>多个发送者</strong>。</li>
<li>XPC 连接的审计令牌是 <strong>从最近接收到的消息中复制的审计令牌</strong>。</li>
<li>获取 XPC 连接的 <strong>审计令牌</strong> 对许多 <strong>安全检查</strong> 至关重要。</li>
</ul>
<p>尽管前面的情况听起来很有前景，但在某些场景中这不会导致问题（<a href="https://sector7.computest.nl/post/2023-10-xpc-audit-token-spoofing">来自这里</a>）：</p>
<ul>
<li>审计令牌通常用于授权检查，以决定是否接受连接。由于这是通过向服务端口发送消息进行的，因此 <strong>尚未建立连接</strong>。在此端口上的更多消息将被视为额外的连接请求。因此，任何 <strong>在接受连接之前的检查都不易受攻击</strong>（这也意味着在 <code>-listener:shouldAcceptNewConnection:</code> 中审计令牌是安全的）。因此，我们 <strong>正在寻找验证特定操作的 XPC 连接</strong>。</li>
<li>XPC 事件处理程序是同步处理的。这意味着一个消息的事件处理程序必须在调用下一个之前完成，即使在并发调度队列中。因此，在 <strong>XPC 事件处理程序内部，审计令牌不能被其他正常（非回复！）消息覆盖</strong>。</li>
</ul>
<p>这可能被利用的两种不同方法：</p>
<ol>
<li>变体1：</li>
</ol>
<ul>
<li><strong>利用</strong> <strong>连接</strong> 到服务 <strong>A</strong> 和服务 <strong>B</strong></li>
<li>服务 <strong>B</strong> 可以调用服务 A 中用户无法调用的 <strong>特权功能</strong></li>
<li>服务 <strong>A</strong> 在 <strong><code>dispatch_async</code></strong> 中的连接事件处理程序 <em><strong>外部</strong></em> 调用 <strong><code>xpc_connection_get_audit_token</code></strong>。</li>
<li>因此，<strong>不同的</strong> 消息可能会 <strong>覆盖审计令牌</strong>，因为它在事件处理程序外部异步调度。</li>
<li>利用将 <strong>发送权</strong> 传递给 <strong>服务 B</strong> 到服务 <strong>A</strong>。</li>
<li>因此 svc <strong>B</strong> 实际上将 <strong>发送</strong> 消息到服务 <strong>A</strong>。</li>
<li><strong>利用</strong> 尝试 <strong>调用</strong> <strong>特权操作</strong>。在 RC svc <strong>A</strong> <strong>检查</strong> 此 <strong>操作</strong> 的授权，同时 <strong>svc B 覆盖了审计令牌</strong>（使利用能够调用特权操作）。</li>
</ul>
<ol start="2">
<li>变体 2：</li>
</ol>
<ul>
<li>服务 <strong>B</strong> 可以调用服务 A 中用户无法调用的 <strong>特权功能</strong></li>
<li>利用与 <strong>服务 A</strong> 连接，<strong>发送</strong> 利用一个 <strong>期望回复</strong> 的消息到一个特定的 <strong>回复</strong> <strong>端口</strong>。</li>
<li>利用向 <strong>服务</strong> B 发送一条消息，传递 <strong>该回复端口</strong>。</li>
<li>当服务 <strong>B 回复</strong> 时，它将 <strong>消息发送到服务 A</strong>，<strong>同时</strong> 利用向服务 A 发送不同的 <strong>消息</strong>，试图 <strong>达到特权功能</strong>，并期望服务 B 的回复会在完美的时刻覆盖审计令牌（竞争条件）。</li>
</ul>
<h2 id="变体-1在事件处理程序外部调用-xpc_connection_get_audit_token"><a class="header" href="#变体-1在事件处理程序外部调用-xpc_connection_get_audit_token">变体 1：在事件处理程序外部调用 xpc_connection_get_audit_token <a href="#variant-1-calling-xpc_connection_get_audit_token-outside-of-an-event-handler" id="variant-1-calling-xpc_connection_get_audit_token-outside-of-an-event-handler"></a></a></h2>
<p>场景：</p>
<ul>
<li>两个 mach 服务 <strong><code>A</code></strong> 和 <strong><code>B</code></strong>，我们都可以连接（基于沙箱配置文件和接受连接之前的授权检查）。</li>
<li><em><strong>A</strong></em> 必须对 <strong><code>B</code></strong> 可以传递的特定操作进行 <strong>授权检查</strong>（但我们的应用程序不能）。</li>
<li>例如，如果 B 拥有某些 <strong>权限</strong> 或以 <strong>root</strong> 身份运行，它可能允许他请求 A 执行特权操作。</li>
<li>对于此授权检查，<strong><code>A</code></strong> 异步获取审计令牌，例如通过从 <strong><code>dispatch_async</code></strong> 调用 <code>xpc_connection_get_audit_token</code>。</li>
</ul>
<p>{% hint style="danger" %}
在这种情况下，攻击者可以触发 <strong>竞争条件</strong>，使 <strong>利用</strong> <strong>多次请求 A 执行操作</strong>，同时使 <strong>B 向 <code>A</code> 发送消息</strong>。当 RC <strong>成功</strong> 时，<strong>B</strong> 的 <strong>审计令牌</strong> 将在 <strong>我们的利用</strong> 的请求被 <strong>处理</strong> 时复制到内存中，从而使其 <strong>访问只有 B 可以请求的特权操作</strong>。
{% endhint %}</p>
<p>这发生在 <strong><code>A</code></strong> 作为 <code>smd</code> 和 <strong><code>B</code></strong> 作为 <code>diagnosticd</code>。<a href="https://developer.apple.com/documentation/servicemanagement/1431078-smjobbless?language=objc"><code>SMJobBless</code></a> 函数可以用于安装新的特权辅助工具（作为 <strong>root</strong>）。如果 <strong>以 root 身份运行的进程联系</strong> <strong>smd</strong>，将不会执行其他检查。</p>
<p>因此，服务 <strong>B</strong> 是 <strong><code>diagnosticd</code></strong>，因为它以 <strong>root</strong> 身份运行并可用于 <strong>监控</strong> 进程，因此一旦监控开始，它将 <strong>每秒发送多条消息</strong>。</p>
<p>要执行攻击：</p>
<ol>
<li>使用标准 XPC 协议初始化与名为 <code>smd</code> 的服务的 <strong>连接</strong>。</li>
<li>形成与 <code>diagnosticd</code> 的二次 <strong>连接</strong>。与正常程序相反，而不是创建并发送两个新的 mach 端口，客户端端口发送权被替换为与 <code>smd</code> 连接相关联的 <strong>发送权</strong> 的副本。</li>
<li>结果，XPC 消息可以调度到 <code>diagnosticd</code>，但来自 <code>diagnosticd</code> 的响应被重定向到 <code>smd</code>。对于 <code>smd</code> 来说，来自用户和 <code>diagnosticd</code> 的消息似乎来自同一连接。</li>
</ol>
<p><img src="https://sector7.computest.nl/post/2023-10-xpc-audit-token-spoofing/exploit.png" alt="描述利用过程的图像" /></p>
<ol start="4">
<li>下一步是指示 <code>diagnosticd</code> 启动对所选进程（可能是用户自己的进程）的监控。同时，向 <code>smd</code> 发送大量常规 1004 消息。这里的意图是安装一个具有提升权限的工具。</li>
<li>此操作触发 <code>handle_bless</code> 函数中的竞争条件。时机至关重要：<code>xpc_connection_get_pid</code> 函数调用必须返回用户进程的 PID（因为特权工具位于用户的应用程序包中）。然而，<code>xpc_connection_get_audit_token</code> 函数，特别是在 <code>connection_is_authorized</code> 子例程中，必须引用属于 <code>diagnosticd</code> 的审计令牌。</li>
</ol>
<h2 id="变体-2回复转发"><a class="header" href="#变体-2回复转发">变体 2：回复转发</a></h2>
<p>在 XPC（跨进程通信）环境中，尽管事件处理程序不会并发执行，但回复消息的处理具有独特的行为。具体而言，存在两种不同的方法来发送期望回复的消息：</p>
<ol>
<li><strong><code>xpc_connection_send_message_with_reply</code></strong>：在这里，XPC 消息在指定队列上接收和处理。</li>
<li><strong><code>xpc_connection_send_message_with_reply_sync</code></strong>：相反，在此方法中，XPC 消息在当前调度队列上接收和处理。</li>
</ol>
<p>这种区别至关重要，因为它允许 <strong>回复数据包在执行 XPC 事件处理程序时并发解析</strong>。值得注意的是，虽然 <code>_xpc_connection_set_creds</code> 确实实现了锁定以防止审计令牌的部分覆盖，但它并未将此保护扩展到整个连接对象。因此，这造成了一个漏洞，即审计令牌可以在解析数据包和执行其事件处理程序之间的间隔中被替换。</p>
<p>要利用此漏洞，需要以下设置：</p>
<ul>
<li>两个 mach 服务，称为 <strong><code>A</code></strong> 和 <strong><code>B</code></strong>，都可以建立连接。</li>
<li>服务 <strong><code>A</code></strong> 应包含对只有 <strong><code>B</code></strong> 可以执行的特定操作的授权检查（用户的应用程序无法）。</li>
<li>服务 <strong><code>A</code></strong> 应发送一条期望回复的消息。</li>
<li>用户可以向 <strong><code>B</code></strong> 发送一条消息，<strong>B</strong> 将对此作出回应。</li>
</ul>
<p>利用过程涉及以下步骤：</p>
<ol>
<li>等待服务 <strong><code>A</code></strong> 发送一条期望回复的消息。</li>
<li>不直接回复 <strong><code>A</code></strong>，而是劫持回复端口并用其向服务 <strong><code>B</code></strong> 发送消息。</li>
<li>随后，发送一条涉及禁止操作的消息，期望它与 <strong><code>B</code></strong> 的回复并发处理。</li>
</ol>
<p>以下是所描述攻击场景的可视化表示：</p>
<p>![https://sector7.computest.nl/post/2023-10-xpc-audit-token-spoofing/variant2.png](../../../../../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1).png)</p>
<figure><img src="../../../../../../.gitbook/assets/image (33).png" alt="https://sector7.computest.nl/post/2023-10-xpc-audit-token-spoofing/variant2.png" width="563"><figcaption></figcaption></figure>
<h2 id="发现问题"><a class="header" href="#发现问题">发现问题</a></h2>
<ul>
<li><strong>定位实例的困难</strong>：静态和动态搜索 <code>xpc_connection_get_audit_token</code> 使用实例都很具挑战性。</li>
<li><strong>方法论</strong>：使用 Frida 钩住 <code>xpc_connection_get_audit_token</code> 函数，过滤不来自事件处理程序的调用。然而，这种方法仅限于被钩住的进程，并且需要主动使用。</li>
<li><strong>分析工具</strong>：使用 IDA/Ghidra 等工具检查可达的 mach 服务，但该过程耗时，且由于涉及 dyld 共享缓存的调用而复杂。</li>
<li><strong>脚本限制</strong>：尝试为从 <code>dispatch_async</code> 块调用 <code>xpc_connection_get_audit_token</code> 的分析编写脚本时，由于解析块和与 dyld 共享缓存的交互的复杂性而受到阻碍。</li>
</ul>
<h2 id="修复"><a class="header" href="#修复">修复 <a href="#the-fix" id="the-fix"></a></a></h2>
<ul>
<li><strong>报告问题</strong>：向 Apple 提交了一份报告，详细说明了在 <code>smd</code> 中发现的一般和特定问题。</li>
<li><strong>Apple 的回应</strong>：Apple 通过将 <code>xpc_connection_get_audit_token</code> 替换为 <code>xpc_dictionary_get_audit_token</code> 解决了 <code>smd</code> 中的问题。</li>
<li><strong>修复的性质</strong>：<code>xpc_dictionary_get_audit_token</code> 函数被认为是安全的，因为它直接从与接收的 XPC 消息相关的 mach 消息中检索审计令牌。然而，它不是公共 API 的一部分，类似于 <code>xpc_connection_get_audit_token</code>。</li>
<li><strong>缺乏更广泛的修复</strong>：尚不清楚为什么 Apple 没有实施更全面的修复，例如丢弃与连接的保存审计令牌不一致的消息。某些场景（例如 <code>setuid</code> 使用）中合法审计令牌更改的可能性可能是一个因素。</li>
<li><strong>当前状态</strong>：该问题在 iOS 17 和 macOS 14 中仍然存在，给那些寻求识别和理解它的人带来了挑战。</li>
</ul>
<p>{% hint style="success" %}
学习和实践 AWS 黑客技术：<img src="/.gitbook/assets/arte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/arte"><strong>HackTricks 培训 AWS 红队专家 (ARTE)</strong></a><img src="/.gitbook/assets/arte.png" alt="" data-size="line"><br />
学习和实践 GCP 黑客技术：<img src="/.gitbook/assets/grte.png" alt="" data-size="line"><a href="https://training.hacktricks.xyz/courses/grte"><strong>HackTricks 培训 GCP 红队专家 (GRTE)</strong><img src="/.gitbook/assets/grte.png" alt="" data-size="line"></a></p>
<details>
<summary>支持 HackTricks</summary>
<ul>
<li>查看 <a href="https://github.com/sponsors/carlospolop"><strong>订阅计划</strong></a>!</li>
<li><strong>加入</strong> 💬 <a href="https://discord.gg/hRep4RUj7f"><strong>Discord 群组</strong></a> 或 <a href="https://t.me/peass"><strong>Telegram 群组</strong></a> 或 <strong>关注</strong> 我们的 <strong>Twitter</strong> 🐦 <a href="https://twitter.com/hacktricks_live"><strong>@hacktricks_live</strong></a><strong>.</strong></li>
<li><strong>通过向</strong> <a href="https://github.com/carlospolop/hacktricks"><strong>HackTricks</strong></a> 和 <a href="https://github.com/carlospolop/hacktricks-cloud"><strong>HackTricks Cloud</strong></a> GitHub 仓库提交 PR 分享黑客技巧。</li>
</ul>
</details>
{% endhint %}

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../../../../../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-ipc-inter-process-communication/macos-xpc/macos-xpc-connecting-process-check/macos-pid-reuse.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../../../../../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-ipc-inter-process-communication/macos-thread-injection-via-task-port.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../../../../../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-ipc-inter-process-communication/macos-xpc/macos-xpc-connecting-process-check/macos-pid-reuse.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../../../../../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-ipc-inter-process-communication/macos-thread-injection-via-task-port.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../../../../../elasticlunr.min.js"></script>
        <script src="../../../../../../mark.min.js"></script>
        <script src="../../../../../../searcher.js"></script>

        <script src="../../../../../../clipboard.min.js"></script>
        <script src="../../../../../../highlight.js"></script>
        <script src="../../../../../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
